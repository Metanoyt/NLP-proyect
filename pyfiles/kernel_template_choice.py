__future__ annotations typing Any Optional TYPE_CHECKING Union template_heuristics params DictKernelTemplateParams TYPE_CHECKING collections abc Generator codegen common KernelTemplate ir ChoiceCaller Layout kernel_inputs KernelInputs select_algorithm ExternKernelChoice template_heuristics params KernelTemplateParams KernelTemplateChoice A encapsulates all components needed create ChoiceCaller template This implements lazy evaluation choice property - actual ChoiceCaller only created when first accessed via choice property __init__ template Union KernelTemplate ExternKernelChoice params KernelTemplateParams extra_kwargs dict str Any layout Layout inputs KernelInputs template = template params = params extra_kwargs = extra_kwargs layout = layout inputs = inputs annotations dict str Any = ktc property choice - Optional ChoiceCaller Lazily evaluate ChoiceCaller template choice On first access calls template choice_or_none stored parameters If successful caches returns ChoiceCaller If fails caches returns None Subsequent accesses cached value Returns ChoiceCaller template choice succeeds None otherwise hasattr _choice First time accessing choice - try generate kwargs = params to_kwargs _choice = template choice_or_none kwargs extra_kwargs layout=self layout input_nodes=self inputs nodes _choice None _choice annotations = annotations _choice make_ktc_generator template Union KernelTemplate ExternKernelChoice cs Generator KernelTemplateParams None None extra_kwargs dict str Any overrides dict str Any layout Layout inputs KernelInputs - Generator KernelTemplateChoice None None Create generator KernelTemplateChoice objects given template Args template The template object KernelTemplate ExternKernelChoice cs Generator KernelTemplateParams template heuristic overrides Override kwargs template layout Layout value template inputs KernelInputs op Yields KernelTemplateChoice objects params cs Apply overrides params base_kwargs = params to_kwargs final_kwargs = base_kwargs overrides final_params = DictKernelTemplateParams final_kwargs yield KernelTemplateChoice template=template params=final_params extra_kwargs=extra_kwargs layout=layout inputs=inputs