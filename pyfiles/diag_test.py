operator_benchmark op_bench torch Microbenchmarks diag operator Configs PT diag operator diag_configs_short = op_bench config_list attr_names= dim M N diagonal out attrs= True - False True cross_product_configs= device cpu cuda tags= short DiagBenchmark op_bench TorchBenchmarkBase init dim M N diagonal out device inputs = input torch rand M N device=device dim == torch rand M device=device diagonal diagonal out out out_tensor torch tensor device=device set_module_name diag forward input diagonal int out bool out_tensor out torch diag input diagonal=diagonal out=out_tensor torch diag input diagonal=diagonal op_bench generate_pt_test diag_configs_short DiagBenchmark __name__ == __main__ op_bench benchmark_runner main