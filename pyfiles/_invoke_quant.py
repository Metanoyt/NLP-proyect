mypy allow-untyped-defs need fix prim_hop_base type annotations first dataclasses typing Optional torch torch _higher_order_ops base_hop BaseHOP FunctionWithNoFreeVars InvokeQuantTracer BaseHOP __init__ - None super __init__ invoke_quant_packed __call__ subgraph operands scheme=None quant_options=None subgraph = FunctionWithNoFreeVars subgraph super __call__ subgraph operands scheme=scheme quant_options=quant_options invoke_quant_packed = InvokeQuantTracer InvokeQuantUnpacked BaseHOP __init__ - None super __init__ invoke_quant __call__ subgraph operands scheme=None super __call__ subgraph operands scheme=scheme invoke_quant = InvokeQuantUnpacked dataclasses dataclass frozen=True repr=True InvokeQuant Invoke quantization function will preserved single operator Preservation single operator aids pattern matching custom lowerings The operation appears torch ops higher_order invoke_quant subgraph args scheme=scheme Args codegen_low_precision Use observed subgraph dtypes codegen instead upcasting fp Can improve performance prologue fusion requires careful testing numerics codegen_low_precision bool = True __call__ args scheme Optional str = None kwargs torch compiler is_compiling args args kwargs scheme None kwargs scheme = scheme invoke_quant_packed args kwargs quant_options=self type ignore call-arg