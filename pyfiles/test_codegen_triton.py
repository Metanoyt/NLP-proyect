Owner s module inductor contextlib sympy torch torch _inductor config inductor_config torch _inductor codegen triton_utils torch _inductor codegen common SizeArg torch _inductor graph GraphLowering torch _inductor test_case TestCase InductorTestCase torch _inductor virtualized V torch testing _internal inductor_utils HAS_CPU HAS_GPU TestCodegenTriton InductorTestCase setUp super setUp DummyModule torch nn Module forward x x _gm = torch fx symbolic_trace DummyModule _graph = GraphLowering _gm _stack = contextlib ExitStack _stack enter_context V set_graph_handler _graph tearDown _stack close super tearDown inductor_config patch triton divisible_by_ True test_config_of_sizearg torch _inductor utils get_triton_attrs_descriptor_version TritonAttrsDescriptorVersion two = sympy Integer eight = sympy Integer sixteen = sympy Integer s = sympy Symbol s positive=True integer=True s = sympy Symbol s positive=True integer=True _check_divisibility expected_divisible_indices config get_triton_attrs_descriptor_version TritonAttrsDescriptorVersion V _COMPILER TritonAttrsDescriptorVersion V _NO_TRITON assertEqual expected_divisible_indices config divisible_by_ get_triton_attrs_descriptor_version TritonAttrsDescriptorVersion V _BACKENDS TritonAttrsDescriptorVersion V _BACKENDS_TUPLE assertEqual expected_divisible_indices config divisibility_ assert get_triton_attrs_descriptor_version == TritonAttrsDescriptorVersion V _DICT assertIsInstance config dict idx expected_divisible_indices config form idx tt divisibility where idx tuple order support tuple inputs triton kernels assertTrue idx config assertTrue tt divisibility config idx _check_divisibility triton_utils config_of SizeArg A two no SizeArg B eight no SizeArg C sixteen yes SizeArg D s no SizeArg E s no _check_divisibility triton_utils config_of SizeArg A two eight yes SizeArg B eight s no SizeArg C two eight s yes SizeArg D s s no SizeArg E sixteen s yes SizeArg F sixteen eight s s yes SizeArg G two eight s s yes __name__ == __main__ torch _inductor test_case run_tests HAS_CPU HAS_GPU run_tests sympy