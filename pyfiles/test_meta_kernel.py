Owner s oncall jit torch torch _lazy torch _lazy ts_backend torch float float torch testing _internal common_utils TestCase torch _lazy ts_backend init TestMetaKernel TestCase test_addmm_invalid_dtype Tests addmm meta kernel returns correct output type input = torch ones dtype=torch float lazy assertTrue input dtype == torch float fc_nobias = torch nn Linear bias=False dtype=float lazy assertRaises Exception fc_nobias input test_addmm Tests addmm meta kernel returns correct output type input = torch ones dtype=torch float lazy assertEqual input dtype torch float fc_nobias = torch nn Linear bias=False dtype=float lazy out_nobias = fc_nobias input assertEqual out_nobias dtype torch float fc_bias = torch nn Linear bias=True dtype=float lazy out_bias = fc_bias input assertEqual out_bias dtype torch float test_add_invalid_device assertRaisesRegex RuntimeError lazy tensor _ = torch tensor device= cpu + torch tensor device= lazy __name__ == __main__ raise RuntimeError This test currently used should enabled discover_tests py required