argparse time common SubTensor SubWithTorchFunction WithTorchFunction torch NUM_REPEATS = NUM_REPEAT_OF_REPEATS = bench t t bench_times = _ range NUM_REPEAT_OF_REPEATS time_start = time time _ range NUM_REPEATS torch add t t bench_times append time time - time_start bench_time = float torch min torch tensor bench_times bench_std = float torch std torch tensor bench_times bench_time bench_std main global NUM_REPEATS global NUM_REPEAT_OF_REPEATS parser = argparse ArgumentParser description= Run __torch_function__ benchmarks parser add_argument -- nreps -n type=int default=NUM_REPEATS help= The number repeats one measurement parser add_argument -- nrepreps -m type=int default=NUM_REPEAT_OF_REPEATS help= The number measurements args = parser parse_args NUM_REPEATS = args nreps NUM_REPEAT_OF_REPEATS = args nrepreps types = torch tensor SubTensor WithTorchFunction SubWithTorchFunction t types tensor_ = t tensor_ = t bench_min bench_std = bench tensor_ tensor_ print f Type t __name__ had minimum time bench_min us f standard deviation bench_std us __name__ == __main__ main