Owner s module PrivateUse os torch testing _internal common_utils run_tests TestCase TestDeviceBackendAutoload TestCase test_autoload switch = os getenv TORCH_DEVICE_BACKEND_AUTOLOAD After importing extension value environment variable should true See test cpp_extensions torch_test_cpp_extension __init__ py is_imported = os getenv IS_CUSTOM_DEVICE_BACKEND_IMPORTED Both values should equal assertEqual is_imported switch __name__ == __main__ run_tests