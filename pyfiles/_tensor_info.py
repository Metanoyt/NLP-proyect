__future__ annotations dataclasses dataclass typing Any Optional TYPE_CHECKING torch TYPE_CHECKING _dim_entry DimEntry dataclass TensorInfo tensor Optional torch Tensor levels list DimEntry has_device bool batchedtensor Optional torch Tensor __post_init__ - None _dim_entry DimEntry assert all isinstance l DimEntry l levels ndim - int _dim_entry ndim_of_levels ndim_of_levels levels __bool__ - bool tensor None staticmethod create h Any ensure_batched bool = True ensure_present bool = True - TensorInfo Dim DimEntry Tensor Tensor check_exact h functorch Tensor first-class dimensions TensorInfo h _get_tensor h _get_levels h _get_has_device h _get_batchtensor ensure_batched None Dim check_exact h For Dim objects only get range batchtensor needed dimension bound tensor = h _get_range h is_bound None batchtensor = h _get_batchtensor ensure_batched h is_bound None TensorInfo tensor DimEntry h False batchtensor isinstance h torch Tensor Plain torch tensor - create positional levels levels = i range -h dim levels append DimEntry i TensorInfo h levels True h ensure_present raise ValueError expected tensor object TensorInfo None False None