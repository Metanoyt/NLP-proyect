Owner s module dynamo ruff noqa TRY enum itertools operator types unittest weakref collections defaultdict namedtuple OrderedDict UserDict typing Any torch torch _dynamo test_case torch _dynamo testing torch _functorch config torch nn torch utils checkpoint torch _dynamo testing same torch _dynamo utils dict_items torch testing _internal common_utils instantiate_parametrized_tests make_dynamo_test munge_exc parametrize torch testing _internal logging_utils LoggingTestCase make_logging_test SimpleDict dict pass DummyUserDict UserDict pass DictTests torch _dynamo test_case TestCase test_dict_subclass_instantiation fn x sd = SimpleDict x= sd x x x = torch randn opt_fn = torch compile fn backend= eager fullgraph=True assertEqual fn x opt_fn x test_dict_subclass_local_mutation fn x sd = SimpleDict x= z = sd x x sd x = z sd x x = torch randn opt_fn = torch compile fn backend= eager fullgraph=True assertEqual fn x opt_fn x test_dict_contains_enum TensorDim str enum Enum DDP = ddp FSDP = fsdp CP = cp TP = tp Foo torch nn Module __init__ super __init__ forward x val = x sin TensorDim DDP ddp val += x cos ddp TensorDim DDP val += x cos val inp = torch randn mod = Foo opt_f = torch compile mod assertEqual mod inp opt_f inp test_dict_subclass_local_with_non_dict_method Checks add_ method inlined MethodDict dict add_ x x + fn x sd = MethodDict x= z = sd x x sd x = sd add_ z sd x x = torch randn opt_fn = torch compile fn backend= eager fullgraph=True assertEqual fn x opt_fn x test_dict_contains sd = dict sd = sd = fn x sd x = x x = x x x = torch randn opt_fn = torch compile fn backend= eager fullgraph=True assertEqual fn x opt_fn x Ensure recompilation sd = assertEqual fn x opt_fn x Ensure recompilation because traced program remains same here sd = unittest mock patch torch _dynamo config error_on_recompile True assertEqual fn x opt_fn x test_dict_subclass_methods_fallback_readonly sd = SimpleDict sd = sd = check regular attr accesses work well sd attr = fn x value sd values x = x value key sd keys x = x key k v sd items x = x k x = x v k sd x = x k sd x = x x = x x = x sd get x = x sd get x = len sd x x = x sd attr x x = torch randn opt_fn = torch compile fn backend= eager fullgraph=True assertEqual fn x opt_fn x Ensure recompilation sd = assertEqual fn x opt_fn x test_dict_subclass_instantiation_return fn x sd = SimpleDict x= x sd y = sd x = torch randn opt_fn = torch compile fn backend= eager fullgraph=True ref = fn x res = opt_fn x assertEqual type ref type res assertEqual ref x res x assertEqual ref y res y test_dict_subclass_methods_fallback_mutation fn sd x value sd values x = x value sd = key sd keys x = x key k v sd items x = x k x = x v k sd x = x k sd x = x x = x x = x sd get x = x sd get x = len sd x x x = torch randn opt_fn = torch compile fn backend= eager fullgraph=True sd = SimpleDict sd = sd = sd = SimpleDict sd = sd = assertTrue sd == sd assertEqual fn sd x opt_fn sd x assertTrue sd == sd test_dict_subclass_setitem SetItemDict dict __setitem__ key value super __setitem__ key value + fn x sd = SetItemDict x= x sd y = sd x = torch randn opt_fn = torch compile fn backend= eager fullgraph=True ref = fn x res = opt_fn x assertEqual type ref type res assertEqual ref x res x assertEqual ref y res y test_custom_iter_dict ReversedDict dict __iter__ reversed list keys d = foo bar d = ReversedDict d torch compile backend= eager fn x d Forces side effects attribute reapplication logic d sample = d baz = x d foo d bar fn torch randn d This intentional because dict mutated so we will have recompilation fn torch randn d unittest mock patch torch _dynamo config error_on_recompile True fn torch randn d test_custom_keys_iter_dict ReversedDict dict keys bar foo d = foo bar d = ReversedDict d torch compile backend= eager fn x d x d foo d bar fn torch randn d unittest mock patch torch _dynamo config error_on_recompile True fn torch randn d test_dict_guard_on_keys_order d = cnts = torch _dynamo testing CompileCounter fn x d key value d items x = x key + value x opt_fn = torch compile fn backend=cnts opt_fn torch randn d opt_fn torch randn d No recompilation assertEqual cnts frame_count move end d = d pop x = torch randn res = opt_fn x d Check recompilation assertEqual cnts frame_count assertEqual res fn x d test_dict_guard_on_keys_order d = cnts = torch _dynamo testing CompileCounter fn x d key d value = d key x = x key + value x opt_fn = torch compile fn backend=cnts opt_fn torch randn d opt_fn torch randn d No recompilation assertEqual cnts frame_count move end d = d pop x = torch randn res = opt_fn x d Check recompilation assertEqual cnts frame_count assertEqual res fn x d test_ordered_dict_reordered_keys d = OrderedDict d = d = d move_to_end cnts = torch _dynamo testing CompileCounter fn x d y = idx value enumerate d values idx == y += torch sin x value y += torch cos x value y opt_fn = torch compile fn backend=cnts x = torch randn assertEqual opt_fn x d fn x d test_ordered_dict_subclass_reordered_keys ODSubclass OrderedDict keys super keys d = ODSubclass d = d = d move_to_end cnts = torch _dynamo testing CompileCounter fn x d y = idx value enumerate d values idx == y += torch sin x value y += torch cos x value y opt_fn = torch compile fn backend=cnts x = torch randn assertEqual opt_fn x d fn x d test_lazy_key_guarding d = b c fn x x d opt_fn = torch compile fn backend= eager fullgraph=True x = torch randn ref = fn x res = opt_fn x assertEqual ref res Since key c used should lead recompilation d pop c d d = unittest mock patch torch _dynamo config error_on_recompile True ref = fn x res = opt_fn x assertEqual ref res test_lazy_key_non_const_guarding d = list dict OrderedDict namedtuple fn x x d list opt_fn = torch compile fn backend= eager fullgraph=True x = torch randn ref = fn x res = opt_fn x assertEqual ref res Since key c used should lead recompilation d pop dict d defaultdict = unittest mock patch torch _dynamo config error_on_recompile True ref = fn x res = opt_fn x assertEqual ref res test_dict_mutation_side_effect fn d d c = d + d pop b d args = torch randn b torch randn args = dict args assert fn args args cnts = torch _dynamo testing CompileCounter opt_fn = torch compile fn backend=cnts assertIs opt_fn args args assertTrue same args args assertEqual cnts frame_count assertEqual cnts op_count test_dict_copy_alias torch compile backend= eager fullgraph=True run x d d = d copy d = x + d d = res d = run torch zeros d assertTrue same res torch ones assertEqual d assertEqual d test_dict_subclass_get_method dotdict dict dot notation access dictionary attributes __getattr__ = dict get __setattr__ = dict __setitem__ __delattr__ = dict __delitem__ config = dotdict b fn x x = x noqa F x = x config get x x = torch randn opt_fn = torch compile fn backend= eager fullgraph=True assertEqual fn x opt_fn x test_dict_order_keys fn d c = v d values c += v c args = args = torch rand args b = torch rand cnts = torch _dynamo testing CompileCounter opt_fn = torch compile fn backend=cnts assertEqual fn args opt_fn args assertEqual cnts frame_count assertEqual cnts op_count A different order keys recompiles args = args b = args b args = args assertEqual fn args opt_fn args assertEqual cnts frame_count Extra calls don t recompile assertEqual cnts frame_count test_dict_namedtuple fn d namedtuple d d d args = namedtuple None torch randn cnts = torch _dynamo testing CompileCounter opt_fn = torch compile fn backend=cnts assertEqual fn args opt_fn args assertEqual cnts frame_count Test failing namedtuple guard args = None torch randn assertEqual fn args opt_fn args assertEqual cnts frame_count test_dict_order_keys_tensors fn d x d x + args = x = torch randn y = torch randn z = torch randn args x = y args = z cnts = torch _dynamo testing CompileCounter opt_fn = torch compile fn backend=cnts assertEqual fn args x opt_fn args x assertEqual cnts frame_count Calling again doesn t recompile same id key order opt_fn args x assertEqual cnts frame_count args = args = z args x = y Different order recompiles assertEqual fn args x opt_fn args x assertEqual cnts frame_count test_dict_order_keys_modules fn d x d x torch ones args = x = torch nn Linear y = torch nn Linear z = torch nn Linear args x = y args = z cnts = torch _dynamo testing CompileCounter opt_fn = torch compile fn backend=cnts assertEqual fn args x opt_fn args x assertEqual cnts frame_count Calling again doesn t recompile same id key order opt_fn args x assertEqual cnts frame_count args = args = z args x = y Different order recompiles assertEqual fn args x opt_fn args x assertEqual cnts frame_count test_contains_dunder_dict UserDefined __init__ - None = b = run x __dict__ x = x b __dict__ x = x b c = c __dict__ x = x c x __dict__ get __dict__ get z obj = UserDefined fn x obj run x x = torch randn ref = fn x opt_fn = torch compile fn backend= eager fullgraph=True res = opt_fn x assertEqual ref res test_contains_module_dunder_dict MyModule torch nn Module __init__ - None super __init__ foo = bar = baz = forward x foo __dict__ x bar x baz mod = MyModule x = torch randn opt_mod = torch compile mod backend= eager fullgraph=True assertEqual mod x opt_mod x test_update_dunder_dict UserDefined run x __dict__ = x + __dict__ obj = UserDefined obj = UserDefined fn x obj obj run x x = torch randn opt_fn = torch compile fn backend= eager fullgraph=True ref = fn x obj res = opt_fn x obj assertEqual ref res Make sure only ` ` updated assertEqual obj __dict__ obj __dict__ test_update_module_dunder_dict MyModule torch nn Module __init__ - None super __init__ forward x __dict__ = x + __dict__ mod = MyModule x = torch randn opt_mod = torch compile mod backend= eager fullgraph=True assertEqual mod x opt_mod x test_dict_reconstruct_keeps_original_order fn modules = OrderedDict act torch nn ReLU module_dict = torch nn ModuleDict modules next_modules = fc torch nn Linear act torch nn Sigmoid modules update next_modules items module_dict update next_modules modules module_dict cnts = torch _dynamo testing CompileCounter opt_fn = torch compile fn backend=cnts modules module_dict = opt_fn assertEqual len module_dict len modules k m zip modules module_dict children assertTrue modules k m test_dict_subclass_initialization_in_graph super_class OrderedDict dict CustomDict super_class __new__ cls args kwargs super __new__ cls args kwargs __init__ args kwargs super __init__ args kwargs fn x c = CustomDict c key = x assert key c c key + opt_fn = torch compile fn backend= eager fullgraph=True x = torch rand assertEqual fn x opt_fn x test_dict_list_values inner_fn args x shape x args torch compile backend= eager fn tensors inner_fn zip itertools count tensors args fn args torch ones torch ones torch ones fn args torch ones test_dict_iter MyMod torch nn Module forward x z = my const dict variable tot = key z tot += z key tot x = torch tensor model = MyMod opt_model = torch compile model backend= eager fullgraph=True y = opt_model x assertEqual y test_dict_subclass_contains pattern huggingface ClassInstantier OrderedDict pass torch compile fullgraph=True backend= eager f x d key d x = x + key d x = x + x = x + x result = f torch ones ClassInstantier key torch ones assertTrue same result torch full result = f torch ones ClassInstantier key torch ones assertTrue same result torch full test_dict_tag_guard Foo __init__ - None scalar = fn d x d d b d c scalar x foo = Foo d = b c foo opt_fn = torch compile fn backend= eager inp = torch randn assertEqual fn d inp opt_fn d inp d = assertEqual fn d inp opt_fn d inp Check recompilation happens foo scalar = assertEqual fn d inp opt_fn d inp test_empty_dict_recompilation fn d x d torch cos x torch sin x opt_fn = torch compile fn backend= eager fullgraph=True x = torch randn assertEqual fn x opt_fn x assertEqual fn x opt_fn x test_udf_dict_reconstruction MyDict dict pass fn x klass x = x sc_dict = dict __new__ klass sc_dict x = x isinstance sc_dict MyDict sc_dict attr = sc_dict opt_fn = torch compile fn backend= eager fullgraph=True x = torch randn ref = fn x MyDict res = opt_fn x MyDict assertEqual ref res assertTrue isinstance res MyDict assertEqual ref attr res attr ref = fn x dict res = opt_fn x dict assertEqual ref res assertTrue isinstance res dict test_weakref_dict states = weakref WeakKeyDictionary mod = torch nn Module mod = torch nn Module states mod = states mod = fn x mod states x = torch sin x mod states x = torch cos x x opt_fn = torch compile fn backend= eager fullgraph=True x = torch randn assertEqual fn x opt_fn x test_construct_user_dict_and_return fn x DummyUserDict x + x = torch randn res = fn x assertEqual res x + opt_fn = torch compile fn backend= eager fullgraph=True assertEqual res opt_fn x test_fn_id fn x f d = id f x d id f opt_fn = torch compile fn backend= eager fullgraph=True x = torch randn nothing pass f = nothing assertEqual fn x f opt_fn x f test_mapping_proxy_for_local fn x d = b c x mp = types MappingProxyType d y = torch sin x mp v mp values y += torch cos x v mp opt_fn = torch compile fn backend= eager fullgraph=True x = torch randn ref = fn x res = opt_fn x assertEqual ref res assertTrue type res types MappingProxyType test_mapping_proxy_for_nonlocal d = b c fn x mp = types MappingProxyType d y = torch sin x mp v mp values y += torch cos x v d d = mp opt_fn = torch compile fn backend= eager fullgraph=True x = torch randn ref = fn x res = opt_fn x assertEqual ref res assertTrue type res types MappingProxyType check update d reflected res d e = assertEqual d e res e test_mapping_proxy_existing d = b c fn x mp y = torch sin x mp v mp values y += torch cos x v isinstance mp types MappingProxyType y = y opt_fn = torch compile fn backend= eager fullgraph=True x = torch randn mp = types MappingProxyType d ref = fn x mp res = opt_fn x mp assertEqual ref res d = ref = fn x mp res = opt_fn x mp assertEqual ref res d pop b ref = fn x mp res = opt_fn x mp assertEqual ref res test_dict_construction_from_mapping_proxy d = b c fn x mp d = dict mp y = torch sin x d y opt_fn = torch compile fn backend= eager fullgraph=True x = torch randn mp = types MappingProxyType d ref = fn x mp res = opt_fn x mp assertEqual ref res test_mapping_proxy_existing_mutation d = b c mp = types MappingProxyType d fn x d d = y = torch sin x mp d y opt_fn = torch compile fn backend= eager x = torch randn ref = torch sin x res = opt_fn x assertEqual ref res assertEqual d keys mp keys test_mapping_proxy_existing_local_mutation d = b c mp = types MappingProxyType d fn x Dynamo should cause graph break here because knows existing proxy can t point new dict other_dict = other_dict d = y = torch sin x mp c y opt_fn = torch compile fn backend= eager fullgraph=True x = torch randn ref = torch sin x mp c res = opt_fn x assertEqual ref res assertEqual d keys mp keys test_move_to_end fn x d = OrderedDict torch cos x b c d move_to_end d opt_fn = torch compile fn backend= eager fullgraph=True x = torch randn assertEqual b c list opt_fn x keys assertEqual fn x opt_fn x test_mapping_proxy_ban_muation_on_dict_realization fn x Foo b = d = dict Foo __dict__ y = torch sin x d b This should cause graph break because otherwise Foo __dict__ will updated Foo bar = Foo y Foo __dict__ bar opt_fn = torch compile fn backend= eager x = torch randn foo ref = fn x foo res = opt_fn x assertEqual ref res assertEqual foo bar foo bar test_overridden_get_item MyDict dict __init__ args kwargs super __init__ args kwargs calls = __getitem__ key calls += super __getitem__ key + fn x d d d = x d + d b + d c + d d opt_fn = torch compile fn backend= eager fullgraph=True x = torch randn d = MyDict b c ref = fn x d d = MyDict b c res = opt_fn x d assertEqual ref res assertEqual d calls d calls test_items_type fn d = dict b c torch tensor noqa C d items opt_fn = torch compile fn backend= eager fullgraph=True ref = fn res = opt_fn assertEqual ref res assertEqual type res dict_items test_builtin_or_with_invalid_types args = int float str tuple list torch compile backend= eager fullgraph=True fn b Any = one torch ones &#124; b torch _dynamo exc Unsupported arg args assertRaisesRegex Unsupported Observed exception _ = fn arg test_builtin_or_with_diff_keys f = one torch ones b = two torch ones b &#124; b b &#124; __or__ b b __or__ opt_f = torch compile f backend= eager fullgraph=True assertEqual f opt_f test_builtin_or_with_same_keys f = one torch ones two torch ones b = one torch ones three torch ones b &#124; b b &#124; __or__ b b __or__ opt_f = torch compile f backend= eager fullgraph=True assertEqual f opt_f test_builtin_ior_ f = one torch ones b = two torch ones &#124; = b b opt_f = torch compile f backend= eager fullgraph=True assertEqual f opt_f test_newly_constructed_default_dict f x d = defaultdict list d = x + d x = torch ones ref = f x res = torch compile f backend= eager fullgraph=True x assertEqual ref res unittest expectedFailure test_newly_constructed_default_dict_with_dict f x d = defaultdict dict d = b x + d x = torch ones ref = f x res = torch compile f backend= eager fullgraph=True x assertEqual ref res test_iter_default_dict f x d = defaultdict list d = k d d k += x + d x = torch ones ref = f x res = torch compile f backend= eager fullgraph=True x assertEqual ref res parametrize op or_ and_ xor sub test_dict_keys_binop op op = getattr operator op f = one torch ones two torch ones b = one torch ones three torch ones op keys b keys op b keys keys opt_f = torch compile f backend= eager fullgraph=True assertEqual f opt_f parametrize op ior iand ixor isub test_dict_keys_inplace_binop op op = getattr operator op f = one torch ones two torch ones keys b = one torch ones three torch ones keys c = one torch ones two torch ones keys = op b b = op b c b opt_f = torch compile f backend= eager fullgraph=True assertEqual f opt_f instantiate_parametrized_tests DictTests DictGuardTests LoggingTestCase thetype = dict make_logging_test recompiles=True test_popitem records d = thetype d = d = torch compile backend= eager fullgraph=True fn x k v = d popitem k == v == x sin x cos x = torch tensor y = fn x sanity check assertEqual len records assertEqual y x sin d = y = fn x assertEqual len records assertEqual y x cos record = getRecord records d assertIn d == munge_exc record make_logging_test recompiles=True test_cmp_eq records torch compile backend= eager fullgraph=True fn x d d d == d x sin x cos x = torch tensor d = thetype d = thetype y = fn x d d sanity check assertEqual len records assertEqual y x cos y = fn x d d assertEqual len records assertEqual y x sin record = getRecord records d assertIn list dict keys d munge_exc record getMessage make_logging_test recompiles=True test_cmp_ne records torch compile backend= eager fullgraph=True fn x d d d == d x sin x cos x = torch tensor d = thetype d = thetype y = fn x d d sanity check assertEqual len records assertEqual y x cos y = fn x d d assertEqual len records assertEqual y x sin record = getRecord records d assertIn list dict keys d munge_exc record getMessage make_logging_test recompiles=True test_cmp_or records torch compile backend= eager fullgraph=True fn x d d d = d &#124; d d get False x sin x cos x = torch tensor d = thetype d = thetype y = fn x d d sanity check assertEqual len records assertEqual y x sin y = fn x d d assertEqual len records assertEqual y x cos record = getRecord records d assertIn KeyError d munge_exc record getMessage make_logging_test recompiles=True test_cmp_ior records torch compile backend= eager fullgraph=True fn x d d d &#124; = d d get False x sin x cos x = torch tensor d = thetype d = thetype d d = d copy d copy y = fn x d d sanity check assertEqual len records assertEqual y x sin y = fn x d d assertEqual len records assertEqual y x cos record = getRecord records d assertIn KeyError d munge_exc record getMessage DictMethodsTests torch _dynamo test_case TestCase thetype = dict Methods + clear + copy + fromkeys + get + items + keys + pop + popitem + setdefault + update + values BinOps == = &#124; setUp torch _dynamo config enable_trace_unittest = True super setUp tearDown torch _dynamo config enable_trace_unittest = False super tearDown assertEqual x y assertTrue x == y f Expected x equal y assertNotEqual x y assertFalse x == y f Expected x equal y make_dynamo_test test_cmp_eq d = thetype b d = thetype b d = thetype b assertEqual d d assertNotEqual d d Test == operator assertEqual d == d True assertEqual d == d False Test __eq__ method assertEqual d __eq__ d True assertEqual d __eq__ d False Test Dict __eq__ assertEqual dict __eq__ d d True assertEqual thetype __eq__ d d False make_dynamo_test test_cmp_ne d = thetype b d = thetype b d = thetype b assertNotEqual d d assertEqual d d Test = operator assertEqual d = d True assertEqual d = d False Test __ne__ method assertEqual d __ne__ d True assertEqual d __ne__ d False Test Dict __ne__ assertEqual dict __ne__ d d True assertEqual thetype __ne__ d d False make_dynamo_test test_binop_or d = thetype b d = thetype b c Test &#124; operator assertEqual d &#124; d b c assertEqual d &#124; d b c Test __or__ method assertEqual d __or__ d b c assertEqual d __or__ d b c Test Dict __or__ assertEqual dict __or__ d d b c assertEqual thetype __or__ d d b c Test non-dict types assertRaises TypeError lambda d &#124; make_dynamo_test test_binop_ior d = thetype b d = thetype b c Test &#124; = operator d d = d copy d copy d &#124; = d d &#124; = d assertEqual d b c assertEqual d b c Test iterable d d = d copy d copy Test __ior__ method d d = d copy d copy d __ior__ d d __ior__ d assertEqual d b c assertEqual d b c Test Dict __or__ d d = d copy d copy assertEqual dict __ior__ d d b c assertEqual thetype __ior__ d d b c Test value d d = d copy d copy assertEqual d __ior__ d b c assertEqual dict __ior__ d d b c Test non-dict types assertRaises TypeError lambda dict __ior__ d make_dynamo_test test_binop_ior_iterable d = thetype b d = thetype b c d d = d copy d copy fn d yield d items assertEqual d __ior__ d items b c assertEqual d __ior__ fn d b c make_dynamo_test test_clear d = thetype b d clear assertEqual d Test clear returns None d = thetype b assertIsNone d clear Test Dict clear d = thetype b dict clear d assertEqual d d = thetype b thetype clear d assertEqual d Test invalid usage assertRaises TypeError d clear make_dynamo_test test_copy d = thetype b d = d copy assertEqual d d Test copy returns new instance assertIsNot d d Test Dict copy assertEqual dict copy d d assertEqual thetype copy d d Test invalid usage assertRaises TypeError d copy unittest expectedFailure make_dynamo_test test_fromkeys d = thetype fromkeys b assertEqual d b p = thetype fromkeys b None assertEqual p None b None Test Dict fromkeys d = thetype fromkeys c d assertEqual d c d Test invalid usage assertRaises TypeError thetype fromkeys assertRaises TypeError thetype fromkeys make_dynamo_test test_get d = thetype b assertEqual d get assertEqual d get c assertIsNone d get c Test Dict get assertEqual dict get d b assertEqual thetype get d b Test invalid usage assertRaises TypeError d get make_dynamo_test test_items d = thetype b items = d items assertEqual set items b Test Dict items assertEqual set dict items d b assertEqual set thetype items d b Test invalid usage assertRaises TypeError d items make_dynamo_test test_keys d = thetype b keys = d keys assertEqual set keys b Test Dict keys assertEqual set dict keys d b assertEqual set thetype keys d b Test invalid usage assertRaises TypeError d keys make_dynamo_test test_pop d = thetype b assertEqual d pop assertEqual d b assertIsNone d pop c None Test Dict pop d = thetype b assertEqual dict pop d b assertEqual thetype pop d Test invalid usage assertRaises KeyError d pop c assertRaises TypeError d pop make_dynamo_test test_popitem d = thetype key value = d popitem assertEqual key assertEqual value assertEqual len d check LIFO d = thetype d = d b = assertEqual d popitem b Test Dict popitem d = thetype key value = dict popitem d assertEqual key assertEqual value d = thetype key value = thetype popitem d assertEqual key assertEqual value Test invalid usage thetype OrderedDict OrderedDict accepts keyword arg assertRaises TypeError d popitem make_dynamo_test test_setdefault d = thetype b assertEqual d setdefault assertEqual d setdefault c assertIsNone d setdefault d None assertEqual d b c d None Test Dict setdefault assertEqual dict setdefault d f assertEqual thetype setdefault d e Test invalid usage assertRaises TypeError d setdefault assertRaises TypeError d setdefault make_dynamo_test test_update d = thetype b d update b c assertEqual d b c Test another dict d = thetype d d update d assertEqual d b c d Test Dict update d = thetype e dict update d d assertEqual d b c d e d = thetype f thetype update d d assertEqual d b c d e f Test keyword arguments d update f= g= assertEqual d b c d e f g Test Dict update keyword arguments thetype update d h= i= assertEqual d b c d e f g h i Test invalid usage assertRaises TypeError d update make_dynamo_test test_values d = thetype b values = d values assertEqual set values Test Dict values assertEqual set dict values d assertEqual set thetype values d Test invalid usage assertRaises TypeError d values make_dynamo_test test_type d = thetype b assertIsInstance d thetype assertIs type d thetype make_dynamo_test test_dict_type_comparison types = dict OrderedDict defaultdict assertEqual thetype thetype assertTrue thetype thetype other types thetype == other continue assertNotEqual thetype other assertTrue thetype other f thetype= other= make_dynamo_test test_dict___iter__ d = thetype = d __iter__ assertEqual next DictSubclassMethodsTests DictMethodsTests thetype = SimpleDict OrderedDictMethodsTests DictMethodsTests thetype = OrderedDict Methods - popitem - Inherited DictMethodsTest + move_to_end make_dynamo_test test_move_to_end d = thetype fromkeys abcde assertEqual join d abcde d move_to_end b assertEqual join d acdeb Test OrderedDict move_to_end thetype move_to_end d assertEqual join d cdeba Test last=False thetype move_to_end d last=False assertEqual join d acdeb Test KeyError assertRaises KeyError d move_to_end f test_cmp_eq_order = thetype fromkeys abc b = thetype fromkeys bca assertFalse == b make_dynamo_test test_binop_or_return_type d = thetype b d = thetype b c Test type assertIs type d &#124; d OrderedDict assertIs type dict d &#124; d OrderedDict assertIs type d &#124; dict d OrderedDict make_dynamo_test test_binop_ior_return_type d = thetype b d = thetype b c Test type d d = d copy d copy assertIs type d __ior__ d OrderedDict assertIs type dict __ior__ d d OrderedDict assertIs type thetype __ior__ d d OrderedDict d d = d copy d copy assertIs type dict __ior__ d dict d OrderedDict assertIs type dict __ior__ dict d d dict assertIs type dict d __ior__ d dict make_dynamo_test test_popitem_kwarg d = thetype fromkeys abcdf assertEqual d popitem last=True f None assertEqual list d list abcd assertEqual d popitem last=False None assertEqual list d list bcd assertEqual d popitem False b None assertEqual list d list cd assertEqual d popitem True d None assertEqual list d list c OrderedDictSubclassOverload torch _dynamo test_case TestCase setUp torch _dynamo config enable_trace_unittest = True super setUp tearDown torch _dynamo config enable_trace_unittest = False super tearDown assertEqual x y assertTrue x == y f Expected x equal y assertNotEqual x y assertFalse x == y f Expected x equal y OrderedDictSubclass OrderedDict get key default=None default move_to_end key last=True change behavior something pop key thetype = OrderedDictSubclass make_dynamo_test test_move_to_end p = thetype b c p move_to_end assertEqual list p keys list bc __name__ == __main__ torch _dynamo test_case run_tests run_tests