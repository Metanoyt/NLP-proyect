mypy allow-untyped-defs typing Optional torch torch _export error InternalError torch _export pass_base _ExportPassBaseDeprecatedDoNotUse torch _ops HigherOrderOperator OpOverload __all__ = ReplaceViewOpsWithViewCopyOpsPass _NON_FUNCTIONAL_OPS_TO_FUNCTIONAL_OPS dict OpOverload OpOverload = torch ops aten _unsafe_view default torch ops aten view_copy default is_view_op schema torch _C FunctionSchema - bool len schema arguments == False alias_info = schema arguments alias_info alias_info None alias_info is_write get_view_copy_of_view_op schema torch _C FunctionSchema - Optional OpOverload is_view_op schema schema name startswith aten view_op_name = schema name split view_op_overload = schema overload_name schema overload_name = default view_copy_op_name = view_op_name + _copy hasattr torch ops aten view_copy_op_name raise InternalError f schema name missing view_copy variant view_copy_op_overload_packet = getattr torch ops aten view_copy_op_name hasattr view_copy_op_overload_packet view_op_overload raise InternalError f schema name missing view_copy variant getattr view_copy_op_overload_packet view_op_overload None ReplaceViewOpsWithViewCopyOpsPass _ExportPassBaseDeprecatedDoNotUse Our backend expects pure functional operators For efficiency purposes we keep view ops around while functionalizing exported program This pass replaces view ops view copy ops backends need AOT memory planning call_operator op args kwargs meta op _NON_FUNCTIONAL_OPS_TO_FUNCTIONAL_OPS super call_operator _NON_FUNCTIONAL_OPS_TO_FUNCTIONAL_OPS op args kwargs meta isinstance op HigherOrderOperator super call_operator op args kwargs meta view_copy_op = get_view_copy_of_view_op op _schema super call_operator view_copy_op args kwargs meta super call_operator op args kwargs meta