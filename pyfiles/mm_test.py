operator_benchmark op_bench torch Microbenchmarks torch mm Benchmark ops performance without broadcast ops_list = op_bench op_list attr_names= op_name op_func attrs= mm torch mm mm_short_configs = op_bench config_list attr_names= M N K attrs= cross_product_configs= device cpu dtype torch float tags= short mm_long_configs = op_bench cross_product_configs M= N= K= device= cuda dtype= torch float torch bfloat torch float tags= long MmOpBenchmark op_bench TorchBenchmarkBase init M N K device dtype op_func inputs = input_one torch randn M N device=device requires_grad=self auto_set dtype=dtype input_two torch randn N K device=device requires_grad=self auto_set dtype=dtype op_func = op_func forward input_one input_two op_func input_one input_two op_bench generate_pt_tests_from_op_list ops_list mm_short_configs + mm_long_configs MmOpBenchmark op_bench generate_pt_gradient_tests_from_op_list ops_list mm_long_configs MmOpBenchmark __name__ == __main__ op_bench benchmark_runner main