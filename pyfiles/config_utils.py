Configuration utilities parsing JSON YAML config files json re heads_input_type s str - tuple int int Convert string format Hq Hkv tuple Hq Hkv try hq hkv = map int s split hq hkv except Exception e raise ValueError Heads must Hq Hkv e default_config = dynamic False calculate_bwd False dtype bfloat b nh s d mods noop causal alibi sliding_window backend efficient max_autotune False decoding False kv_size None throughput True save_path None output_json_for_dashboard None benchmark_name PyTorch operator microbenchmark load_config_file config_path str - dict Load configuration JSON YAML file Automatically converts nh field strings tuples Args config_path Path configuration file Returns Dictionary containing configuration Raises FileNotFoundError If config file doesn t exist ValueError If config file format invalid open config_path f config_str = f read Try load JSON first try config = json loads config_str except json JSONDecodeError Fall back YAML parsing config = _parse_simple_yaml config_str Apply automatic conversions nh field nh config isinstance config nh list config nh = heads_input_type h isinstance h str h h config nh config _parse_simple_yaml yaml_str str - dict Simple YAML parser basic configs without external dependencies Supports - key value pairs - booleans true false - null values - integers floats - strings quoted unquoted - lists JSON format item item - comments lines starting after Args yaml_str YAML content string Returns Dictionary containing parsed YAML content config = line yaml_str split \n Remove comments line = line split strip line line continue key value = line split key = key strip value = value strip Parse value based type value lower == true config key = True value lower == false config key = False value lower null none config key = None value startswith value endswith Parse list - handle quoted strings properly pattern = r ^ + &#124; \ ^\ + \ &#124; ^ \ \ \s + matches = re findall pattern value - Remove parsed_items = match matches match tuple double_quoted single_quoted unquoted item = match match match item = item strip item try parsed_items append int item except ValueError parsed_items append item config key = parsed_items value startswith config key = value strip \ Try parse number try config key = int value except ValueError try config key = float value except ValueError config key = value config print_default_config output_format str - None Print default configuration template JSON YAML format Args output_format Either json yaml output_format == json print json dumps default_config indent= yaml key value default_config items value None print f key null isinstance value bool print f key str value lower isinstance value str print f key value isinstance value list print f key json dumps value print f key value