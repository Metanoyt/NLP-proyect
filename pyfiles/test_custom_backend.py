Owner s module unknown os tempfile backend get_custom_backend_library_path Model to_custom_backend torch torch testing _internal common_utils run_tests TestCase TestCustomBackend TestCase setUp Load library containing custom backend library_path = get_custom_backend_library_path torch ops load_library library_path Create instance test Module lower custom backend model = to_custom_backend torch jit script Model test_execute Test execution using custom backend = torch randn b = torch randn The custom backend hardcoded compute f b = + b - b expected = + b - b out = model b assertTrue expected allclose out assertTrue expected allclose out test_save_load Test lowered module can executed correctly after saving loading Test execution before saving loading make sure lowered module works first place test_execute Save load f = tempfile NamedTemporaryFile delete=False try f close torch jit save model f name loaded = torch jit load f name finally os unlink f name model = loaded Test execution again test_execute __name__ == __main__ run_tests