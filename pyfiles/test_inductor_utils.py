Owner s module inductor functools logging torch torch _inductor runtime benchmarking benchmarker torch _inductor test_case run_tests TestCase torch _inductor utils do_bench_using_profiling log = logging getLogger __name__ TestBench TestCase classmethod setUpClass cls super setUpClass x = torch rand cuda half w = torch rand cuda half cls _bench_fn = functools partial torch nn functional linear x w test_benchmarker res = benchmarker benchmark_gpu _bench_fn log warning do_bench result s res assertGreater res test_do_bench_using_profiling res = do_bench_using_profiling _bench_fn log warning do_bench_using_profiling result s res assertGreater res __name__ == __main__ run_tests cuda