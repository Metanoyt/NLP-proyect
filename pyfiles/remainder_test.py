operator_benchmark op_bench torch Microbenchmarks remainder operators Benchmark ops performance broadcast remainder_ops_list = op_bench op_list attr_names= op_name op_func attrs= fmod torch fmod remainder torch remainder remainder_short_configs = op_bench config_list attr_names= M N K attrs= cross_product_configs= device cpu cuda dtype torch int torch float torch double tags= short remainder_long_configs = op_bench cross_product_configs M= N= K= device= cpu cuda dtype= torch int torch float torch double tags= long RemainderOpBenchmark op_bench TorchBenchmarkBase init M N K device dtype op_func dividend = torch rand M N K device=device dividend = dividend - dtype=dtype divisor = torch rand M N K device=device + so we don t divide zero divisor = divisor + dtype=dtype inputs = dividend dividend divisor divisor op_func = op_func forward dividend divisor op_func dividend divisor op_bench generate_pt_tests_from_op_list remainder_ops_list remainder_short_configs + remainder_long_configs RemainderOpBenchmark __name__ == __main__ op_bench benchmark_runner main