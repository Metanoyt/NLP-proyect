torchvision models torch torch autograd profiler profiler with_cuda False True model = models resnet inputs = torch randn sort_key = self_cpu_memory_usage with_cuda torch cuda is_available model = model cuda inputs = inputs cuda sort_key = self_cuda_memory_usage print Profiling CUDA Resnet model print Profiling CPU Resnet model profiler profile profile_memory=True record_shapes=True prof profiler record_function root model inputs print prof key_averages group_by_input_shape=True table sort_by=sort_key row_limit=-