Owner s module dynamo Test scalar constructors which also do type-coercion fractions functools types typing Any unittest skipIf skipif SkipTest pytest pytest raises assert_raises torch testing _internal common_utils instantiate_parametrized_tests parametrize run_tests TEST_WITH_TORCHDYNAMO TestCase TEST_WITH_TORCHDYNAMO numpy np numpy testing assert_equal torch _numpy np torch _numpy testing assert_equal skip = functools partial skipif True skip reason= XXX scalar as_integer_ratio implemented instantiate_parametrized_tests TestAsIntegerRatio TestCase derived part cpython test test_floatasratio parametrize ftype np half np single np double parametrize f ratio - - test_small ftype f ratio assert_equal ftype f as_integer_ratio ratio parametrize ftype np half np single np double test_simple_fractions ftype R = fractions Fraction assert_equal R R ftype as_integer_ratio assert_equal R R ftype as_integer_ratio assert_equal R R ftype as_integer_ratio assert_equal R - R ftype - as_integer_ratio parametrize ftype np half np single np double test_errors ftype assert_raises OverflowError ftype inf as_integer_ratio assert_raises OverflowError ftype -inf as_integer_ratio assert_raises ValueError ftype nan as_integer_ratio test_against_known_values R = fractions Fraction assert_equal R R np half as_integer_ratio assert_equal R - R np half - as_integer_ratio assert_equal R R np single as_integer_ratio assert_equal R - R np single - as_integer_ratio assert_equal R R np double as_integer_ratio assert_equal R - R np double - as_integer_ratio longdouble platform dependent parametrize ftype frac_vals exp_vals dtype test cases generated using hypothesis first five generated cases per dtype np half - np single - np double - - test_roundtrip ftype frac_vals exp_vals frac exp zip frac_vals exp_vals f = np ldexp ftype frac exp assert f dtype == ftype n d = f as_integer_ratio try nf = np longdouble n df = np longdouble d except OverflowError RuntimeWarning values may fit any float type raise SkipTest longdouble too small platform noqa B assert_equal nf df f f n d skip reason= NP_VER older numpies has problems is_integer instantiate_parametrized_tests TestIsInteger TestCase parametrize str_value inf nan parametrize code np typecodes Float test_special code str_value cls = np dtype code type value = cls str_value assert value is_integer parametrize code efd + Bbhil np typecodes Float + np typecodes AllInteger test_true code str - None float_array = np arange - astype code value float_array assert value is_integer parametrize code bhil np typecodes Float test_false code str - None float_array = np arange - astype code float_array = value float_array value == continue assert value is_integer skip reason= XXX implementation details type system differ instantiate_parametrized_tests TestClassGetItem TestCase parametrize cls np number np integer np inexact np unsignedinteger np signedinteger np floating test_abc cls type np number - None alias = cls Any assert isinstance alias types GenericAlias assert alias __origin__ cls test_abc_complexfloating - None alias = np complexfloating Any Any assert isinstance alias types GenericAlias assert alias __origin__ np complexfloating parametrize arg_len range test_abc_complexfloating_subscript_tuple arg_len int - None arg_tup = Any arg_len arg_len assert np complexfloating arg_tup match = f Too few arg_len == many arguments pytest raises TypeError match=match np complexfloating arg_tup parametrize cls np generic test_abc_non_numeric cls type np generic - None pytest raises TypeError cls Any parametrize code np typecodes All test_concrete code str - None cls = np dtype code type pytest raises TypeError cls Any parametrize arg_len range test_subscript_tuple arg_len int - None arg_tup = Any arg_len arg_len == assert np number arg_tup pytest raises TypeError np number arg_tup test_subscript_scalar - None assert np number Any skip reason= scalartype bit_count implemented instantiate_parametrized_tests TestBitCount TestCase derived part cpython test test_bit_count parametrize itype np int np int np int np int + np uint np uint np uint np uint test_small itype range max np iinfo itype min msg = f Smoke test itype bit_count assert itype bit_count == bit_count msg test_bit_count exp = exp assert np uint bit_count == assert np uint - bit_count == exp assert np uint ^ bit_count == assert np uint - ^ bit_count == exp - __name__ == __main__ run_tests