inspect torch torch utils _pytree register_pytree_node SequenceKey __all__ = pytree_register_structseq all_return_types all_return_types = error Module has no attribute _return_types return_types = torch _C _return_types type ignore attr-defined pytree_register_structseq cls structseq_flatten structseq list structseq None structseq_flatten_with_keys structseq values context = structseq_flatten structseq SequenceKey i v i v enumerate values context structseq_unflatten values context cls values register_pytree_node cls structseq_flatten structseq_unflatten flatten_with_keys_fn=structseq_flatten_with_keys name dir return_types name startswith __ continue _attr = getattr return_types name globals name = _attr name startswith _ __all__ append name all_return_types append _attr Today everything torch return_types structseq aka namedtuple -like thing defined Python C-API We re going need modify when no longer case NB I don t know how check something structseq so we do fuzzy check tuple inspect isclass _attr issubclass _attr tuple pytree_register_structseq _attr