tensor_engine = None unsupported func wrapper func wrapper is_supported = False wrapper is_supported method hasattr method is_supported method is_supported True set_engine_mode mode global tensor_engine mode == tf tf_engine tensor_engine = tf_engine TensorFlowEngine mode == pt pt_engine tensor_engine = pt_engine TorchTensorEngine mode == topi topi_engine tensor_engine = topi_engine TopiEngine mode == relay relay_engine tensor_engine = relay_engine RelayEngine mode == nnc nnc_engine tensor_engine = nnc_engine NncEngine raise ValueError f invalid tensor engine mode mode tensor_engine mode = mode get_engine tensor_engine None raise ValueError use get_engine before calling set_engine_mode illegal tensor_engine