operator_benchmark op_bench torch Microbenchmarks where operator configs_short = op_bench config_list attr_names= cond_shape input_shape other_shape attrs= cross_product_configs= device cpu dtype torch float tags= short configs_long = op_bench cross_product_configs cond_shape= input_shape= other_shape= device= cpu cuda dtype= torch float tags= long WhereBenchmark op_bench TorchBenchmarkBase init cond_shape input_shape other_shape dtype device _create_tensor shape torch randn shape dtype=dtype device=device inputs = condition _create_tensor cond_shape input _create_tensor input_shape other _create_tensor other_shape set_module_name where forward condition input other torch where condition input other op_bench generate_pt_test configs_short + configs_long WhereBenchmark __name__ == __main__ op_bench benchmark_runner main