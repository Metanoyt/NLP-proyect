pyre-strict mypy allow-untyped-defs abc os concurrent futures Future typing Optional Union torch distributed dist torch distributed checkpoint metadata STATE_DICT_TYPE torch distributed checkpoint planner SavePlanner torch distributed checkpoint storage StorageWriter _AsyncCheckpointExecutor abc ABC abc abstractmethod execute_save staging_future_or_state_dict Union STATE_DICT_TYPE Future STATE_DICT_TYPE checkpoint_id Union str os PathLike None = None storage_writer Optional StorageWriter = None planner Optional SavePlanner = None process_group Optional dist ProcessGroup = None no_dist bool = False use_collectives bool = True - Future Execute checkpoint save request asynchronously This method intended used abstraction implementing async checkpointing The actual checkpoint save operation executed separate thread process depending implementation interface