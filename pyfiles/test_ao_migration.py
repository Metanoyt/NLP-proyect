Owner s oncall quantization torch testing _internal common_utils raise_on_run_directly common AOMigrationTestCase TestAOMigrationNNQuantized AOMigrationTestCase test_functional_import r Tests migration torch nn quantized functional function_list = avg_pool d avg_pool d adaptive_avg_pool d adaptive_avg_pool d conv d conv d conv d interpolate linear max_pool d max_pool d celu leaky_relu hardtanh hardswish threshold elu hardsigmoid clamp upsample upsample_bilinear upsample_nearest _test_function_import functional function_list base= nn quantized test_modules_import module_list = Modules BatchNorm d BatchNorm d Conv d Conv d Conv d ConvTranspose d ConvTranspose d ConvTranspose d DeQuantize ELU Embedding EmbeddingBag GroupNorm Hardswish InstanceNorm d InstanceNorm d InstanceNorm d LayerNorm LeakyReLU Linear MaxPool d Quantize ReLU Sigmoid Softmax Dropout Wrapper modules FloatFunctional FXFloatFunctional QFunctional _test_function_import modules module_list base= nn quantized test_modules_activation function_list = ReLU Hardswish ELU LeakyReLU Sigmoid Softmax _test_function_import activation function_list base= nn quantized modules test_modules_batchnorm function_list = BatchNorm d BatchNorm d _test_function_import batchnorm function_list base= nn quantized modules test_modules_conv function_list = _reverse_repeat_padding Conv d Conv d Conv d ConvTranspose d ConvTranspose d ConvTranspose d _test_function_import conv function_list base= nn quantized modules test_modules_dropout function_list = Dropout _test_function_import dropout function_list base= nn quantized modules test_modules_embedding_ops function_list = EmbeddingPackedParams Embedding EmbeddingBag _test_function_import embedding_ops function_list base= nn quantized modules test_modules_functional_modules function_list = FloatFunctional FXFloatFunctional QFunctional _test_function_import functional_modules function_list base= nn quantized modules test_modules_linear function_list = Linear LinearPackedParams _test_function_import linear function_list base= nn quantized modules test_modules_normalization function_list = LayerNorm GroupNorm InstanceNorm d InstanceNorm d InstanceNorm d _test_function_import normalization function_list base= nn quantized modules test_modules_utils function_list = _ntuple_from_first _pair_from_first _quantize_weight _hide_packed_params_repr WeightedQuantizedModule _test_function_import utils function_list base= nn quantized modules test_import_nn_quantized_dynamic_import module_list = Modules Linear LSTM GRU LSTMCell RNNCell GRUCell Conv d Conv d Conv d ConvTranspose d ConvTranspose d ConvTranspose d _test_function_import dynamic module_list base= nn quantized test_import_nn_quantizable_activation module_list = Modules MultiheadAttention _test_function_import activation module_list base= nn quantizable modules test_import_nn_quantizable_rnn module_list = Modules LSTM LSTMCell _test_function_import rnn module_list base= nn quantizable modules test_import_nn_qat_conv module_list = Conv d Conv d Conv d _test_function_import conv module_list base= nn qat modules test_import_nn_qat_embedding_ops module_list = Embedding EmbeddingBag _test_function_import embedding_ops module_list base= nn qat modules test_import_nn_qat_linear module_list = Linear _test_function_import linear module_list base= nn qat modules test_import_nn_qat_dynamic_linear module_list = Linear _test_function_import linear module_list base= nn qat dynamic modules TestAOMigrationNNIntrinsic AOMigrationTestCase test_modules_import_nn_intrinsic module_list = Modules _FusedModule ConvBn d ConvBn d ConvBn d ConvBnReLU d ConvBnReLU d ConvBnReLU d ConvReLU d ConvReLU d ConvReLU d LinearReLU BNReLU d BNReLU d LinearBn d _test_function_import intrinsic module_list base= nn test_modules_nn_intrinsic_fused function_list = _FusedModule ConvBn d ConvBn d ConvBn d ConvBnReLU d ConvBnReLU d ConvBnReLU d ConvReLU d ConvReLU d ConvReLU d LinearReLU BNReLU d BNReLU d LinearBn d _test_function_import fused function_list base= nn intrinsic modules test_modules_import_nn_intrinsic_qat module_list = LinearReLU LinearBn d ConvReLU d ConvReLU d ConvReLU d ConvBn d ConvBn d ConvBn d ConvBnReLU d ConvBnReLU d ConvBnReLU d update_bn_stats freeze_bn_stats _test_function_import qat module_list base= nn intrinsic test_modules_intrinsic_qat_conv_fused function_list = ConvBn d ConvBnReLU d ConvReLU d ConvBn d ConvBnReLU d ConvReLU d ConvBn d ConvBnReLU d ConvReLU d update_bn_stats freeze_bn_stats _test_function_import conv_fused function_list base= nn intrinsic qat modules test_modules_intrinsic_qat_linear_fused function_list = LinearBn d _test_function_import linear_fused function_list base= nn intrinsic qat modules test_modules_intrinsic_qat_linear_relu function_list = LinearReLU _test_function_import linear_relu function_list base= nn intrinsic qat modules test_modules_import_nn_intrinsic_quantized module_list = BNReLU d BNReLU d ConvReLU d ConvReLU d ConvReLU d LinearReLU _test_function_import quantized module_list base= nn intrinsic test_modules_intrinsic_quantized_bn_relu function_list = BNReLU d BNReLU d _test_function_import bn_relu function_list base= nn intrinsic quantized modules test_modules_intrinsic_quantized_conv_relu function_list = ConvReLU d ConvReLU d ConvReLU d _test_function_import conv_relu function_list base= nn intrinsic quantized modules test_modules_intrinsic_quantized_linear_relu function_list = LinearReLU _test_function_import linear_relu function_list base= nn intrinsic quantized modules test_modules_no_import_nn_intrinsic_quantized_dynamic TODO future PR generalize torch _ = torch ao nn intrinsic quantized dynamic _ = torch nn intrinsic quantized dynamic __name__ == __main__ raise_on_run_directly test test_quantization py