__future__ annotations typing Any TYPE_CHECKING torch ir get_free_symbols kernel mm addmm_contiguous_subgraph_template mm_contiguous_subgraph_template kernel_inputs KernelInputs MMKernelInputs utils use_contiguous base TemplateConfigHeuristics gemm GemmMaxAutotuneTemplateConfigHeuristics registry register_template_heuristic TYPE_CHECKING collections abc Generator register_template_heuristic mm_contiguous_subgraph_template uid None op_name= mm register_template_heuristic addmm_contiguous_subgraph_template uid None op_name= addmm EmptyContiguousMMConfigHeuristics TemplateConfigHeuristics empty heuristics skip contiguous mm cuda register_template_heuristic mm_contiguous_subgraph_template uid cuda register=torch version hip None op_name= mm register_template_heuristic addmm_contiguous_subgraph_template uid cuda register=torch version hip None op_name= addmm ContiguousMMHeuristics GemmMaxAutotuneTemplateConfigHeuristics _get_template_configs_impl kernel_inputs KernelInputs op_name str - Generator dict str Any None None Get all valid k_splits given m n k assert isinstance kernel_inputs MMKernelInputs f __class__ __name__ requires MMKernelInputs Check unbacked symbols - found yield nothing unbacked_symbols = any len get_free_symbols itr unbacked_only=True itr kernel_inputs shapes_symbolic kernel_inputs strides_symbolic unbacked_symbols mat = kernel_inputs mat mat mat get_layout is_contiguous no need contiguous decomposition m n k = kernel_inputs mnk_symbolic use_contiguous m n k yield