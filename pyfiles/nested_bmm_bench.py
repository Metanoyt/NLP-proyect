argparse random torch bench nt_a nt_b niter Warmup nt_a bmm nt_b torch cuda synchronize start_event = torch cuda Event enable_timing=True end_event = torch cuda Event enable_timing=True start_event record iter range niter nt_a bmm nt_b end_event record torch cuda synchronize runtime = start_event elapsed_time end_event niter runtime sweep_n niter dtype ntensor tensors = torch randn random randint t range ntensor nt_a = torch nested nested_tensor tensors dtype=dtype device= cuda nt_b = torch nested nested_tensor t t t tensors dtype=dtype device= cuda runtime = bench nt_a nt_b niter nt_a_size = torch ops aten _nested_tensor_size nt_a lengths = nt_a_size print join map str ntensor dtype lengths min item lengths float mean item lengths max item runtime __name__ == __main__ random seed parser = argparse ArgumentParser description= Nested Tensor BMM Benchmark parser add_argument -- niter default= type=int args = parser parse_args niter = args niter print ntensor dtype min_length mean_length max_length runtime sweep_n niter torch float sweep_n niter torch float