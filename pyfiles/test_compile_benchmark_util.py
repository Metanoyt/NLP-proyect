Owner s module dynamo unittest torch torch _dynamo torchdynamo torch testing _internal common_utils run_tests TEST_CUDA TestCase try tabulate noqa F type ignore torch utils benchmark utils compile bench_all HAS_TABULATE = True except ImportError HAS_TABULATE = False unittest skipIf TEST_CUDA CUDA unavailable unittest skipIf HAS_TABULATE tabulate available TestCompileBenchmarkUtil TestCase test_training_and_inference ToyModel torch nn Module __init__ - None super __init__ weight = torch nn Parameter torch Tensor forward x x weight torchdynamo reset model = ToyModel cuda inference_table = bench_all model torch ones cuda assertTrue Inference inference_table Eager inference_table - inference_table training_table = bench_all model torch ones cuda optimizer=torch optim SGD model parameters lr= assertTrue Train training_table Eager training_table - training_table __name__ == __main__ run_tests