usr bin env python __future__ annotations argparse re sys pathlib Path typing Any typing_extensions TypedDict Python + yaml Step = dict str Any Script TypedDict extension str script str extract step Step - Script &#124; None run = step get run https docs github com en actions reference workflow-syntax-for-github-actions#using-a-specific-shell shell = step get shell bash extension = bash sh pwsh ps python py sh sh cmd cmd powershell ps get shell is_gh_script = step get uses startswith actions github-script gh_script = step get get script run None extension None script = bash f usr bin env bash\nset -eo pipefail\n run sh f usr bin env sh\nset -e\n run get shell run extension extension script script type ignore typeddict-item is_gh_script gh_script None extension js script gh_script None main - None parser = argparse ArgumentParser parser add_argument -- out required=True args = parser parse_args out = Path args out out exists sys exit f out already exists aborting avoid overwriting gha_expressions_found = False p Path github workflows iterdir open p rb f workflow = yaml safe_load f job_name job workflow jobs items job_dir = out p job_name steps job continue steps = job steps index_chars = len str len steps - i step enumerate steps start= extracted = extract step extracted script = extracted script step_name = step get name $ script gha_expressions_found = True print f p job ` job_name ` step i step_name file=sys stderr job_dir mkdir parents=True exist_ok=True sanitized = re sub ^a-zA-Z_ + _ f _ step_name rstrip _ extension = extracted extension filename = f i index_chars sanitized extension job_dir filename write_text script gha_expressions_found sys exit Each above scripts contains GitHub Actions $ expression which must replaced ` env ` variable security reasons __name__ == __main__ main