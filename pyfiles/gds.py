os sys collections abc Callable typing Optional torch torch types Storage __all__ list str = gds_register_buffer gds_deregister_buffer GdsFile _dummy_fn name str - Callable fn args kwargs type ignore no-untyped-def raise RuntimeError f torch _C name supported platform fn hasattr torch _C _gds_register_buffer assert hasattr torch _C _gds_deregister_buffer assert hasattr torch _C _gds_register_handle assert hasattr torch _C _gds_deregister_handle assert hasattr torch _C _gds_load_storage assert hasattr torch _C _gds_save_storage Define functions torch _C __dict__ _gds_register_buffer = _dummy_fn _gds_register_buffer torch _C __dict__ _gds_deregister_buffer = _dummy_fn _gds_deregister_buffer torch _C __dict__ _gds_register_handle = _dummy_fn _gds_register_handle torch _C __dict__ _gds_deregister_handle = _dummy_fn _gds_deregister_handle torch _C __dict__ _gds_load_storage = _dummy_fn _gds_load_storage torch _C __dict__ _gds_save_storage = _dummy_fn _gds_save_storage gds_register_buffer s Storage - None Registers storage CUDA device cufile buffer Example xdoctest +SKIP gds filesystem requirements src = torch randn device= cuda s = src untyped_storage gds_register_buffer s Args s Storage Buffer register torch _C _gds_register_buffer s gds_deregister_buffer s Storage - None Deregisters previously registered storage CUDA device cufile buffer Example xdoctest +SKIP gds filesystem requirements src = torch randn device= cuda s = src untyped_storage gds_register_buffer s gds_deregister_buffer s Args s Storage Buffer register torch _C _gds_deregister_buffer s GdsFile r Wrapper around cuFile cuFile file-like interface GPUDirect Storage GDS API See ` cufile docs https docs nvidia com gpudirect-storage api-reference-guide index html#cufile-io-api ` _ more details Args filename str Name file open flags int Flags pass ` ` os open ` ` when opening file ` ` os O_DIRECT ` ` will added automatically Example xdoctest +SKIP gds filesystem requirements src = torch randn device= cuda src = torch randn device= cuda file = torch cuda gds GdsFile f os O_CREAT &#124; os O_RDWR file save_storage src untyped_storage offset= file save_storage src untyped_storage offset=src nbytes dest = torch empty device= cuda dest = torch empty device= cuda file load_storage dest untyped_storage offset= file load_storage dest untyped_storage offset=src nbytes torch equal src dest True torch equal src dest True __init__ filename str flags int sys platform == win raise RuntimeError GdsFile supported platform filename = filename flags = flags fd = os open filename flags &#124; os O_DIRECT type ignore attr-defined handle Optional int = None register_handle __del__ - None handle None deregister_handle os close fd register_handle - None Registers file descriptor cuFile Driver This wrapper around ` ` cuFileHandleRegister ` ` assert handle None Cannot register handle already registered handle = torch _C _gds_register_handle fd deregister_handle - None Deregisters file descriptor cuFile Driver This wrapper around ` ` cuFileHandleDeregister ` ` assert handle None Cannot deregister handle registered torch _C _gds_deregister_handle handle handle = None load_storage storage Storage offset int = - None Loads data file into storage This wrapper around ` ` cuFileRead ` ` ` ` storage nbytes ` ` data will loaded file ` ` offset ` ` into storage Args storage Storage Storage load data into offset int optional Offset into file start loading Default assert handle None Cannot load data file registered torch _C _gds_load_storage handle storage offset save_storage storage Storage offset int = - None Saves data storage into file This wrapper around ` ` cuFileWrite ` ` All bytes storage will written file ` ` offset ` ` Args storage Storage Storage save data offset int optional Offset into file start saving Default assert handle None Cannot save data file registered torch _C _gds_save_storage handle storage offset