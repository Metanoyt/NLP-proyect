Owner s oncall quantization torch unittest torch ao quantization experimental observer APoTObserver torch ao quantization experimental quantizer quantize_APoT TestQuantizedTensor unittest TestCase r Tests int_repr APoTQuantizer random tensor quantize hard-coded values test_int_repr generate tensor random fp values tensor quantize = torch tensor observer = APoTObserver b= k= observer forward tensor quantize qparams = observer calculate_qparams signed=False get apot quantized tensor result qtensor = quantize_APoT tensor quantize=tensor quantize alpha=qparams gamma=qparams quantization_levels=qparams level_indices=qparams qtensor_data = qtensor int_repr int expected qtensor values calculated based corresponding level_indices nearest quantization level each fp value tensor quantize e g tensor quantize nearest quantization_levels - level_indices expected_qtensor_data = torch tensor dtype=torch int assertTrue torch equal qtensor_data expected_qtensor_data __name__ == __main__ unittest main