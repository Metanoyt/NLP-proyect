mypy allow-untyped-defs typing Union torch torch Tensor torch distributions distribution Distribution __all__ = ExponentialFamily ExponentialFamily Distribution r ExponentialFamily abstract base probability distributions belonging exponential family whose probability mass density function has form defined below math p_ F x \theta = \exp \langle t x \theta\rangle - F \theta + k x where math ` \theta ` denotes natural parameters math ` t x ` denotes sufficient statistic math ` F \theta ` log normalizer function given family math ` k x ` carrier measure Note This intermediary between ` Distribution ` distributions which belong exponential family mainly check correctness ` entropy ` analytic KL divergence methods We use compute entropy KL divergence using AD framework Bregman divergences courtesy Frank Nielsen Richard Nock Entropies Cross-entropies Exponential Families property _natural_params - tuple Tensor Abstract method natural parameters Returns tuple Tensors based distribution raise NotImplementedError _log_normalizer natural_params Abstract method log normalizer function Returns log normalizer based distribution input raise NotImplementedError property _mean_carrier_measure - float Abstract method expected carrier measure which required computing entropy raise NotImplementedError entropy Method compute entropy using Bregman divergence log normalizer result Union Tensor float = -self _mean_carrier_measure nparams = p detach requires_grad_ p _natural_params lg_normal = _log_normalizer nparams gradients = torch autograd grad lg_normal sum nparams create_graph=True result += lg_normal np g zip nparams gradients result -= np g reshape _batch_shape + - sum - result