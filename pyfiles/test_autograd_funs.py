Owner s module onnx pytorch_test_common onnx_test_common run_model_test torch torch onnx OperatorExportTypes torch testing _internal common_utils TestAutogradFuns pytorch_test_common ExportTestCase opset_version = keep_initializers_as_inputs = False onnx_shape_inference = True test_single_output SingleOut torch autograd Function staticmethod forward ctx i result = i exp result = result log ctx save_for_backward result result staticmethod backward ctx grad_output result = ctx saved_tensors grad_output result Caller torch nn Module forward input result = input + SingleOut apply result + model = Caller input = torch ones run_model_test model input_args= input test_multi_output MultiOut torch autograd Function staticmethod forward ctx i result_exp = i exp result_log = result_exp log ctx save_for_backward result_exp result_log result_exp result_log staticmethod backward ctx grad_output result = ctx saved_tensors grad_output result Caller torch nn Module forward input MultiOut apply input model = Caller input = torch ones run_model_test model input_args= input test_partial_output PartialOut torch autograd Function staticmethod forward ctx input ctx save_for_backward input values _ = torch topk input values Caller torch nn Module forward input PartialOut apply input model = Caller input = torch ones run_model_test model input_args= input test_nested_autograd Child torch autograd Function staticmethod forward ctx i result = i log result_log = result log ctx save_for_backward result_log result_log staticmethod backward ctx grad_output result = ctx saved_tensors grad_output result Parent torch autograd Function staticmethod forward ctx i result_exp = i exp result_log = Child apply result_exp ctx save_for_backward result_exp result_log result_exp result_log staticmethod backward ctx grad_output result = ctx saved_tensors grad_output result Caller torch nn Module forward input Parent apply input model = Caller input = torch ones run_model_test model input_args= input Run export ONNX_FALLTHROUGH mode torch erf supported test_aten_unsupported Erf torch autograd Function staticmethod forward ctx x erf_out = torch special erf x ctx save_for_backward erf_out erf_out staticmethod backward ctx grad_output result = ctx saved_tensors torch special erfinv result None Caller torch nn Module forward input Erf apply input model = Caller input = torch ones Test ONNX_FALLTHROUGH_MODE graph _ _ = torch onnx utils _model_to_graph model input operator_export_type=OperatorExportTypes ONNX_FALLTHROUGH iter = graph nodes assertEqual next iter kind prim PythonOp Test ATEN_FALLBACK_MODE graph _ _ = torch onnx utils _model_to_graph model input operator_export_type=OperatorExportTypes ONNX_ATEN_FALLBACK iter = graph nodes assertEqual next iter kind aten ATen test_inline_and_symbolic Exp torch autograd Function staticmethod forward ctx i ctx save_for_backward input i exp staticmethod symbolic g input g op Exp input LogLog torch autograd Function staticmethod forward ctx i ctx save_for_backward input i log log Caller torch nn Module forward input exp_result = Exp apply input LogLog apply exp_result model = Caller input = torch ones run_model_test model input_args= input test_inline_with_scoped_tracing Exp torch autograd Function staticmethod forward ctx i ctx save_for_backward input i exp staticmethod symbolic g input g op Exp input LogLog torch autograd Function staticmethod forward ctx i ctx save_for_backward input i log log Caller torch nn Module forward input exp_result = Exp apply input LogLog apply exp_result model = Caller input = torch ones torch jit _trace _trace_module_map = _m torch typename type _m _m model modules run_model_test model input_args= input torch jit _trace _trace_module_map = None __name__ == __main__ common_utils run_tests