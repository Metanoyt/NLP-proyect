mypy ignore-errors __future__ annotations typing Optional torch _binary_ufuncs_impl _dtypes_impl _unary_ufuncs_impl _util _normalizations ArrayLike ArrayLikeOrScalar CastingModes DTypeLike normalizer NotImplementedType OutArray _ufunc_postprocess result out casting out None result = _util typecast_tensor result out dtype torch_dtype casting result = torch broadcast_to result out shape result ############# Binary ufuncs ###################### _binary = name name dir _binary_ufuncs_impl name startswith _ name torch matmul divmod ldexp NEP _FUNCS = add subtract multiply floor_divide true_divide divide remainder bitwise_and bitwise_or bitwise_xor bitwise_left_shift bitwise_right_shift hypot arctan logaddexp logaddexp heaviside copysign fmax minimum fmin maximum fmod gcd lcm pow deco_binary_ufunc torch_func Common infra binary ufuncs Normalize arguments sort out type casting broadcasting delegate pytorch functions actual work normalizer wrapped x ArrayLikeOrScalar x ArrayLikeOrScalar out Optional OutArray = None where NotImplementedType = True casting Optional CastingModes = same_kind order NotImplementedType = K dtype Optional DTypeLike = None subok NotImplementedType = False signature NotImplementedType = None extobj NotImplementedType = None dtype None cast x dtype isinstance x torch Tensor _util typecast_tensor x dtype casting torch as_tensor x dtype=dtype x = cast x dtype x = cast x dtype isinstance x torch Tensor isinstance x torch Tensor dtype = _dtypes_impl result_type_impl x x x x = _util typecast_tensors x x dtype casting x x = _dtypes_impl nep _to_tensors x x torch_func __name__ NEP _FUNCS torch_func __name__ result = torch_func x x _ufunc_postprocess result out casting wrapped __qualname__ = torch_func __name__ wrapped __name__ = torch_func __name__ wrapped matmul s signature _slightly_ different other ufuncs - no where= - additional axis= axes= - no NEP scalars out normalizer matmul x ArrayLike x ArrayLike out Optional OutArray = None casting Optional CastingModes = same_kind order NotImplementedType = K dtype Optional DTypeLike = None subok NotImplementedType = False signature NotImplementedType = None extobj NotImplementedType = None axes NotImplementedType = None axis NotImplementedType = None dtype None dtype = _dtypes_impl result_type_impl x x x x = _util typecast_tensors x x dtype casting result = _binary_ufuncs_impl matmul x x result = _ufunc_postprocess result out casting result ldexp casting special dtype result == dtype st arg normalizer ldexp x ArrayLikeOrScalar x ArrayLikeOrScalar out Optional OutArray = None where NotImplementedType = True casting Optional CastingModes = same_kind order NotImplementedType = K dtype Optional DTypeLike = None subok NotImplementedType = False signature NotImplementedType = None extobj NotImplementedType = None dtype None isinstance x torch Tensor x = _util typecast_tensor x dtype casting x = torch as_tensor x dtype=dtype isinstance x torch Tensor x = torch as_tensor x x = _util cast_int_to_float x x = torch as_tensor x second arg must integer _dtypes_impl _category x dtype = raise ValueError ldexp nd arg must integer result = _binary_ufuncs_impl ldexp x x x dtype == torch float torch ldexp f int - f undo result = result torch float _ufunc_postprocess result out casting nin= nout= normalizer divmod x ArrayLike x ArrayLike out Optional OutArray = None out Optional OutArray = None out tuple Optional OutArray Optional OutArray = None None where NotImplementedType = True casting Optional CastingModes = same_kind order NotImplementedType = K dtype Optional DTypeLike = None subok NotImplementedType = False signature NotImplementedType = None extobj NotImplementedType = None make sure we either have no out arrays all there either out out out=tuple both num_outs = sum x None x out out num_outs == raise ValueError both out out need provided num_outs == o o = out o None o None raise TypeError cannot specify out both positional keyword argument out out = out dtype None dtype = _dtypes_impl result_type_impl x x x x = _util typecast_tensors x x dtype casting quot rem = _binary_ufuncs_impl divmod x x quot = _ufunc_postprocess quot out casting rem = _ufunc_postprocess rem out casting quot rem Attach ufuncs module further export public namespace __init__ py name _binary ufunc = getattr _binary_ufuncs_impl name vars name = deco_binary_ufunc ufunc modf x args kwds quot rem = divmod x args kwds rem quot _binary = _binary + divmod modf matmul ldexp ############# Unary ufuncs ###################### _unary = name name dir _unary_ufuncs_impl name startswith _ name = torch these ufunc int - float _fp_unary = arccos arccosh arcsin arcsinh arctan arctanh cbrt cos cosh deg rad degrees exp exp expm log log log p log rad deg radians reciprocal sin sinh sqrt square tan tanh trunc deco_unary_ufunc torch_func Common infra unary ufuncs Normalize arguments sort out type casting broadcasting delegate pytorch functions actual work normalizer wrapped x ArrayLike out Optional OutArray = None where=True casting Optional CastingModes = same_kind order= K dtype Optional DTypeLike = None subok NotImplementedType = False signature=None extobj=None dtype None x = _util typecast_tensor x dtype casting torch_func __name__ _fp_unary x = _util cast_int_to_float x result = torch_func x result = _ufunc_postprocess result out casting result wrapped __qualname__ = torch_func __name__ wrapped __name__ = torch_func __name__ wrapped Attach ufuncs module further export public namespace __init__ py name _unary ufunc = getattr _unary_ufuncs_impl name vars name = deco_unary_ufunc ufunc __all__ = _binary + _unary noqa PLE