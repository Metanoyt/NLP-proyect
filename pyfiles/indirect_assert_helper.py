sys torch torch testing _internal inductor_utils GPU_TYPE first_arg x y x y second_arg x y x y same_pm_one x y x y + y - same_pp_one x y x y + y + store x y z x y + y + = z upper x b = torch arange device=x device x b lower x b = x new_full - dtype=torch int x b upper x b = x new_full dtype=torch int x b lower x b = x new_zeros dtype=torch int x b - __name__ == __main__ fns = name name obj locals items callable obj obj __module__ == __name__ _ fn_name dims dyn_shape one_size = sys argv assert fn_name fns assert one_size True False one_size = one_size == True assert dims shape_x = dims == one_size assert fn_name == first_arg only first_arg can tested special case -size tensor shape_x = assert dyn_shape True False dynamic_shapes = dyn_shape == True x = torch randn shape_x device=GPU_TYPE y = torch arange device=GPU_TYPE fn = vars fn_name fn = torch compile dynamic=dynamic_shapes fn fn_name == store shape = y numel + x shape z = torch randn shape device=GPU_TYPE fn x y z On Windows Python will optimize away function call its updated value used Touch memory x so fn x y z will optimized away print x fn_name upper upper lower lower print fn x print fn x y