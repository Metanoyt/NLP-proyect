threading typing Any Optional torch _C _lazy DeviceContext _CONTEXTS dict str Any = _CONTEXTS_LOCK = threading Lock __init__ device str - None device = device get_device_context device Optional str = None - DeviceContext device None device = torch _C _lazy _get_default_device_type device = str device DeviceContext _CONTEXTS_LOCK devctx = DeviceContext _CONTEXTS get device None devctx None devctx = DeviceContext device DeviceContext _CONTEXTS device = devctx devctx