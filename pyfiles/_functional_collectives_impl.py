mypy allow-untyped-defs typing Optional torch torch distributed distributed_c d c d This file contains op impls legacy c d_functional functional collectives These impls simply call into native _c d_functional functional collectives _broadcast input src tag ranks group_size group_name = c d _resolve_group_name_by_ranks_and_tag ranks tag torch ops _c d_functional broadcast input src group_name _all_reduce input reduce_op tag ranks group_size group_name = c d _resolve_group_name_by_ranks_and_tag ranks tag torch ops _c d_functional all_reduce input reduce_op group_name _all_reduce_coalesced inputs reduce_op tag ranks group_size group_name = c d _resolve_group_name_by_ranks_and_tag ranks tag torch ops _c d_functional all_reduce_coalesced inputs reduce_op group_name _all_gather_into_tensor input tag ranks group_size group_name = c d _resolve_group_name_by_ranks_and_tag ranks tag torch ops _c d_functional all_gather_into_tensor input group_size group_name _all_gather_into_tensor_coalesced input tag ranks group_size group_name = c d _resolve_group_name_by_ranks_and_tag ranks tag torch ops _c d_functional all_gather_into_tensor_coalesced input group_size group_name _reduce_scatter_tensor input torch Tensor reduce_op str tag str ranks list int group_size int group_name = c d _resolve_group_name_by_ranks_and_tag ranks tag torch ops _c d_functional reduce_scatter_tensor input reduce_op group_size group_name _reduce_scatter_tensor_coalesced inputs list torch Tensor reduce_op str tag str ranks list int group_size int group_name = c d _resolve_group_name_by_ranks_and_tag ranks tag torch ops _c d_functional reduce_scatter_tensor_coalesced inputs reduce_op group_size group_name _all_to_all_single input torch Tensor output_split_sizes Optional list int input_split_sizes Optional list int tag str ranks list int group_size int output_split_sizes None input_split_sizes None assert output_split_sizes None input_split_sizes None output_split_sizes input_split_sizes must either specified together both set None output_split_sizes = input shape group_size group_size input_split_sizes = output_split_sizes group_name = c d _resolve_group_name_by_ranks_and_tag ranks tag torch ops _c d_functional all_to_all_single input output_split_sizes input_split_sizes group_name _wait_tensor tensor torch Tensor - torch Tensor torch ops _c d_functional wait_tensor tensor