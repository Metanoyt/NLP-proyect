operator_benchmark op_bench torch D pooling will have input matrix rank qpool d_long_configs = op_bench config_list attrs= C H W k s p dummy noqa E E dummy noqa E E VGG pools original input shape - MaxPool d- noqa E MaxPool d- noqa E attr_names= C H W k s p Input layout Pooling parameters cross_product_configs= N contig False True dtype torch quint tags= long qpool d_short_configs = op_bench config_list attrs= dummy attr_names= C H W k s p Input layout Pooling parameters cross_product_configs= N contig True dtype torch qint torch qint torch quint tags= short qadaptive_avgpool d_long_configs = op_bench cross_product_configs input_size= VGG pools original input shape - MaxPool d- output_size= VGG pools original input shape - MaxPool d- MaxPool d- MaxPool d- noqa E E MaxPool d- noqa E E N= C= contig= False True dtype= torch quint tags= long qadaptive_avgpool d_short_configs = op_bench config_list attrs= True attr_names= N C input_size output_size contig cross_product_configs= dtype torch qint torch qint torch quint tags= short _QPool dBenchmarkBase op_bench TorchBenchmarkBase setup N C H W dtype contig Input N == f_input = torch rand C H W - f_input = torch rand N C H W - scale = zero_point = Quantize tensor q_input = torch quantize_per_tensor f_input scale=scale zero_point=zero_point dtype=dtype contig Permute into NHWC back make non-contiguous N == q_input = q_input permute contiguous q_input = q_input permute q_input = q_input permute contiguous q_input = q_input permute inputs = q_input q_input forward q_input pool_op q_input QMaxPool dBenchmark _QPool dBenchmarkBase init N C H W k s p contig dtype pool_op = torch nn MaxPool d kernel_size=k stride=s padding=p dilation= ceil_mode=False return_indices=False super setup N C H W dtype contig QAvgPool dBenchmark _QPool dBenchmarkBase init N C H W k s p contig dtype pool_op = torch nn AvgPool d kernel_size=k stride=s padding=p ceil_mode=False super setup N C H W dtype contig QAdaptiveAvgPool dBenchmark _QPool dBenchmarkBase init N C input_size output_size contig dtype pool_op = torch nn AdaptiveAvgPool d output_size=output_size super setup N C input_size dtype=dtype contig=contig op_bench generate_pt_test qadaptive_avgpool d_short_configs + qadaptive_avgpool d_long_configs QAdaptiveAvgPool dBenchmark op_bench generate_pt_test qpool d_short_configs + qpool d_long_configs QAvgPool dBenchmark op_bench generate_pt_test qpool d_short_configs + qpool d_long_configs QMaxPool dBenchmark __name__ == __main__ op_bench benchmark_runner main