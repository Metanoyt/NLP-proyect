Copyright c Meta Platforms Inc affiliates torch torch distributed tensor _op_schema OpSchema OpSpec OpStrategy StrategyType torch distributed tensor _ops utils is_tensor_partial register_op_strategy aten = torch ops aten register_op_strategy aten normal_ default aten uniform_ default aten native_dropout default aten bernoulli_ float aten bernoulli default random_op_strategy op_schema OpSchema - StrategyType self_strategy = op_schema args_schema assert isinstance self_strategy OpStrategy random_strategy = OpStrategy arg_strategy self_strategy strategies arg_spec = arg_strategy output_spec is_tensor_partial arg_spec TODO figure out how inplace random op should behave when s partial raise RuntimeError f op_schema op Partial supported yet random_strategy strategies append OpSpec output_specs=arg_spec input_specs= arg_spec redistribute_cost= len self_strategy strategies random_strategy