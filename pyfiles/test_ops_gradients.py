Owner s module unknown functools partial torch torch testing _internal common_device_type instantiate_device_type_tests OpDTypes ops torch testing _internal common_methods_invocations op_db torch testing _internal common_utils run_tests TestCase TestGradients unMarkDynamoStrictTest torch testing _internal custom_op_db custom_op_db torch testing _internal hop_db hop_db gradcheck requires double precision _gradcheck_ops = partial ops dtypes=OpDTypes supported allowed_dtypes= torch double torch cdouble unMarkDynamoStrictTest TestBwdGradients TestGradients Tests gradients computed correctly _gradcheck_ops op_db + hop_db + custom_op_db test_fn_grad device dtype op This verified test_dtypes test_ops py dtype op supported_backward_dtypes torch device device type skipTest Skipped Dtype supported backward dtypes _grad_test_helper device dtype op op get_op Method grad gradgrad see below tests disabled since they re costly redundant function grad gradgad tests _gradcheck_ops op_db test_method_grad device dtype op _skip_helper op device dtype _grad_test_helper device dtype op op get_method _gradcheck_ops op_db + custom_op_db test_inplace_grad device dtype op _skip_helper op device dtype op inplace_variant skipTest Op has no inplace variant Verifies operation doesn t support inplace autograd claims op supports_inplace_autograd inplace = _get_safe_inplace op get_inplace sample op sample_inputs device dtype requires_grad=True sample broadcasts_input continue assertRaises Exception result = inplace sample result sum backward _grad_test_helper device dtype op _get_safe_inplace op get_inplace Test gradients gradients computed correctly _gradcheck_ops op_db + hop_db + custom_op_db test_fn_gradgrad device dtype op _skip_helper op device dtype op supports_gradgrad skipTest Op claims doesn t support gradgrad This verified _check_helper device dtype op op get_op bwgrad_bwgrad Test gradients gradients properly raising _gradcheck_ops op_db + custom_op_db test_fn_fail_gradgrad device dtype op _skip_helper op device dtype op supports_gradgrad skipTest Skipped Operation does support gradgrad err_msg = r derivative implemented assertRaisesRegex RuntimeError err_msg _check_helper device dtype op op get_op bwgrad_bwgrad Method gradgrad grad see above tests disabled since they re costly redundant function gradgrad grad tests _gradcheck_ops op_db test_method_gradgrad device dtype op _skip_helper op device dtype _gradgrad_test_helper device dtype op op get_method _gradcheck_ops op_db test_inplace_gradgrad device dtype op _skip_helper op device dtype op inplace_variant op supports_inplace_autograd skipTest Skipped Operation does support inplace autograd _check_helper device dtype op _get_safe_inplace op get_inplace bwgrad_bwgrad instantiate_device_type_tests TestBwdGradients globals __name__ == __main__ TestCase _default_dtype_check_enabled = True run_tests