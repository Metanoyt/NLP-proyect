mypy allow-untyped-defs logging torch ao pruning _experimental data_sparsifier base_data_sparsifier SUPPORTED_TYPES logger logging Logger = logging getLogger __name__ _attach_model_to_data_sparsifier module data_sparsifier config=None Attaches data sparsifier all layers module Essentially loop over all weight parameters module attach data sparsifier Note The layer names replaced _ refer _get_valid_name below before attaching sparsifier This because data sparsifier uses dummy model inside store weight parameters config None config = name parameter module named_parameters type parameter SUPPORTED_TYPES valid_name = _get_valid_name name will defaulted default configs data_sparsifier add_data name=valid_name data=parameter config get valid_name _get_valid_name name name replace _ allowed name _log_sparsified_level model data_sparsifier - None Show level sparsity AFTER step name parameter model named_parameters type parameter SUPPORTED_TYPES continue valid_name = _get_valid_name name mask = data_sparsifier get_mask name=valid_name sparsity_level = - mask float mean logger info Sparsity layer s = name sparsity_level