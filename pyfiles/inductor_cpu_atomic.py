itertools benchmark_helper time_with_torch_timer torch torch _dynamo torch _dynamo optimize inductor nopython=True inductor_scatter_add dst src index torch scatter_add dst index src torch_scatter_add dst src index torch scatter_add dst index src test_total_time shapes types print shape type torch scatter_add inductor scatter_add torch scatter_add worst case inductor scatter_add worst case shape dtype itertools product shapes types print shape dtype sep= end= torch manual_seed dtype is_floating_point src = torch randn shape device= cpu dtype=dtype dst = torch randn shape device= cpu dtype=dtype src = torch randint shape shape device= cpu dtype=dtype dst = torch randint shape shape device= cpu dtype=dtype index = torch randint shape shape device= cpu dtype=torch int worst_index = torch tensor shape device= cpu dtype=torch int torch_result = torch_scatter_add dst src index inductor_result = inductor_scatter_add dst src index torch testing assert_close torch_result inductor_result torch_ms = time_with_torch_timer torch_scatter_add dst src index mean inductor_ms = time_with_torch_timer inductor_scatter_add dst src index mean torch_worst_ms = time_with_torch_timer torch_scatter_add dst src worst_index mean inductor_worst_ms = time_with_torch_timer inductor_scatter_add dst src worst_index mean print torch_ms inductor_ms torch_worst_ms inductor_worst_ms sep= torch _dynamo reset __name__ == __main__ shapes = types = torch float torch int print test total time test_total_time shapes types Results preview H test total time shape type torch scatter_add inductor scatter_add torch scatter_add worst case inductor scatter_add worst case torch float torch int torch float torch int