mypy allow-untyped-defs typing Optional Union torch torch Tensor torch distributions constraints torch distributions gamma Gamma torch distributions transformed_distribution TransformedDistribution torch distributions transforms PowerTransform __all__ = InverseGamma InverseGamma TransformedDistribution r Creates inverse gamma distribution parameterized attr ` concentration ` attr ` rate ` where X ~ Gamma concentration rate Y = X ~ InverseGamma concentration rate Example xdoctest +IGNORE_WANT non-deterinistic m = InverseGamma torch tensor torch tensor m sample tensor Args concentration float Tensor shape parameter distribution often referred alpha rate float Tensor rate = scale distribution often referred beta arg_constraints = concentration constraints positive rate constraints positive pyrefly ignore bad-override support = constraints positive has_rsample = True pyrefly ignore bad-override base_dist Gamma __init__ concentration Union Tensor float rate Union Tensor float validate_args Optional bool = None - None base_dist = Gamma concentration rate validate_args=validate_args neg_one = -base_dist rate new_ones super __init__ base_dist PowerTransform neg_one validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance InverseGamma _instance super expand batch_shape _instance=new property concentration - Tensor base_dist concentration property rate - Tensor base_dist rate property mean - Tensor result = rate concentration - torch where concentration result torch inf property mode - Tensor rate concentration + property variance - Tensor result = rate square concentration - square concentration - torch where concentration result torch inf entropy concentration + rate log + concentration lgamma - + concentration concentration digamma