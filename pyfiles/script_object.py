This module implements variable tracking TorchScript objects during Dynamo tracing The TorchScriptObjectVariable provides specialized handling TorchScript objects strong safety guarantees - Enforcing method-call-only access prevent unsafe attribute manipulation - Converting graph breaks into hard errors via _raise_hard_error_if_graph_break - Proper proxy source tracking TorchScript method calls - Integration higher-order operators method call handling Key safety features - Strict validation only method calls allowed no direct attribute access - Immediate error reporting potentially unsafe operations - Proper source tracking debugging guard installation - Safe handling TorchScript object method calls through torchbind The module ensures TorchScript objects handled safely during tracing limiting operations known-safe patterns failing fast unsafe usage functools collections abc Callable typing Any Iterable TYPE_CHECKING TypeVar typing_extensions ParamSpec torch torch _guards Source torch fx proxy Proxy graph_break_hints exc unimplemented_v UnsafeScriptObjectError Unsupported base VariableTracker user_defined UserDefinedObjectVariable TYPE_CHECKING torch _dynamo symbolic_convert InstructionTranslator _P = ParamSpec _P _T = TypeVar _T _raise_hard_error_if_graph_break reason str - Callable Callable _P _T Callable _P _T deco fn Callable _P _T - Callable _P _T functools wraps fn graph_break_as_hard_error args _P args kwargs _P kwargs - _T try fn args kwargs except Unsupported e raise UnsafeScriptObjectError e msg e graph_break_as_hard_error deco TorchScriptObjectVariable UserDefinedObjectVariable _fake_script_object_cache dict int TorchScriptObjectVariable = classmethod is_matching_cls cls user_cls type - bool issubclass user_cls torch ScriptObject staticmethod create proxy Proxy value Any options Any - TorchScriptObjectVariable TorchScriptObjectVariable proxy value options __init__ proxy Proxy value Any source Source kwargs Any - None super __init__ value kwargs proxy = proxy proxy node meta example_value = value source = source as_proxy - Proxy proxy _raise_hard_error_if_graph_break Dynamo cannot safely trace script object due graph break var_getattr tx InstructionTranslator name str - VariableTracker torch _higher_order_ops torchbind call_torchbind source AttrSource higher_order_ops TorchHigherOrderOperatorVariable method = getattr value name None method None unimplemented_v gb_type= FakeScriptObject missing method implementation context=f value= value method= name explanation=f TorchScript object value doesn t define method name hints= f Ensure method name implemented value graph_break_hints USER_ERROR callable method unimplemented_v gb_type= Attempted access non-callable attribute TorchScript object context=f value= value method= name explanation= Attribute accesses TorchScript objects non-callable attributes supported hints= Use method calls instead attribute access assert source None TorchHigherOrderOperatorVariable make call_torchbind source=AttrSource source name script_obj_var=self method_name=name We only support method calls script objects Interpreting bytecodes should go through var_getattr then call_function instead call_method However s possible call_method used directly e g __setattr__ _raise_hard_error_if_graph_break Dynamo cannot safely trace script object due graph break call_method tx InstructionTranslator name str args Iterable Any kwargs dict str Any - VariableTracker unimplemented_v gb_type= Weird method call TorchScript object context=f value= value method= name explanation= f This particular method call name supported e g calling ` __setattr__ ` Most method calls TorchScript objects should supported hints= Avoid calling method