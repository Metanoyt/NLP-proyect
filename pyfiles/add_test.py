operator_benchmark op_bench torch Microbenchmarks add_ operator Supports both Caffe PyTorch Configs PT add operator add_long_configs = op_bench cross_product_configs M= N= K= device= cpu cuda tags= long add_short_configs = op_bench config_list attr_names= M N K attrs= cross_product_configs= device cpu cuda tags= short AddBenchmark op_bench TorchBenchmarkBase init M N K device inputs = input_one torch rand M N K device=device requires_grad=self auto_set input_two torch rand M N K device=device requires_grad=self auto_set set_module_name add forward input_one input_two torch add input_one input_two The generated test names based add_short_configs will following pattern add_M _N _K _devicecpu add_M _N _K _devicecpu_bwdall add_M _N _K _devicecpu_bwd add_M _N _K _devicecpu_bwd Those names can used filter tests op_bench generate_pt_test add_long_configs + add_short_configs AddBenchmark op_bench generate_pt_gradient_test add_long_configs + add_short_configs AddBenchmark Mircobenchmark addr operator AddrBenchmark op_bench TorchBenchmarkBase init M N device dtype inputs = input_one torch rand M N device=device requires_grad=self auto_set dtype=dtype vec torch rand M device=device requires_grad=self auto_set dtype=dtype vec torch rand N device=device requires_grad=self auto_set dtype=dtype set_module_name addr forward input_one vec vec torch addr input_one vec vec addr_configs = op_bench cross_product_configs M= N= device= cpu cuda dtype= torch double torch half tags= addr op_bench generate_pt_test addr_configs AddrBenchmark op_bench generate_pt_gradient_test addr_configs AddrBenchmark __name__ == __main__ op_bench benchmark_runner main