typing Any torch library torch Tensor torch autograd Function _test_lib_def = torch library Library _inductor_test DEF _test_lib_def define realize Tensor - Tensor tags=torch Tag pt _compliant_tag _test_lib_impl = torch library Library _inductor_test IMPL dispatch_key CPU CUDA MPS Meta _test_lib_impl impl realize lambda x x clone dispatch_key Realize Function staticmethod pyrefly ignore bad-override forward ctx object x Tensor - Tensor torch ops _inductor_test realize x staticmethod types need stay consistent _SingleLevelFunction backward ctx Any grad_output Any - Any grad_output realize x Tensor - Tensor Realize apply x