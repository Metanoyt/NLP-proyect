numpy pt configs operator_benchmark op_bench torch torch ao nn quantized nnq Microbenchmarks qEmbeddingBag operators QEmbeddingBagBenchmark op_bench TorchBenchmarkBase init embeddingbags dim mode input_size offset sparse include_last_offset device embedding = nnq EmbeddingBag num_embeddings=embeddingbags embedding_dim=dim mode=mode include_last_offset=include_last_offset device=device numpy random seed - input = torch tensor numpy random randint embeddingbags input_size device=device long offset = torch LongTensor offset device=device offset = torch cat offset torch tensor input size dtype=torch long inputs = input input offset offset set_module_name qEmbeddingBag forward input offset embedding input offset op_bench generate_pt_test configs embeddingbag_short_configs QEmbeddingBagBenchmark __name__ == __main__ op_bench benchmark_runner main