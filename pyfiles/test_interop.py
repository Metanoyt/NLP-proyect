Owner s module dynamo torch torch _dynamo test_case torch _dynamo testing fn b + b InteropTests torch _dynamo test_case TestCase _common fn inputs = torch randn torch randn ref = fn inputs opt_fn = torch compile fn backend= eager fullgraph=True res = opt_fn inputs assertEqual ref res test_fx_fn fx_fn = torch fx symbolic_trace fn _common lambda b fx_fn b + test_script_fn script_fn = torch jit script fn _common lambda b script_fn b + test_trace_fn trace_fn = torch jit trace fn torch zeros torch zeros _common lambda b trace_fn b + test_staticmethod_script_fn Foo staticmethod torch jit script _g g b _g + b foo = Foo _common lambda b foo g b + test_vmap_in_graph functools wraps torch _dynamo allow_in_graph traceable f f = allow_in_graph f wraps f wrapper args kwargs f args kwargs wrapper cnts = torch _dynamo testing CompileCounter x = torch randn fn x torch vmap torch Tensor t x fn_opt = torch compile fn backend=cnts fullgraph=True fn_opt_traceable = torch compile traceable fn backend=cnts fullgraph=True assertEqual fn x fn_opt x assertEqual cnts frame_count assertEqual fn_opt x fn_opt_traceable x assertEqual cnts frame_count __name__ == __main__ torch _dynamo test_case run_tests run_tests