usr bin env python collections abc Callable Iterator typing TypeVar typing_extensions Self Copyright c Facebook Inc its affiliates All rights reserved This source code licensed under BSD-style license found LICENSE file root directory source tree _T = TypeVar _T __all__ = CyclingIterator CyclingIterator Iterator _T An iterator decorator cycles through underlying iterator n times Useful unroll dataset across multiple training epochs The generator function called ` ` generator_fn epoch ` ` obtain underlying iterator where ` ` epoch ` ` number less than equal ` ` n ` ` representing ` ` k ` ` th cycle For example ` ` generator_fn ` ` always returns ` ` ` ` then ` ` CyclingIterator n= generator_fn ` ` will iterate through ` ` ` ` __init__ n int generator_fn Callable int Iterator _T start_epoch int = _n = n _epoch = start_epoch _generator_fn = generator_fn _iter = generator_fn _epoch __iter__ - Self __next__ - _T try next _iter except StopIteration eod eod == end data _epoch _n - _epoch += _iter = _generator_fn _epoch __next__ raise eod