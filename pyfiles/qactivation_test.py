operator_benchmark op_bench torch torch ao nn quantized functional qF r Microbenchmarks quantized activations qactivation_long_configs = op_bench cross_product_configs dims= VGG- relu s original shape - ReLU- noqa E ReLU- ReLU- noqa E ReLU- noqa E ReLU- noqa E Batch = ReLU- noqa E ReLU- ReLU- noqa E ReLU- noqa E ReLU- noqa E contig= False True inplace= False True dtype= torch quint tags= long qactivation_short_configs = op_bench cross_product_configs dims= Rank= Rank= Dimensions floating point benchmarks contig= False inplace= False dtype= torch quint torch qint torch qint tags= short qactivation_ops = op_bench op_list attrs= relu torch nn ReLU relu torch ops quantized relu functional hardtanh qF hardtanh functional hardsigmoid qF hardsigmoid functional leaky_relu qF leaky_relu functional sigmoid torch nn functional sigmoid functional tanh torch nn functional tanh attr_names= op_name op_func QActivationBenchmarkBase op_bench TorchBenchmarkBase r Base all activations _setup dims contig dtype Input f_input = torch rand dims - scale = zero_point = Quantize tensor q_input = torch quantize_per_tensor f_input scale=self scale zero_point=self zero_point dtype=dtype contig Make non-contiguous new_shape = list range q_input ndim - q_input = q_input permute new_shape inputs = q_input q_input init dims contig inplace dtype op_func _setup dims contig dtype qop = op_func QActivationBenchmark QActivationBenchmarkBase forward q_input qop q_input op_bench generate_pt_tests_from_op_list qactivation_ops qactivation_short_configs + qactivation_long_configs QActivationBenchmark qactivation_scale_zero_point_ops = op_bench op_list attrs= functional hardswish qF hardswish functional elu qF elu functional celu qF celu attr_names= op_name op_func QActivationScaleZeroPointBenchmark QActivationBenchmarkBase forward q_input qop q_input scale=self scale zero_point=self zero_point op_bench generate_pt_tests_from_op_list qactivation_scale_zero_point_ops qactivation_short_configs + qactivation_long_configs QActivationScaleZeroPointBenchmark __name__ == __main__ op_bench benchmark_runner main