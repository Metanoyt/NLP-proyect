mypy allow-untyped-defs typing Optional Union torch torch Tensor torch distributions constraints torch distributions distribution Distribution torch distributions transformed_distribution TransformedDistribution torch distributions transforms SigmoidTransform torch distributions utils broadcast_all clamp_probs lazy_property logits_to_probs probs_to_logits torch types _Number _size Number __all__ = LogitRelaxedBernoulli RelaxedBernoulli LogitRelaxedBernoulli Distribution r Creates LogitRelaxedBernoulli distribution parameterized attr ` probs ` attr ` logits ` both which logit RelaxedBernoulli distribution Samples logits values See more details Args temperature Tensor relaxation temperature probs Number Tensor probability sampling ` ` logits Number Tensor log-odds sampling ` ` The Concrete Distribution A Continuous Relaxation Discrete Random Variables Maddison et al Categorical Reparametrization Gumbel-Softmax Jang et al pyrefly ignore bad-override arg_constraints = probs constraints unit_interval logits constraints real support = constraints real __init__ temperature Tensor probs Optional Union Tensor Number = None logits Optional Union Tensor Number = None validate_args Optional bool = None - None temperature = temperature probs None == logits None raise ValueError Either ` probs ` ` logits ` must specified both probs None is_scalar = isinstance probs _Number pyrefly ignore read-only probs = broadcast_all probs assert logits None helps mypy is_scalar = isinstance logits _Number pyrefly ignore read-only logits = broadcast_all logits _param = probs probs None logits is_scalar batch_shape = torch Size batch_shape = _param size super __init__ batch_shape validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance LogitRelaxedBernoulli _instance batch_shape = torch Size batch_shape new temperature = temperature probs __dict__ new probs = probs expand batch_shape new _param = new probs logits __dict__ new logits = logits expand batch_shape new _param = new logits super LogitRelaxedBernoulli new __init__ batch_shape validate_args=False new _validate_args = _validate_args new _new args kwargs _param new args kwargs lazy_property logits - Tensor probs_to_logits probs is_binary=True lazy_property probs - Tensor logits_to_probs logits is_binary=True property param_shape - torch Size _param size rsample sample_shape _size = torch Size - Tensor shape = _extended_shape sample_shape probs = clamp_probs probs expand shape uniforms = clamp_probs torch rand shape dtype=probs dtype device=probs device uniforms log - -uniforms log p + probs log - -probs log p temperature log_prob value _validate_args _validate_sample value logits value = broadcast_all logits value diff = logits - value mul temperature temperature log + diff - diff exp log p RelaxedBernoulli TransformedDistribution r Creates RelaxedBernoulli distribution parametrized attr ` temperature ` either attr ` probs ` attr ` logits ` both This relaxed version ` Bernoulli ` distribution so values has reparametrizable samples Example xdoctest +IGNORE_WANT non-deterministic m = RelaxedBernoulli torch tensor torch tensor m sample tensor Args temperature Tensor relaxation temperature probs Number Tensor probability sampling ` ` logits Number Tensor log-odds sampling ` ` arg_constraints = probs constraints unit_interval logits constraints real pyrefly ignore bad-override support = constraints unit_interval has_rsample = True pyrefly ignore bad-override base_dist LogitRelaxedBernoulli __init__ temperature Tensor probs Optional Union Tensor Number = None logits Optional Union Tensor Number = None validate_args Optional bool = None - None base_dist = LogitRelaxedBernoulli temperature probs logits super __init__ base_dist SigmoidTransform validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance RelaxedBernoulli _instance super expand batch_shape _instance=new property temperature - Tensor base_dist temperature property logits - Tensor base_dist logits property probs - Tensor base_dist probs