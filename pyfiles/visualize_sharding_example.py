To run example use following command TERM=xterm- color torchrun -- nproc-per-node= visualize_sharding_example py os rich rich rule torch torch distributed dist torch distributed tensor dt torch distributed tensor debug assert int os getenv WORLD_SIZE = We need least devices rank = int os environ RANK device_type = getattr torch accelerator current_accelerator type cpu section msg str - None rank == rich print rich rule Rule msg visualize t dt DTensor msg str = - None rank == rich print msg dt debug visualize_sharding t use_rich=False dt debug visualize_sharding t use_rich=True section bold D Tensor D Mesh bold m = dist init_device_mesh device_type t = torch ones visualize dt distribute_tensor t m dt Replicate Replicate along only mesh dimension visualize dt distribute_tensor t m dt Shard dim= Shard along only tensor dimension section bold D Tensor D Mesh bold m = dist init_device_mesh device_type t = torch ones visualize dt distribute_tensor t m dt Replicate Replicate along only mesh dimension visualize dt distribute_tensor t m dt Shard dim= Shard alone first tensor dimension along only mesh dimension visualize dt distribute_tensor t m dt Shard dim= Shard along second tensor dimension along only mesh dimension section bold D Tensor D Mesh bold m = dist init_device_mesh device_type t = torch ones visualize dt distribute_tensor t m dt Replicate dt Replicate Replicate along both mesh dimensions visualize dt distribute_tensor t m dt Shard dim= dt Shard dim= Shard only tensor dimension along both mesh dimensions visualize dt distribute_tensor t m dt Shard dim= dt Replicate Shard only tensor dimension along first mesh dimension visualize dt distribute_tensor t m dt Replicate dt Shard dim= Shard only tensor dimension along second mesh dimension section bold D Tensor D Mesh bold m = dist init_device_mesh device_type t = torch ones visualize dt distribute_tensor t m dt Replicate dt Replicate Replicate along both mesh dimensions visualize dt distribute_tensor t m dt Shard dim= dt Shard dim= Shard first tensor dimension along both mesh dimensions visualize dt distribute_tensor t m dt Shard dim= dt Shard dim= Shard second tensor dimension along both mesh dimensions visualize dt distribute_tensor t m dt Shard dim= dt Shard dim= Shard first tensor dimension along first mesh dimension + second tensor dimension along second mesh dimension visualize dt distribute_tensor t m dt Shard dim= dt Shard dim= Shard first tensor dimension along second mesh dimension + second tensor dimension along first mesh dimension visualize dt distribute_tensor t m dt Shard dim= dt Replicate Shard first tensor dimension along first mesh dimension + replicate second tensor dimension along second mesh dimension visualize dt distribute_tensor t m dt Replicate dt Shard dim= Shard first tensor dimension along second mesh dimension + replicate second tensor dimension along first mesh dimension visualize dt distribute_tensor t m dt Shard dim= dt Replicate Shard second tensor dimension along first mesh dimension + replicate second tensor dimension along second mesh dimension visualize dt distribute_tensor t m dt Replicate dt Shard dim= Shard second tensor dimension along second mesh dimension + replicate second tensor dimension along first mesh dimension dist destroy_process_group