logging dataclasses dataclass typing Optional Union torch log = logging getLogger __name__ dataclass frozen=True DeviceInfo Theoretical Numbers data sheet If two numbers given Tensor Matrix Core vs then higher number reported Sparsity considered Bandwidth numbers tricky because there platform differences may show up profiler trace For example tops dict Union torch dtype str float dram_bw_gbs float dram_gb float Indexing based ` torch cuda get_device_name ` TODO investigate profiler support tf allow device report correct number when s turned _device_mapping dict str DeviceInfo = Source lint-ignore https www nvidia com en-us data-center h NVIDIA H DeviceInfo tops= torch float torch float torch tf torch bfloat torch float torch float _e m fnu torch float _e m fnu torch float _e m fnuz torch float _e m torch float _e m fnuz torch float _e m fnu torch int dram_bw_gbs= dram_gb= Source lint-ignore https www nvidia com content dam en-zz Solutions Data-Center pdf nvidia-a -datasheet-us-nvidia- -r -web pdf NVIDIA A DeviceInfo tops= torch float torch float torch bfloat torch float Not datasheet float torch int torch tf dram_bw_gbs= dram_gb= Source lint-ignore https resources nvidia com en-us-gpu-resources l -tensor-datasheet NVIDIA L DeviceInfo tops= This guess datasheet torch float torch float torch tf torch bfloat torch float torch float _e m fnu torch float _e m fnu torch float _e m fnuz torch float _e m torch float _e m fnuz torch float _e m fnu torch int dram_bw_gbs= dram_gb= Source lint-ignore https www amd com content dam amd en documents\ instinct-tech-docs product-briefs amd-instinct-mi x-gpu-brochure pdf AMD MI X DeviceInfo tops= torch float torch float specified fall back float numbers torch tf torch bfloat torch float torch float _e m fnu torch float _e m fnu torch float _e m fnuz torch float _e m torch float _e m fnuz torch float _e m fnu torch int dram_bw_gbs= dram_gb= Source lint-ignore https www amd com content dam amd en documents\ instinct-tech-docs data-sheets amd-instinct-mi a-data-sheet pdf AMD MI A DeviceInfo tops= torch float torch float torch tf torch bfloat torch float torch float _e m fnu torch float _e m fnu torch float _e m fnuz torch float _e m torch float _e m fnuz torch float _e m fnu torch int dram_bw_gbs= dram_gb= Source lint-ignore https www amd com content dam amd en documents \ instinct-tech-docs data-sheets amd-instinct-mi x-data-sheet pdf AMD MI X DeviceInfo tops= torch float torch float torch tf torch bfloat torch float torch float _e m fnu torch float _e m fnu torch float _e m fnuz torch float _e m torch float _e m fnuz torch float _e m fnu torch int dram_bw_gbs= dram_gb= Source lint-ignore https www amd com content dam amd \ en documents instinct-business-docs product-briefs instinct-mi -brochure pdf AMD MI X DeviceInfo tops= torch float torch float specified fall back float numbers torch tf torch bfloat torch float specified fall back float numbers torch float _e m fnu torch float _e m fnu torch float _e m fnuz torch float _e m torch float _e m fnuz torch float _e m fnu torch int pcie x dram_bw_gbs= dram_gb= _device_mapping AMD INSTINCT MI X = _device_mapping AMD MI X _device_mapping AMD INSTINCT MI X = _device_mapping AMD MI X _device_mapping AMD INSTINCT MI X = _device_mapping AMD MI X lookup_device_info name str - Optional DeviceInfo Problem when diffing profiles between amd nvidia we don t have access device information other one Also since analysis static we should able do another device unrelated recorded device Therefore _device_mapping statically contains information lots devices If one missing please run DeviceInfo get_device_info add _device_mapping name str name device lookup Should map onto torch cuda get_device_name _device_mapping get name datasheet_tops dtype torch dtype is_tf bool = False - Optional float Get theoretical TFLOPS device given dtype This can throw exception device datasheet list above name Optional str = torch cuda get_device_name name None log info No device found returning None None device_info = lookup_device_info name device_info None log_str = f Device name datasheet returning None log info log_str None dtype device_info tops log info Device s does have datasheet entry s returning None name dtype None device_info tops torch tf dtype == torch float is_tf dtype