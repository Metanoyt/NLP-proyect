sys benchmark_base BenchmarkBase torch Benchmark BenchmarkBase __init__ super __init__ category= aotdispatcher_partitioner backend= aot_eager_decomp_partition device= cpu name f category _ device description Partitioner benchmark many parallel use chains See https github com pytorch pytorch issues _prepare_once x = torch randn requires_grad=True _prepare torch _dynamo reset _work torch compile backend=self backend fullgraph=True f x tmps = x + i i range tmps = x + tmp tmp tmps i range len tmps - tmps i = tmps i sin mul tmps i tmps i + -= tmps i tmps i + -= tmps i tmps i + -= tmps i sum tmps f x main result_path = sys argv all = Benchmark benchmark all benchmark enable_compile_time_instruction_count collect_all append_results result_path __name__ == __main__ main