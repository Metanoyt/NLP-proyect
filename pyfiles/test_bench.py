pytest torch fuser set_fuser runner get_nn_runners pytest fixture scope= modeldef request net_name executor fuser set_fuser fuser executor Given net_name provided generate_tests build thing name rnn_creator context = get_nn_runners net_name creator_args = seqLength numLayers inputSize hiddenSize miniBatch device cuda seed None rnn_creator creator_args cuda_sync func args kwargs out = func args kwargs torch cuda synchronize out pytest mark benchmark warmup=True warmup_iterations= disable_gc=True max_time= group= fastrnns TestBenchNetwork See modeldef fixture which provides things benchmark test_forward modeldef benchmark benchmark cuda_sync modeldef forward modeldef inputs test_backward modeldef benchmark backward_input = modeldef forward modeldef inputs modeldef backward_setup None backward_input = modeldef backward_setup backward_input modeldef backward None benchmark cuda_sync modeldef backward backward_input retain_graph=True torch no_grad param modeldef params assert param grad None param grad zero_