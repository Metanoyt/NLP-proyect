Used load initialize polyfill handlers when importing torch _dynamo Please add new when adding new polyfill module importlib typing TYPE_CHECKING polyfills trace_rules TYPE_CHECKING types ModuleType See also TYPE_CHECKING block torch _dynamo polyfills __init__ py POLYFILLED_MODULE_NAMES tuple str = _collections builtins functools itertools operator os pytree struct sys fx tensor POLYFILLED_MODULES tuple ModuleType = tuple importlib import_module f submodule package=polyfills __name__ submodule POLYFILLED_MODULE_NAMES Unregister builtin functions _builtin_function_ids let them dispatched appropriate VariableTracker type Otherwise they will dispatched BuiltinVariable present _builtin_function_ids polyfill_module POLYFILLED_MODULES polyfill_name polyfill_module __all__ polyfill_handler = getattr polyfill_module polyfill_name original_fn = polyfill_handler __torch_dynamo_original__ trace_rules _builtin_function_ids remove id original_fn