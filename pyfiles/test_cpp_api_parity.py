Owner s module cpp os cpp_api_parity functional_impl_check module_impl_check sample_functional sample_module cpp_api_parity parity_table_parser parse_parity_tracker_table cpp_api_parity utils is_torch_nn_functional_test torch torch testing _internal common_nn common_nn torch testing _internal common_utils common NOTE turn you want print source code all C++ tests e g debugging purpose PRINT_CPP_SOURCE = False devices = cpu cuda PARITY_TABLE_PATH = os path join os path dirname __file__ cpp_api_parity parity-tracker md parity_table = parse_parity_tracker_table PARITY_TABLE_PATH torch testing _internal common_utils markDynamoStrictTest TestCppApiParity common TestCase module_test_params_map = functional_test_params_map = expected_test_params_dicts = test_params_dicts test_instance_class sample_module module_tests common_nn NewModuleTest sample_functional functional_tests common_nn NewModuleTest common_nn module_tests common_nn NewModuleTest common_nn get_new_module_tests common_nn NewModuleTest common_nn criterion_tests common_nn CriterionTest test_params_dict test_params_dicts test_params_dict get test_cpp_api_parity True is_torch_nn_functional_test test_params_dict functional_impl_check write_test_to_test_class TestCppApiParity test_params_dict test_instance_class parity_table devices module_impl_check write_test_to_test_class TestCppApiParity test_params_dict test_instance_class parity_table devices expected_test_params_dicts append test_params_dict Assert all NN module functional test dicts appear parity test assert len name name TestCppApiParity __dict__ test_torch_nn_ name == len expected_test_params_dicts len devices Assert there exists auto-generated tests ` SampleModule ` ` sample_functional ` == number test dicts skipped number devices assert len name name TestCppApiParity __dict__ SampleModule name == == number test dicts skipped number devices assert len name name TestCppApiParity __dict__ sample_functional name == module_impl_check build_cpp_tests TestCppApiParity print_cpp_source=PRINT_CPP_SOURCE functional_impl_check build_cpp_tests TestCppApiParity print_cpp_source=PRINT_CPP_SOURCE __name__ == __main__ common TestCase _default_dtype_check_enabled = True common run_tests