operator_benchmark op_bench torch Microbenchmarks interpolate operator InterpolateBenchmark op_bench TorchBenchmarkBase init input_size output_size channels_last=False mode= linear dtype=torch float input_image = torch randint size=input_size dtype=dtype device= cpu requires_grad=self auto_set channels_last input_image ndim == input_image = input_image contiguous memory_format=torch channels_last input_image ndim == input_image = input_image contiguous memory_format=torch channels_last_ d raise ValueError f Can set channels_last input input_image ndim dims align_corners = None mode == nearest False mode == linear mode = linear bilinear trilinear input_image ndim inputs = input_image input_image output_size output_size mode mode align_corners align_corners set_module_name interpolate forward input_image output_size mode align_corners torch nn functional interpolate input_image size=output_size mode=mode align_corners=align_corners config_short = op_bench config_list attr_names= input_size output_size attrs= cross_product_configs= channels_last True False mode nearest linear bicubic tags= short config_short += op_bench config_list attr_names= input_size output_size attrs= cross_product_configs= channels_last True False mode nearest dtype torch uint tags= short config_long = op_bench config_list attr_names= input_size output_size attrs= vectorization test-case cross_product_configs= channels_last True False mode nearest linear bicubic tags= long config_ d = op_bench config_list no channels_last D tensors attr_names= input_size output_size attrs= cross_product_configs= mode nearest linear tags= long config_ d = op_bench config_list attr_names= input_size output_size attrs= vectorization test-case cross_product_configs= channels_last True False mode nearest linear tags= long config config_short config_long config_ d config_ d op_bench generate_pt_test config InterpolateBenchmark __name__ == __main__ op_bench benchmark_runner main