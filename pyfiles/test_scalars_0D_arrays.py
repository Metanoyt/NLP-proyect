Owner s module dynamo Basic tests assert illustrate behavior around decision use D arrays place array scalars Extensive tests sort functionality numpy_tests core scalar Also test isscalar function which deliberately bit more lax torch testing _internal common_utils instantiate_parametrized_tests parametrize run_tests subtest TEST_WITH_TORCHDYNAMO TestCase xfailIfTorchDynamo TEST_WITH_TORCHDYNAMO numpy np numpy testing assert_equal torch _numpy np torch _numpy testing assert_equal parametrize_value = parametrize value subtest np int name= int subtest np array name= array subtest np asarray name= asarray subtest np asarray np int name= asarray_int instantiate_parametrized_tests TestArrayScalars TestCase parametrize_value test_array_scalar_basic value assert value ndim == assert value shape == assert value size == assert value dtype == np dtype int parametrize_value test_conversion_to_int value py_scalar = int value assert py_scalar == assert isinstance py_scalar int assert isinstance value int parametrize_value test_decay_to_py_scalar value NumPy distinguishes array scalars D arrays For instance ` scalar list ` equivalent ` int scalar list ` ` D array list ` equivalent ` D array np asarray list ` Our scalars follow D array behavior because they D arrays lst = product = value lst assert isinstance product np ndarray assert product shape == assert_equal product repeat right-multiply product = lst value assert isinstance product np ndarray assert product shape == assert_equal product test_scalar_comparisons scalar = np int arr = np array assert arr == scalar assert arr = scalar assert arr = scalar assert scalar == assert arr == xfailIfTorchDynamo instantiate_parametrized_tests TestIsScalar TestCase np isscalar checks its argument numeric object exactly one element This differs NumPy which also requires shape == scalars = subtest literal subtest int int subtest np float float subtest np array array_ D decorators= xfailIfTorchDynamo subtest list decorators= xfailIfTorchDynamo subtest list-list decorators= xfailIfTorchDynamo subtest np array array_ D decorators= xfailIfTorchDynamo subtest np array array_ D decorators= xfailIfTorchDynamo math not_scalars = int np float subtest s decorators= xfailIfTorchDynamo subtest string decorators= xfailIfTorchDynamo math sin np np transpose np asarray np float parametrize value scalars test_is_scalar value assert np isscalar value parametrize value not_scalars test_is_not_scalar value assert np isscalar value __name__ == __main__ run_tests