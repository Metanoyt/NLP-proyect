contextlib os typing Union torch _dynamo test_case run_tests dynamo_run_tests TestCase DynamoTestCase torch _functorch config functorch_config torch _inductor config torch _inductor utils fresh_cache run_tests needs Union str tuple str = - None dynamo_run_tests needs TestCase DynamoTestCase A base TestCase inductor tests Enables FX graph caching isolates cache directory each test setUp - None super setUp _inductor_test_stack = contextlib ExitStack _inductor_test_stack enter_context functorch_config patch enable_autograd_cache True TORCHINDUCTOR_FX_GRAPH_CACHE os environ _inductor_test_stack enter_context config patch fx_graph_cache True os environ get INDUCTOR_TEST_DISABLE_FRESH_CACHE = os environ get TORCH_COMPILE_DEBUG = _inductor_test_stack enter_context fresh_cache tearDown - None super tearDown _inductor_test_stack close