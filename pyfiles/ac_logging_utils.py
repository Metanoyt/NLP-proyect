json logging typing Any torch _logging trace_structured torch fx Graph Node log logging Logger = logging getLogger __name__ create_joint_graph_node_information joint_graph Graph recomputable_node_info dict str int - dict str Any joint_graph_node_information dict str Any = i joint_graph_node enumerate joint_graph nodes is_recomputable_candidate bool = joint_graph_node name recomputable_node_info tensor_meta = joint_graph_node meta get tensor_meta shape = getattr tensor_meta shape tensor_meta node_info dict str Any = index i name joint_graph_node name is_recomputable_candidate is_recomputable_candidate target str joint_graph_node target shape str shape input_arguments inp name inp joint_graph_node all_input_nodes stack_trace joint_graph_node meta get stack_trace is_recomputable_candidate idx int = recomputable_node_info joint_graph_node name node_info recomputable_candidate_info = recomputable_node_idx idx joint_graph_node_information joint_graph_node name = node_info joint_graph_node_information create_joint_graph_edges joint_graph Graph - list tuple str str joint_graph_edges list tuple str str = inp name node name node joint_graph nodes inp node all_input_nodes joint_graph_edges create_activation_checkpointing_logging_structure_payload joint_graph Graph joint_graph_node_information dict str Any joint_graph_edges list tuple str str all_recomputable_banned_nodes list Node expected_runtime float saved_node_idxs list int recomputable_node_idxs list int memories_banned_nodes list int normalized_memories_banned_nodes list float runtimes_banned_nodes list float min_cut_saved_values list Node - dict str Any Creates structured payload logging activation checkpointing information Args joint_graph The computational graph representing operations joint_graph_node_information Dictionary containing information about nodes joint graph joint_graph_edges List edges joint graph represented tuples node names all_recomputable_banned_nodes List nodes banned recomputation expected_runtime Expected runtime computation saved_node_idxs Indices nodes saved recomputed recomputable_node_idxs Indices nodes can recomputed memories_banned_nodes Memory usage values absolute units banned nodes normalized_memories_banned_nodes Normalized memory usage values banned nodes used input knapsack algorithm runtimes_banned_nodes Runtime values banned nodes used input knapsack algorithm min_cut_saved_values List nodes saved min-cut algorithm Returns A dictionary containing structured logging information activation checkpointing activation_checkpointing_logging_structure_payload dict str Any = Joint Graph Size len joint_graph nodes Joint Graph Edges Total len joint_graph_edges Edges joint_graph_edges Joint Graph Node Information joint_graph_node_information Recomputable Banned Nodes Order node name node all_recomputable_banned_nodes Expected Runtime expected_runtime Knapsack Saved Nodes saved_node_idxs Knapsack Recomputed Nodes recomputable_node_idxs Absolute Memories memories_banned_nodes Knapsack Input Memories normalized_memories_banned_nodes Knapsack Input Runtimes runtimes_banned_nodes Min Cut Solution Saved Values node name node min_cut_saved_values activation_checkpointing_logging_structure_payload create_structured_trace_for_min_cut_info joint_graph Graph all_recomputable_banned_nodes list Node saved_node_idxs list int recomputable_node_idxs list int expected_runtime float memories_banned_nodes list int normalized_memories_banned_nodes list float runtimes_banned_nodes list float min_cut_saved_values list Node - None Creates structured trace minimum cut information graph Args joint_graph The computational graph representation all_recomputable_banned_nodes List nodes can recomputed saved_node_idxs Indices nodes saved memory recomputable_node_idxs Indices nodes recomputed expected_runtime Expected runtime computation memories_banned_nodes Memory requirements each banned node bytes normalized_memories_banned_nodes Normalized memory requirements each banned node typically scaled between relative comparison runtimes_banned_nodes Runtime costs associated each banned node min_cut_saved_values Nodes saved part minimum cut solution Create dictionary store recomputable node information recomputable_node_info dict str int = node name idx idx node enumerate all_recomputable_banned_nodes Create joint graph node information joint_graph_node_information = create_joint_graph_node_information joint_graph recomputable_node_info Update node information recomputable candidate details node_name node_info joint_graph_node_information items node_info is_recomputable_candidate idx = recomputable_node_info node_name node_info recomputable_candidate_info memory = memories_banned_nodes idx node_info recomputable_candidate_info runtime = runtimes_banned_nodes idx node_info recomputable_candidate_info is_saved = idx saved_node_idxs node_info recomputable_candidate_info is_recomputed = idx recomputable_node_idxs Create joint graph edges joint_graph_edges = create_joint_graph_edges joint_graph Create activation checkpointing logging structure payload activation_checkpointing_logging_structure_payload = create_activation_checkpointing_logging_structure_payload joint_graph=joint_graph joint_graph_node_information=joint_graph_node_information joint_graph_edges=joint_graph_edges all_recomputable_banned_nodes=all_recomputable_banned_nodes expected_runtime=expected_runtime saved_node_idxs=saved_node_idxs recomputable_node_idxs=recomputable_node_idxs memories_banned_nodes=memories_banned_nodes normalized_memories_banned_nodes=normalized_memories_banned_nodes runtimes_banned_nodes=runtimes_banned_nodes min_cut_saved_values=min_cut_saved_values Create structured trace trace_structured artifact metadata_fn=lambda name min_cut_information encoding json payload_fn=lambda json dumps activation_checkpointing_logging_structure_payload