operator_benchmark op_bench torch torch ao nn quantized nnq Microbenchmarks quantized Cat operator Configs PT Cat operator qcat_configs_short = op_bench config_list attr_names= M N K L dim attrs= cross_product_configs= contig all one none dtype torch quint torch qint torch qint tags= short qcat_configs_long = op_bench cross_product_configs M= N= K= L= dim= contig= all one none dtype= torch quint tags= long QCatBenchmark op_bench TorchBenchmarkBase init M N K L dim contig dtype f_input = torch rand M N K - qf = nnq QFunctional scale = zero_point = qf scale = scale qf zero_point = zero_point assert contig none one all q_input = torch quantize_per_tensor f_input scale zero_point dtype permute_dims = tuple range q_input ndim - - - q_input_non_contig = q_input permute permute_dims contiguous q_input_non_contig = q_input_non_contig permute permute_dims contig == all input = q_input q_input contig == one input = q_input q_input_non_contig contig == none input = q_input_non_contig q_input_non_contig inputs = input input dim dim set_module_name qcat forward input list torch Tensor dim int qf cat input dim=dim op_bench generate_pt_test qcat_configs_short + qcat_configs_long QCatBenchmark __name__ == __main__ op_bench benchmark_runner main