mypy allow-untyped-defs typing Optional torch torch Tensor torch autograd Function torch autograd function once_differentiable torch distributions constraints torch distributions exp_family ExponentialFamily torch types _size __all__ = Dirichlet This helper exposed testing _Dirichlet_backward x concentration grad_output total = concentration sum - True expand_as concentration grad = torch _dirichlet_grad x concentration total grad grad_output - x grad_output sum - True _Dirichlet Function staticmethod pyrefly ignore bad-override forward ctx concentration x = torch _sample_dirichlet concentration ctx save_for_backward x concentration x staticmethod once_differentiable pyrefly ignore bad-override backward ctx grad_output x concentration = ctx saved_tensors _Dirichlet_backward x concentration grad_output Dirichlet ExponentialFamily r Creates Dirichlet distribution parameterized concentration attr ` concentration ` Example xdoctest +IGNORE_WANT non-deterministic m = Dirichlet torch tensor m sample Dirichlet distributed concentration tensor Args concentration Tensor concentration parameter distribution often referred alpha pyrefly ignore bad-override arg_constraints = concentration constraints independent constraints positive support = constraints simplex has_rsample = True __init__ concentration Tensor validate_args Optional bool = None - None concentration dim raise ValueError ` concentration ` parameter must least one-dimensional concentration = concentration batch_shape event_shape = concentration shape - concentration shape - super __init__ batch_shape event_shape validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance Dirichlet _instance batch_shape = torch Size batch_shape new concentration = concentration expand batch_shape + event_shape super Dirichlet new __init__ batch_shape event_shape validate_args=False new _validate_args = _validate_args new rsample sample_shape _size = - Tensor shape = _extended_shape sample_shape concentration = concentration expand shape _Dirichlet apply concentration log_prob value _validate_args _validate_sample value torch xlogy concentration - value sum - + torch lgamma concentration sum - - torch lgamma concentration sum - property mean - Tensor concentration concentration sum - True property mode - Tensor concentrationm = concentration - clamp min= mode = concentrationm concentrationm sum - True mask = concentration all dim=- mode mask = torch nn functional one_hot mode mask argmax dim=- concentrationm shape - mode mode property variance - Tensor con = concentration sum - True concentration con - concentration con pow con + entropy k = concentration size - = concentration sum - torch lgamma concentration sum - - torch lgamma - k - torch digamma - concentration - torch digamma concentration sum - property _natural_params - tuple Tensor concentration pyrefly ignore bad-override _log_normalizer x x lgamma sum - - torch lgamma x sum -