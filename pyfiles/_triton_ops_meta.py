mypy allow-untyped-defs Provides optimal triton kernel parameters Aim --- The usage optimal triton kernel parameters may increase performance operations several times For example large tensor shapes usage bsr tensor mat argument addmm-based operations typically outperforms corresponding operation strided-only inputs when blocked representation tensor provides better alignment memory access than what strided representation would provide Pre-computed kernel parameters ------------------------------ This script finds stores optimal triton kernel parameters specific set shape configurations For instance set shape configurations bsr_dense_addmm kernel defined input out M x N strided tensor mat M x K bsr tensor blocksize BM BK given sparsity mat M x N strided tensor dtype = float bfloat float sparsity = M = K = M N = BM = BK = BM alpha = beta = GPUs NVIDIA A -SXM - GB Approximations -------------- It practically infeasible pre-compute optimal kernel parameter all possible shape configurations well all existing GPUs Therefore we ll assume pre-computed optimal parameters good enough approximations when used GPU any NVIDIA A Tensor Core GPUs actual sparsity mat different sparsity value If particular shape configuration does fall set pre-computed kernel parameters does match listed approximations above used GPU device NVIDIA A GPU then reference set triton kernel parameters will used when executing operations The reference kernel parameters defined torch sparse _triton_ops py see bsr_dense_addmm_meta function instance Computing optimal kernel parameters ----------------------------------- If approximations listed above unacceptable e g when one seeks maximal performance possible optimal kernel parameters particular GPU can computed simply running script pytorch development tree cd path pytorch python -m pip install -- no-build-isolation -v -e python torch sparse _triton_ops_meta py This will compute optimal kernel parameters GPU device available host system all shape configurations listed Pre-computed kernel parameters above The results will stored database kernel parameters Currently database defined module see BEGIN GENERATED DATA comment below will modified when script run Create pytorch PR corresponding modifications file make computed optimal kernel parameters available other users pre-computed kernel parameters Moreover one can compute optimal kernel parameters specific set shape configurations specific sparsity patterns For use tuning functions provided module tune_bsr_dense_addmm input mat mat beta= alpha= out=None verbose=False store=False - meta The tuning functions dictionary optimal kernel parameters can passed corresponding operation e g bsr_dense_addmm meta=meta Or when store==True optimal kernel parameters will stored database pre-computed kernel parameters runtime so all addmm-based operations such torch addmm torch mm torch nn functional linear will benefit using computed optimal set kernel parameters Note running tune_bsr_dense_addmm can take several minutes So use wisely e g implementing persistent storage optimized kernel parameters See source code get_meta tune_bsr_dense_addmm learn how register custom set optimal kernel parameters addmm-based operations __all__ = get_meta tune_bsr_dense_addmm tune__int_bsr_dense_addmm inspect itertools re warnings typing Any torch torch hub tqdm torch testing make_tensor get_meta op key device_name=None version= torch float exact=False Return triton kernel meta parameters specified op its inputs key Parameters ---------- op str The name operation implementation uses meta parameters key tuple A tuple op input parameters e g shapes etc device_name optional str The name device which op parameters provided version optional hashable Specifies version parameters exact optional bool When True returned data available corresponds exactly specified device_name version information Otherwise corresponding data available there exists data set computed similar GPU device then data set will returned Returns ------- result dict The requested mapping parameter names values None when no data available If input ` key ` contains ` ` result will dictionary keys mappings match given ` key ` device_name None device_name = torch cuda get_device_name op_data = _operation_device_version_data get op device_name version op_data None exact A lack op data could due using slightly different GPU model compared model which optimal meta parameters have been computed In following we ll assume there set GPU models all have similar set optimal meta parameters re match r NVIDIA A ^\d device_name None device_name = NVIDIA A -SXM - GB op_data = _operation_device_version_data get op device_name version op_data None matching_data = key op_key op_data None k k zip op_key key strict=True k = k = k continue matching_data op_key = op_data op_key values = op_data get key values None matching_data key = values matching_meta = op_key values matching_data items op == scatter_mm names = GROUP_SIZE SPLIT_N TILE_M TILE_N num_stages num_warps meta = dict zip names values strict=True op bsr_dense_addmm _int_bsr_dense_addmm meta = dict zip GROUP_SIZE_ROW SPLIT_N num_stages num_warps values strict=True raise NotImplementedError f names op= key meta matching_meta op_key = meta key matching_meta update op device_name version key value Update db op parameters skip storing possible optimization failures value warnings warn f skipping empty value op device_name= version= key= stacklevel= op device_name version _operation_device_version_data _operation_device_version_data op device_name version get key == value _operation_device_version_data op device_name version key = value _operation_device_version_data op device_name version = key value dump Store current runtime db state module file current_file = inspect getfile dump f = open current_file current_content = f read f close begin_data_str = BEGIN GENERATED DATA\n begin_data_index = current_content find begin_data_str end_data_index = current_content find END GENERATED DATA\n begin_data_index == - end_data_index == - warnings warn f current_file cannot updated BEGIN END GENERATED DATA comment blocks appear corrupted stacklevel= sort_key key op device_name version = key version = tuple str item isinstance item torch dtype item item version op device_name version part = current_content begin_data_index + len begin_data_str part = current_content end_data_index data_part = op_key sorted _operation_device_version_data key=sort_key pyrefly ignore bad-argument-type data_part append + repr op_key replace + op_data = _operation_device_version_data op_key pyrefly ignore bad-argument-type data_part extend f key op_data key key sorted op_data data_part append new_content = part + \n join data_part + \n + part current_content = new_content f = open current_file w f write new_content f close minimize target_func initial_parameters reference_parameters step_func max_step= verbose=False all_values=None Find dict parameters minimizes target function using initial dict parameters step function progresses specified parameter dict parameters Parameters ---------- target_func callable functional signature ` ` target_func parameters dict - float ` ` initial_parameters dict set parameters used initial value minimization process reference_parameters dict set parameters used reference value respect which speed up computed step_func callable functional signature ` ` step_func parameter_name str parameter_value int direction int parameters dict - int ` ` increments decrements when ` ` direction ` ` positive negative respectively parameter given name value When value equal ` ` parameter_value ` ` means no step along given direction can made Returns ------- parameters dict set parameters minimizes target function speedup_incr float speedup change given percentage timing float value target function parameters sensitivity_message str message containing sensitivity information parameters around target function minimizer to_key parameters tuple parameters k k sorted parameters from_key key parameters dict zip sorted parameters key strict=True all_values None all_values = directions = list range -max_step max_step + names = sorted initial_parameters all_directions = d_tuple itertools product directions len names dist = sum map abs d_tuple dist dist = max_step all_directions append dist d_tuple all_directions sort try reference_target = target_func reference_parameters except Exception msg verbose out resource str msg print f reference_parameters= lead failure msg reference_target = None reference_target None all_values to_key reference_parameters = reference_target parameters = initial_parameters try initial_target = target_func parameters except Exception msg reference_target None verbose print f initial_parameters= lead failure msg Optimization failed - - f msg verbose out resource str msg print f initial_parameters= lead failure msg Using reference parameters instead initial parameters parameters = reference_parameters initial_target = reference_target reference_target None verbose print Using initial parameters instead reference parameters reference_target = initial_target initial_key = to_key parameters minimal_target = all_values initial_key = initial_target pbar = tqdm total=len all_directions desc= Tuning disable=not verbose ncols= while True i _ d_tuple enumerate all_directions pbar update next_parameters = parameters copy name direction zip names d_tuple strict=True value = next_parameters name direction == continue next_value = step_func name value direction parameters next_value == value break next_parameters name = next_value next_key = to_key next_parameters next_key all_values continue try next_target = target_func next_parameters except Exception msg all_values next_key = str msg verbose out resource str msg print f next_parameters= lead failure msg Skipping continue all_values next_key = next_target next_target minimal_target minimal_target = next_target parameters = next_parameters pyrefly ignore unsupported-operation pbar total += i + break ensure stable minimizer minimizer_keys = k k v all_values items isinstance v float abs - v minimal_target minimizer_key = initial_key initial_key minimizer_keys min minimizer_keys parameters = from_key minimizer_key parameters speedup_incr = - minimal_target reference_target speedup_incr verbose print f speedup_incr= negative Rerunning minimize reference parameters initial parameters minimize target_func reference_parameters reference_parameters step_func max_step=max_step verbose=verbose all_values=all_values sensitivity = name parameters value = parameters name rel_diffs = direction range -max_step max_step + direction == continue next_value = step_func name value direction parameters next_value == value rel_diffs append continue next_parameters = parameters copy next_parameters name = next_value next_key = to_key next_parameters next_target = all_values get next_key next_target None isinstance next_target str rel_diffs append continue rel_diff = next_target minimal_target - rel_diffs append rel_diff sensitivity append max rel_diffs rel_diffs name sensitivity_message = f timing = initial_target f _ rel_diffs name sorted sensitivity reverse=True left_diffs = &#124; join f rel_diff f rel_diff rel_diffs max_step right_diffs = &#124; join f rel_diff f rel_diff rel_diffs max_step sensitivity_message append f name = parameters name left_diffs right_diffs sensitivity_message = join sensitivity_message parameters speedup_incr minimal_target sensitivity_message create_blocked_tensor B M N blocksize sparsity dtype device assert sparsity = sparsity = sparsity should value between assert M blocksize == assert N blocksize == shape = B M blocksize N blocksize int B == A = torch bernoulli torch full shape - sparsity dtype=torch float device=device dtype expected_nnz = int - sparsity M N blocksize blocksize nonzero_indices = A flatten nonzero actual_nnz = nonzero_indices shape actual_nnz expected_nnz selected_nonzeros = torch randperm actual_nnz actual_nnz - expected_nnz A flatten nonzero_indices selected_nonzeros = actual_nnz expected_nnz zero_indices = A == flatten nonzero selected_zeros = torch randperm zero_indices shape expected_nnz - actual_nnz A flatten zero_indices selected_zeros = A = torch repeat_interleave A blocksize dim=- A = torch repeat_interleave A blocksize dim=- A optimize_scatter_mm m k n bm bk dtype=torch float device= cuda sparsity= force=False triton torch sparse _triton_ops bsr_scatter_mm bsr_scatter_mm_indices_data key = m k n bm bk version = dtype sparsity device_name = torch cuda get_device_name reference_meta = dict GROUP_SIZE= TILE_M= TILE_N= SPLIT_N=n num_stages= num_warps= initial_meta = get_meta scatter_mm key device_name=device_name version=version exact=True initial_meta None initial_meta = get_meta bsr_dense_addmm key device_name=device_name version= dtype exact=True initial_meta None initial_meta = reference_meta force torch manual_seed bsr = create_blocked_tensor m k bm bk sparsity dtype device to_sparse_bsr bm bk dense = make_tensor k n dtype=dtype device=device bench meta bsr=bsr dense=dense indices_data = bsr_scatter_mm_indices_data bsr dense indices_format= bsr_strided_mm_compressed meta test_func bsr_scatter_mm bsr dense indices_data=indices_data ms_min = triton testing do_bench test_func warmup= rep= ms_min step_meta_parameter name value direction meta m=m n=n k=k bm=bm bk=bk next value positive negative direction input value step will result invalid value The input value assumed valid is_log = name SPLIT_N TILE_M TILE_N num_warps min_value = dict SPLIT_N= TILE_M= TILE_N= num_warps= num_stages= GROUP_SIZE= name max_value = dict SPLIT_N=n meta TILE_N TILE_M=bm TILE_N=n meta SPLIT_N get name value_step = dict SPLIT_N= TILE_M= TILE_N= num_warps= num_stages= GROUP_SIZE= name is_log next_value = value value_step direction direction value value_step abs direction next_value = value + value_step direction min_value None next_value = max next_value min_value max_value None next_value = min next_value max_value name == SPLIT_N n next_value = value Hard-skip parameter combinations break CUDA state pytorch dtype name next_value m n k bm bk torch float num_warps torch float num_warps torch float num_warps torch float num_warps torch float num_warps re match r NVIDIA A ^\d device_name None value next_value meta speedup timing _sensitivity_message = minimize bench initial_meta reference_meta step_meta_parameter initial_meta reference_meta initial_meta == meta force print f meta= speedup= f timing= f ms speedup device_name = torch cuda get_device_name update scatter_mm device_name version key tuple meta k k sorted meta tune__int_bsr_dense_addmm input bsr dense beta= alpha= out=None store=False verbose=False force=False tune_bsr_dense_addmm input bsr dense beta=beta alpha=alpha out=out store=store verbose=verbose force=force opname= _int_bsr_dense_addmm tune_bsr_dense_addmm input bsr dense beta= alpha= left_alpha=None right_alpha=None out=None store=False verbose=False force=False opname=None Tune bsr_dense_addmm kernel parameters against given inputs When store True tuning results will stored database kernel parameters triton opname None opname = bsr_dense_addmm opname == _int_bsr_dense_addmm torch sparse _triton_ops _int_bsr_dense_addmm bsr_dense_addmm torch sparse _triton_ops bsr_dense_addmm N = dense shape - values = bsr values crow_indices = bsr crow_indices batch_ndim = crow_indices dim - M K = bsr shape batch_ndim batch_ndim + BM BK = values shape batch_ndim + batch_ndim + Reference parameters set parameters leads successful kernel call corresponding timing used reference computing speedups Avoid changing reference parameters when possible reference_meta = dict GROUP_SIZE_ROW= num_stages= num_warps= SPLIT_N=max N BM Compute key parameters sparsity = round - bsr _nnz BM BK M K dtype = bsr dtype out None out_dtype = dtype out_dtype = out dtype out_dtype dtype version_dtype = dtype version_dtype = dtype out_dtype version = version_dtype sparsity key = M K N BM BK beta == beta == alpha == For tuning initial state use parameters database available otherwise use reference parameters initial_meta = get_meta opname key version=version exact=True initial_meta None may_skip_update = False initial_meta = get_meta opname key version= dtype exact=True initial_meta None initial_meta = reference_meta force initial_meta may_skip_update = True The target function minimized tuning process bench meta input=input bsr=bsr dense=dense alpha=alpha out=out test_func bsr_dense_addmm input bsr dense beta=beta alpha=alpha left_alpha=left_alpha right_alpha=right_alpha meta=meta out=out triton testing do_bench test_func warmup= rep= The step function increments specified meta parameter step_meta_parameter name value direction meta M=M N=N K=K BM=BM BK=BK next value positive negative direction input value step will result invalid value The input value assumed valid is_log = name SPLIT_N num_warps min_value = dict SPLIT_N= num_warps= num_stages= GROUP_SIZE_ROW= name max_value = dict SPLIT_N=max N BM get name value_step = dict SPLIT_N= num_warps= num_stages= GROUP_SIZE_ROW= name is_log next_value = value value_step direction direction value value_step abs direction next_value = value + value_step direction min_value None next_value = max next_value min_value max_value None next_value = min next_value max_value name == SPLIT_N N next_value = value next_value Tune meta speedup timing sensitivity_message = minimize bench initial_meta reference_meta step_meta_parameter max_step= verbose=verbose verbose print f - sensitivity_message speedup= f timing= f ms store may_skip_update meta == initial_meta initial_meta reference_meta device_name = torch cuda get_device_name update opname device_name version key tuple meta k k sorted meta meta optimize_bsr_dense_addmm m k n bm bk beta= alpha= use_left_alpha=False use_right_alpha=False dtype=torch float out_dtype=None device= cuda sparsity= force=False verbose=False opname=None torch manual_seed bsr = create_blocked_tensor m k bm bk sparsity dtype device to_sparse_bsr bm bk dense = make_tensor k n dtype=dtype device=device input = make_tensor m n dtype=dtype device=device left_alpha = make_tensor m dtype=dtype device=device use_left_alpha None right_alpha = make_tensor n dtype=dtype device=device use_right_alpha None out_dtype None out = dense new_empty m n dtype=out_dtype out = None tune_bsr_dense_addmm input bsr dense beta=beta alpha=alpha left_alpha=left_alpha right_alpha=right_alpha out=out store=True force=force verbose=verbose opname=opname main op= scatter_mm force=False dtype=torch float verbose=True itertools sizes_lst = sizes _lst = sz sz + sizes_lst sz = shapes_lst = sz sz sz sizes_lst - + sizes _lst shapes_lst extend shapes_lst extend dtype torch int triton does support smaller blocks than blocksize_lst = blocksize_lst = sparsity_lst = sparsity sparsity_lst print f op dtype sparsity= try M K N BM BK itertools product shapes_lst sizes_lst blocksize_lst BM = M BK = K M BM == K BK == continue op == scatter_mm optimize_scatter_mm M K N BM BK force=force sparsity=sparsity dtype=dtype op bsr_dense_addmm _int_bsr_dense_addmm M == K N == continue print f M K N BM BK = alpha beta optimize_bsr_dense_addmm M K N BM BK beta=beta alpha=alpha force=force sparsity=sparsity dtype=dtype verbose=verbose opname=op raise NotImplementedError op except KeyboardInterrupt break except Exception dump raise dump Check performance dependence sparsity apply adjustments when differences noticeable more than When using NVIDIA A GPU performance dependence sparsity insignificant majority shapes blocksizes combinations However very few specific size combinations effect sparsity performance can up M K N BM BK itertools product shapes_lst sizes_lst blocksize_lst meta_lst list = key = M K N BM BK sparsity sparsity_lst torch manual_seed bsr = create_blocked_tensor M K BM BK sparsity dtype device= cuda to_sparse_bsr BM BK dense = make_tensor K N dtype=dtype device= cuda meta_lst = sparsity sparsity_lst meta = get_meta op key version= dtype sparsity exact=True meta None continue bench meta bsr=bsr dense=dense triton op == scatter_mm torch sparse _triton_ops bsr_scatter_mm bsr_scatter_mm_indices_data indices_data = bsr_scatter_mm_indices_data bsr dense indices_format= bsr_strided_mm_compressed meta test_func bsr_scatter_mm bsr dense indices_data=indices_data raise NotImplementedError op ms_min = triton testing do_bench test_func warmup= rep= ms_min meta_lst append bench meta sparsity tuple meta k k sorted meta meta_lst continue meta_lst = sorted meta_lst index = next i i item enumerate meta_lst item == sparsity meta_lst == meta_lst index continue speeddiff = - meta_lst index meta_lst abs speeddiff continue print sparsity index key meta_lst speeddiff index device_name = torch cuda get_device_name meta = get_meta op key version= dtype meta_lst exact=True update op device_name dtype sparsity key tuple meta k k sorted meta print update dump _operation_device_version_data dict Any dict = Warning data between BEGIN END DATA comment lines below generated It can updated either manually via calling dump function defined above Legend op key - data scatter_mm M K N Ms Ks - GROUP_SIZE SPLIT_N TILE_M TILE_N num_stages num_warps bsr_dense_addmm M K N Ms Ks beta== beta== alpha== - GROUP_SIZE_ROW SPLIT_N num_stages num_warps BEGIN GENERATED DATA _int_bsr_dense_addmm NVIDIA A -SXM - GB torch int False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True _int_bsr_dense_addmm NVIDIA A -SXM - GB torch int False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True _int_bsr_dense_addmm NVIDIA A -SXM - GB torch int False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True bsr_dense_addmm NVIDIA A -SXM - GB torch bfloat False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True bsr_dense_addmm NVIDIA A -SXM - GB torch bfloat False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True bsr_dense_addmm NVIDIA A -SXM - GB torch float False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True bsr_dense_addmm NVIDIA A -SXM - GB torch float False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True bsr_dense_addmm NVIDIA A -SXM - GB torch float False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False False False False False True False True False False True True True False False True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True False True True False True True False True True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True bsr_dense_addmm NVIDIA A -SXM - GB torch float False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True bsr_dense_addmm NVIDIA A -SXM - GB torch int False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True False True True True False True scatter_mm NVIDIA A -SXM - GB torch bfloat scatter_mm NVIDIA A -SXM - GB torch float scatter_mm NVIDIA A -SXM - GB torch float END GENERATED DATA __name__ == __main__ dtype torch int op _int_bsr_dense_addmm main op=op force=False dtype=dtype dtype torch float torch bfloat torch float torch int op bsr_dense_addmm main op=op force=False dtype=dtype