Owner s module unknown typing Optional torch torch testing _internal common_utils TestCase run_tests skipIfTorchDynamo End-to-end tests features native_functions yaml FloatListWrapperModule torch nn Module forward values incr Optional list float torch _C _nn _test_optional_floatlist values incr IntListWrapperModule torch nn Module forward values incr Optional list int torch _C _nn _test_optional_intlist values incr TestNativeFunctions TestCase _lists_with_str foo foo foo foo foo foo foo _test_raises_str_typeerror fn arg _lists_with_str assertRaisesRegex TypeError str lambda fn arg try fn arg except TypeError e print e test_symintlist_error x = torch randn _test_raises_str_typeerror lambda arg torch _C _nn pad x arg test_vararg_symintlist_error _test_raises_str_typeerror lambda arg torch rand arg _test_raises_str_typeerror lambda arg torch rand arg test_symintlist_error_with_overload_but_is_unique x = torch randn y = torch randn _test_raises_str_typeerror lambda arg x set_ y arg test_symintlist_error_with_overload x = torch randn _test_raises_str_typeerror lambda arg x view arg test_intlist_error_with_overload x = torch randn _test_raises_str_typeerror lambda arg torch _C _nn pad x arg optional float list do_test_optional_floatlist_with_module module values = torch tensor dtype=torch float returned = module values None assertEqual values returned Make sure s alias indicating operator saw nullopt values = assertEqual values returned returned = module values assertEqual values torch tensor dtype=torch float assertEqual returned torch tensor dtype=torch float trace_optional_floatlist const wrapper values torch _C _nn _test_optional_floatlist values const torch jit trace wrapper torch tensor dtype=torch float skipIfTorchDynamo Not suitable test TorchDynamo test_optional_floatlist do_test_optional_floatlist_with_module FloatListWrapperModule do_test_optional_floatlist_with_module torch jit script FloatListWrapperModule traced_none = trace_optional_floatlist None traced_list = trace_optional_floatlist Not really module just lets us use our two traced functions handle specific cases passing None fake_module values const const None traced_none values const == traced_list values raise Exception Invalid argument noqa TRY do_test_optional_floatlist_with_module fake_module test_optional_floatlist_invalid assertRaisesRegex TypeError must tuple floats list FloatListWrapperModule torch zeros hi assertRaisesRegex RuntimeError value type instead found type torch jit script FloatListWrapperModule torch zeros hi assertRaisesRegex TypeError must Tensor FloatListWrapperModule torch zeros torch zeros assertRaisesRegex RuntimeError value type instead found type torch jit script FloatListWrapperModule torch zeros torch zeros optional int list do_test_optional_intlist_with_module module values = torch tensor dtype=torch int returned = module values None assertEqual values returned Make sure s alias indicating operator saw nullopt values = assertEqual values returned returned = module values assertEqual values torch tensor dtype=torch int assertEqual returned torch tensor dtype=torch int trace_optional_intlist const wrapper values torch _C _nn _test_optional_intlist values const torch jit trace wrapper torch tensor dtype=torch int skipIfTorchDynamo Not suitable test TorchDynamo test_optional_intlist do_test_optional_intlist_with_module IntListWrapperModule do_test_optional_intlist_with_module torch jit script IntListWrapperModule traced_none = trace_optional_intlist None traced_list = trace_optional_intlist Not really module just lets us use our two traced functions handle specific cases passing None fake_module values const const None traced_none values const == traced_list values raise Exception Invalid argument noqa TRY do_test_optional_intlist_with_module fake_module test_optional_intlist_invalid assertRaisesRegex TypeError must found IntListWrapperModule torch zeros assertRaisesRegex RuntimeError value type instead found type torch jit script IntListWrapperModule torch zeros assertRaisesRegex TypeError must Tensor IntListWrapperModule torch zeros torch zeros assertRaisesRegex RuntimeError value type instead found type torch jit script IntListWrapperModule torch zeros torch zeros optional filled int list do_test_optional_filled_intlist_with_module module values = torch tensor dtype=torch int returned = module values None assertEqual values returned Make sure s alias indicating operator saw nullopt values = assertEqual values returned returned = module values assertEqual values torch tensor dtype=torch int assertEqual returned torch tensor dtype=torch int trace_optional_filled_intlist const wrapper values torch _C _nn _test_optional_filled_intlist values const torch jit trace wrapper torch tensor dtype=torch int skipIfTorchDynamo Not suitable test TorchDynamo test_optional_filled_intlist f n int x = torch _C _nn _test_optional_filled_intlist torch tensor dtype=torch int n n y = torch _C _nn _test_optional_filled_intlist torch tensor dtype=torch int n x y eager returned = f assertEqual returned returned scripted s = torch jit script f returned = s assertEqual returned returned traced traced_none = trace_optional_filled_intlist None traced_int = trace_optional_filled_intlist Not really module just lets us use our two traced functions handle specific cases passing None fake_module values const const None traced_none values const == traced_int values raise Exception Invalid argument noqa TRY do_test_optional_filled_intlist_with_module fake_module test_string_defaults dummy = torch rand fn = torch _C _nn _test_string_default fn dummy assertRaisesRegex RuntimeError A fn dummy a= assertRaisesRegex RuntimeError B fn dummy b= f x torch _C _nn _test_string_default x scripted_fn = torch jit script f scripted_fn dummy __name__ == __main__ run_tests