operator_benchmark op_bench torch Microbenchmarks inplace binary operators add_ add_ sub_ sub_ div_ div_ mul_ mul_ copy_ copy_ ###### Benchmark ops performance inplace add + sub + mul + copy ###### binary_ops_list = op_bench op_list attr_names= op_name op_func attrs= add_ add_ sub_ sub_ div_ div_ done separately below because data type mul_ mul_ copy_ copy_ binary_short_configs = op_bench config_list attr_names= M N K attrs= cross_product_configs= device cpu cuda dtype_one torch int dtype_two torch int tags= short binary_long_configs = op_bench cross_product_configs M= N= K= device= cpu cuda dtype_one= torch int torch int dtype_two= torch int torch int tags= long InpBinaryOpBenchmark op_bench TorchBenchmarkBase init M N K device dtype_one dtype_two op_func inputs = input_one torch randn M N K device=device dtype=dtype_one input_two torch randn M N K device=device dtype=dtype_two op_func = op_func forward input_one input_two op_func input_one input_two op_bench generate_pt_tests_from_op_list binary_ops_list binary_short_configs + binary_long_configs InpBinaryOpBenchmark ###### Benchmark ops performance inplace div ###### Performing division inplace benchmarks separately data needs float binary_ops_list = op_bench op_list attr_names= op_name op_func attrs= div_ div_ binary_short_configs = op_bench config_list attr_names= M N K attrs= cross_product_configs= device cpu cuda dtype_one torch float dtype_two torch float tags= short binary_long_configs = op_bench cross_product_configs M= N= K= device= cpu cuda dtype_one= torch float torch float dtype_two= torch float torch float tags= long InpBinaryOpBenchmark op_bench TorchBenchmarkBase init M N K device dtype_one dtype_two op_func inputs = input_one torch randn M N K device=device dtype=dtype_one input_two torch randn M N K device=device dtype=dtype_two op_func = op_func forward input_one input_two op_func input_one input_two op_bench generate_pt_tests_from_op_list binary_ops_list binary_short_configs + binary_long_configs InpBinaryOpBenchmark __name__ == __main__ op_bench benchmark_runner main