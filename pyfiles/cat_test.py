random operator_benchmark op_bench torch Microbenchmarks Cat operator cross_product_configs = device cpu cuda Configs PT Cat operator cat_configs_short = op_bench config_list attr_names= sizes N dim attrs= noqa E noqa E noqa E cross_product_configs=cross_product_configs tags= short Configs specific static runtime feature - fast path runtime pared down models cat_configs_static_runtime = op_bench config_list attr_names= sizes N dim attrs= - - - - - - cross_product_configs=cross_product_configs tags= static_runtime cat_configs_long = op_bench config_list attr_names= sizes N dim attrs= noqa E + - noqa E E noqa E lambda random randint - + noqa E E E + lambda random randint noqa E E E E lambda random randint noqa E E E lambda random randint noqa E lambda random randint noqa E E + + lambda random randint noqa E E E cross_product_configs=cross_product_configs tags= long There different codepath CUDA dimensions cat_configs_multidim = op_bench config_list attr_names= sizes N dim attrs= noqa E noqa E + - + - + noqa E E cross_product_configs=cross_product_configs tags= multidim cat_configs_manyinputs = op_bench config_list attr_names= sizes N dim attrs= lambda random randint lambda random randint lambda random randint lambda random randint cross_product_configs=cross_product_configs tags= manyinputs CatBenchmark op_bench TorchBenchmarkBase init sizes N dim device random seed inputs = gen_sizes = type sizes list N == - gen_sizes = sizes i range N gen_sizes append old_size callable old_size old_size old_size sizes s gen_sizes inputs append torch rand s device=device result = torch empty device=device inputs = result result inputs inputs dim dim set_module_name cat forward result torch Tensor inputs list torch Tensor dim int torch cat inputs dim=dim out=result op_bench generate_pt_test cat_configs_short + cat_configs_long + cat_configs_multidim + cat_configs_manyinputs + cat_configs_static_runtime CatBenchmark __name__ == __main__ op_bench benchmark_runner main