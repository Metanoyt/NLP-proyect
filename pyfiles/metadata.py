mypy allow-untyped-defs dataclasses dataclass field enum Enum torch torch distributed _shard metadata ShardMetadata MEM_FORMAT_ENCODING Enum TORCH_CONTIGUOUS_FORMAT = TORCH_CHANNELS_LAST = TORCH_PRESERVE_FORMAT = dataclass TensorProperties Properties used create ` Tensor ` Regular tensor fields dtype torch dtype = field default=torch get_default_dtype layout torch layout = field default=torch strided requires_grad bool = False memory_format torch memory_format = field default=torch contiguous_format pin_memory bool = False __getstate__ Since torch memory_format cannot pickled memory_format = memory_format memory_format == torch contiguous_format mem_format_encoding = MEM_FORMAT_ENCODING TORCH_CONTIGUOUS_FORMAT memory_format == torch channels_last mem_format_encoding = MEM_FORMAT_ENCODING TORCH_CHANNELS_LAST memory_format == torch preserve_format mem_format_encoding = MEM_FORMAT_ENCODING TORCH_PRESERVE_FORMAT raise RuntimeError f Invalid torch memory_format memory_format dtype layout requires_grad mem_format_encoding pin_memory __setstate__ state dtype layout requires_grad mem_format_encoding pin_memory = state mem_format_encoding == MEM_FORMAT_ENCODING TORCH_CONTIGUOUS_FORMAT memory_format = torch contiguous_format mem_format_encoding == MEM_FORMAT_ENCODING TORCH_CHANNELS_LAST memory_format = torch channels_last mem_format_encoding == MEM_FORMAT_ENCODING TORCH_PRESERVE_FORMAT memory_format = torch preserve_format raise RuntimeError f Invalid torch memory_format encoding mem_format_encoding memory_format = memory_format staticmethod create_from_tensor tensor torch Tensor - TensorProperties TensorProperties dtype=tensor dtype layout=tensor layout requires_grad=tensor requires_grad memory_format=torch contiguous_format pin_memory=tensor is_pinned dataclass ShardedTensorMetadata Represents metadata ` ShardedTensor ` Metadata about each shard Tensor shards_metadata list ShardMetadata = field default_factory=list Size each dim overall Tensor size torch Size = field default=torch Size tensor_properties TensorProperties = field default_factory=TensorProperties