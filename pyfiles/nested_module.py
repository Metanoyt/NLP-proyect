sys benchmark_base BenchmarkBase torch torch nn nn torch _inductor utils fresh_cache NestedModule nn Module __init__ depth= width= super __init__ depth = depth width = width relu_a = nn ReLU relu_b = nn ReLU sub_mods = depth i range width sub_mods append NestedModule depth - width i range width sub_mods append nn ReLU sub_mods = nn Sequential sub_mods = forward x x = relu_a x x = x + sub_mods x x + relu_b x + Benchmark BenchmarkBase __init__ ModuleClass backend= eager is_gpu=False dynamic=False ModuleClass = ModuleClass _name = ModuleClass __name__ _is_gpu = is_gpu super __init__ category= basic backend=backend device= cuda _is_gpu cpu dynamic=dynamic name prefix = f category _ _name _ backend prefix _prepare_once m = ModuleClass torch set_float _matmul_precision high input = torch ones device=self device _prepare torch _dynamo reset _work enable_cpp_symbolic_shape_guards has impact benchmark Keep using False value consistency fresh_cache opt_m = torch compile backend=self backend dynamic=self is_dynamic m cuda _is_gpu m opt_m input main result_path = sys argv benchmarks = Benchmark NestedModule b benchmarks b enable_compile_time_instruction_count collect_all append_results result_path __name__ == __main__ main