collections abc Callable typing Any torch torch nn nn torch fx _compatibility compatibility torch fx graph_module GraphModule __all__ = default_matching extract_attrs_for_lowering lift_lowering_attrs_to_nodes Matching method matches attribute name current version attribute name ` target_version ` compatibility is_backward_compatible=False default_matching name str target_version int - str Default matching method name This dict maps nn Module name attribute name list we want fetch lowering The first integer tuple version number nn Module when we create parameter list If there s version mismatch then means parameter names book might mismatched nn Module module_fetch_book dict type tuple int list str Callable str int str = torch nn modules linear Linear weight bias default_matching torch nn modules conv Conv d weight bias kernel_size stride padding dilation groups padding_mode default_matching torch nn modules batchnorm BatchNorm d weight bias running_mean running_var eps default_matching torch nn modules pooling AdaptiveAvgPool d default_matching torch nn modules pooling MaxPool d kernel_size stride padding dilation return_indices ceil_mode default_matching torch nn modules activation ReLU inplace default_matching compatibility is_backward_compatible=False extract_attrs_for_lowering mod nn Module - dict str Any If ` mod ` ` module_fetch_book ` fetch mod s attributes ` module_fetch_book ` after checking module s version compatible ` module_fetch_book ` attrs_for_lowering dict str Any = attrs_for_lowering name = torch typename mod type mod module_fetch_book version param_to_fetch matching_method = module_fetch_book type mod version mod _version raise RuntimeError f Fetcher version version try fetch torch typename mod version mod _version please upgrade module_fetch_book open issue report bug AIACC team directly attr param_to_fetch attrs_for_lowering attr = getattr mod matching_method attr mod _version raise RuntimeError f torch typename mod module_fetch_book yet please add module_fetch_book open issue report bug AIACC team directly attrs_for_lowering compatibility is_backward_compatible=False lift_lowering_attrs_to_nodes fx_module GraphModule - None Recursively traverse all ` fx_module ` nodes fetch module s attributes node leaf module submodules = dict fx_module named_modules node fx_module graph nodes node op == call_module isinstance submodules node target GraphModule lift_lowering_attrs_to_nodes submodules node target node attrs_for_lowering = extract_attrs_for_lowering submodules node target