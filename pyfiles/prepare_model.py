This script end-to-end mobile custom build test purpose It prepares MobileNetV TorchScript model dumps root ops used model custom build script create tailored build which only contains these used ops yaml torchvision models torch Download trace model model = models mobilenet_v weights=models MobileNet_V _Weights IMAGENET K_V model eval example = torch rand traced_script_module = torch jit trace model example Save traced TorchScript model traced_script_module save MobileNetV pt Dump root ops used model custom build optimization ops = torch jit export_opnames traced_script_module Besides ops used model custom c++ client code might use some extra ops too For example dummy predictor cpp driver test suite calls ` aten ones ` create all-one-tensor testing purpose which used MobileNetV model itself This less problem Android where we expect users use limited set Java APIs To actually solve problem we probably need ask users run code analyzer against their client code dump these extra root ops So will require more work switch custom build dynamic dispatch - static dispatch case these extra ops will kept linker automatically For CI purpose one-off hack probably fine EXTRA_CI_ROOT_OPS = aten ones ops extend EXTRA_CI_ROOT_OPS open MobileNetV yaml w output yaml dump ops output