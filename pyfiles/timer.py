threading Lock Thread time monotonic sleep typing Callable Optional Union Timer This measures how long we have gone since last receiving event greater than set interval calls function __init__ duration Union int float Duration seconds call Callable None Function call when we expire - None We don t start background thread until we actually get event background_thread Optional Thread = None last_called Optional float = None duration = duration sleep_time = call = call exit = False lock = Lock record_call - None lock background_thread None background_thread = Thread target=self check daemon=True name= subproc_worker_timer background_thread start last_called = monotonic quit - None lock exit = True check - None while True We have sensitive checking here avoid too much impact cpu sleep sleep_time lock exit assert last_called None last_called + duration = monotonic continue last_called = None background_thread = None Releasing lock case call takes very long time reentrant call