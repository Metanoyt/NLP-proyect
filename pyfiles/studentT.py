mypy allow-untyped-defs math typing Optional Union torch torch inf nan Tensor torch distributions Chi constraints torch distributions distribution Distribution torch distributions utils _standard_normal broadcast_all torch types _size __all__ = StudentT StudentT Distribution r Creates Student s t-distribution parameterized degree freedom attr ` df ` mean attr ` loc ` scale attr ` scale ` Example xdoctest +IGNORE_WANT non-deterministic m = StudentT torch tensor m sample Student s t-distributed degrees freedom= tensor Args df float Tensor degrees freedom loc float Tensor mean distribution scale float Tensor scale distribution pyrefly ignore bad-override arg_constraints = df constraints positive loc constraints real scale constraints positive support = constraints real has_rsample = True property mean - Tensor m = loc clone memory_format=torch contiguous_format m df = = nan m property mode - Tensor loc property variance - Tensor m = df clone memory_format=torch contiguous_format m df = scale df pow df df df df - m df = df = inf m df = = nan m __init__ df Union Tensor float loc Union Tensor float = scale Union Tensor float = validate_args Optional bool = None - None df loc scale = broadcast_all df loc scale _chi = Chi df batch_shape = df size super __init__ batch_shape validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance StudentT _instance batch_shape = torch Size batch_shape new df = df expand batch_shape new loc = loc expand batch_shape new scale = scale expand batch_shape new _chi = _chi expand batch_shape super StudentT new __init__ batch_shape validate_args=False new _validate_args = _validate_args new rsample sample_shape _size = torch Size - Tensor NOTE This does agree scipy implementation much other distributions see https github com fritzo notebooks blob master debug-student-t ipynb Using DoubleTensor parameters seems help X ~ Normal Z ~ Chi df Y = X sqrt Z df ~ StudentT df shape = _extended_shape sample_shape X = _standard_normal shape dtype=self df dtype device=self df device Z = _chi rsample sample_shape Y = X torch rsqrt Z df loc + scale Y log_prob value _validate_args _validate_sample value y = value - loc scale Z = scale log + df log + math log math pi + torch lgamma df - torch lgamma df + - df + torch log p y df - Z entropy lbeta = torch lgamma df + math lgamma - torch lgamma df + scale log + df + torch digamma df + - torch digamma df + df log + lbeta