Owner s module onnx os unittest onnx_test_common parameterized PIL torchvision torch torch nn torch testing _internal common_utils _get_test_image_tensor data_dir = os path join os path dirname __file__ assets img_path = os path join data_dir grace_hopper_ x jpg input_image = PIL Image open img_path Based example https pytorch org hub pytorch_vision_resnet preprocess = torchvision transforms Compose torchvision transforms Resize torchvision transforms CenterCrop torchvision transforms ToTensor torchvision transforms Normalize mean= std= preprocess input_image unsqueeze Due precision error quantization check only top prediction matches _TopPredictor nn Module __init__ base_model super __init__ base_model = base_model forward x x = base_model x _ topk_id = torch topk x topk_id TODO All torchvision quantized model test can written single parameterized test case after per-parameter test decoration supported via after they all enabled whichever first parameterized parameterized_class is_script True False class_name_func=onnx_test_common parameterize_class_name TestQuantizedModelsONNXRuntime onnx_test_common _TestONNXRuntime run_test model inputs args kwargs model = _TopPredictor model super run_test model inputs args kwargs test_mobilenet_v model = torchvision models quantization mobilenet_v _large pretrained=True quantize=True run_test model _get_test_image_tensor unittest skip quantized cat supported test_inception_v model = torchvision models quantization inception_v pretrained=True quantize=True run_test model _get_test_image_tensor unittest skip quantized cat supported test_googlenet model = torchvision models quantization googlenet pretrained=True quantize=True run_test model _get_test_image_tensor unittest skip quantized cat supported test_shufflenet_v _x _ model = torchvision models quantization shufflenet_v _x _ pretrained=True quantize=True run_test model _get_test_image_tensor test_resnet model = torchvision models quantization resnet pretrained=True quantize=True run_test model _get_test_image_tensor test_resnet model = torchvision models quantization resnet pretrained=True quantize=True run_test model _get_test_image_tensor test_resnext _ x d model = torchvision models quantization resnext _ x d pretrained=True quantize=True run_test model _get_test_image_tensor __name__ == __main__ common_utils run_tests