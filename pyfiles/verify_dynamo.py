os re subprocess sys traceback warnings MIN_CUDA_VERSION = MIN_ROCM_VERSION = MIN_PYTHON_VERSION = VerifyDynamoError BaseException pass check_python sys version_info MIN_PYTHON_VERSION raise VerifyDynamoError f Python version supported sys version_info f - minimum requirement MIN_PYTHON_VERSION sys version_info check_torch torch torch __version__ based torch utils cpp_extension py get_cuda_version torch torch_version TorchVersion torch utils cpp_extension CUDA_HOME = cpp_extension _find_cuda_home CUDA_HOME raise VerifyDynamoError cpp_extension CUDA_NOT_FOUND_MESSAGE nvcc = os path join CUDA_HOME bin nvcc cuda_version_str = subprocess check_output nvcc -- version strip decode cpp_extension SUBPROCESS_DECODE_ARGS cuda_version = re search r release \d+ \d+ cuda_version_str cuda_version None raise VerifyDynamoError CUDA version found ` nvcc -- version ` output cuda_str_version = cuda_version group TorchVersion cuda_str_version get_rocm_version torch torch_version TorchVersion torch utils cpp_extension ROCM_HOME = cpp_extension _find_rocm_home ROCM_HOME raise VerifyDynamoError ROCM found system please set ROCM_HOME environment variable hipcc = os path join ROCM_HOME bin hipcc hip_version_str = subprocess check_output hipcc -- version strip decode cpp_extension SUBPROCESS_DECODE_ARGS hip_version = re search r HIP version \d+ \d+ hip_version_str hip_version None raise VerifyDynamoError HIP version found ` hipcc -- version ` output hip_str_version = hip_version group TorchVersion hip_str_version check_cuda torch torch torch_version TorchVersion torch cuda is_available torch version hip None None torch_cuda_ver = TorchVersion torch version cuda check torch cuda version matches system cuda version cuda_ver = get_cuda_version cuda_ver = torch_cuda_ver raise VerifyDynamoError warnings warn f CUDA version mismatch ` torch ` version torch_cuda_ver env version cuda_ver torch_cuda_ver MIN_CUDA_VERSION raise VerifyDynamoError warnings warn f ` torch ` CUDA version supported torch_cuda_ver f - minimum requirement MIN_CUDA_VERSION cuda_ver MIN_CUDA_VERSION raise VerifyDynamoError warnings warn f env CUDA version supported cuda_ver f - minimum requirement MIN_CUDA_VERSION cuda_ver torch version hip None None check_rocm torch torch torch_version TorchVersion torch cuda is_available torch version hip None None Extracts main ROCm version full string torch_rocm_ver = TorchVersion join list torch version hip split check torch rocm version matches system rocm version rocm_ver = get_rocm_version rocm_ver = torch_rocm_ver warnings warn f ROCm version mismatch ` torch ` version torch_rocm_ver env version rocm_ver torch_rocm_ver MIN_ROCM_VERSION warnings warn f ` torch ` ROCm version supported torch_rocm_ver f - minimum requirement MIN_ROCM_VERSION rocm_ver MIN_ROCM_VERSION warnings warn f env ROCm version supported rocm_ver f - minimum requirement MIN_ROCM_VERSION rocm_ver torch version hip None check_dynamo backend device err_msg - None torch device == cuda torch cuda is_available print f CUDA available -- skipping CUDA check backend backend\n try torch _dynamo dynamo device == cuda torch utils _triton has_triton has_triton print f WARNING CUDA available triton cannot used f Your GPU may supported f Skipping CUDA check backend backend\n dynamo reset dynamo optimize backend nopython=True fn x x + x Module torch nn Module forward x x + x mod = Module opt_mod = dynamo optimize backend nopython=True mod f fn opt_mod x = torch randn device x requires_grad = True y = f x torch testing assert_close y x + x z = y sum z backward torch testing assert_close x grad torch ones_like x except Exception sys stderr write traceback format_exc + \n + err_msg + \n\n sys exit _SANITY_CHECK_ARGS = eager cpu CPU eager sanity check failed eager cuda CUDA eager sanity check failed aot_eager cpu CPU aot_eager sanity check failed aot_eager cuda CUDA aot_eager sanity check failed inductor cpu CPU inductor sanity check failed inductor cuda CUDA inductor sanity check failed\n + NOTE Please check you installed correct hash version ` triton ` main - None python_ver = check_python torch_ver = check_torch cuda_ver = check_cuda rocm_ver = check_rocm print f Python version python_ver major python_ver minor python_ver micro \n f ` torch ` version torch_ver \n f CUDA version cuda_ver \n f ROCM version rocm_ver \n args _SANITY_CHECK_ARGS sys version_info = warnings warn Dynamo yet supported Python Skipping check check_dynamo args print All required checks passed __name__ == __main__ main