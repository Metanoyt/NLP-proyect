mypy allow-untyped-defs typing Optional torch torch Tensor torch distributions constraints torch distributions categorical Categorical torch distributions distribution Distribution torch distributions transformed_distribution TransformedDistribution torch distributions transforms ExpTransform torch distributions utils broadcast_all clamp_probs torch types _size __all__ = ExpRelaxedCategorical RelaxedOneHotCategorical ExpRelaxedCategorical Distribution r Creates ExpRelaxedCategorical parameterized attr ` temperature ` either attr ` probs ` attr ` logits ` both Returns log point simplex Based interface ` OneHotCategorical ` Implementation based See also func ` torch distributions OneHotCategorical ` Args temperature Tensor relaxation temperature probs Tensor event probabilities logits Tensor unnormalized log probability each event The Concrete Distribution A Continuous Relaxation Discrete Random Variables Maddison et al Categorical Reparametrization Gumbel-Softmax Jang et al pyrefly ignore bad-override arg_constraints = probs constraints simplex logits constraints real_vector support = constraints real_vector The true support actually submanifold has_rsample = True __init__ temperature Tensor probs Optional Tensor = None logits Optional Tensor = None validate_args Optional bool = None - None _categorical = Categorical probs logits temperature = temperature batch_shape = _categorical batch_shape event_shape = _categorical param_shape - super __init__ batch_shape event_shape validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance ExpRelaxedCategorical _instance batch_shape = torch Size batch_shape new temperature = temperature new _categorical = _categorical expand batch_shape super ExpRelaxedCategorical new __init__ batch_shape event_shape validate_args=False new _validate_args = _validate_args new _new args kwargs _categorical _new args kwargs property param_shape - torch Size _categorical param_shape property logits - Tensor _categorical logits property probs - Tensor _categorical probs rsample sample_shape _size = torch Size - Tensor shape = _extended_shape sample_shape uniforms = clamp_probs torch rand shape dtype=self logits dtype device=self logits device gumbels = - - uniforms log log scores = logits + gumbels temperature scores - scores logsumexp dim=- keepdim=True log_prob value K = _categorical _num_events _validate_args _validate_sample value logits value = broadcast_all logits value log_scale = torch full_like temperature float K lgamma - temperature log mul - K - score = logits - value mul temperature score = score - score logsumexp dim=- keepdim=True sum - score + log_scale RelaxedOneHotCategorical TransformedDistribution r Creates RelaxedOneHotCategorical distribution parametrized attr ` temperature ` either attr ` probs ` attr ` logits ` This relaxed version ` OneHotCategorical ` distribution so its samples simplex reparametrizable Example xdoctest +IGNORE_WANT non-deterministic m = RelaxedOneHotCategorical torch tensor torch tensor m sample tensor Args temperature Tensor relaxation temperature probs Tensor event probabilities logits Tensor unnormalized log probability each event arg_constraints = probs constraints simplex logits constraints real_vector pyrefly ignore bad-override support = constraints simplex has_rsample = True pyrefly ignore bad-override base_dist ExpRelaxedCategorical __init__ temperature Tensor probs Optional Tensor = None logits Optional Tensor = None validate_args Optional bool = None - None base_dist = ExpRelaxedCategorical temperature probs logits validate_args=validate_args super __init__ base_dist ExpTransform validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance RelaxedOneHotCategorical _instance super expand batch_shape _instance=new property temperature - Tensor base_dist temperature property logits - Tensor base_dist logits property probs - Tensor base_dist probs