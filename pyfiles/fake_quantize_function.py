torch torch Tensor torch ao quantization experimental quantizer dequantize_APoT quantize_APoT fake_quantize_function torch autograd Function staticmethod forward type ignore override ctx torch autograd function FunctionCtx x Tensor alpha Tensor gamma Tensor quantization_levels Tensor level_indices Tensor - Tensor quantized_result = quantize_APoT x alpha gamma quantization_levels level_indices calculate mask tensor mask = x detach apply_ lambda x x = alpha x = -alpha result = dequantize_APoT quantized_result ctx save_for_backward mask result staticmethod backward type ignore override ctx torch autograd function FunctionCtx grad_output Tensor - Tensor mask = ctx saved_tensors type ignore attr-defined grad_output mask