usr bin env python Tool quickly rebuild one two files debug info Mimics following behavior - touch file - ninja -j -v -n torch_python &#124; sed -e s -O -g g -e s#\ - \+\ - \+\ \+## &#124; sh - Copy libs build lib torch lib folder __future__ annotations subprocess sys pathlib Path typing Any PYTORCH_ROOTDIR = Path __file__ resolve parent parent TORCH_DIR = PYTORCH_ROOTDIR torch TORCH_LIB_DIR = TORCH_DIR lib BUILD_DIR = PYTORCH_ROOTDIR build BUILD_LIB_DIR = BUILD_DIR lib check_output args list str cwd str &#124; None = None - str subprocess check_output args cwd=cwd decode utf- parse_args - Any argparse ArgumentParser parser = ArgumentParser description= Incremental build PyTorch debinfo parser add_argument -- verbose action= store_true parser add_argument files nargs= parser parse_args get_lib_extension - str sys platform == linux so sys platform == darwin dylib raise RuntimeError f Unsupported platform sys platform create_symlinks - None Creates symlinks build lib torch lib TORCH_LIB_DIR exists raise RuntimeError f Can t create symlinks TORCH_LIB_DIR does exist BUILD_LIB_DIR exists raise RuntimeError f Can t create symlinks BUILD_LIB_DIR does exist torch_lib TORCH_LIB_DIR glob f get_lib_extension torch_lib is_symlink continue build_lib = BUILD_LIB_DIR torch_lib name build_lib exists raise RuntimeError f Can t find build_lib corresponding torch_lib torch_lib unlink torch_lib symlink_to build_lib has_build_ninja - bool BUILD_DIR build ninja exists is_devel_setup - bool output = check_output sys executable -c torch print torch __file__ output strip == str TORCH_DIR __init__ py create_build_plan - list tuple str str output = check_output ninja -j -v -n torch_python cwd=str BUILD_DIR rc = line output split \n line startswith continue line = line split strip line startswith line endswith line = line - line = line replace -O -g replace -O -g Build Metal shaders debug information xcrun metal line -frecord-sources line line += -frecord-sources -gline-tables-only try name = line split -o split rc append name line except IndexError print f Skipping line does specify output file rc main - None sys platform == win print Not supported Windows yet sys exit - is_devel_setup print Not devel setup PyTorch please run ` python -m pip install -- no-build-isolation -v -e ` first sys exit - has_build_ninja print Only ninja build system supported moment sys exit - args = parse_args file args files file None continue Path file touch build_plan = create_build_plan len build_plan == print Nothing do len build_plan print More than items needs rebuild run ` ninja torch_python ` first sys exit - idx name cmd enumerate build_plan print f idx + len build_plan Building name args verbose print cmd subprocess check_call sh -c cmd cwd=BUILD_DIR create_symlinks __name__ == __main__ main