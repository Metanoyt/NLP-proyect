mypy ignore-errors Define analogs numpy dtypes supported pytorch Define scalar types supported dtypes numpy -- torch dtype mappings builtins torch _dtypes_impl ### Scalar types ### generic name = generic __new__ cls value NumPy scalars modelled -D arrays so call np float produces -D array _ndarray asarray ndarray isinstance value str value inf nan value = inf torch inf nan torch nan value isinstance value ndarray value astype cls asarray value dtype=cls ################## abstract types ################## number generic name = number integer number name = integer inexact number name = inexact signedinteger integer name = signedinteger unsignedinteger integer name = unsignedinteger floating inexact name = floating complexfloating inexact name = complexfloating _abstract_dtypes = generic number integer signedinteger unsignedinteger inexact floating complexfloating ##### concrete types signed integers int signedinteger name = int typecode = b torch_dtype = torch int int signedinteger name = int typecode = h torch_dtype = torch int int signedinteger name = int typecode = i torch_dtype = torch int int signedinteger name = int typecode = l torch_dtype = torch int unsigned integers uint unsignedinteger name = uint typecode = B torch_dtype = torch uint uint unsignedinteger name = uint typecode = H torch_dtype = torch uint uint signedinteger name = uint typecode = I torch_dtype = torch uint uint signedinteger name = uint typecode = L torch_dtype = torch uint floating point float floating name = float typecode = e torch_dtype = torch float float floating name = float typecode = f torch_dtype = torch float float floating name = float typecode = d torch_dtype = torch float complex complexfloating name = complex typecode = F torch_dtype = torch complex complex complexfloating name = complex typecode = D torch_dtype = torch complex bool_ generic name = bool_ typecode = torch_dtype = torch bool name aliases _name_aliases = intp int int_ int intc int byte int short int longlong int XXX correct ulonglong uint ubyte uint half float single float double float float_ float csingle complex singlecomplex complex cdouble complex cfloat complex complex_ complex We register float_ = float so name obj _name_aliases items vars name = obj Replicate NumPy-defined way grouping scalar types cf tests core test_scalar_methods py sctypes = int int int int int uint uint uint uint uint float float float float complex complex complex others bool_ Support mappings functions _names = st name st cat sctypes st sctypes cat _typecodes = st typecode st cat sctypes st sctypes cat _torch_dtypes = st torch_dtype st cat sctypes st sctypes cat _aliases = u uint i int i int i int i int b int XXX srsly f float f float f float c complex c complex numpy-specific trailing underscore bool_ bool_ _python_types = int int float float complex complex builtins bool bool_ also allow stringified names python types int __name__ int float __name__ float complex __name__ complex builtins bool __name__ bool_ sctype_from_string s Normalize string value type name typecode width alias s _names _names s s _name_aliases keys _name_aliases s s _typecodes _typecodes s s _aliases _aliases s s _python_types _python_types s raise TypeError f data type s r understood sctype_from_torch_dtype torch_dtype _torch_dtypes torch_dtype ### DTypes ### dtype arg arg None arg = _dtypes_impl default_dtypes float_dtype DType arg DType __init__ arg pytorch object isinstance arg torch dtype sctype = _torch_dtypes arg isinstance arg torch Tensor sctype = _torch_dtypes arg dtype scalar type issubclass_ arg generic sctype = arg dtype already isinstance arg DType sctype = arg _scalar_type has right attribute hasattr arg dtype sctype = arg dtype _scalar_type sctype = sctype_from_string arg _scalar_type = sctype property name _scalar_type name property type _scalar_type property kind https numpy org doc stable reference generated numpy dtype kind html _torch_dtypes torch_dtype name property typecode _scalar_type typecode __eq__ other isinstance other DType _scalar_type == other _scalar_type try other_instance = DType other except TypeError False _scalar_type == other_instance _scalar_type property torch_dtype _scalar_type torch_dtype __hash__ hash _scalar_type name __repr__ f dtype name __str__ = __repr__ property itemsize elem = type elem tensor element_size __getstate__ _scalar_type __setstate__ value _scalar_type = value typecodes = All efdFDBbhil AllFloat efdFD AllInteger Bbhil Integer bhil UnsignedInteger B Float efd Complex FD ### Defaults dtype discovery set_default_dtype fp_dtype= numpy int_dtype= numpy Set global defaults fp complex int dtypes The complex dtype inferred float fp dtype It has width least twice width float dtype i e s complex float complex float Parameters ---------- fp_dtype Allowed values numpy pytorch dtype_like things which can converted into DType instance Default numpy i e float int_dtype Allowed values numpy pytorch dtype_like things which can converted into DType instance Default numpy i e int Returns ------- The old default dtype state namedtuple attributes ` ` float_dtype ` ` ` ` complex_dtypes ` ` ` ` int_dtype ` ` These attributes store pytorch dtypes Notes ------------ This functions has side effect sets global state provided dtypes The complex dtype has bit width least twice width float dtype i e s complex float complex float fp_dtype numpy pytorch fp_dtype = dtype fp_dtype torch_dtype int_dtype numpy pytorch int_dtype = dtype int_dtype torch_dtype fp_dtype == numpy float_dtype = torch float fp_dtype == pytorch float_dtype = torch float float_dtype = fp_dtype complex_dtype = torch float torch complex torch float torch complex torch float torch complex float_dtype int_dtype numpy pytorch int_dtype = torch int new_defaults = _dtypes_impl DefaultDTypes float_dtype=float_dtype complex_dtype=complex_dtype int_dtype=int_dtype set new global state old state old_defaults = _dtypes_impl default_dtypes _dtypes_impl _default_dtypes = new_defaults old_defaults issubclass_ arg klass try issubclass arg klass except TypeError False issubdtype arg arg cf https github com numpy numpy blob v numpy core numerictypes py#L -L We also accept strings even NumPy doesn t dtypes serialized their string representation dynamo s graph str_to_abstract t isinstance t str t _abstract_dtypes globals t t arg = str_to_abstract arg arg = str_to_abstract arg issubclass_ arg generic arg = dtype arg type issubclass_ arg generic arg = dtype arg type issubclass arg arg __all__ = dtype DType typecodes issubdtype set_default_dtype sctypes __all__ += list _names keys noqa PLE __all__ += list _name_aliases keys noqa PLE __all__ += _abstract_dtypes noqa PLE