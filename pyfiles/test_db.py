Owner s oncall export copy unittest torch _dynamo torchdynamo torch _export config torch _export db case ExportCase SupportLevel torch _export db examples filter_examples_by_support_level get_rewrite_cases torch export export torch testing _internal common_utils instantiate_parametrized_tests IS_WINDOWS parametrize run_tests TestCase unittest skipIf IS_WINDOWS Windows supported test unittest skipIf torchdynamo is_dynamo_supported dynamo doesn t support ExampleTests TestCase TODO Maybe we should make tests actually show up file parametrize name case filter_examples_by_support_level SupportLevel SUPPORTED items name_fn=lambda name case f case_ name test_exportdb_supported name str case ExportCase - None model = case model args_export = case example_args kwargs_export = case example_kwargs args_model = copy deepcopy args_export kwargs_model = copy deepcopy kwargs_export config patch use_new_tracer_experimental=True exported_program = export model case example_args case example_kwargs dynamic_shapes=case dynamic_shapes strict=True exported_program graph_module print_readable assertEqual exported_program module args_export kwargs_export model args_model kwargs_model case extra_args None args = case extra_args args_model = copy deepcopy args assertEqual exported_program module args model args_model parametrize name case filter_examples_by_support_level SupportLevel NOT_SUPPORTED_YET items name_fn=lambda name case f case_ name test_exportdb_not_supported name str case ExportCase - None model = case model pyre-ignore assertRaises torchdynamo exc Unsupported AssertionError RuntimeError config patch use_new_tracer_experimental=True _ = export model case example_args case example_kwargs dynamic_shapes=case dynamic_shapes strict=True exportdb_not_supported_rewrite_cases = name rewrite_case name case filter_examples_by_support_level SupportLevel NOT_SUPPORTED_YET items rewrite_case get_rewrite_cases case exportdb_not_supported_rewrite_cases parametrize name rewrite_case exportdb_not_supported_rewrite_cases name_fn=lambda name case f case_ name _ case name test_exportdb_not_supported_rewrite name str rewrite_case ExportCase - None pyre-ignore export rewrite_case model rewrite_case example_args rewrite_case example_kwargs dynamic_shapes=rewrite_case dynamic_shapes strict=True instantiate_parametrized_tests ExampleTests __name__ == __main__ run_tests