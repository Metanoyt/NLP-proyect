benchmark_helper time_with_torch_timer torch torch _dynamo torch _inductor config inductor_config inductor_config triton mm = triton torch _dynamo optimize inductor nopython=True inductor_mm b torch mm b torch_mm_relu b torch nn functional relu torch mm b torch_mm b torch mm b __name__ == __main__ Real shapes torchbench a_shapes = b_shapes = Artificial larger shapes a_shapes += b_shapes += i range len a_shapes a_shape = a_shapes i b_shape = b_shapes i print Shape a_shape x b_shape = torch randn a_shape device= cuda dtype=torch float b = torch randn b_shape device= cuda dtype=a dtype time_with_torch_timer torch_mm b string_id= torch mm time_with_torch_timer torch_mm_relu b string_id= torch mm + relu time_with_torch_timer inductor_mm b string_id= inductor mm Results obtained AWS AI cluster CPU Intel R Xeon R Platinum CL CPU GHz GPU NVIDIA A -SXM GB memory Shape x torch mm mean ms torch mm + relu mean ms inductor mm mean ms Shape x torch mm mean ms torch mm + relu mean ms inductor mm mean ms Shape x torch mm mean ms torch mm + relu mean ms inductor mm mean ms Shape x torch mm mean ms torch mm + relu mean ms inductor mm mean ms Shape x torch mm mean ms torch mm + relu mean ms inductor mm mean ms Shape x torch mm mean ms torch mm + relu mean ms inductor mm mean ms Shape x torch mm mean ms torch mm + relu mean ms inductor mm mean ms Shape x torch mm mean ms torch mm + relu mean ms inductor mm mean ms Shape x torch mm mean ms torch mm + relu mean ms inductor mm mean ms