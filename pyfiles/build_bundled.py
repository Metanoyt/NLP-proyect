usr bin env python argparse os mydir = os path dirname __file__ licenses = LICENSE LICENSE txt LICENSE rst COPYING BSD collect_license current collected = root dirs files os walk current license = list licenses set files license name = root split - license_file = os path join root license try ident = identify_license license_file except ValueError raise ValueError could identify license file f root None val = Name name Files root License ident License_file license_file name collected Only add license different collected name License == ident collected name Files append root collected name License_file append license_file collected name + f root = val collected name = val collected create_bundled d outstream include_files=False Write information open outstream collected = collect_license d sorted_keys = sorted collected keys outstream write The PyTorch repository source distributions bundle several libraries \n outstream write compatibly licensed We list these here files_to_include = k sorted_keys c = collected k files = \n join c Files license_file = \n join c License_file outstream write \n\n outstream write f Name c Name \n outstream write f License c License \n outstream write f Files files \n outstream write For details see include_files outstream write files concatenated below files_to_include += c License_file outstream write outstream write license_file fname files_to_include outstream write \n\n outstream write fname outstream write \n + - len fname + \n open fname r fid outstream write fid read identify_license f exception= Read f try identify license type This __very__ rough probably legally binding specific repo squeeze t Remove n normalize quotes t = t replace \n replace t = t replace ` ` replace t open f fid txt = fid read exception exception txt license = identify_license f exception license + exception txt = squeeze txt ApacheLicense txt Hmm do we need check text Apache- MITLicense txt Hmm do we need check text MIT BSD- -ClauseLicense txt Hmm do we need check text BSD- -Clause BSD -ClauseLicense txt Hmm do we need check text BSD- -Clause BoostSoftwareLicense-Version txt Hmm do we need check text BSL- gettimeofday txt Used opentelemetry-cpp tools vcpkg ports gettimeofday Apache- libhungarian txt Used opentelemetry-cpp tools vcpkg ports hungarian Permissive free use PDCurses txt Used opentelemetry-cpp tools vcpkg ports pdcurses Public Domain core Copyright UniversityofNorthCarolina txt Used opentelemetry-cpp tools vcpkg ports pqp Apache- sigslot txt Used opentelemetry-cpp tools vcpkg ports sigslot Public Domain squeeze Clarified Artistic License txt Clarified Artistic License all squeeze m txt lower m bsd _txt BSD- -Clause all squeeze m txt lower m bsd _v _txt BSD- -Clause all squeeze m txt lower m bsd _txt BSD- -Clause all squeeze m txt lower m bsd _src_txt BSD-Source-Code any squeeze m txt lower m mit_txt MIT raise ValueError unknown license mit_txt = permission hereby granted free charge any person obtaining copy software associated documentation files software deal software without restriction including without limitation rights use copy modify merge publish distribute sublicense sell copies software permit persons whom software furnished do so subject following conditions above copyright notice permission notice shall included all copies substantial portions software software provided without warranty any kind express implied including limited warranties merchantability fitness particular purpose noninfringement no event shall authors copyright holders liable any claim damages other liability whether action contract tort otherwise arising out connection software use other dealings software bsd _txt = redistribution use source binary forms without modification permitted provided following conditions met redistributions source code redistributions binary form neither name software provided copyright holders contributors any express implied warranties including limited implied warranties merchantability fitness particular purpose disclaimed BSD BSD without neither name clause bsd _txt = bsd _txt + bsd _txt This BSD variant leaves contributors out last clause BSD- which still valid BSD- v = bsd _txt replace contributors bsd _v _txt = bsd _txt + v This source variant BSD- leaves redistributions binary form out which https spdx org licenses BSD-Source-Code html bsd _src_txt = bsd _txt + bsd _txt __name__ == __main__ third_party = os path relpath mydir parser = argparse ArgumentParser description= Generate bundled licenses file parser add_argument -- out-file type=str default=os environ get PYTORCH_THIRD_PARTY_BUNDLED_LICENSE_FILE str os path join third_party LICENSES_BUNDLED txt help= location output new bundled licenses file parser add_argument -- include-files action= store_true default=False help= include actual license terms output args = parser parse_args fname = args out_file print f + Writing bundled licenses args out_file open fname w fid create_bundled third_party fid args include_files