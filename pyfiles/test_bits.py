Owner s oncall quantization torch torch testing _internal common_device_type instantiate_device_type_tests torch testing _internal common_utils run_tests TestCase skipIfRocm torch utils _mode_utils no_dispatch torch utils _pytree tree_map itertools Int Tensor torch Tensor __new__ cls elem assert elem dtype == torch bits torch Tensor _make_subclass cls elem elem requires_grad __init__ elem super __init__ classmethod __torch_dispatch__ cls func types args= kwargs=None unwrap t isinstance t torch Tensor no_dispatch t view torch int t args = tree_map unwrap args kwargs = tree_map unwrap kwargs no_dispatch out = func args kwargs wrap t isinstance t torch Tensor no_dispatch t view torch bits t out = tree_map wrap out out This most likely should removed thus use disabled impl test below fail under Dynamo case classmethod __torch_function__ cls func types args= kwargs=None super __torch_function__ func types args kwargs __repr__ - str no_dispatch view torch int f TensorSubclassDemo view torch int TestBits TestCase skipIfRocm test_types device bits_types = torch bits x torch bits x torch bits x torch bits torch bits bits_type bits_types _ = torch zeros dtype=torch int device=device view bits_type _ = torch empty dtype=bits_type device=device x = torch randint dtype=torch int device=device view bits_type y = x t contiguous view_type = torch int x element_size == torch int assertEqual x t view view_type y view view_type y = x t clone assertEqual x t view view_type y view view_type test_cat device bits_types = torch bits x torch bits x torch bits x torch bits torch bits bits_type bits_types view_type = torch int bits_type itemsize == torch int x_int = torch randint dtype=view_type device=device x = x_int view bits_type y_int = torch randint dtype=view_type device=device y = y_int view bits_type dim transpose itertools product range x_int ndim True False y_ref = y_int t transpose y_int y_b = y t transpose y z_ref = torch cat x_int y_ref dim=dim z = torch cat x y_b dim=dim assertEqual z_ref z view view_type test_subclass t = torch zeros dtype=torch int view torch bits s = Int Tensor t s = s + - assertTrue torch allclose s torch zeros dtype=torch bits instantiate_device_type_tests TestBits globals __name__ == __main__ run_tests