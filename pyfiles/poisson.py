mypy allow-untyped-defs typing Optional Union torch torch Tensor torch distributions constraints torch distributions exp_family ExponentialFamily torch distributions utils broadcast_all torch types _Number Number __all__ = Poisson Poisson ExponentialFamily r Creates Poisson distribution parameterized attr ` rate ` rate parameter Samples nonnegative integers pmf given math \mathrm rate ^k \frac e^ -\mathrm rate k Example xdoctest +SKIP poisson_cpu implemented Long m = Poisson torch tensor m sample tensor Args rate Number Tensor rate parameter pyrefly ignore bad-override arg_constraints = rate constraints nonnegative support = constraints nonnegative_integer property mean - Tensor rate property mode - Tensor rate floor property variance - Tensor rate __init__ rate Union Tensor Number validate_args Optional bool = None - None rate = broadcast_all rate isinstance rate _Number batch_shape = torch Size batch_shape = rate size super __init__ batch_shape validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance Poisson _instance batch_shape = torch Size batch_shape new rate = rate expand batch_shape super Poisson new __init__ batch_shape validate_args=False new _validate_args = _validate_args new sample sample_shape=torch Size shape = _extended_shape sample_shape torch no_grad torch poisson rate expand shape log_prob value _validate_args _validate_sample value rate value = broadcast_all rate value value xlogy rate - rate - value + lgamma property _natural_params - tuple Tensor torch log rate pyrefly ignore bad-override _log_normalizer x torch exp x