functools logging shutil typing Optional torch torch _inductor utils clear_on_fresh_cache config log = logging getLogger __name__ clear_on_fresh_cache functools lru_cache get_cuda_arch - Optional str try cuda_arch = config cuda arch cuda_arch None Get Compute Capability first Visible device major minor = torch cuda get_device_capability str major + minor str cuda_arch except Exception log exception Error getting cuda arch None clear_on_fresh_cache functools lru_cache is_datacenter_blackwell_arch - bool arch = get_cuda_arch arch None False arch_number = int arch arch_number = arch_number clear_on_fresh_cache functools lru_cache get_cuda_version - Optional str try cuda_version = config cuda version cuda_version None cuda_version = torch version cuda cuda_version except Exception log exception Error getting cuda version None functools cache nvcc_exist nvcc_path Optional str = nvcc - bool nvcc_path None shutil which nvcc_path None