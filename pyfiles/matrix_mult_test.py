operator_benchmark op_bench torch Microbenchmarks batch matrix mult einsum torch bmm batch_mm_configs_short = op_bench config_list attr_names= B M N K attrs= cross_product_configs= device cpu cuda tags= short batch_mm_configs_long = op_bench config_list attr_names= B M N K attrs= cross_product_configs= device cpu cuda tags= long batch_mm_op_list = op_bench op_list attr_names= op_name op_func attrs= einsum_bmm torch einsum bmm torch bmm BatchMatrixMultBenchmark op_bench TorchBenchmarkBase init B M N K device op_func inputs = input_one torch rand B M N device=device input_two torch rand B N K device=device op_func = op_func forward input_one input_two op_func __name__ == einsum torch einsum bij bjk- bik input_one input_two torch bmm input_one input_two Microbenchmarks element-wise matrix mult einsum torch mul batch_elementwise_configs_short = op_bench config_list attr_names= B M N attrs= cross_product_configs= device cpu cuda tags= short batch_elementwise_configs_long = op_bench cross_product_configs B= M= N= device= cpu cuda tags= long batch_elementwise_op_list = op_bench op_list attr_names= op_name op_func attrs= einsum_elementwise torch einsum mul torch mul BatchElementWiseBenchmark op_bench TorchBenchmarkBase init B M N device op_func inputs = input_one torch rand B M N device=device input_two torch rand B M N device=device op_func = op_func forward input_one input_two op_func __name__ == einsum torch einsum bij bij- bij input_one input_two torch mul input_one input_two op_bench generate_pt_tests_from_op_list batch_mm_op_list batch_mm_configs_short + batch_mm_configs_long BatchMatrixMultBenchmark op_bench generate_pt_tests_from_op_list batch_elementwise_op_list batch_elementwise_configs_short + batch_elementwise_configs_long BatchElementWiseBenchmark __name__ == __main__ op_bench benchmark_runner main