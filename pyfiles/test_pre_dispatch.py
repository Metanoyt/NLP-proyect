Owner s module dynamo torch torch _dynamo torch _dynamo test_case PreDispatchTests torch _dynamo test_case TestCase test_no_grad_simple f b = sin torch no_grad c = b cos b c sin f_compiled = torch compile f backend= pre_dispatch_eager a_ref = torch randn requires_grad=True a_test = a_ref detach clone requires_grad_ True out_ref = f a_ref out_test = f_compiled a_test assertEqual out_ref out_test out_ref sum backward out_test sum backward assertEqual a_ref grad a_test grad test_enable_grad_and_no_grad f b = torch no_grad c = b torch enable_grad d = c e = d b + c + d + e f_compiled = torch compile f backend= pre_dispatch_eager a_ref = torch randn requires_grad=True a_test = a_ref detach clone requires_grad_ True out_ref = f a_ref out_test = f_compiled a_test assertEqual out_ref out_test out_ref sum backward out_test sum backward assertEqual a_ref grad a_test grad test_autocast_simple f b = torch amp autocast device_type= cpu c = torch matmul b b b + c f_compiled = torch compile f backend= pre_dispatch_eager a_ref = torch randn device= cpu requires_grad=True a_test = a_ref detach clone requires_grad_ True out_ref = f a_ref out_test = f_compiled a_test assertEqual out_ref out_test out_ref sum backward out_test sum backward assertEqual a_ref grad a_test grad __name__ == __main__ torch _dynamo test_case run_tests run_tests