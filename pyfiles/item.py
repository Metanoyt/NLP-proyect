Item operator implementation typing Optional torchfuzz operators base Operator torchfuzz tensor_fuzzer ScalarSpec Spec TensorSpec ItemOperator Operator Operator converting -d tensor scalar __init__ super __init__ item property torch_op_name - Optional str Item tensor method direct torch operation None can_produce output_spec Spec - bool Item produces scalars -d tensors isinstance output_spec ScalarSpec fuzz_inputs_specs output_spec Spec num_inputs int = - list Spec Decompose scalar into single-element tensor item operation isinstance output_spec ScalarSpec raise ValueError ItemOperator can only produce ScalarSpec outputs Create tensor spec can produce scalar via item Use -D tensor scalar tensor ensure item works reliably tensor_spec = TensorSpec size= stride= dtype=output_spec dtype tensor_spec codegen output_name str input_names list str output_spec Spec - str Generate code item operation len input_names = raise ValueError ItemOperator requires exactly one input f output_name = input_names item