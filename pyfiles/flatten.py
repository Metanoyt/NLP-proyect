mypy allow-untyped-defs typing Union torch Tensor torch types _size module Module __all__ = Flatten Unflatten Flatten Module r Flattens contiguous range dims into tensor For use ` ~nn Sequential ` see meth ` torch flatten ` details Shape - Input math ` S_ \text start S_ i S_ \text end ` where math ` S_ i ` size dimension math ` i ` math ` ` means any number dimensions including none - Output math ` \prod_ i=\text start ^ \text end S_ i ` Args start_dim first dim flatten default = end_dim last dim flatten default = - Examples input = torch randn With default parameters m = nn Flatten output = m input output size torch Size With non-default parameters m = nn Flatten output = m input output size torch Size __constants__ = start_dim end_dim start_dim int end_dim int __init__ start_dim int = end_dim int = - - None super __init__ start_dim = start_dim end_dim = end_dim forward input Tensor - Tensor Runs forward pass input flatten start_dim end_dim extra_repr - str Returns extra representation module f start_dim= start_dim end_dim= end_dim Unflatten Module r Unflattens tensor dim expanding desired shape For use ` ~nn Sequential ` attr ` dim ` specifies dimension input tensor unflattened can either ` int ` ` str ` when ` Tensor ` ` NamedTensor ` used respectively attr ` unflattened_size ` new shape unflattened dimension tensor can ` tuple ` ints ` list ` ints ` torch Size ` ` Tensor ` input ` NamedShape ` tuple ` name size ` tuples ` NamedTensor ` input Shape - Input math ` S_ \text dim ` where math ` S_ \text dim ` size dimension attr ` dim ` math ` ` means any number dimensions including none - Output math ` U_ U_n ` where math ` U ` = attr ` unflattened_size ` math ` \prod_ i= ^n U_i = S_ \text dim ` Args dim Union int str Dimension unflattened unflattened_size Union torch Size Tuple List NamedShape New shape unflattened dimension Examples input = torch randn With tuple ints m = nn Sequential nn Linear nn Unflatten output = m input output size torch Size With torch Size m = nn Sequential nn Linear nn Unflatten torch Size output = m input output size torch Size With namedshape tuple tuples input = torch randn names= N features unflatten = nn Unflatten features C H W output = unflatten input output size torch Size NamedShape = tuple tuple str int __constants__ = dim unflattened_size dim Union int str unflattened_size Union _size NamedShape __init__ dim Union int str unflattened_size Union _size NamedShape - None super __init__ isinstance dim int _require_tuple_int unflattened_size isinstance dim str _require_tuple_tuple unflattened_size raise TypeError invalid argument type dim parameter dim = dim unflattened_size = unflattened_size _require_tuple_tuple input - None isinstance input tuple idx elem enumerate input isinstance elem tuple raise TypeError unflattened_size must tuple tuples + f found element type type elem __name__ pos idx raise TypeError unflattened_size must tuple tuples + f found type type input __name__ _require_tuple_int input - None isinstance input tuple list idx elem enumerate input isinstance elem int raise TypeError unflattened_size must tuple ints + f found element type type elem __name__ pos idx raise TypeError f unflattened_size must tuple ints found type type input __name__ forward input Tensor - Tensor Runs forward pass input unflatten dim unflattened_size extra_repr - str Returns extra representation module f dim= dim unflattened_size= unflattened_size