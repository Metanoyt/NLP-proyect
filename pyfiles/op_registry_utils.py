mypy allow-untyped-defs functools inspect signature common_op_utils _basic_validation Common utilities register ops ShardedTensor PartialTensor _register_op op func op_table Performs basic validation registers provided op given op_table len signature func parameters = raise TypeError f Custom sharded op function expects signature f types args kwargs process_group received f signature signature func op_table op = func _decorator_func wrapped_func op op_table Decorator function register given ` ` op ` ` provided ` ` op_table ` ` functools wraps wrapped_func wrapper types args kwargs process_group _basic_validation op args kwargs wrapped_func types args kwargs process_group _register_op op wrapper op_table wrapper