Owner s module inductor ctypes torch torch _inductor async_compile AsyncCompile torch _inductor codecache CUDACodeCache torch _inductor codegen cuda cuda_env nvcc_exist torch _inductor exc CUDACompileError torch _inductor test_case TestCase InductorTestCase torch _inductor utils fresh_cache torch testing _internal triton_utils requires_cuda_and_triton _SOURCE_CODE = r #include stdio h __global__ void saxpy_device int n float float x float y int i = blockIdx x blockDim x + threadIdx x i n y i = x i + y i extern C __attribute__ __visibility__ default int saxpy int n float float x float y Perform SAXPY saxpy_device n+ n x y TestCUDACodeCache InductorTestCase requires_cuda_and_triton test_cuda_load fresh_cache Test both o so compilation object_file_path object_hash_key source_code_path = CUDACodeCache compile _SOURCE_CODE o dll_wrapper so_hash_key source_code_path = CUDACodeCache load _SOURCE_CODE so assertEqual source_code_path source_code_path assertEqual object_hash_key so_hash_key Test load call functions so x = torch rand float cuda y = torch rand float cuda = expected_y = x + y dll_wrapper saxpy ctypes c_int ctypes c_float ctypes c_void_p x data_ptr ctypes c_void_p y data_ptr torch testing assert_close y expected_y requires_cuda_and_triton test_compilation_error fresh_cache error_source_code = _SOURCE_CODE replace saxpy_device saxpy_wrong assertRaises CUDACompileError CUDACodeCache compile error_source_code o requires_cuda_and_triton test_async_compile fresh_cache async_compile = AsyncCompile compiled_res = async_compile cuda _SOURCE_CODE so async_compile wait globals Test load call functions so x = torch rand float cuda y = torch rand float cuda = expected_y = x + y compiled_res result saxpy ctypes c_int ctypes c_float ctypes c_void_p x data_ptr ctypes c_void_p y data_ptr torch testing assert_close y expected_y __name__ == __main__ torch _inductor test_case run_tests nvcc_exist run_tests cuda