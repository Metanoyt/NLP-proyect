operator_benchmark op_bench torch torch nn nn Microbenchmarks softmax operators Configs softmax ops softmax_configs_short = op_bench config_list attr_names= N C H W attrs= cross_product_configs= device cpu cuda tags= short softmax_configs_long = op_bench cross_product_configs N= C= H= W= device= cpu cuda tags= long softmax_ops_list = op_bench op_list attr_names= op_name op_func attrs= Softmax nn Softmax Softmax d nn Softmax d LogSoftmax nn LogSoftmax softmax_two_dims_ops_list = op_bench op_list attr_names= op_name op_func attrs= Softmax nn Softmax LogSoftmax nn LogSoftmax softmax_two_dims_configs = op_bench config_list attr_names= M N dim attrs= cross_product_configs= device cpu cuda tags= long SoftmaxBenchmark op_bench TorchBenchmarkBase init N C H W device op_func inputs = input torch rand N C H W device=device op_func = op_func forward input op_func input Softmax DimsBenchmark op_bench TorchBenchmarkBase init M N dim device op_func inputs = input torch rand M N device=device op_func = op_func dim=dim forward input op_func input op_bench generate_pt_tests_from_op_list softmax_ops_list softmax_configs_short + softmax_configs_long SoftmaxBenchmark op_bench generate_pt_tests_from_op_list softmax_two_dims_ops_list softmax_two_dims_configs Softmax DimsBenchmark __name__ == __main__ op_bench benchmark_runner main