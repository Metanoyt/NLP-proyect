typing Any torch The _get_device_index has been moved torch utils _get_device_index torch _utils _get_device_index _torch_get_device_index _get_device_index device Any optional bool = False allow_cpu bool = False - int r Get device index attr ` device ` which can torch device object Python integer ` ` None ` ` If attr ` device ` torch device object returns device index XPU device Note XPU device without specified index i e ` ` torch device xpu ` ` will current default XPU device attr ` optional ` ` ` True ` ` If attr ` allow_cpu ` ` ` True ` ` CPU devices will accepted ` ` - ` ` will returned case If attr ` device ` Python integer returned If attr ` device ` ` ` None ` ` will current default XPU device attr ` optional ` ` ` True ` ` isinstance device int device isinstance device str device = torch device device isinstance device torch device allow_cpu device type xpu cpu raise ValueError f Expected xpu cpu device got device device type = xpu raise ValueError f Expected xpu device got device torch jit is_scripting isinstance device torch xpu device device idx _torch_get_device_index device optional allow_cpu