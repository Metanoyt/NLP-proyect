Owner s module dynamo unittest mock torch torch _dynamo torch _dynamo test_case torch _inductor utils pass_execution_and_save FxPassesPreGradTests torch _dynamo test_case TestCase mock patch torch _inductor utils ShapeProp propagate test_pass_execution_and_save mock_shape_prop TestModule torch nn Module __init__ - None super __init__ param = torch nn Parameter torch ones forward x torch Tensor - torch Tensor param + x fx_pass graph torch fx GraphModule - None sample_input = torch randn m = TestModule m sample_input exported_program = torch export export m sample_input strict=True gm = exported_program graph_module pass_execution_and_save fx_pass gm sample_input Apply testing pass mock_shape_prop assert_called_once __name__ == __main__ torch _dynamo test_case run_tests run_tests