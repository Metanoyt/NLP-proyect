mypy allow-untyped-defs core type ignore attr-defined _reify core_reify _unify core_unify reify unify dispatch dispatch __all__ = unifiable reify_object unify_object unifiable cls Register standard unify reify operations This uses type __dict__ __slots__ attributes define nature term See Also xdoctest +SKIP A object __init__ b = b = b unifiable A unification more A x = var x = A b = A x unify b ~x core_unify add cls cls dict unify_object type ignore attr-defined core_reify add cls dict reify_object type ignore attr-defined cls ######### Reify ######### reify_object o s Reify Python object substitution xdoctest +SKIP Foo object __init__ b = b = b __str__ Foo s s str str b x = var x f = Foo x print f Foo ~x print reify_object f x Foo hasattr o __slots__ _reify_object_slots o s _reify_object_dict o s _reify_object_dict o s obj = object __new__ type o d = reify o __dict__ s d == o __dict__ o obj __dict__ update d obj _reify_object_slots o s attrs = getattr o attr attr o __slots__ new_attrs = reify attrs s attrs == new_attrs o newobj = object __new__ type o slot attr zip o __slots__ new_attrs setattr newobj slot attr newobj dispatch slice dict _reify o s Reify Python ` ` slice ` ` object pyrefly ignore not-iterable slice reify o start o stop o step s ######### Unify ######### unify_object u v s Unify two Python objects Unifies their type ` ` __dict__ ` ` attributes xdoctest +SKIP Foo object __init__ b = b = b __str__ Foo s s str str b x = var x f = Foo x g = Foo unify_object f g ~x type u type v False hasattr u __slots__ unify getattr u slot slot u __slots__ getattr v slot slot v __slots__ s unify u __dict__ v __dict__ s dispatch slice slice dict _unify u v s Unify Python ` ` slice ` ` object unify u start u stop u step v start v stop v step s