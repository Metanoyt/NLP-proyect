functools collections abc Callable typing Concatenate TypeVar typing_extensions ParamSpec _P = ParamSpec _P _T = TypeVar _T _C = TypeVar _C Sentinel used indicate cache lookup failed _cache_sentinel = object cache_method f Callable Concatenate _C _P _T - Callable Concatenate _C _P _T Like ` functools cache ` methods ` functools cache ` similarly ` functools lru_cache ` shouldn t used methods because caches ` ` keeping alive forever ` cache_method ` ignores ` ` so won t keep ` ` alive assuming no cycles ` ` parameters Footgun warning This decorator completely ignores s properties so only use when you know frozen won t change meaningful way such wrapped function being pure cache_name = _cache_method_ + f __name__ functools wraps f wrap _C args _P args kwargs _P kwargs - _T kwargs raise AssertionError cache_method does accept keyword arguments cache = getattr cache_name None cache = setattr cache_name cache pyrefly ignore unbound-name cached_value = cache get args _cache_sentinel cached_value _cache_sentinel cached_value value = f args kwargs pyrefly ignore unbound-name cache args = value value wrap