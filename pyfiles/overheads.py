time timeit numpy np torch add x x + bench name fn requires_grad torch _dynamo reset x = torch randn requires_grad=requires_grad start = time perf_counter _ range fn x end = time perf_counter results = timeit repeat lambda fn x number= repeat= print f name np median results f us warmup= end - start f s main print requires_grad=False bench eager add False bench compiled torch compile add False print print requires_grad=True bench eager add True bench compiled torch compile add True print print inference_mode torch inference_mode bench eager add False bench compiled torch compile add False __name__ == __main__ main