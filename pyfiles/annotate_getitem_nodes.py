operator torch annotate_getitem_nodes graph torch fx Graph - None Annotate type getitem nodes inferred type sequence node If sequence node annotated type do nothing Currently support getitem nodes tuple list NamedTuple sequence node This helpful since annotations local names within function lost during FX transforms Adding back known type annotation getitem nodes improve jit scriptability Args graph Graph The graph annotated node graph nodes node target operator getitem sequence_node index_node = node args sequence_node type continue container types hasattr sequence_node type _name parameterized_types = sequence_node type __args__ sequence_node type _name == Tuple len parameterized_types == isinstance parameterized_types type node type = parameterized_types assert len parameterized_types index_node node_type = parameterized_types index_node node type = node_type sequence_node type _name == List assert len parameterized_types == node type = parameterized_types Generic Alias Type hasattr sequence_node type __origin__ parameterized_types = sequence_node type __args__ sequence_node type __origin__ tuple len parameterized_types == isinstance parameterized_types type node type = parameterized_types assert len parameterized_types index_node node_type = parameterized_types index_node node type = node_type sequence_node type __origin__ list assert len parameterized_types == node type = parameterized_types NamedTuple type hasattr sequence_node type __annotations__ sequence_node type == torch Tensor continue sequence_node_field_types = sequence_node type __annotations__ field_name = sequence_node type _fields index_node node type = sequence_node_field_types field_name