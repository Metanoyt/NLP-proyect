mypy ignore-errors Owner s oncall distributed torch torch nn nn UnitModule nn Module __init__ device torch device super __init__ l = nn Linear device=device seq = nn Sequential nn ReLU nn Linear device=device nn ReLU l = nn Linear device=device forward x l seq l x CompositeModel nn Module __init__ device torch device super __init__ l = nn Linear device=device u = UnitModule device u = UnitModule device l = nn Linear device=device forward x l u u l x UnitParamModule nn Module __init__ device torch device super __init__ l = nn Linear device=device seq = nn Sequential nn ReLU nn Linear device=device nn ReLU p = nn Parameter torch randn device=device forward x torch mm seq l x p CompositeParamModel nn Module __init__ device torch device super __init__ l = nn Linear device=device u = UnitModule device u = UnitModule device p = nn Parameter torch randn device=device register_buffer buffer torch randn device=device persistent=True forward x = u u l x b = p torch mm b FakeSequential nn Module Define achieve desired nested wrapping using module wrap policy ` nn Sequential ` __init__ modules tuple nn Module - None super __init__ _module_sequence = list modules forward x torch Tensor - torch Tensor module _module_sequence x = module x x NestedSequentialModel nn Module __init__ device torch device - None super __init__ This nested structure exercises traversal order catch differences between valid traversals e g BFS DFS variations seq = nn Sequential nn Linear device=device FakeSequential nn Linear device=device nn ReLU FakeSequential nn Linear device=device nn ReLU nn Linear device=device lin = nn Linear device=device seq = nn Sequential nn ReLU nn Linear device=device FakeSequential nn Linear bias=False device=device nn Linear bias=False device=device FIXME rec forward method s local function inside __init__ never used It should probabkly outdented four spaces removed forward x torch Tensor - torch Tensor seq lin seq x