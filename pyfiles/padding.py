mypy allow-untyped-defs collections abc Sequence torch nn functional F torch Tensor torch nn common_types _size_ _t _size_ _t _size_ _t module Module utils _ntuple _pair _quadruple TODO grad_output size asserts THNN __all__ = CircularPad d CircularPad d CircularPad d ConstantPad d ConstantPad d ConstantPad d ReflectionPad d ReflectionPad d ReflectionPad d ReplicationPad d ReplicationPad d ReplicationPad d ZeroPad d ZeroPad d ZeroPad d _CircularPadNd Module __constants__ = padding padding Sequence int _check_input_dim input raise NotImplementedError forward input Tensor - Tensor _check_input_dim input F pad input padding circular extra_repr - str f padding CircularPad d _CircularPadNd r Pads input tensor using circular padding input boundary Tensor values beginning dimension used pad end values end used pad beginning If negative padding applied then ends tensor get removed For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding all boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` Note padding size should less than equal corresponding input dimension Shape - Input math ` C W_ ` math ` N C W_ ` - Output math ` C W_ out ` math ` N C W_ out ` where math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples xdoctest +IGNORE_WANT sure why xdoctest choking m = nn CircularPad d input = torch arange dtype=torch float reshape input tensor m input tensor using different paddings different sides m = nn CircularPad d m input tensor pyrefly ignore bad-override padding tuple int int __init__ padding _size_ _t - None super __init__ padding = _pair padding _check_input_dim input - None input dim = input dim = raise ValueError f expected D D input got input dim D input CircularPad d _CircularPadNd r Pads input tensor using circular padding input boundary Tensor values beginning dimension used pad end values end used pad beginning If negative padding applied then ends tensor get removed For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding all boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` math ` \text padding\_top ` math ` \text padding\_bottom ` Note padding size should less than equal corresponding input dimension Shape - Input math ` N C H_ W_ ` math ` C H_ W_ ` - Output math ` N C H_ out W_ out ` math ` C H_ out W_ out ` where math ` H_ out = H_ + \text padding\_top + \text padding\_bottom ` math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples m = nn CircularPad d input = torch arange dtype=torch float reshape input tensor m input tensor using different paddings different sides m = nn CircularPad d m input tensor pyrefly ignore bad-override padding tuple int int int int __init__ padding _size_ _t - None super __init__ padding = _quadruple padding _check_input_dim input - None input dim = input dim = raise ValueError f expected D D input got input dim D input CircularPad d _CircularPadNd r Pads input tensor using circular padding input boundary Tensor values beginning dimension used pad end values end used pad beginning If negative padding applied then ends tensor get removed For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding all boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` math ` \text padding\_top ` math ` \text padding\_bottom ` math ` \text padding\_front ` math ` \text padding\_back ` Note padding size should less than equal corresponding input dimension Shape - Input math ` N C D_ H_ W_ ` math ` C D_ H_ W_ ` - Output math ` N C D_ out H_ out W_ out ` math ` C D_ out H_ out W_ out ` where math ` D_ out = D_ + \text padding\_front + \text padding\_back ` math ` H_ out = H_ + \text padding\_top + \text padding\_bottom ` math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples xdoctest +IGNORE_WANT non-deterministic m = nn CircularPad d input = torch randn output = m input using different paddings different sides m = nn CircularPad d output = m input pyrefly ignore bad-override padding tuple int int int int int int __init__ padding _size_ _t - None super __init__ padding = _ntuple padding _check_input_dim input - None input dim = input dim = raise ValueError f expected D D input got input dim D input _ConstantPadNd Module __constants__ = padding value value float padding Sequence int __init__ value float - None super __init__ value = value forward input Tensor - Tensor F pad input padding constant value extra_repr - str f padding= padding value= value ConstantPad d _ConstantPadNd r Pads input tensor boundaries constant value For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding both boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` Shape - Input math ` C W_ ` math ` N C W_ ` - Output math ` C W_ out ` math ` N C W_ out ` where math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples xdoctest +IGNORE_WANT non-deterministic m = nn ConstantPad d input = torch randn input tensor - - - - - m input tensor - - - - - m = nn ConstantPad d input = torch randn input tensor - - - m input tensor - - - using different paddings different sides m = nn ConstantPad d m input tensor - - - pyrefly ignore bad-override padding tuple int int __init__ padding _size_ _t value float - None super __init__ value padding = _pair padding ConstantPad d _ConstantPadNd r Pads input tensor boundaries constant value For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding all boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` math ` \text padding\_top ` math ` \text padding\_bottom ` Shape - Input math ` N C H_ W_ ` math ` C H_ W_ ` - Output math ` N C H_ out W_ out ` math ` C H_ out W_ out ` where math ` H_ out = H_ + \text padding\_top + \text padding\_bottom ` math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples xdoctest +IGNORE_WANT non-deterministic m = nn ConstantPad d input = torch randn input tensor - - m input tensor - - using different paddings different sides m = nn ConstantPad d m input tensor - - __constants__ = padding value pyrefly ignore bad-override padding tuple int int int int __init__ padding _size_ _t value float - None super __init__ value padding = _quadruple padding ConstantPad d _ConstantPadNd r Pads input tensor boundaries constant value For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding all boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` math ` \text padding\_top ` math ` \text padding\_bottom ` math ` \text padding\_front ` math ` \text padding\_back ` Shape - Input math ` N C D_ H_ W_ ` math ` C D_ H_ W_ ` - Output math ` N C D_ out H_ out W_ out ` math ` C D_ out H_ out W_ out ` where math ` D_ out = D_ + \text padding\_front + \text padding\_back ` math ` H_ out = H_ + \text padding\_top + \text padding\_bottom ` math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples m = nn ConstantPad d input = torch randn output = m input using different paddings different sides m = nn ConstantPad d output = m input pyrefly ignore bad-override padding tuple int int int int int int __init__ padding _size_ _t value float - None super __init__ value padding = _ntuple padding _ReflectionPadNd Module __constants__ = padding padding Sequence int forward input Tensor - Tensor F pad input padding reflect extra_repr - str f padding ReflectionPad d _ReflectionPadNd r Pads input tensor using reflection input boundary For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding all boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` Note padding size should less than corresponding input dimension Shape - Input math ` C W_ ` math ` N C W_ ` - Output math ` C W_ out ` math ` N C W_ out ` where math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples m = nn ReflectionPad d xdoctest +IGNORE_WANT other tests seem modify printing styles input = torch arange dtype=torch float reshape input tensor m input tensor using different paddings different sides m = nn ReflectionPad d m input tensor pyrefly ignore bad-override padding tuple int int __init__ padding _size_ _t - None super __init__ padding = _pair padding ReflectionPad d _ReflectionPadNd r Pads input tensor using reflection input boundary For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding all boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` math ` \text padding\_top ` math ` \text padding\_bottom ` Note padding size should less than corresponding input dimension Shape - Input math ` N C H_ W_ ` math ` C H_ W_ ` - Output math ` N C H_ out W_ out ` math ` C H_ out W_ out ` where math ` H_ out = H_ + \text padding\_top + \text padding\_bottom ` math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples xdoctest +IGNORE_WANT sure why xdoctest choking m = nn ReflectionPad d input = torch arange dtype=torch float reshape input tensor m input tensor using different paddings different sides m = nn ReflectionPad d m input tensor pyrefly ignore bad-override padding tuple int int int int __init__ padding _size_ _t - None super __init__ padding = _quadruple padding ReflectionPad d _ReflectionPadNd r Pads input tensor using reflection input boundary For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding all boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` math ` \text padding\_top ` math ` \text padding\_bottom ` math ` \text padding\_front ` math ` \text padding\_back ` Note padding size should less than corresponding input dimension Shape - Input math ` N C D_ H_ W_ ` math ` C D_ H_ W_ ` - Output math ` N C D_ out H_ out W_ out ` math ` C D_ out H_ out W_ out ` where math ` D_ out = D_ + \text padding\_front + \text padding\_back ` math ` H_ out = H_ + \text padding\_top + \text padding\_bottom ` math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples xdoctest +IGNORE_WANT sure why xdoctest choking m = nn ReflectionPad d input = torch arange dtype=torch float reshape m input tensor pyrefly ignore bad-override padding tuple int int int int int int __init__ padding _size_ _t - None super __init__ padding = _ntuple padding _ReplicationPadNd Module __constants__ = padding padding Sequence int forward input Tensor - Tensor F pad input padding replicate extra_repr - str f padding ReplicationPad d _ReplicationPadNd r Pads input tensor using replication input boundary For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding all boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` Note output dimensions must remain positive Shape - Input math ` C W_ ` math ` N C W_ ` - Output math ` C W_ out ` math ` N C W_ out ` where math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples xdoctest +IGNORE_WANT sure why xdoctest choking m = nn ReplicationPad d input = torch arange dtype=torch float reshape input tensor m input tensor using different paddings different sides m = nn ReplicationPad d m input tensor pyrefly ignore bad-override padding tuple int int __init__ padding _size_ _t - None super __init__ padding = _pair padding ReplicationPad d _ReplicationPadNd r Pads input tensor using replication input boundary For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding all boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` math ` \text padding\_top ` math ` \text padding\_bottom ` Note output dimensions must remain positive Shape - Input math ` N C H_ W_ ` math ` C H_ W_ ` - Output math ` N C H_ out W_ out ` math ` C H_ out W_ out ` where math ` H_ out = H_ + \text padding\_top + \text padding\_bottom ` math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples m = nn ReplicationPad d xdoctest +IGNORE_WANT non-deterministic input = torch arange dtype=torch float reshape input tensor m input tensor using different paddings different sides m = nn ReplicationPad d m input tensor pyrefly ignore bad-override padding tuple int int int int __init__ padding _size_ _t - None super __init__ padding = _quadruple padding ReplicationPad d _ReplicationPadNd r Pads input tensor using replication input boundary For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding all boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` math ` \text padding\_top ` math ` \text padding\_bottom ` math ` \text padding\_front ` math ` \text padding\_back ` Note output dimensions must remain positive Shape - Input math ` N C D_ H_ W_ ` math ` C D_ H_ W_ ` - Output math ` N C D_ out H_ out W_ out ` math ` C D_ out H_ out W_ out ` where math ` D_ out = D_ + \text padding\_front + \text padding\_back ` math ` H_ out = H_ + \text padding\_top + \text padding\_bottom ` math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples xdoctest +IGNORE_WANT non-deterministic m = nn ReplicationPad d input = torch randn output = m input using different paddings different sides m = nn ReplicationPad d output = m input pyrefly ignore bad-override padding tuple int int int int int int __init__ padding _size_ _t - None super __init__ padding = _ntuple padding ZeroPad d ConstantPad d r Pads input tensor boundaries zero For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding both boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` Shape - Input math ` C W_ ` math ` N C W_ ` - Output math ` C W_ out ` math ` N C W_ out ` where math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples xdoctest +IGNORE_WANT non-deterministic m = nn ZeroPad d input = torch randn input tensor - - - - - m input tensor - - - - - m = nn ZeroPad d input = torch randn input tensor - - - m input tensor - - - using different paddings different sides m = nn ZeroPad d m input tensor - - - padding tuple int int __init__ padding _size_ _t - None super __init__ padding extra_repr - str Return extra representation module f padding ZeroPad d ConstantPad d r Pads input tensor boundaries zero For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding all boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` math ` \text padding\_top ` math ` \text padding\_bottom ` Shape - Input math ` N C H_ W_ ` math ` C H_ W_ ` - Output math ` N C H_ out W_ out ` math ` C H_ out W_ out ` where math ` H_ out = H_ + \text padding\_top + \text padding\_bottom ` math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples xdoctest +IGNORE_WANT non-deterministic m = nn ZeroPad d input = torch randn input tensor - - - - - - - m input tensor - - - - - - - using different paddings different sides m = nn ZeroPad d m input tensor - - - - - - - padding tuple int int int int __init__ padding _size_ _t - None super __init__ padding extra_repr - str Return extra representation module f padding ZeroPad d ConstantPad d r Pads input tensor boundaries zero For ` N ` -dimensional padding use func ` torch nn functional pad ` Args padding int tuple size padding If ` int ` uses same padding all boundaries If - ` tuple ` uses math ` \text padding\_left ` math ` \text padding\_right ` math ` \text padding\_top ` math ` \text padding\_bottom ` math ` \text padding\_front ` math ` \text padding\_back ` Shape - Input math ` N C D_ H_ W_ ` math ` C D_ H_ W_ ` - Output math ` N C D_ out H_ out W_ out ` math ` C D_ out H_ out W_ out ` where math ` D_ out = D_ + \text padding\_front + \text padding\_back ` math ` H_ out = H_ + \text padding\_top + \text padding\_bottom ` math ` W_ out = W_ + \text padding\_left + \text padding\_right ` Examples m = nn ZeroPad d input = torch randn output = m input using different paddings different sides m = nn ZeroPad d output = m input padding tuple int int int int int int __init__ padding _size_ _t - None super __init__ padding extra_repr - str Return extra representation module f padding