timeit torch torch nn nn functorch compile compiled_module tvm_compile nop f _ f fw_compiler = tvm_compile target= llvm tuning_logfile= fw_keops bw_compiler = tvm_compile target= llvm tuning_logfile= bw_keops fw_compiler = nop bw_compiler = nop run mod input out = mod input out sum backward grads = p grad p mod parameters out grads Foo nn Module __init__ - None super __init__ param = nn Parameter torch randn register_buffer buf torch randn forward x param x + buf sum dim= input = torch randn mod = Foo compiled_mod = compiled_module mod fw_compiler bw_compiler b zip run mod input run compiled_mod input torch testing assert_close b out = mod input out sum backward mod param data -= mod param grad compiled_mod orig_module param data -= compiled_mod orig_module param grad compiled_mod orig_module param grad = None b zip run mod input run compiled_mod input torch testing assert_close b _ range i = t = timeit Timer mod input globals=globals timeit print f eager t i e t = timeit Timer compiled_mod input globals=globals timeit print f compiled t i e