Owner s oncall r p sys tempfile time unittest datetime datetime timedelta torch monitor _WaitCounter Aggregation Event log_event register_event_handler Stat TensorboardEventHandler unregister_event_handler torch testing _internal common_utils run_tests skipIfTorchDynamo TestCase TestMonitor TestCase test_interval_stat - None events = handler event events append event handle = register_event_handler handler s = Stat asdf Aggregation SUM Aggregation COUNT timedelta milliseconds= assertEqual s name asdf s add _ range NOTE different platforms sleep may inaccurate so we loop instead i e win time sleep ms s add len events = break assertGreaterEqual len events unregister_event_handler handle test_fixed_count_stat - None s = Stat asdf Aggregation SUM Aggregation COUNT timedelta hours= s add s add name = s name assertEqual name asdf assertEqual s count s add assertEqual s count assertEqual s get Aggregation SUM Aggregation COUNT test_log_event - None e = Event name= torch monitor TestEvent timestamp=datetime now data= str string float int assertEqual e name torch monitor TestEvent assertIsNotNone e timestamp assertIsNotNone e data log_event e skipIfTorchDynamo Really weird error test_event_handler - None events = handler event Event - None events append event handle = register_event_handler handler e = Event name= torch monitor TestEvent timestamp=datetime now data= log_event e assertEqual len events assertEqual events e log_event e assertEqual len events unregister_event_handler handle log_event e assertEqual len events test_wait_counter - None wait_counter = _WaitCounter test_wait_counter wait_counter guard pass skipIfTorchDynamo Really weird error TestMonitorTensorboard TestCase setUp global SummaryWriter event_multiplexer try tensorboard backend event_processing plugin_event_multiplexer event_multiplexer torch utils tensorboard SummaryWriter except ImportError skipTest Skip test since TensorBoard installed temp_dirs = create_summary_writer temp_dir = tempfile TemporaryDirectory noqa P temp_dirs append temp_dir SummaryWriter temp_dir name tearDown Remove directories created SummaryWriter temp_dir temp_dirs temp_dir cleanup unittest skipIf sys version_info = numpy failure likely caused old tensorboard version test_event_handler create_summary_writer w handle = register_event_handler TensorboardEventHandler w s = Stat asdf Aggregation SUM Aggregation COUNT timedelta hours= i range s add i assertEqual s count unregister_event_handler handle mul = event_multiplexer EventMultiplexer mul AddRunsFromDirectory temp_dirs - name mul Reload scalar_dict = mul PluginRunToTagToContent scalars raw_result = tag mul Tensors run tag run run_dict scalar_dict items tag run_dict scalars = tag e tensor_proto float_val e events tag events raw_result items assertEqual scalars asdf sum asdf count __name__ == __main__ run_tests