logging collections abc Callable typing Any torch functorch compile make_boxed_func torch fx backends common aot_autograd registry CompiledFn register_backend register_experimental_backend log = logging getLogger __name__ register_experimental_backend openxla_eval model fx GraphModule fake_tensor_inputs list torch Tensor - CompiledFn xla_backend_helper model fake_tensor_inputs boxed=False openxla_eval_boxed model fx GraphModule fake_tensor_inputs list torch Tensor - Callable Any xla_backend_helper model fake_tensor_inputs boxed=True xla_backend_helper model fx GraphModule fake_tensor_inputs list torch Tensor boxed bool = False - Callable Any try torch_xla core dynamo_bridge bridge except ImportError e raise ImportError Please follow instruction https github com pytorch xla#pytorchxla install torch_xla e compiled_graph = None fwd args torch Tensor - Any nonlocal model nonlocal compiled_graph compiled_graph None compiled_graph = bridge extract_compiled_graph model args del model compiled_graph args make_boxed_func fwd boxed fwd openxla = aot_autograd fw_compiler=openxla_eval_boxed register_backend name= openxla compiler_fn=openxla