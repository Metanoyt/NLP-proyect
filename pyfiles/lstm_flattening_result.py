torch nn torch nn utils rnn PackedSequence LstmFlatteningResult nn LSTM forward input fargs fkwargs output hidden cell = nn LSTM forward input fargs fkwargs output hidden cell LstmFlatteningResultWithSeqLength nn Module __init__ input_size hidden_size layers bidirect dropout batch_first super __init__ batch_first = batch_first inner_model = nn LSTM input_size=input_size hidden_size=hidden_size num_layers=layers bidirectional=bidirect dropout=dropout batch_first=batch_first forward input PackedSequence hx=None output hidden cell = inner_model forward input hx output hidden cell LstmFlatteningResultWithoutSeqLength nn Module __init__ input_size hidden_size layers bidirect dropout batch_first super __init__ batch_first = batch_first inner_model = nn LSTM input_size=input_size hidden_size=hidden_size num_layers=layers bidirectional=bidirect dropout=dropout batch_first=batch_first forward input hx=None output hidden cell = inner_model forward input hx output hidden cell