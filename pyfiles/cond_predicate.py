mypy allow-untyped-defs torch functorch experimental control_flow cond CondPredicate torch nn Module The conditional statement aka predicate passed cond must one following - torch Tensor single element - boolean expression NOTE If ` pred ` test dim batch size will specialized forward x pred = x dim x shape cond pred lambda x x cos lambda y y sin x example_args = torch randn tags = torch cond torch dynamic-shape model = CondPredicate