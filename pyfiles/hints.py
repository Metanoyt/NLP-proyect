mypy allow-untyped-defs __future__ annotations collections functools typing enum auto Enum torch torch utils _triton has_triton_package The following maximums only apply runtime autotuning when using FixedTritonConfig one may see larger values NOTE these fail asserts submit PR increase them TRITON_MAX_BLOCK = X torch version hip Y Z R _ multi-kernel only R _ multi-kernel only TRITON_MAX_RSPLIT = ReductionHint Enum INNER = OUTER = OUTER_TINY = DEFAULT = TileHint Enum SQUARE = DEFAULT = Define ` AttrsDescriptorWrapper ` function clear conditional handling has_triton_package triton triton backends compiler triton compiler compiler hasattr triton backends compiler AttrsDescriptor Triton - second implementation triton backends compiler AttrsDescriptor AttrsDescriptorWrapper divisible_by_ =None equal_to_ =None Prepare arguments AttrsDescriptor kwargs = tt divisibility divisible_by_ tt equal_to equal_to_ Instantiate AttrsDescriptor prepared arguments res = AttrsDescriptor from_dict arg_properties kwargs cls AttrsDescriptor __name__ assert res property_values tt divisibility == assert res property_values tt equal_to == res hasattr triton compiler compiler AttrsDescriptor Triton - original implementation triton compiler compiler AttrsDescriptor AttrsDescriptorWrapper divisible_by_ =None equal_to_ =None Prepare arguments AttrsDescriptor kwargs = divisible_by_ divisible_by_ equal_to_ equal_to_ Instantiate AttrsDescriptor prepared arguments AttrsDescriptor kwargs Triton note there s also range triton commits currently supported ~Dec Jan which AttrsDescriptors still used contents different AttrsDescriptorWrapper divisible_by_ =None equal_to_ =None pyrefly ignore not-iterable x tt divisibility x divisible_by_ Define namedtuple fallback when AttrsDescriptor available AttrsDescriptorWrapper = collections namedtuple type ignore no-redef name-match pyrefly ignore invalid-argument AttrsDescriptor divisible_by_ equal_to_ defaults= _NUM_THREADS_PER_WARP = HeuristicType Enum PERSISTENT_REDUCTION = auto POINTWISE = auto REDUCTION = auto SPLIT_SCAN = auto TEMPLATE = auto USER_AUTOTUNE = auto FIXED = auto AutotuneHint Enum ONE_ELEMENT_PER_THREAD = Triton codegen tries codegen set AutotuneHints Enum __repr__ looks like AutotuneHint ELEMENTS_PER_WARP_ which isn t valid python Enum __str__ will just AutotuneHint ELEMENTS_PER_WARP_ __repr__ = Enum __str__ DeviceProperties typing NamedTuple Copy device properties into data structure requiring torch imported type str type ignore assignment index int type ignore assignment multi_processor_count int cc int major int &#124; None = None regs_per_multiprocessor int &#124; None = None max_threads_per_multi_processor int &#124; None = None warp_size int &#124; None = None classmethod functools cache create cls device - DeviceProperties torch torch _dynamo device_interface get_interface_for_device device_type = device type torch version hip device_type == cuda device_type = hip device_interface = get_interface_for_device device props = device_interface get_device_properties device try multi_processor_count = props multi_processor_count except AttributeError device_type == xpu multi_processor_count = props gpu_subslice_count device_type == mtia multi_processor_count = raise cls type=device_type index=device index multi_processor_count=multi_processor_count cc=device_interface get_compute_capability device major=getattr props major None regs_per_multiprocessor=getattr props regs_per_multiprocessor None max_threads_per_multi_processor=getattr props max_threads_per_multi_processor None warp_size=getattr props warp_size device_type = cpu None HalideInputSpec typing NamedTuple ctype str name str shape list str &#124; None = None stride list str &#124; None = None offset str &#124; None = None alias_of str &#124; None = None bindings_type - str ctype Half BFloat uint _t half defined ctype halide_type - str ctype == Half halide_type_t halide_type_float half defined ctype == BFloat halide_type_t halide_type_bfloat half defined f halide_type_of ctype replace is_scalar - bool shape None is_buffer - bool shape None HalideMeta typing NamedTuple argtypes list HalideInputSpec target str scheduler str &#124; None = None scheduler_flags dict str int &#124; str &#124; None = None cuda_device int &#124; None = None args - list str Command line args pass halide generator args = f target= target scheduler args append f autoscheduler= scheduler scheduler_flags assert scheduler k v scheduler_flags items args append f autoscheduler k = v args is_cuda - bool cuda_device None