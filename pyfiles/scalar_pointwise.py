Scalar pointwise operator implementation random typing Optional torch torchfuzz operators base Operator torchfuzz tensor_fuzzer ScalarSpec Spec ScalarPointwiseOperator Operator Base scalar pointwise operations __init__ name str symbol str super __init__ name symbol = symbol property torch_op_name - Optional str Scalar operations don t have specific torch ops they use Python operators None can_produce output_spec Spec - bool Scalar pointwise operations can only produce scalars output_spec dtype == torch bool False isinstance output_spec ScalarSpec fuzz_inputs_specs output_spec Spec num_inputs int = - list Spec Decompose scalar into input scalars pointwise operation type promotion isinstance output_spec ScalarSpec raise ValueError f __class__ __name__ can only produce ScalarSpec outputs Use shared type promotion utility torchfuzz type_promotion get_scalar_promotion_pairs supported_types = get_scalar_promotion_pairs output_spec dtype dtypes = random choice supported_types ScalarSpec dtype=dtypes ScalarSpec dtype=dtypes codegen output_name str input_names list str output_spec Spec - str Generate code scalar pointwise operation len input_names = raise ValueError f __class__ __name__ requires exactly two inputs f output_name = input_names symbol input_names ScalarAddOperator ScalarPointwiseOperator Operator scalar addition __init__ super __init__ scalar_add + ScalarMulOperator ScalarPointwiseOperator Operator scalar multiplication __init__ super __init__ scalar_mul ScalarSubOperator ScalarPointwiseOperator Operator scalar subtraction __init__ super __init__ scalar_sub - ScalarDivOperator ScalarPointwiseOperator Operator scalar division __init__ super __init__ scalar_div codegen output_name str input_names list str output_spec Spec - str Generate code scalar division zero-denominator guard len input_names = raise ValueError f __class__ __name__ requires exactly two inputs Prevent ZeroDivisionError runtime clamping denominator Clamp denominator least ints e- floats isinstance output_spec ScalarSpec output_spec dtype torch int torch int torch int torch int f output_name = input_names max input_names f output_name = input_names max input_names e-