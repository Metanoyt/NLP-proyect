mypy allow-untyped-defs copy random torch torch distributed _shard sharded_tensor torch distributed _shard sharding_spec ChunkShardingSpec PLACEMENTS = rank cuda rank cuda rank cuda rank cuda DEFAULT_GPU_NUM = _chunk_sharding_specs_list_for_test sharding_dims seed= spec_list = i range len sharding_dims random Random seed + i shuffle PLACEMENTS spec_list append ChunkShardingSpec dim=sharding_dims i placements=copy deepcopy PLACEMENTS spec_list MyShardedModel torch nn Module __init__ spec=None group=None init_rrefs=True - None super __init__ spec None sharded_tensor = sharded_tensor rand spec process_group=group init_rrefs=init_rrefs sharded_tensor = None random_tensor = torch nn Parameter torch rand MyShardedModel torch nn Module __init__ spec=None group=None init_rrefs=True - None super __init__ spec None sharded_tensor = sharded_tensor rand spec process_group=group init_rrefs=init_rrefs sharded_tensor = None random_tensor = torch nn Parameter torch rand submodule = MyShardedModel spec group init_rrefs