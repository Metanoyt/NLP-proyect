collections abc Callable typing Any Optional TypeVar typing_extensions ParamSpec TypeVarTuple Unpack torch _prims context TorchRefsMode torch fx GraphModule torch fx experimental proxy_tensor make_fx wrapper_and_args_for_make_fx T = TypeVar T P = ParamSpec P Ts = TypeVarTuple Ts execute gm GraphModule args Unpack Ts executor str = aten executor_parameters Optional dict = None - Any Prototype ATen executor Just executes context s graph executor == aten gm forward args msg = f Received unexpected value executor executor Allowed values aten raise ValueError msg make_traced fn Callable P T - Callable P T Returns function when called will trace its torch operations prims then execute those prims requested trace executor possibly lowering them trace executor first Only supports torch operations defined _torch_to_reference_map context py operations positional args All args must tensors In near future all these restrictions will lifted Example usage foo b torch add b traced_foo = make_traced foo = torch randn device= cuda b = torch randn device= cuda result = traced_foo b executor= aten _traced args P args kwargs P kwargs - T executor = str kwargs pop executor aten TODO caching wrapped all_args = wrapper_and_args_for_make_fx fn args kwargs TorchRefsMode gm = make_fx wrapped all_args execute gm all_args executor=executor _traced type ignore return-value