json os functools lru_cache typing Any clickhouse_connect type ignore lru_cache maxsize= get_clickhouse_client - Any endpoint = os environ CLICKHOUSE_ENDPOINT I cannot figure out why these values aren t being handled automatically when fine lambda endpoint = endpoint removeprefix https endpoint = endpoint removesuffix clickhouse_connect get_client host=endpoint user=os environ CLICKHOUSE_USERNAME password=os environ CLICKHOUSE_PASSWORD secure=True interface= https port= query_clickhouse query str params dict str Any - list dict str Any Queries ClickHouse Returns datetime YYYY-MM-DD HH MM SS format convert_to_json_list res bytes - list dict str Any rows = row res decode split \n row rows append json loads row rows res = get_clickhouse_client raw_query query params fmt= JSONEachRow convert_to_json_list res