math torch nn torch nn init _initialize_orthogonal conv prelu_gain = math sqrt init orthogonal conv weight gain=prelu_gain conv bias None conv bias data zero_ ResidualBlock nn Module __init__ n_filters super __init__ conv = nn Conv d n_filters n_filters kernel_size= padding= bias=False bn = nn BatchNorm d n_filters prelu = nn PReLU n_filters conv = nn Conv d n_filters n_filters kernel_size= padding= bias=False bn = nn BatchNorm d n_filters Orthogonal initialisation _initialize_orthogonal conv _initialize_orthogonal conv forward x residual = prelu bn conv x residual = bn conv residual x + residual UpscaleBlock nn Module __init__ n_filters super __init__ upscaling_conv = nn Conv d n_filters n_filters kernel_size= padding= upscaling_shuffler = nn PixelShuffle upscaling = nn PReLU n_filters _initialize_orthogonal upscaling_conv forward x upscaling upscaling_shuffler upscaling_conv x SRResNet nn Module __init__ rescale_factor n_filters n_blocks super __init__ rescale_levels = int math log rescale_factor noqa FURB n_filters = n_filters n_blocks = n_blocks conv = nn Conv d n_filters kernel_size= padding= prelu = nn PReLU n_filters residual_block_num range n_blocks + residual_block = ResidualBlock n_filters add_module residual_block + str residual_block_num nn Sequential residual_block skip_conv = nn Conv d n_filters n_filters kernel_size= padding= bias=False skip_bn = nn BatchNorm d n_filters upscale_block_num range rescale_levels + upscale_block = UpscaleBlock n_filters add_module upscale_block + str upscale_block_num nn Sequential upscale_block output_conv = nn Conv d n_filters kernel_size= padding= Orthogonal initialisation _initialize_orthogonal conv _initialize_orthogonal skip_conv _initialize_orthogonal output_conv forward x x_init = prelu conv x x = residual_block x_init residual_block_num range n_blocks + x = getattr residual_block + str residual_block_num x x = skip_bn skip_conv x + x_init upscale_block_num range rescale_levels + x = getattr upscale_block + str upscale_block_num x output_conv x