Owner s module onnx onnx_test_common pytorch_test_common torch torch utils cpp_extension torch onnx symbolic_helper torch testing _internal common_utils TestCustomAutogradFunction pytorch_test_common ExportTestCase opset_version = keep_initializers_as_inputs = False onnx_shape_inference = True test_symbolic MyClip torch autograd Function staticmethod forward ctx input scalar ctx save_for_backward input input clamp min=scalar staticmethod symbolic g input scalar g op Clip input min_f=scalar MyModule torch nn Module __init__ - None super __init__ clip = MyClip apply forward x h = clip x h x = torch randn requires_grad=True model = MyModule onnx_test_common run_model_test model input_args= x test_register_op MyClip torch autograd Function staticmethod forward ctx input scalar ctx save_for_backward input input clamp min=scalar MyRelu torch autograd Function staticmethod forward ctx input ctx save_for_backward input input clamp min= MyModule torch nn Module __init__ - None super __init__ clip = MyClip apply relu = MyRelu apply forward x h = clip x h = relu h h symbolic_pythonop g args kwargs name = kwargs name name == MyClip g op Clip args min_f=args name == MyRelu g op Relu args symbolic_helper _unimplemented prim PythonOp unknown node kind + name torch onnx register_custom_op_symbolic register_custom_op_symbolic prim PythonOp symbolic_pythonop x = torch randn requires_grad=True model = MyModule onnx_test_common run_model_test model input_args= x TestExportAsContribOps pytorch_test_common ExportTestCase opset_version = keep_initializers_as_inputs = False onnx_shape_inference = True test_contrib_op_with_loop M torch nn Module __init__ - None super __init__ gelu = torch nn GELU approximate= none forward x res = res = _ range x size len res res append res res append gelu x res append x torch stack res torch stack res symbolic_custom_gelu g input approximate g op com microsoft Gelu input setType input type torch onnx register_custom_op_symbolic register_custom_op_symbolic gelu symbolic_custom_gelu x = torch randn requires_grad=True model = torch jit script M onnx_test_common run_model_test model input_args= x __name__ == __main__ common_utils run_tests