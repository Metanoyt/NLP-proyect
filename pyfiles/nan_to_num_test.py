math operator_benchmark op_bench torch Microbenchmarks torch nan_to_num nan_to_num_ operators Configs PT torch nan_to_num nan_to_num_ operators nan_to_num_ops_list = op_bench op_list attr_names= op_name op_func attrs= nan_to_num torch nan_to_num nan_to_num_ torch nan_to_num_ nan_to_num_long_configs = op_bench cross_product_configs M= N=range dtype= torch float torch double replace_inf= True False tags= long nan_to_num_short_configs = op_bench cross_product_configs M= N= dtype= torch float torch double replace_inf= True False tags= short ReplaceNaNBenchmark op_bench TorchBenchmarkBase init M N dtype replace_inf op_func input = torch randn M N dtype=dtype input = float nan inputs = input input replace_inf replace_inf op_func = op_func set_module_name nan_to_num To make casename unique nan_to_num nan_to_num_ two different functions op_func torch nan_to_num_ set_module_name nan_to_num_ forward input replace_inf bool compare inplace replace_inf op_func input nan= op_func input nan= posinf=math inf neginf=-math inf op_bench generate_pt_tests_from_op_list nan_to_num_ops_list nan_to_num_long_configs + nan_to_num_short_configs ReplaceNaNBenchmark __name__ == __main__ op_bench benchmark_runner main