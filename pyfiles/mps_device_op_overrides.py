__future__ annotations common DeviceOpOverrides register_device_op_overrides MPSDeviceOpOverrides DeviceOpOverrides device_guard device_idx int - str assert device_idx == torch _ops contextlib nullcontext set_device device_idx int - str assert device_idx == pass MPS set device kernel_driver - str #include ATen native mps MetalShaderLibrary h cpp_kernel_type - str MTLFunction_t register_device_op_overrides mps MPSDeviceOpOverrides