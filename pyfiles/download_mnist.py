argparse gzip os sys urllib error URLError urllib request urlretrieve MIRRORS = https ossci-datasets s amazonaws com mnist lint-ignore RESOURCES = train-images-idx -ubyte gz train-labels-idx -ubyte gz t k-images-idx -ubyte gz t k-labels-idx -ubyte gz report_download_progress chunk_number int chunk_size int file_size int - None file_size = - pyrefly ignore no-matching-overload percent = min chunk_number chunk_size file_size bar = int percent sys stdout write f \r &#124; bar &#124; int percent download destination_path str resource str quiet bool - None os path exists destination_path quiet print f destination_path already exists skipping mirror MIRRORS url = mirror + resource print f Downloading url try hook = None quiet report_download_progress urlretrieve url destination_path reporthook=hook except URLError ConnectionError e print f Failed download trying next \n e continue finally quiet Just newline print break raise RuntimeError Error downloading resource unzip zipped_path str quiet bool - None unzipped_path = os path splitext zipped_path os path exists unzipped_path quiet print f unzipped_path already exists skipping gzip open zipped_path rb zipped_file open unzipped_path wb unzipped_file unzipped_file write zipped_file read quiet print f Unzipped zipped_path main - None parser = argparse ArgumentParser description= Download MNIST dataset internet parser add_argument -d -- destination default= help= Destination directory parser add_argument -q -- quiet action= store_true help= Don t report about progress options = parser parse_args os path exists options destination os makedirs options destination try resource RESOURCES path = os path join options destination resource download path resource options quiet unzip path options quiet except KeyboardInterrupt print Interrupted __name__ == __main__ main