operator_benchmark op_bench torch Microbenchmarks topk operator topk_configs_short = op_bench config_list attr_names= shape k dim attrs= cross_product_configs= device cpu dtype torch float tags= short topk_configs_long = op_bench cross_product_configs shape= k= dim= device= cpu cuda dtype= torch float torch bfloat tags= long TopkBenchmark op_bench TorchBenchmarkBase init shape k dim dtype device inputs = input torch randn shape device=device dtype=dtype k k dim dim set_module_name topk forward input k dim torch topk input k=k dim=dim op_bench generate_pt_test topk_configs_short + topk_configs_long TopkBenchmark __name__ == __main__ op_bench benchmark_runner main