Owner s oncall jit os sys typing List Tuple torch Make helper files test importable pytorch_test_dir = os path dirname os path dirname os path realpath __file__ sys path append pytorch_test_dir torch testing _internal common_utils raise_on_run_directly torch testing _internal jit_utils JitTestCase TestHash JitTestCase test_hash_tuple fn t Tuple int int t Tuple int int - bool hash t == hash t checkScript fn checkScript fn checkScript fn test_hash_tuple_nested_unhashable_type Tuples may contain unhashable types like ` list ` check we error properly case torch jit script fn_unhashable t Tuple int List int hash t assertRaisesRegexWithHighlight RuntimeError unhashable hash fn_unhashable test_hash_tensor Tensors should hash identity fn t t hash t == hash t tensor = torch tensor tensor _clone = torch tensor tensor = torch tensor checkScript fn tensor tensor checkScript fn tensor tensor _clone checkScript fn tensor tensor test_hash_none fn n = None n = None hash n == hash n checkScript fn test_hash_bool fn b bool b bool hash b == hash b checkScript fn True False checkScript fn True True checkScript fn False True checkScript fn False False test_hash_float fn f float f float hash f == hash f checkScript fn checkScript fn checkScript fn float inf checkScript fn float inf float inf checkScript fn float nan checkScript fn float nan float inf test_hash_int fn i int i int hash i == hash i checkScript fn checkScript fn checkScript fn - checkScript fn - - checkScript fn test_hash_string fn s str s str hash s == hash s checkScript fn foo foo checkScript fn foo bar checkScript fn foo test_hash_device fn d torch device d torch device hash d == hash d gpu = torch device cuda gpu = torch device cuda cpu = torch device cpu checkScript fn gpu gpu checkScript fn gpu gpu checkScript fn gpu cpu checkScript fn cpu cpu __name__ == __main__ raise_on_run_directly test test_jit py