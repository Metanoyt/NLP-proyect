operator_benchmark op_bench torch Microbenchmarks boolean operators Supports both Caffe PyTorch Configs PT all operator all_long_configs = op_bench cross_product_configs M= N= K= device= cpu cuda tags= long all_short_configs = op_bench config_list attr_names= M N K attrs= cross_product_configs= device cpu cuda tags= short AllBenchmark op_bench TorchBenchmarkBase init M N K device inputs = input_one torch randint M N K device=device dtype=torch bool set_module_name all forward input_one torch all input_one The generated test names based all_short_configs will following pattern all_M _N _K _devicecpu all_M _N _K _devicecpu_bwdall all_M _N _K _devicecpu_bwd all_M _N _K _devicecpu_bwd Those names can used filter tests op_bench generate_pt_test all_long_configs + all_short_configs AllBenchmark Mircobenchmark any operator AnyBenchmark op_bench TorchBenchmarkBase init M N device inputs = input_one torch randint M N device=device dtype=torch bool set_module_name any forward input_one torch any input_one any_configs = op_bench cross_product_configs M= N= device= cpu cuda tags= any op_bench generate_pt_test any_configs AnyBenchmark __name__ == __main__ op_bench benchmark_runner main