mypy allow-untyped-defs collections abc Callable Iterable math sqrt typing Optional TypeVar torch torch Tensor torch _torch_docs factory_common_args merge_dicts parse_kwargs __all__ = bartlett blackman cosine exponential gaussian general_cosine general_hamming hamming hann kaiser nuttall _T = TypeVar _T window_common_args = merge_dicts parse_kwargs M int length window In other words number points returned window sym bool optional If ` False ` returns periodic window suitable use spectral analysis If ` True ` returns symmetric window suitable use filter design Default ` True ` factory_common_args normalization The window normalized maximum value However doesn t appear attr ` M ` even attr ` sym ` ` True ` _add_docstr args str - Callable _T _T r Adds docstrings given decorated function Specially useful when then docstrings needs string interpolation e g str format REMARK Do use function docstring doesn t need string interpolation just write conventional docstring Args args str decorator o _T - _T o __doc__ = join args o decorator _window_function_checks function_name str M int dtype torch dtype layout torch layout - None r Performs common checks all defined windows This function should called before computing any window Args function_name str name window function M int length window dtype ` torch dtype ` desired data type returned tensor layout ` torch layout ` desired layout returned tensor M raise ValueError f function_name requires non-negative window length got M= M layout torch strided raise ValueError f function_name implemented strided tensors only got layout dtype torch float torch float raise ValueError f function_name expects float float dtypes got dtype _add_docstr r Computes window exponential waveform Also known Poisson window The exponential window defined follows math w_n = \exp \left -\frac &#124; n - c &#124; \tau \right where ` c ` ` ` center ` ` window r normalization Args M Keyword args center float optional where center window will located Default ` M ` ` sym ` ` False ` ` M - ` tau float optional decay value Tau generally associated percentage means value should vary within interval If tau considered uniform window Default sym dtype layout device requires_grad Examples Generates symmetric exponential window size decay value The center will M - where M torch signal windows exponential tensor Generates periodic exponential window decay factor equal torch signal windows exponential sym=False tau= tensor e- e- e- e- e- e+ e- e- e- e- format window_common_args exponential M int center Optional float = None tau float = sym bool = True dtype Optional torch dtype = None layout torch layout = torch strided device Optional torch device = None requires_grad bool = False - Tensor dtype None dtype = torch get_default_dtype _window_function_checks exponential M dtype layout tau = raise ValueError f Tau must positive got tau instead sym center None raise ValueError Center must None symmetric windows M == torch empty dtype=dtype layout=layout device=device requires_grad=requires_grad center None center = M sym M M - constant = tau k = torch linspace start=-center constant end= -center + M - constant steps=M dtype=dtype layout=layout device=device requires_grad=requires_grad torch exp -torch abs k _add_docstr r Computes window simple cosine waveform following same implementation SciPy This window also known sine window The cosine window defined follows math w_n = \sin\left \frac \pi n + M \right This formula differs typical cosine window formula incorporating term numerator which shifts sample positions This adjustment results window starts ends non-zero values r normalization Args M Keyword args sym dtype layout device requires_grad Examples Generates symmetric cosine window torch signal windows cosine tensor Generates periodic cosine window torch signal windows cosine sym=False tensor format window_common_args cosine M int sym bool = True dtype Optional torch dtype = None layout torch layout = torch strided device Optional torch device = None requires_grad bool = False - Tensor dtype None dtype = torch get_default_dtype _window_function_checks cosine M dtype layout M == torch empty dtype=dtype layout=layout device=device requires_grad=requires_grad start = constant = torch pi M + sym M M k = torch linspace start=start constant end= start + M - constant steps=M dtype=dtype layout=layout device=device requires_grad=requires_grad torch sin k _add_docstr r Computes window gaussian waveform The gaussian window defined follows math w_n = \exp \left -\left \frac n \sigma \right ^ \right r normalization Args M Keyword args std float optional standard deviation gaussian It controls how narrow wide window Default sym dtype layout device requires_grad Examples Generates symmetric gaussian window standard deviation torch signal windows gaussian tensor e- e- e- e- e- e- e- e- e- e- Generates periodic gaussian window standard deviation equal torch signal windows gaussian sym=False std= tensor e- e- e- e- e- e+ e- e- e- e- format window_common_args gaussian M int std float = sym bool = True dtype Optional torch dtype = None layout torch layout = torch strided device Optional torch device = None requires_grad bool = False - Tensor dtype None dtype = torch get_default_dtype _window_function_checks gaussian M dtype layout std = raise ValueError f Standard deviation must positive got std instead M == torch empty dtype=dtype layout=layout device=device requires_grad=requires_grad start = - M sym M M - constant = std sqrt k = torch linspace start=start constant end= start + M - constant steps=M dtype=dtype layout=layout device=device requires_grad=requires_grad torch exp - k pyrefly ignore unsupported-operation _add_docstr r Computes Kaiser window The Kaiser window defined follows math w_n = I_ \left \beta \sqrt - \left \frac n - N N \right ^ \right I_ \beta where ` ` I_ ` ` zeroth order modified Bessel function first kind see func ` torch special i ` ` ` N = M - sym M ` ` r normalization Args M Keyword args beta float optional shape parameter window Must non-negative Default sym dtype layout device requires_grad Examples Generates symmetric gaussian window standard deviation torch signal windows kaiser tensor e- e- e- e- e- e- e- e- e- e- Generates periodic gaussian window standard deviation equal torch signal windows kaiser sym=False std= tensor e- e- e- e- e- e+ e- e- e- e- format window_common_args kaiser M int beta float = sym bool = True dtype Optional torch dtype = None layout torch layout = torch strided device Optional torch device = None requires_grad bool = False - Tensor dtype None dtype = torch get_default_dtype _window_function_checks kaiser M dtype layout beta raise ValueError f beta must non-negative got beta instead M == torch empty dtype=dtype layout=layout device=device requires_grad=requires_grad M == torch ones dtype=dtype layout=layout device=device requires_grad=requires_grad Avoid NaNs casting ` beta ` appropriate dtype pyrefly ignore bad-assignment beta = torch tensor beta dtype=dtype device=device start = -beta constant = beta M sym M - end = torch minimum pyrefly ignore bad-argument-type beta pyrefly ignore bad-argument-type start + M - constant k = torch linspace start=start end=end steps=M dtype=dtype layout=layout device=device requires_grad=requires_grad torch i torch sqrt beta beta - torch pow k torch i pyrefly ignore bad-argument-type beta _add_docstr r Computes Hamming window The Hamming window defined follows math w_n = \alpha - \beta\ \cos \left \frac \pi n M - \right r normalization Arguments M Keyword args sym alpha float optional The coefficient math ` \alpha ` equation above beta float optional The coefficient math ` \beta ` equation above dtype layout device requires_grad Examples Generates symmetric Hamming window torch signal windows hamming tensor Generates periodic Hamming window torch signal windows hamming sym=False tensor format window_common_args hamming M int sym bool = True dtype Optional torch dtype = None layout torch layout = torch strided device Optional torch device = None requires_grad bool = False - Tensor general_hamming M sym=sym dtype=dtype layout=layout device=device requires_grad=requires_grad _add_docstr r Computes Hann window The Hann window defined follows math w_n = \frac \ \left - \cos \left \frac \pi n M - \right \right = \sin^ \left \frac \pi n M - \right r normalization Arguments M Keyword args sym dtype layout device requires_grad Examples Generates symmetric Hann window torch signal windows hann tensor Generates periodic Hann window torch signal windows hann sym=False tensor format window_common_args hann M int sym bool = True dtype Optional torch dtype = None layout torch layout = torch strided device Optional torch device = None requires_grad bool = False - Tensor general_hamming M alpha= sym=sym dtype=dtype layout=layout device=device requires_grad=requires_grad _add_docstr r Computes Blackman window The Blackman window defined follows math w_n = - \cos \left \frac \pi n M - \right + \cos \left \frac \pi n M - \right r normalization Arguments M Keyword args sym dtype layout device requires_grad Examples Generates symmetric Blackman window torch signal windows blackman tensor - e- e- e+ e- - e- Generates periodic Blackman window torch signal windows blackman sym=False tensor - e- e- e- e- e- format window_common_args blackman M int sym bool = True dtype Optional torch dtype = None layout torch layout = torch strided device Optional torch device = None requires_grad bool = False - Tensor dtype None dtype = torch get_default_dtype _window_function_checks blackman M dtype layout general_cosine M a= sym=sym dtype=dtype layout=layout device=device requires_grad=requires_grad _add_docstr r Computes Bartlett window The Bartlett window defined follows math w_n = - \left &#124; \frac n M - - \right &#124; = \begin cases \frac n M - \text \leq n \leq \frac M - \\ - \frac n M - \text \frac M - n M \\ \end cases r normalization Arguments M Keyword args sym dtype layout device requires_grad Examples Generates symmetric Bartlett window torch signal windows bartlett tensor Generates periodic Bartlett window torch signal windows bartlett sym=False tensor format window_common_args bartlett M int sym bool = True dtype Optional torch dtype = None layout torch layout = torch strided device Optional torch device = None requires_grad bool = False - Tensor dtype None dtype = torch get_default_dtype _window_function_checks bartlett M dtype layout M == torch empty dtype=dtype layout=layout device=device requires_grad=requires_grad M == torch ones dtype=dtype layout=layout device=device requires_grad=requires_grad start = - constant = M sym M - k = torch linspace start=start end=start + M - constant steps=M dtype=dtype layout=layout device=device requires_grad=requires_grad - torch abs k _add_docstr r Computes general cosine window The general cosine window defined follows math w_n = \sum^ M- _ i= - ^i a_i \cos \left \frac \pi i n M - \right r normalization Arguments M Keyword args Iterable coefficients associated each cosine functions sym dtype layout device requires_grad Examples Generates symmetric general cosine window coefficients torch signal windows general_cosine a= sym=True tensor Generates periodic general cosine window coefficients torch signal windows general_cosine a= - sym=False tensor format window_common_args general_cosine M Iterable sym bool = True dtype Optional torch dtype = None layout torch layout = torch strided device Optional torch device = None requires_grad bool = False - Tensor dtype None dtype = torch get_default_dtype _window_function_checks general_cosine M dtype layout M == torch empty dtype=dtype layout=layout device=device requires_grad=requires_grad M == torch ones dtype=dtype layout=layout device=device requires_grad=requires_grad isinstance Iterable raise TypeError Coefficients must list tuple raise ValueError Coefficients cannot empty constant = torch pi M sym M - k = torch linspace start= end= M - constant steps=M dtype=dtype layout=layout device=device requires_grad=requires_grad a_i = torch tensor - i w i w enumerate device=device dtype=dtype requires_grad=requires_grad i = torch arange a_i shape dtype=a_i dtype device=a_i device requires_grad=a_i requires_grad a_i unsqueeze - torch cos i unsqueeze - k sum _add_docstr r Computes general Hamming window The general Hamming window defined follows math w_n = \alpha - - \alpha \cos \left \frac \pi n M- \right r normalization Arguments M Keyword args alpha float optional window coefficient Default sym dtype layout device requires_grad Examples Generates symmetric Hamming window general Hamming window torch signal windows general_hamming sym=True tensor Generates periodic Hann window general Hamming window torch signal windows general_hamming alpha= sym=False tensor format window_common_args general_hamming M alpha float = sym bool = True dtype Optional torch dtype = None layout torch layout = torch strided device Optional torch device = None requires_grad bool = False - Tensor general_cosine M a= alpha - alpha sym=sym dtype=dtype layout=layout device=device requires_grad=requires_grad _add_docstr r Computes minimum -term Blackman-Harris window according Nuttall math w_n = - \cos z_n + \cos z_n - \cos z_n + \cos z_n where math ` z_n = \frac \pi n M ` normalization Arguments M Keyword args sym dtype layout device requires_grad References - A Nuttall Some windows very good sidelobe behavior IEEE Transactions Acoustics Speech Signal Processing vol no pp - Feb https doi org TASSP - Heinzel G et al Spectrum spectral density estimation Discrete Fourier transform DFT including comprehensive list window functions some new flat-top windows February https holometer fnal gov GH_FFT pdf Examples Generates symmetric Nutall window torch signal windows general_hamming sym=True tensor e- e- e+ e- e- Generates periodic Nuttall window torch signal windows general_hamming sym=False tensor e- e- e- e- e- format window_common_args nuttall M int sym bool = True dtype Optional torch dtype = None layout torch layout = torch strided device Optional torch device = None requires_grad bool = False - Tensor general_cosine M a= sym=sym dtype=dtype layout=layout device=device requires_grad=requires_grad