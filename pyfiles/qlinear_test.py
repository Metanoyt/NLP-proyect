pt configs operator_benchmark op_bench torch torch ao nn quantized nnq torch ao nn quantized dynamic nnqd Microbenchmarks Quantized Linear operators _QLinearBenchmarkBase op_bench TorchBenchmarkBase init N IN OUT linear_under_test scale = torch tensor zero_point = torch tensor X = torch randn N IN dtype=torch float qX = torch quantize_per_tensor X scale=scale zero_point=zero_point dtype=torch quint W = torch randn OUT IN dtype=torch float qW = torch quantize_per_tensor W scale=scale zero_point= dtype=torch qint Assume ` qlinear ` set child qlinear = linear_under_test qlinear weight = qW qlinear scale = scale qlinear zero_point = zero_point forward input Assume ` input ` set child qlinear input QLinearBenchmark _QLinearBenchmarkBase init N IN OUT device super init N IN OUT nnq Linear IN OUT inputs = input qX set_module_name QLinear QDynamicLinearBenchmark _QLinearBenchmarkBase init N IN OUT device super init N IN OUT nnqd Linear IN OUT inputs = input X set_module_name QDynamicLinear op_bench generate_pt_test configs remove_cuda configs linear_configs_short + configs linear_configs_long QLinearBenchmark op_bench generate_pt_test configs remove_cuda configs linear_configs_short + configs linear_configs_long QDynamicLinearBenchmark __name__ == __main__ op_bench benchmark_runner main