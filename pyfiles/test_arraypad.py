Owner s module dynamo unittest skipIf skipif torch testing _internal common_utils run_tests TEST_WITH_TORCHDYNAMO TestCase xpassIfTorchDynamo_np If we going trace through these we should use NumPy If testing eager mode we use torch _numpy TEST_WITH_TORCHDYNAMO numpy np numpy testing assert_allclose assert_array_equal torch _numpy np torch _numpy testing assert_allclose assert_array_equal TestConstant TestCase xpassIfTorchDynamo_np reason= tuple values test_check_constant = np arange = np pad constant constant_values= b = np array assert_array_equal b test_check_constant_zeros = np arange = np pad constant b = np array assert_array_equal b test_check_constant_float If input array int constant_values float dtype array padded kept arr = np arange reshape test = np pad arr mode= constant constant_values= expected = np array assert_allclose test expected test_check_constant_float If input array float constant_values float dtype array padded kept - here retaining float constants arr = np arange reshape arr_float = arr astype np float test = np pad arr_float mode= constant constant_values= expected = np array assert_allclose test expected xpassIfTorchDynamo_np reason= tuple values test_check_constant_float = np arange dtype=float = np pad constant constant_values= - - b = np array - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - assert_allclose b test_check_constant_odd_pad_amount arr = np arange reshape test = np pad arr mode= constant constant_values= expected = np array assert_allclose test expected xpassIfTorchDynamo_np reason= tuple values test_check_constant_pad_ d arr = np arange reshape test = np pad arr mode= constant constant_values= expected = np array assert_allclose test expected skipif True reason= passes MacOS fails otherwise reason= int overflow test_check_large_integers int _max = - arr = np full int _max dtype=np int test = np pad arr mode= constant constant_values=arr min expected = np full int _max dtype=np int assert_array_equal test expected test_pad_empty_dimension arr = np zeros result = np pad arr mode= constant assert result shape == __name__ == __main__ run_tests