torch torch _inductor codegen rocm rocm_template ROCmTemplate torch _inductor ir IRNode torch _inductor utils IndentedBuffer CKTileTemplate ROCmTemplate Base generating CK templates has common i e non-gemm-specific code generation logic _TORCH_DTYPE_TO_CK = torch float F torch float F torch float F torch bfloat BF torch int I torch int I torch float _e m fnuz F gfx torch float _e m fn F gfx torch float _e m fnuz BF gfx torch float _e m BF gfx ck_dtype_to_size = FP BF header - IndentedBuffer res = super header res splice CK headers #include ck_tile core hpp res globals - IndentedBuffer res = super globals res splice using F = ck_tile fp _t using BF = ck_tile bf _t using F = ck_tile half_t using F = float using BF = ck_tile bfloat _t res torch_type_to_ck node IRNode ptr str - str node None ptr f _TORCH_DTYPE_TO_CK get node get_dtype ptr