mypy allow-untyped-defs math typing Optional Union torch torch inf Tensor torch distributions constraints torch distributions normal Normal torch distributions transformed_distribution TransformedDistribution torch distributions transforms AbsTransform __all__ = HalfNormal HalfNormal TransformedDistribution r Creates half-normal distribution parameterized ` scale ` where X ~ Normal scale Y = &#124; X &#124; ~ HalfNormal scale Example xdoctest +IGNORE_WANT non-deterministic m = HalfNormal torch tensor m sample half-normal distributed scale= tensor Args scale float Tensor scale full Normal distribution arg_constraints = scale constraints positive pyrefly ignore bad-override support = constraints nonnegative has_rsample = True pyrefly ignore bad-override base_dist Normal __init__ scale Union Tensor float validate_args Optional bool = None - None base_dist = Normal scale validate_args=False super __init__ base_dist AbsTransform validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance HalfNormal _instance super expand batch_shape _instance=new property scale - Tensor base_dist scale property mean - Tensor scale math sqrt math pi property mode - Tensor torch zeros_like scale property variance - Tensor scale pow - math pi log_prob value _validate_args _validate_sample value log_prob = base_dist log_prob value + math log log_prob = torch where value = log_prob -inf log_prob cdf value _validate_args _validate_sample value base_dist cdf value - icdf prob base_dist icdf prob + entropy base_dist entropy - math log