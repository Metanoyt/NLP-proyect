Owner s module PrivateUse torch torch testing _internal common_utils run_tests skipIfTorchDynamo TestCase DummyPrivateUse Module staticmethod is_available True staticmethod is_autocast_enabled True staticmethod get_autocast_dtype torch float staticmethod set_autocast_enabled enable pass staticmethod set_autocast_dtype dtype pass staticmethod get_amp_supported_dtype torch float TestRenamePrivateuseoneToExistingBackend TestCase skipIfTorchDynamo TorchDynamo exposes https github com pytorch pytorch issues test_external_module_register_with_existing_backend torch utils rename_privateuse _backend maia assertRaisesRegex RuntimeError has already been set torch utils rename_privateuse _backend dummmy custom_backend_name = torch _C _get_privateuse _backend_name assertEqual custom_backend_name maia assertRaises AttributeError torch maia is_available assertRaisesRegex AssertionError Tried use AMP torch autocast device_type=custom_backend_name pass torch _register_device_module maia DummyPrivateUse Module torch maia is_available type ignore attr-defined torch autocast device_type=custom_backend_name pass assertEqual torch _utils _get_device_index maia assertEqual torch _utils _get_device_index torch device maia __name__ == __main__ run_tests