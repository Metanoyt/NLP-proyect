mypy allow-untyped-defs functools json enum Enum typing Any Optional torch _inductor codegen cuda cutlass_utils try_import_cutlass CUTLASSOperationSerializer Serializes deserializes CUTLASS GEMM operations JSON Handles GemmOperation objects their nested components TileDescription TensorDescription used keeping case we want generalize serializer _SUPPORTED_CLASSES list str = GemmOperation GemmKind TileDescription TensorDescription DataType EpilogueFunctor EpilogueFunctor x SwizzlingFunctor KernelScheduleType EpilogueScheduleType TileSchedulerType classmethod serialize cls operation GemmOperation - str type ignore name-defined noqa F Serialize GEMM operation JSON string Args operation GemmOperation object Returns str JSON string representation operation assert operation __class__ __qualname__ == GemmOperation Only GemmOperation objects supported via main API json dumps cls _gemm_operation_to_json operation classmethod deserialize cls json_str str - GemmOperation type ignore name-defined noqa F Deserialize JSON string GEMM operation Args json_str JSON string GEMM operation Returns GemmOperation Reconstructed operation json_dict = json loads json_str cls _json_to_gemm_operation json_dict classmethod _gemm_operation_to_json cls operation GemmOperation - dict str Any type ignore name-defined noqa F Convert GemmOperation JSON-serializable dict Args operation GemmOperation object Returns dict Dictionary representation cutlass_library library TensorDescription Create main dictionary required optional parameters result = Required parameters gemm_kind cls _enum_to_json operation gemm_kind arch operation arch tile_description cls _tile_description_to_json operation tile_description A cls _tensor_description_to_json operation A B cls _tensor_description_to_json operation B C cls _tensor_description_to_json operation C element_epilogue cls _enum_to_json operation element_epilogue Optional parameters epilogue_functor cls _enum_to_json operation epilogue_functor swizzling_functor cls _enum_to_json operation swizzling_functor D cls _tensor_description_to_json operation D operation D None kernel_schedule cls _enum_to_json operation kernel_schedule epilogue_schedule cls _enum_to_json operation epilogue_schedule tile_scheduler cls _enum_to_json operation tile_scheduler Process optional attributes optional_attrs = mixed_input_mode mixed_input_shuffle ScaleFactorA ScaleFactorB ScaleFactorD ScaleFactorMVecSize ScaleFactorNVecSize ScaleFactorKVecSize ScaleFactorVectorSize is_ x attr optional_attrs hasattr operation attr continue value = getattr operation attr isinstance value TensorDescription result attr = cls _tensor_description_to_json value isinstance value Enum result attr = cls _enum_to_json value result attr = value result classmethod _json_to_gemm_operation cls json_dict dict str Any - GemmOperation type ignore name-defined noqa F Convert JSON dict GemmOperation object Args json_dict Dictionary representation Returns GemmOperation Reconstructed object cutlass_library DataType cutlass_library gemm_operation GemmKind GemmOperation cutlass_library library EpilogueFunctor EpilogueFunctor x EpilogueScheduleType KernelScheduleType MixedInputMode SwizzlingFunctor TileSchedulerType Extract constructor parameters JSON dictionary gemm_kind = cls _json_to_enum json_dict gemm_kind GemmKind arch = json_dict arch tile_description = cls _json_to_tile_description json_dict tile_description A = cls _json_to_tensor_description json_dict get A A B = cls _json_to_tensor_description json_dict get B B C = cls _json_to_tensor_description json_dict get C C element_epilogue = cls _json_to_enum json_dict element_epilogue DataType Get optional parameters defaults epilogue_functor = cls _json_to_enum json_dict get epilogue_functor EpilogueFunctor x json_dict get is_ x EpilogueFunctor swizzling_functor = cls _json_to_enum json_dict get swizzling_functor SwizzlingFunctor D = cls _json_to_tensor_description json_dict get D D kernel_schedule = cls _json_to_enum json_dict get kernel_schedule KernelScheduleType epilogue_schedule = cls _json_to_enum json_dict get epilogue_schedule EpilogueScheduleType tile_scheduler = cls _json_to_enum json_dict get tile_scheduler TileSchedulerType mixed_input_mode = cls _json_to_enum json_dict get mixed_input_mode MixedInputMode mixed_input_shuffle = json_dict get mixed_input_shuffle False Scale factors ScaleFactorA = cls _json_to_enum json_dict get ScaleFactorA DataType ScaleFactorB = cls _json_to_enum json_dict get ScaleFactorB DataType ScaleFactorD = None ScaleFactorD json_dict ScaleFactorVectorSize json_dict ScaleFactorD = tensor cls _json_to_tensor_description json_dict get ScaleFactorD ScaleFactorD vector_size json_dict get ScaleFactorVectorSize ScaleFactorMVecSize = json_dict get ScaleFactorMVecSize ScaleFactorNVecSize = json_dict get ScaleFactorNVecSize ScaleFactorKVecSize = json_dict get ScaleFactorKVecSize Create GemmOperation extracted parameters operation = GemmOperation gemm_kind=gemm_kind arch=arch tile_description=tile_description A=A B=B C=C element_epilogue=element_epilogue epilogue_functor=epilogue_functor swizzling_functor=swizzling_functor D=D kernel_schedule=kernel_schedule epilogue_schedule=epilogue_schedule tile_scheduler=tile_scheduler mixed_input_mode=mixed_input_mode mixed_input_shuffle=mixed_input_shuffle ScaleFactorA=ScaleFactorA ScaleFactorB=ScaleFactorB ScaleFactorD=ScaleFactorD ScaleFactorMVecSize=ScaleFactorMVecSize ScaleFactorNVecSize=ScaleFactorNVecSize ScaleFactorKVecSize=ScaleFactorKVecSize operation classmethod functools lru_cache None _tile_description_to_json cls tile_desc TileDescription - str type ignore name-defined noqa F Convert TileDescription JSON string Args tile_desc TileDescription object Returns str JSON string representation Create main dictionary field names matching TileDescription constructor parameters result = threadblock_shape tile_desc threadblock_shape stages tile_desc stages warp_count tile_desc warp_count math_instruction cls _math_instruction_to_json tile_desc math_instruction min_compute tile_desc minimum_compute_capability Store min_compute constructor max_compute tile_desc maximum_compute_capability Store max_compute constructor cluster_shape tile_desc cluster_shape explicit_vector_sizes tile_desc explicit_vector_sizes Add tile_shape exists differs threadblock_shape hasattr tile_desc tile_shape tile_desc tile_shape = tile_desc threadblock_shape result tile_shape = tile_desc tile_shape json dumps result classmethod functools lru_cache None _json_to_tile_description cls json_dict Optional str - Optional TileDescription type ignore name-defined noqa F Convert JSON dict TileDescription object Args json_dict Dictionary representation Returns TileDescription Reconstructed object json_dict None None tile_dict = json loads json_dict cutlass_library library TileDescription math_instruction = cls _json_to_math_instruction tile_dict math_instruction Get compute capability values checking both naming conventions min_compute = tile_dict get min_compute tile_dict get minimum_compute_capability max_compute = tile_dict get max_compute tile_dict get maximum_compute_capability Get cluster shape default value cluster_shape = tile_dict get cluster_shape Create TileDescription object tile_desc = TileDescription threadblock_shape=tile_dict threadblock_shape stages=tile_dict stages warp_count=tile_dict warp_count math_instruction=math_instruction min_compute=min_compute max_compute=max_compute cluster_shape=cluster_shape explicit_vector_sizes=tile_dict get explicit_vector_sizes Set tile_shape exists differs threadblock_shape tile_shape tile_dict tile_dict tile_shape = tile_dict threadblock_shape tile_desc tile_shape = tile_dict tile_shape tile_desc classmethod functools lru_cache None _math_instruction_to_json cls math_instruction Optional MathInstruction type ignore name-defined noqa F - Optional str Convert MathInstruction JSON string Args math_instruction MathInstruction object Returns Optional str JSON string representation None math_instruction None None result = instruction_shape math_instruction instruction_shape element_a cls _enum_to_json math_instruction element_a element_b cls _enum_to_json math_instruction element_b element_accumulator cls _enum_to_json math_instruction element_accumulator opcode_class cls _enum_to_json math_instruction opcode_class math_operation cls _enum_to_json math_instruction math_operation element_scale_factor cls _enum_to_json math_instruction element_scale_factor json dumps result classmethod functools lru_cache None _json_to_math_instruction cls json_dict Optional str - Optional MathInstruction type ignore name-defined noqa F Convert JSON string MathInstruction object Args json_dict JSON string representation Returns Optional MathInstruction Reconstructed object None json_dict None None cutlass_library DataType cutlass_library library MathInstruction MathOperation OpcodeClass mi_dict = json loads json_dict Convert string enum names back enum values element_a = cls _json_to_enum mi_dict element_a DataType element_b = cls _json_to_enum mi_dict element_b DataType element_acc = cls _json_to_enum mi_dict element_accumulator DataType Get opcode_class enum opcode_class = cls _json_to_enum mi_dict opcode_class OpcodeClass Get math_operation enum math_op = cls _json_to_enum mi_dict math_operation MathOperation Create MathInstruction object math_instruction_obj = MathInstruction instruction_shape=mi_dict instruction_shape element_a=element_a element_b=element_b element_accumulator=element_acc opcode_class=opcode_class math_operation=math_op Add element_scale_factor exists element_scale_factor mi_dict mi_dict element_scale_factor None math_instruction_obj element_scale_factor = cls _json_to_enum mi_dict element_scale_factor DataType math_instruction_obj classmethod functools lru_cache None _tensor_description_to_json cls tensor_desc Optional TensorDescription type ignore name-defined noqa F - Optional str Convert TensorDescription JSON string Args tensor_desc TensorDescription object Returns Optional str JSON string representation None tensor_desc None None result = element cls _enum_to_json tensor_desc element layout cls _enum_to_json tensor_desc layout alignment tensor_desc alignment complex_transform cls _enum_to_json tensor_desc complex_transform json dumps result classmethod functools lru_cache None _json_to_tensor_description cls json_dict Optional str tensor_name Optional str = None - Optional TensorDescription type ignore name-defined noqa F Convert JSON string TensorDescription object Args json_dict JSON string representation tensor_name Name tensor avoid cache same op Returns Optional TensorDescription Reconstructed object None json_dict None None tensor_dict = json loads json_dict cutlass_library DataType cutlass_library library ComplexTransform LayoutType TensorDescription element = cls _json_to_enum tensor_dict element DataType layout = cls _json_to_enum tensor_dict layout LayoutType alignment = tensor_dict alignment complex_transform = cls _json_to_enum tensor_dict complex_transform ComplexTransform TensorDescription element layout alignment complex_transform classmethod functools lru_cache None _enum_to_json cls enum_value Optional Enum - Optional str Convert enum value JSON string Args enum_value Enum value Returns Optional str JSON string representation None enum_value None None result = type enum_value __class__ __name__ name enum_value name json dumps result classmethod functools lru_cache None _json_to_enum cls json_dict Optional str enum_class Any - Optional Enum Convert JSON string enum value Format name EnumName value Args json_dict JSON string representation enum_class Target enum Returns Optional Enum Reconstructed enum value None json_dict None None enum_dict = json loads json_dict enum_class enum_dict name functools lru_cache get_cutlass_operation_serializer - Optional CUTLASSOperationSerializer try_import_cutlass None CUTLASSOperationSerializer