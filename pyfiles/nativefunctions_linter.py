usr bin env python Verify possible round-trip native_functions yaml via ruamel under some configuration Keeping native_functions yaml consistent way allows us run codemods file using ruamel without introducing line noise Note we don t want normalize YAML file would lots spurious lint failures Anything ruamel understands how roundtrip e g whitespace comments OK ruamel bit picky about inconsistent indentation so you will have indent your file properly Also you working changing syntax native_functions yaml you may find you want use some format what ruamel prefers If so OK modify script instead reformatting native_functions yaml -- point simply make sure there some configuration ruamel can round trip YAML prescriptive about __future__ annotations argparse json sys enum Enum io StringIO typing NamedTuple ruamel yaml type ignore LintSeverity str Enum ERROR = error WARNING = warning ADVICE = advice DISABLED = disabled LintMessage NamedTuple path str &#124; None line int &#124; None char int &#124; None code str severity LintSeverity name str original str &#124; None replacement str &#124; None description str &#124; None __name__ == __main__ parser = argparse ArgumentParser description= native functions linter fromfile_prefix_chars= parser add_argument -- native-functions-yml required=True help= location native_functions yaml args = parser parse_args open args native_functions_yml f contents = f read yaml = ruamel yaml YAML type ignore attr-defined yaml preserve_quotes = True type ignore assignment yaml width = type ignore assignment yaml boolean_representation = False True type ignore attr-defined try r = yaml load contents except Exception err msg = LintMessage path=None line=None char=None code= NATIVEFUNCTIONS severity=LintSeverity ERROR name= YAML load failure original=None replacement=None description=f Failed due err __class__ __name__ \n err print json dumps msg _asdict flush=True sys exit Cuz ruamel s author intentionally didn t include conversion string https stackoverflow com questions best-way-to-use-ruamel-yaml-to-dump-to-string-not-to-stream string_stream = StringIO yaml dump r string_stream new_contents = string_stream getvalue string_stream close contents = new_contents msg = LintMessage path=args native_functions_yml line=None char=None code= NATIVEFUNCTIONS severity=LintSeverity ERROR name= roundtrip inconsistency original=contents replacement=new_contents description= YAML roundtrip failed run ` lintrunner -- take NATIVEFUNCTIONS -a ` apply suggested changes If you think error please see tools linter adapters nativefunctions_linter py print json dumps msg _asdict flush=True