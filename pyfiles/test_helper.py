Owner s module dynamo Test functions fftpack helper module Copied fftpack helper Pearu Peterson October torch testing _internal common_utils run_tests TEST_WITH_TORCHDYNAMO TestCase TEST_WITH_TORCHDYNAMO numpy np numpy fft pi numpy testing assert_array_almost_equal torch _numpy np torch _numpy fft pi torch _numpy testing assert_array_almost_equal TestFFTShift TestCase test_definition x = - - - - y = - - - - assert_array_almost_equal fft fftshift x y assert_array_almost_equal fft ifftshift y x x = - - - - - y = - - - - - assert_array_almost_equal fft fftshift x y assert_array_almost_equal fft ifftshift y x test_inverse n x = np random random n assert_array_almost_equal fft ifftshift fft fftshift x x test_axes_keyword freqs = - - - - shifted = - - - - assert_array_almost_equal fft fftshift freqs axes= shifted assert_array_almost_equal fft fftshift freqs axes= fft fftshift freqs axes= assert_array_almost_equal fft ifftshift shifted axes= freqs assert_array_almost_equal fft ifftshift shifted axes= fft ifftshift shifted axes= assert_array_almost_equal fft fftshift freqs shifted assert_array_almost_equal fft ifftshift shifted freqs test_uneven_dims Test D input which has uneven dimension sizes freqs = shift dimension shift_dim = assert_array_almost_equal fft fftshift freqs axes= shift_dim assert_array_almost_equal fft ifftshift shift_dim axes= freqs assert_array_almost_equal fft fftshift freqs axes= shift_dim assert_array_almost_equal fft ifftshift shift_dim axes= freqs shift dimension shift_dim = assert_array_almost_equal fft fftshift freqs axes= shift_dim assert_array_almost_equal fft ifftshift shift_dim axes= freqs shift both dimensions shift_dim_both = assert_array_almost_equal fft fftshift freqs axes= shift_dim_both assert_array_almost_equal fft ifftshift shift_dim_both axes= freqs assert_array_almost_equal fft fftshift freqs axes= shift_dim_both assert_array_almost_equal fft ifftshift shift_dim_both axes= freqs axes=None default shift all dimensions assert_array_almost_equal fft fftshift freqs axes=None shift_dim_both assert_array_almost_equal fft ifftshift shift_dim_both axes=None freqs assert_array_almost_equal fft fftshift freqs shift_dim_both assert_array_almost_equal fft ifftshift shift_dim_both freqs test_equal_to_original Test new =v implementation see equal original =v TEST_WITH_TORCHDYNAMO numpy arange asarray concatenate take torch _numpy arange asarray concatenate take original_fftshift x axes=None How fftshift implemented v tmp = asarray x ndim = tmp ndim axes None axes = list range ndim isinstance axes int axes = axes y = tmp k axes n = tmp shape k p = n + mylist = concatenate arange p n arange p y = take y mylist k y original_ifftshift x axes=None How ifftshift implemented v tmp = asarray x ndim = tmp ndim axes None axes = list range ndim isinstance axes int axes = axes y = tmp k axes n = tmp shape k p = n - n + mylist = concatenate arange p n arange p y = take y mylist k y create possible d array combinations try all possible keywords compare output original functions i range j range axes_keyword None inp = np random rand i j assert_array_almost_equal fft fftshift inp axes_keyword original_fftshift inp axes_keyword assert_array_almost_equal fft ifftshift inp axes_keyword original_ifftshift inp axes_keyword TestFFTFreq TestCase test_definition x = - - - - assert_array_almost_equal fft fftfreq x assert_array_almost_equal pi fft fftfreq pi x x = - - - - - assert_array_almost_equal fft fftfreq x assert_array_almost_equal pi fft fftfreq pi x TestRFFTFreq TestCase test_definition x = assert_array_almost_equal fft rfftfreq x assert_array_almost_equal pi fft rfftfreq pi x x = assert_array_almost_equal fft rfftfreq x assert_array_almost_equal pi fft rfftfreq pi x TestIRFFTN TestCase test_not_last_axis_success ar ai = np random random = ar + j ai axes = - Should raise error fft irfftn axes=axes __name__ == __main__ run_tests