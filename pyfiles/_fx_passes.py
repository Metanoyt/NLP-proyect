__future__ annotations torch torch export torch fx torch onnx _internal exporter _decomp _registration torch onnx _internal fx passes decompose_with_registry exported_program torch export ExportedProgram registry _registration ONNXRegistry - torch export ExportedProgram Decompose exported program given registry This function needed so shows clearly profiler results onnx_registered_ops = set _decomp get_onnx_implemented_overloads registry decomp_table = _decomp create_onnx_friendly_decomposition_table onnx_registered_ops exported_program run_decompositions decomp_table insert_type_promotion_nodes graph_module torch fx GraphModule - None Inplace pass insert explicit type promotion nodes recursively through nested modules module graph_module modules assert isinstance module torch fx GraphModule passes InsertTypePromotion module run remove_assertion_nodes graph_module torch fx GraphModule - torch fx GraphModule Remove all assertion check nodes FX graph aten_assertion_targets = torch ops aten sym_constrain_range_for_size default torch ops aten _assert_async default torch ops aten _assert_async msg torch ops aten _assert_scalar default torch ops aten _assert_tensor_metadata default gm graph_module modules node gm graph nodes type ignore union-attr node op == call_function node target aten_assertion_targets gm graph erase_node node type ignore operator union-attr gm recompile type ignore operator graph_module