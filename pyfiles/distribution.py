mypy allow-untyped-defs warnings typing Optional typing_extensions deprecated torch torch Tensor torch distributions constraints torch distributions utils lazy_property torch types _size __all__ = Distribution Distribution r Distribution abstract base probability distributions Args batch_shape torch Size The shape over which parameters batched event_shape torch Size The shape single sample without batching validate_args bool optional Whether validate arguments Default None has_rsample = False has_enumerate_support = False _validate_args = __debug__ staticmethod set_default_validate_args value bool - None Sets whether validation enabled disabled The default behavior mimics Python s ` ` assert ` ` statement validation default disabled Python run optimized mode via ` ` python -O ` ` Validation may expensive so you may want disable once model working Args value bool Whether enable validation value True False raise ValueError Distribution _validate_args = value __init__ batch_shape torch Size = torch Size event_shape torch Size = torch Size validate_args Optional bool = None - None _batch_shape = batch_shape _event_shape = event_shape validate_args None _validate_args = validate_args _validate_args try arg_constraints = arg_constraints except NotImplementedError arg_constraints = warnings warn f __class__ does define ` arg_constraints ` + Please set ` arg_constraints = ` initialize distribution + ` validate_args=False ` turn off validation stacklevel= param constraint arg_constraints items constraints is_dependent constraint continue skip constraints cannot checked param __dict__ isinstance getattr type param lazy_property continue skip checking lazily-constructed args value = getattr param valid = constraint check value torch _is_all_true valid raise ValueError f Expected parameter param f type value __name__ shape tuple value shape f distribution repr f satisfy constraint repr constraint f found invalid values \n value super __init__ expand batch_shape _size _instance=None Returns new distribution instance populates existing instance provided derived batch dimensions expanded ` batch_shape ` This method calls ` ~torch Tensor expand ` distribution s parameters As such does allocate new memory expanded distribution instance Additionally does repeat any args checking parameter broadcasting ` __init__ py ` when instance first created Args batch_shape torch Size desired expanded size _instance new instance provided subclasses need override ` expand ` Returns New distribution instance batch dimensions expanded ` batch_size ` raise NotImplementedError property batch_shape - torch Size Returns shape over which parameters batched _batch_shape property event_shape - torch Size Returns shape single sample without batching _event_shape property arg_constraints - dict str constraints Constraint Returns dictionary argument names ` ~torch distributions constraints Constraint ` objects should satisfied each argument distribution Args tensors need appear dict raise NotImplementedError property support - Optional constraints Constraint Returns ` ~torch distributions constraints Constraint ` object representing distribution s support raise NotImplementedError property mean - Tensor Returns mean distribution raise NotImplementedError property mode - Tensor Returns mode distribution raise NotImplementedError f __class__ does implement mode property variance - Tensor Returns variance distribution raise NotImplementedError property stddev - Tensor Returns standard deviation distribution variance sqrt sample sample_shape _size = torch Size - Tensor Generates sample_shape shaped sample sample_shape shaped batch samples distribution parameters batched torch no_grad rsample sample_shape rsample sample_shape _size = torch Size - Tensor Generates sample_shape shaped reparameterized sample sample_shape shaped batch reparameterized samples distribution parameters batched raise NotImplementedError deprecated ` sample_n n ` will deprecated Use ` sample n ` instead category=FutureWarning sample_n n int - Tensor Generates n samples n batches samples distribution parameters batched sample torch Size n log_prob value Tensor - Tensor Returns log probability density mass function evaluated ` value ` Args value Tensor raise NotImplementedError cdf value Tensor - Tensor Returns cumulative density mass function evaluated ` value ` Args value Tensor raise NotImplementedError icdf value Tensor - Tensor Returns inverse cumulative density mass function evaluated ` value ` Args value Tensor raise NotImplementedError enumerate_support expand bool = True - Tensor Returns tensor containing all values supported discrete distribution The result will enumerate over dimension so shape result will ` cardinality + batch_shape + event_shape ` where ` event_shape = ` univariate distributions Note enumerates over all batched tensors lock-step ` ` With ` expand=False ` enumeration happens along dim remaining batch dimensions being singleton dimensions ` ` To iterate over full Cartesian product use ` itertools product m enumerate_support ` Args expand bool whether expand support over batch dims match distribution s ` batch_shape ` Returns Tensor iterating over dimension raise NotImplementedError entropy - Tensor Returns entropy distribution batched over batch_shape Returns Tensor shape batch_shape raise NotImplementedError perplexity - Tensor Returns perplexity distribution batched over batch_shape Returns Tensor shape batch_shape torch exp entropy _extended_shape sample_shape _size = torch Size - torch Size Returns size sample returned distribution given ` sample_shape ` Note batch event shapes distribution instance fixed time construction If empty returned shape upcast Args sample_shape torch Size size sample drawn isinstance sample_shape torch Size sample_shape = torch Size sample_shape torch Size sample_shape + _batch_shape + _event_shape _validate_sample value Tensor - None Argument validation distribution methods such ` log_prob ` ` cdf ` ` icdf ` The rightmost dimensions value scored via these methods must agree distribution s batch event shapes Args value Tensor tensor whose log probability computed ` log_prob ` method Raises ValueError when rightmost dimensions ` value ` do match distribution s batch event shapes isinstance value torch Tensor raise ValueError The value argument log_prob must Tensor event_dim_start = len value size - len _event_shape value size event_dim_start = _event_shape raise ValueError f The right-most size value must match event_shape value size vs _event_shape actual_shape = value size expected_shape = _batch_shape + _event_shape i j zip reversed actual_shape reversed expected_shape i = j = i = j raise ValueError f Value broadcastable batch_shape+event_shape actual_shape vs expected_shape try support = support except NotImplementedError warnings warn f __class__ does define ` support ` enable + sample validation Please initialize distribution + ` validate_args=False ` turn off validation stacklevel= assert support None valid = support check value torch _is_all_true valid raise ValueError Expected value argument f type value __name__ shape tuple value shape f within support repr support f distribution repr f found invalid values \n value _get_checked_instance cls _instance=None _instance None type __init__ = cls __init__ raise NotImplementedError f Subclass __class__ __name__ cls __name__ defines custom __init__ method must also define custom expand method __new__ type _instance None _instance __repr__ - str param_names = k k _ arg_constraints items k __dict__ args_string = join f p __dict__ p __dict__ p numel == __dict__ p size p param_names __class__ __name__ + + args_string +