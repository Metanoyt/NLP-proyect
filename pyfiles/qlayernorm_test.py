operator_benchmark op_bench torch Microbenchmarks quantized layernorm operator layernorm_configs_short = op_bench cross_product_configs dims= dtype= torch qint tags= short QLayerNormBenchmark op_bench TorchBenchmarkBase init dims dtype X = torch rand dims - scale = zero_point = qX = torch quantize_per_tensor X scale=scale zero_point=zero_point dtype=dtype inputs = qX qX weight torch rand qX size dtype=torch float bias torch rand qX size dtype=torch float eps e- Y_scale Y_zero_point forward qX weight bias eps float Y_scale float Y_zero_point int torch ops quantized layer_norm qX qX size weight=weight bias=bias eps=eps output_scale=Y_scale output_zero_point=Y_zero_point op_bench generate_pt_test layernorm_configs_short QLayerNormBenchmark __name__ == __main__ op_bench benchmark_runner main