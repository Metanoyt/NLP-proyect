__future__ annotations argparse json logging shutil subprocess sys time enum Enum typing NamedTuple LINTER_CODE = SHELLCHECK LintSeverity str Enum ERROR = error WARNING = warning ADVICE = advice DISABLED = disabled LintMessage NamedTuple path str &#124; None line int &#124; None char int &#124; None code str severity LintSeverity name str original str &#124; None replacement str &#124; None description str &#124; None run_command args list str - subprocess CompletedProcess bytes logging debug $ s join args start_time = time monotonic try subprocess run args capture_output=True finally end_time = time monotonic logging debug took dms end_time - start_time check_files files list str - list LintMessage try proc = run_command shellcheck -- external-sources -- format=json + files except OSError err LintMessage path=None line=None char=None code=LINTER_CODE severity=LintSeverity ERROR name= command-failed original=None replacement=None description= f Failed due err __class__ __name__ \n err stdout = str proc stdout utf- strip results = json loads stdout comments LintMessage path=result file name=f SC result code description=result message line=result line char=result column code=LINTER_CODE severity=LintSeverity ERROR original=None replacement=None result results __name__ == __main__ parser = argparse ArgumentParser description= shellcheck runner fromfile_prefix_chars= parser add_argument filenames nargs= + help= paths lint shutil which shellcheck None err_msg = LintMessage path= none line=None char=None code=LINTER_CODE severity=LintSeverity ERROR name= command-failed original=None replacement=None description= shellcheck installed did you forget run ` lintrunner init ` print json dumps err_msg _asdict flush=True sys exit args = parser parse_args lint_messages = check_files args filenames lint_message lint_messages print json dumps lint_message _asdict flush=True