mypy allow-untyped-defs warnings base_scheduler BaseScheduler __all__ = CubicSL _clamp x lo hi max lo min hi x CubicSL BaseScheduler r Sets sparsity level each parameter group final sl plus given exponential function math s_i = s_f + s_ - s_f \cdot \left - \frac t - t_ n\Delta t \right ^ where math ` s_i ` sparsity epoch math ` t ` math ` s_f ` final sparsity level math ` f i ` function applied current epoch math ` t ` initial epoch math ` t_ ` final epoch math ` t_f ` math ` \Delta t ` used control how often update sparsity level happens By default Args sparsifier BaseSparsifier Wrapped sparsifier init_sl int list Initial level sparsity init_t int list Initial step when pruning starts delta_t int list Pruning frequency total_t int list Total number pruning steps initially_zero bool list If True sets level sparsity before init_t math ` t_ ` Otherwise sparsity level before init_t math ` t_ ` set init_sl math ` s_ ` last_epoch int The index last epoch Default - verbose bool If ` ` True ` ` prints message stdout each update Default ` ` False ` ` __init__ sparsifier init_sl= init_t= delta_t= total_t= initially_zero=False last_epoch=- verbose=False sparsifier = sparsifier init_sl = _make_sure_a_list init_sl init_t = _make_sure_a_list init_t delta_t = _make_sure_a_list delta_t total_t = _make_sure_a_list total_t initially_zero = _make_sure_a_list initially_zero super __init__ sparsifier last_epoch verbose staticmethod sparsity_compute_fn s_ s_f t t_ dt n initially_zero=False r Computes current level sparsity Based https arxiv org pdf pdf Args s_ Initial level sparsity math ` s_i ` s_f Target level sparsity math ` s_f ` t Current step math ` t ` t_ Initial step math ` t_ ` dt Pruning frequency math ` \Delta T ` n Pruning steps math ` n ` initially_zero Sets level sparsity before t_ If False sets s_ Returns The sparsity level math ` s_t ` current step math ` t ` initially_zero t t_ s_t = s_f + s_ - s_f - t - t_ dt n s_t = _clamp s_t s_ s_f s_t get_sl _get_sl_called_within_step warnings warn To get last sparsity level computed scheduler please use ` get_last_sl ` stacklevel= sparsity_compute_fn s_ =initial_sparsity s_f=final_sparsity t=self last_epoch t_ =initial_epoch dt=delta_epoch n=interval_epochs initially_zero=initially_zero initial_sparsity final_sparsity initial_epoch delta_epoch interval_epochs initially_zero zip init_sl base_sl init_t delta_t total_t initially_zero