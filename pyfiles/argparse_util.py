usr bin env python mypy allow-untyped-defs Copyright c Facebook Inc its affiliates All rights reserved This source code licensed under BSD-style license found LICENSE file root directory source tree os argparse Action env Action Get argument values ` ` PET_ dest ` ` before defaulting given ` ` default ` ` value For flags e g ` ` -- standalone ` ` use ` ` check_env ` ` instead note when multiple option strings specified ` ` dest ` ` longest option string e g ` ` -f -- foo ` ` env var set ` ` PET_FOO ` ` ` ` PET_F ` ` Example parser add_argument -f -- foo action=env default= bar program - args foo= bar program -f baz - args foo= baz program -- foo baz - args foo= baz PET_FOO= env_bar program -f baz - args foo= baz PET_FOO= env_bar program -- foo baz - args foo= baz PET_FOO= env_bar program - args foo= env_bar parser add_argument -f -- foo action=env required=True program - fails program -f baz - args foo= baz PET_FOO= env_bar program - args foo= env_bar PET_FOO= env_bar program -f baz - args foo= baz __init__ dest default=None required=False kwargs - None env_name = f PET_ dest upper default = os environ get env_name default ` ` required ` ` means NEEDS present command-line args rather than option requires value either set explicitly default so we found default then we don t require command-line so set False default required = False super __init__ dest=dest default=default required=required kwargs __call__ parser namespace values option_string=None setattr namespace dest values check_env Action Check whether env var ` ` PET_ dest ` ` exists before defaulting given ` ` default ` ` value Equivalent ` ` store_true ` ` argparse built-in action except argument can omitted commandline env var present has non-zero value note redundant pass ` ` default=True ` ` arguments use action because flag should ` ` True ` ` when present ` ` False ` ` otherwise Example parser add_argument -- verbose action=check_env program - args verbose=False program -- verbose - args verbose=True PET_VERBOSE= program - args verbose=True PET_VERBOSE= program - args verbose=False PET_VERBOSE= program -- verbose - args verbose=True Anti-pattern don t do parser add_argument -- verbose action=check_env default=True program - args verbose=True program -- verbose - args verbose=True PET_VERBOSE= program - args verbose=True PET_VERBOSE= program - args verbose=False __init__ dest default=False kwargs - None env_name = f PET_ dest upper default = bool int os environ get env_name default super __init__ dest=dest const=True default=default nargs= kwargs __call__ parser namespace values option_string=None setattr namespace dest const