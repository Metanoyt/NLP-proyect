collections abc Callable typing Any Optional fake_impl FakeImplHolder utils RegistrationHandle __all__ = SimpleLibraryRegistry SimpleOperatorEntry singleton SimpleLibraryRegistry Registry simple torch library APIs The simple torch library APIs higher-level API top raw PyTorch DispatchKey registration APIs includes - fake impl Registrations these APIs do go into PyTorch dispatcher s table because they may directly involve DispatchKey For example fake impl Python function gets invoked FakeTensor Instead we manage them here SimpleLibraryRegistry mapping fully qualified operator name including overload SimpleOperatorEntry __init__ - None _data dict str SimpleOperatorEntry = find qualname str - SimpleOperatorEntry res = _data get qualname None res None _data qualname = res = SimpleOperatorEntry qualname res singleton SimpleLibraryRegistry = SimpleLibraryRegistry SimpleOperatorEntry This operator overload The fields SimpleOperatorEntry Holders where kernels can registered __init__ qualname str - None qualname str = qualname fake_impl FakeImplHolder = FakeImplHolder qualname torch_dispatch_rules GenericTorchDispatchRuleHolder = GenericTorchDispatchRuleHolder qualname For compatibility reasons We can delete soon property abstract_impl - FakeImplHolder fake_impl GenericTorchDispatchRuleHolder __init__ qualname str - None _data dict type Callable Any = qualname str = qualname register torch_dispatch_class type func Callable Any - RegistrationHandle find torch_dispatch_class raise RuntimeError f torch_dispatch_class already has ` __torch_dispatch__ ` rule registered qualname _data torch_dispatch_class = func deregister - None del _data torch_dispatch_class RegistrationHandle deregister find torch_dispatch_class type - Optional Callable Any _data get torch_dispatch_class None find_torch_dispatch_rule op Any torch_dispatch_class type - Optional Callable Any singleton find op __qualname__ torch_dispatch_rules find torch_dispatch_class