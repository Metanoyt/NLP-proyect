operator_benchmark op_bench torch torch nn functional F Microbenchmarks batchnorm operator Benchmark cudnn available torch backends cudnn is_available cudnn_benchmark_configs configs result = config configs is_cuda = any cuda attr values attr config is_cuda result append config dict cudnn=True result append config dict cudnn=False result cudnn_benchmark_configs configs config dict cudnn=False config configs batchnorm_configs_short = cudnn_benchmark_configs op_bench config_list attr_names= M N K attrs= cross_product_configs= device cpu cuda training True False tags= short batchnorm_configs_long = cudnn_benchmark_configs op_bench cross_product_configs M= N= K= device= cpu cuda training= True False tags= long BatchNormBenchmark op_bench TorchBenchmarkBase init M N K device training cudnn inputs = input_one torch rand M N K device=device requires_grad=self auto_set mean torch rand N device=device var torch rand N device=device weight torch rand N device=device bias torch rand N device=device training training cudnn cudnn set_module_name batchnorm forward input_one mean var weight bias training cudnn torch backends cudnn flags enabled=cudnn F batch_norm input_one mean var weight bias training op_bench generate_pt_test batchnorm_configs_short + batchnorm_configs_long BatchNormBenchmark op_bench generate_pt_gradient_test batchnorm_configs_short + batchnorm_configs_long BatchNormBenchmark batchnorm d_configs_short = cudnn_benchmark_configs op_bench config_list attr_names= N C attrs= cross_product_configs= device cpu cuda training True False tags= short batchnorm d_configs_long = cudnn_benchmark_configs op_bench cross_product_configs N= C= device= cpu cuda training= True False tags= long BatchNorm dBenchmark op_bench TorchBenchmarkBase init N C device training cudnn inputs = input_one torch rand N C device=device requires_grad=self auto_set mean torch rand C device=device var torch rand C device=device weight torch rand C device=device bias torch rand C device=device training training cudnn cudnn set_module_name batchnorm forward input_one mean var weight bias training cudnn torch backends cudnn flags enabled=cudnn F batch_norm input_one mean var weight bias training op_bench generate_pt_test batchnorm d_configs_short + batchnorm d_configs_long BatchNorm dBenchmark op_bench generate_pt_gradient_test batchnorm d_configs_short + batchnorm d_configs_long BatchNorm dBenchmark __name__ == __main__ op_bench benchmark_runner main