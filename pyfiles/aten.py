__future__ annotations typing Any TYPE_CHECKING torch _inductor config inductor_config kernel bmm aten_baddbmm aten_bmm aten_bmm_dtype kernel mm aten__fp _mm aten__int_mm aten_addmm aten_bias_addmm aten_mm aten_mm_dtype kernel mm_plus_mm aten_mm_plus_mm base TemplateConfigHeuristics gemm GemmMaxAutotuneTemplateConfigHeuristics registry register_template_heuristic TYPE_CHECKING collections abc Generator kernel_inputs KernelInputs These all labeled device type None indicate they valid all device types register_template_heuristic aten_mm uid None register_template_heuristic aten_mm_dtype uid cuda register_template_heuristic aten__fp _mm uid None register_template_heuristic aten__int_mm uid None register_template_heuristic aten_bmm uid None register_template_heuristic aten_mm_plus_mm uid None bmm dtype only valid cuda register_template_heuristic aten_bmm_dtype uid cuda ATenConfigHeuristics TemplateConfigHeuristics Pseudo heuristic make ATen choices go through same flow other templates This single choice without kwargs If you want use ATen choice has kwargs just subclass _get_template_configs_impl kernel_inputs KernelInputs op_name str - Generator dict str Any None None yield dict None here indicates valid all device types op Note None op takes precedence over device_type None register_template_heuristic aten_addmm uid None op_name= addmm register_template_heuristic aten_baddbmm uid None op_name= baddbmm ATenAddMMConfigHeuristics ATenConfigHeuristics get_extra_kwargs kernel_inputs KernelInputs op_name str - dict str Any kwargs = super get_extra_kwargs kernel_inputs op_name alpha = kernel_inputs get_scalar alpha beta = kernel_inputs get_scalar beta kwargs alpha alpha beta beta register_template_heuristic aten_bias_addmm uid None op_name= addmm ATenBiasAddMMConfigHeuristics ATenAddMMConfigHeuristics GemmMaxAutotuneTemplateConfigHeuristics _get_template_configs_impl kernel_inputs KernelInputs op_name str - Generator dict str Any None None nodes = kernel_inputs nodes addmm bias first input bias = nodes bias get_stride == inductor_config triton autotune_cublasLt yield dict