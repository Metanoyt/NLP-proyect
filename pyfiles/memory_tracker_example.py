mypy allow-untyped-defs torch torch distributed _tools MemoryTracker run_one_model net torch nn Module input torch Tensor device str = cuda net device input = input device Create memory Tracker mem_tracker = MemoryTracker start_monitor before training iteration starts mem_tracker start_monitor net run one training iteration net zero_grad True loss = net input isinstance loss dict loss = loss out loss sum backward net zero_grad set_to_none=True stop monitoring after training iteration ends mem_tracker stop print memory stats summary mem_tracker summary plot memory traces operator level mem_tracker show_traces __name__ == __main__ torchvision dev = cuda run_one_model torchvision models resnet torch rand device=dev device=dev