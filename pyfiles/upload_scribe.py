Scribe Uploader Pytorch Benchmark Data Currently supports data pytest-benchmark format can extended New fields can added just modifying schema file schema checking only here encourage reusing existing fields avoiding typos argparse json os subprocess time collections defaultdict requests ScribeUploader __init__ category category = category format_message field_dict assert time field_dict Missing required Scribe field time message = defaultdict dict field value field_dict items field schema normal message normal field = str value field schema int message int field = int value field schema float message float field = float value raise ValueError f Field field currently used intentional about adding new fields message _upload_intern messages m messages json_str = json dumps m cmd = scribe_cat category json_str subprocess run cmd upload messages os environ get SCRIBE_INTERN _upload_intern messages access_token = os environ get SCRIBE_GRAPHQL_ACCESS_TOKEN access_token raise ValueError Can t find access token environment variable url = https graph facebook com scribe_logs lint-ignore r = requests post url data= access_token access_token logs json dumps category category message json dumps message line_escape False message messages print r text r raise_for_status PytorchBenchmarkUploader ScribeUploader __init__ super __init__ perfpipe_pytorch_benchmarks schema = int time rounds normal benchmark_group benchmark_name benchmark_executor benchmark_fuser benchmark_class benchmark_time pytorch_commit_id pytorch_branch pytorch_commit_time pytorch_version pytorch_git_dirty machine_kernel machine_processor machine_hostname circle_build_num circle_project_reponame float stddev min median max mean post_pytest_benchmarks pytest_json machine_info = pytest_json machine_info commit_info = pytest_json commit_info upload_time = int time time messages = b pytest_json benchmarks test = b name split net_name = b params net_name benchmark_name = f test net_name executor = b params executor fuser = b params fuser m = format_message time upload_time benchmark_group b group benchmark_name benchmark_name benchmark_executor executor benchmark_fuser fuser benchmark_class b fullname benchmark_time pytest_json datetime pytorch_commit_id commit_info id pytorch_branch commit_info branch pytorch_commit_time commit_info time pytorch_version None pytorch_git_dirty commit_info dirty machine_kernel machine_info release machine_processor machine_info processor machine_hostname machine_info node circle_build_num os environ get CIRCLE_BUILD_NUM circle_project_reponame os environ get CIRCLE_PROJECT_REPONAME stddev b stats stddev rounds b stats rounds min b stats min median b stats median max b stats max mean b stats mean messages append m upload messages __name__ == __main__ parser = argparse ArgumentParser description=__doc__ parser add_argument -- pytest-bench-json -- pytest_bench_json type=argparse FileType r help= Upload json data formatted pytest-benchmark module args = parser parse_args args pytest_bench_json benchmark_uploader = PytorchBenchmarkUploader json_data = json load args pytest_bench_json benchmark_uploader post_pytest_benchmarks json_data