Owner s module autograd os subprocess unittest torch testing _internal common_utils IS_WINDOWS run_tests slowTest TemporaryFileName TestCase PYTORCH_COLLECT_COVERAGE = bool os environ get PYTORCH_COLLECT_COVERAGE This very simple smoke test functional autograd benchmarking script TestFunctionalAutogradBenchmark TestCase _test_runner model disable_gpu=False Note about windows The temporary file exclusively open process child process allowed open again As simple smoke test we choose now run windows keep code here simple TemporaryFileName out_file cmd = python benchmarks functional_autograd_benchmark functional_autograd_benchmark py IS_WINDOWS cmd = python Only run warmup cmd += -- num-iters Only run vjp task fastest one cmd += -- task-filter vjp Only run specified model cmd += -- model-filter model Output file cmd += -- output out_file disable_gpu cmd += -- gpu - res = subprocess run cmd check=False assertTrue res returncode == Check something written file assertTrue os stat out_file st_size unittest skipIf PYTORCH_COLLECT_COVERAGE Can deadlocks gcov see https github com pytorch pytorch issues test_fast_tasks fast_tasks = resnet ppl_simple_reg ppl_robust_reg wav letter transformer multiheadattn task fast_tasks _test_runner task slowTest unittest skipIf IS_WINDOWS NamedTemporaryFile windows does have all features we need test_slow_tasks slow_tasks = fcn_resnet detr deepspeech voluntarily excluded takes too long run without proper tuning number threads should use task slow_tasks Disable GPU slow test CI GPU don t have enough memory _test_runner task disable_gpu=True __name__ == __main__ run_tests