Program runner utilities PyTorch fuzzer This module handles running testing generated PyTorch programs os random subprocess sys ProgramRunner Runs generated PyTorch programs handles output error reporting __init__ pass run_program program_path Run generated Python program handle output errors Args program_path Path Python program run Returns bool True program ran successfully False otherwise abs_path = os path abspath program_path print f Running abs_path Select random CUDA device available cuda_visible_devices = os environ get CUDA_VISIBLE_DEVICES cuda_visible_devices devices = d strip d cuda_visible_devices split d strip Default all GPUs set try torch num_gpus = torch cuda device_count devices = str i i range num_gpus except ImportError devices = devices selected_device = random choice devices env = os environ copy env CUDA_VISIBLE_DEVICES = selected_device print f Selected CUDA_VISIBLE_DEVICES= selected_device env = None No GPU available torch installed try result = subprocess run sys executable abs_path capture_output=True text=True check=True env=env print === Program Output === print result stdout print result stderr True except subprocess CalledProcessError e print === Program Output Failure === print e stdout print e stderr print =============================== print === Program Source === open abs_path f print f read print ====================== print f Program exited code e returncode sys exit run_and_validate program_path Run program detailed results validation Args program_path Path Python program run Returns dict Dictionary success stdout stderr returncode abs_path = os path abspath program_path Select random CUDA device available cuda_visible_devices = os environ get CUDA_VISIBLE_DEVICES cuda_visible_devices devices = d strip d cuda_visible_devices split d strip try torch num_gpus = torch cuda device_count num_gpus devices = str i i range num_gpus devices = str i i range num_gpus except ImportError devices = devices selected_device = random choice devices env = os environ copy env CUDA_VISIBLE_DEVICES = selected_device print f Selected CUDA_VISIBLE_DEVICES= selected_device env = None try result = subprocess run sys executable abs_path capture_output=True text=True check=True env=env success True stdout result stdout stderr result stderr returncode result returncode except subprocess CalledProcessError e success False stdout e stdout stderr e stderr returncode e returncode