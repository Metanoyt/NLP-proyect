numpy pt configs operator_benchmark op_bench torch Embedding EmbeddingBag Operator Benchmark EmbeddingBagBenchmark op_bench TorchBenchmarkBase init embeddingbags dim mode input_size offset sparse include_last_offset device embedding = torch nn EmbeddingBag num_embeddings=embeddingbags embedding_dim=dim mode=mode include_last_offset=include_last_offset sparse=sparse device=device numpy random seed - offsets = torch LongTensor offset device=device input = torch tensor numpy random randint embeddingbags input_size device=device long inputs = input input offset torch cat offsets torch tensor input size dtype=torch long set_module_name embeddingbag forward input offset embedding input offset op_bench generate_pt_test configs embeddingbag_short_configs EmbeddingBagBenchmark op_bench generate_pt_gradient_test configs embeddingbag_short_configs EmbeddingBagBenchmark EmbeddingBenchmark op_bench TorchBenchmarkBase init num_embeddings embedding_dim input_size device embedding = torch nn Embedding num_embeddings=num_embeddings embedding_dim=embedding_dim device=device numpy random seed - input = torch tensor numpy random randint num_embeddings input_size device=device long inputs = input input set_module_name embedding forward input embedding input op_bench generate_pt_test configs embedding_short_configs EmbeddingBenchmark op_bench generate_pt_gradient_test configs embedding_short_configs EmbeddingBenchmark __name__ == __main__ op_bench benchmark_runner main