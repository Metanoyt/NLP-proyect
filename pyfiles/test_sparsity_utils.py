Owner s module sparse logging torch torch ao pruning sparsifier utils fqn_to_module get_arg_info_from_tensor_fqn module_to_fqn torch testing _internal common_quantization ConvBnReLUModel ConvModel FunctionalLinear LinearAddModel ManualEmbeddingBagLinear SingleLayerLinearModel TwoLayerLinearModel torch testing _internal common_utils raise_on_run_directly TestCase logging basicConfig format= asctime s - name s - levelname s - message s level=logging INFO model_list = ConvModel SingleLayerLinearModel TwoLayerLinearModel LinearAddModel ConvBnReLUModel ManualEmbeddingBagLinear FunctionalLinear TestSparsityUtilFunctions TestCase test_module_to_fqn Tests module_to_fqn works expected when compared known good module get_submodule fqn function model_class model_list model = model_class list_of_modules = m _ m model named_modules + model module list_of_modules fqn = module_to_fqn model module check_module = model get_submodule fqn assertEqual module check_module test_module_to_fqn_fail Tests module_to_fqn returns None when fqn doesn t correspond path node tensor given model_class model_list model = model_class fqn = module_to_fqn model torch nn Linear assertEqual fqn None test_module_to_fqn_root Tests module_to_fqn returns when model target module same model_class model_list model = model_class fqn = module_to_fqn model model assertEqual fqn test_fqn_to_module Tests fqn_to_module operates inverse module_to_fqn model_class model_list model = model_class list_of_modules = m _ m model named_modules + model module list_of_modules fqn = module_to_fqn model module check_module = fqn_to_module model fqn assertEqual module check_module test_fqn_to_module_fail Tests fqn_to_module returns None when tries find fqn module outside model model_class model_list model = model_class fqn = foo bar baz check_module = fqn_to_module model fqn assertEqual check_module None test_fqn_to_module_for_tensors Tests fqn_to_module works tensors actually all parameters model This tested identifying module tensor generating tensor_fqn using module_to_fqn module + name tensor model_class model_list model = model_class list_of_modules = m _ m model named_modules + model module list_of_modules module_fqn = module_to_fqn model module tensor_name tensor module named_parameters recurse=False tensor_fqn = string manip handle tensors root module_fqn + module_fqn = + tensor_name check_tensor = fqn_to_module model tensor_fqn assertEqual tensor check_tensor test_get_arg_info_from_tensor_fqn Tests get_arg_info_from_tensor_fqn works all parameters model Generates tensor_fqn same way test_fqn_to_module_for_tensors then compares known parent module tensor_name well module_fqn module_to_fqn model_class model_list model = model_class list_of_modules = m _ m model named_modules + model module list_of_modules module_fqn = module_to_fqn model module tensor_name _ module named_parameters recurse=False tensor_fqn = module_fqn + module_fqn = + tensor_name arg_info = get_arg_info_from_tensor_fqn model tensor_fqn assertEqual arg_info module module assertEqual arg_info module_fqn module_fqn assertEqual arg_info tensor_name tensor_name assertEqual arg_info tensor_fqn tensor_fqn test_get_arg_info_from_tensor_fqn_fail Tests get_arg_info_from_tensor_fqn works expected invalid tensor_fqn inputs The string outputs still work output module expected None model_class model_list model = model_class tensor_fqn = foo bar baz arg_info = get_arg_info_from_tensor_fqn model tensor_fqn assertEqual arg_info module None assertEqual arg_info module_fqn foo bar assertEqual arg_info tensor_name baz assertEqual arg_info tensor_fqn foo bar baz __name__ == __main__ raise_on_run_directly test test_ao_sparsity py