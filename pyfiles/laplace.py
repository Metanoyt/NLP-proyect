mypy allow-untyped-defs typing Optional Union torch torch Tensor torch distributions constraints torch distributions distribution Distribution torch distributions utils broadcast_all torch types _Number _size __all__ = Laplace Laplace Distribution r Creates Laplace distribution parameterized attr ` loc ` attr ` scale ` Example xdoctest +IGNORE_WANT non-deterministic m = Laplace torch tensor torch tensor m sample Laplace distributed loc= scale= tensor Args loc float Tensor mean distribution scale float Tensor scale distribution pyrefly ignore bad-override arg_constraints = loc constraints real scale constraints positive support = constraints real has_rsample = True property mean - Tensor loc property mode - Tensor loc property variance - Tensor scale pow property stddev - Tensor scale __init__ loc Union Tensor float scale Union Tensor float validate_args Optional bool = None - None loc scale = broadcast_all loc scale isinstance loc _Number isinstance scale _Number batch_shape = torch Size batch_shape = loc size super __init__ batch_shape validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance Laplace _instance batch_shape = torch Size batch_shape new loc = loc expand batch_shape new scale = scale expand batch_shape super Laplace new __init__ batch_shape validate_args=False new _validate_args = _validate_args new rsample sample_shape _size = torch Size - Tensor shape = _extended_shape sample_shape finfo = torch finfo loc dtype torch _C _get_tracing_state JIT WORKAROUND lack support uniform_ u = torch rand shape dtype=self loc dtype device=self loc device - loc - scale u sign torch log p -u abs clamp min=finfo tiny u = loc new shape uniform_ finfo eps - TODO If we ever implement tensor nextafter below what we want ideally u = loc new shape uniform_ loc nextafter - loc - scale u sign torch log p -u abs log_prob value _validate_args _validate_sample value -torch log scale - torch abs value - loc scale cdf value _validate_args _validate_sample value - value - loc sign torch expm - value - loc abs scale icdf value term = value - loc - scale term sign torch log p - term abs entropy + torch log scale