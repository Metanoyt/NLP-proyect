Owner s oncall jit torch torch nn torch testing _internal common_utils TestCase r Test TorchScript exception handling TestException TestCase test_pyop_exception_message Foo torch jit ScriptModule __init__ - None super __init__ conv = nn Conv d kernel_size= torch jit script_method forward x conv x foo = Foo testing correct error message propagates assertRaisesRegex RuntimeError r Expected D \ unbatched\ D \ batched\ input conv d foo torch ones wrong size test_builtin_error_messsage assertRaisesRegex RuntimeError Arguments call valid torch jit script close_match x x masked_fill True assertRaisesRegex RuntimeError This op may exist may currently supported TorchScript torch jit script unknown_op x torch set_anomaly_enabled True x test_exceptions cu = torch jit CompilationUnit foo cond bool cond raise ValueError cu foo torch tensor assertRaisesRegex torch jit Error cu foo torch tensor foo cond = bool cond raise ArbitraryError hi noqa F == raise ArbitraryError noqa F assertRaisesRegex RuntimeError undefined value ArbitraryError torch jit script foo exception_as_value = Exception print assertRaisesRegex RuntimeError cannot used value torch jit script exception_as_value torch jit script foo_no_decl_always_throws raise RuntimeError Hi function has no declared type always throws set None output_type = next foo_no_decl_always_throws graph outputs type assertTrue str output_type == NoneType torch jit script foo_decl_always_throws type - Tensor raise Exception Hi noqa TRY output_type = next foo_decl_always_throws graph outputs type assertTrue str output_type == Tensor foo raise + assertRaisesRegex RuntimeError must derive BaseException torch jit script foo escapes scope torch jit script foo == = == raise Exception Hi noqa TRY raise Exception Hi noqa TRY assertEqual foo torch jit script tuple_fn raise RuntimeError hello goodbye assertRaisesRegex torch jit Error hello goodbye tuple_fn torch jit script no_message raise RuntimeError assertRaisesRegex torch jit Error RuntimeError no_message test_assertions cu = torch jit CompilationUnit foo cond assert bool cond hi cu foo torch tensor assertRaisesRegex torch jit Error AssertionError hi cu foo torch tensor torch jit script foo cond assert bool cond hi foo torch tensor we don t currently validate name exception assertRaisesRegex torch jit Error AssertionError hi foo torch tensor test_python_op_exception torch jit ignore python_op x raise Exception bad noqa TRY torch jit script fn x python_op x assertRaisesRegex RuntimeError operation failed TorchScript interpreter fn torch tensor test_dict_expansion_raises_error fn d = foo bar baz d assertRaisesRegex torch jit frontend NotSupportedError Dict expansion torch jit script fn test_custom_python_exception MyValueError ValueError pass torch jit script fn raise MyValueError test custom exception assertRaisesRegex torch jit Error jit test_exception MyValueError test custom exception fn test_custom_python_exception_defined_elsewhere jit myexception MyKeyError torch jit script fn raise MyKeyError This user defined key error assertRaisesRegex torch jit Error jit myexception MyKeyError This user defined key error fn __name__ == __main__ raise RuntimeError This test currently used should enabled discover_tests py required