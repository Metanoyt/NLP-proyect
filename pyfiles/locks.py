Lock acquisition utilities caching system timeout support This module provides safe unsafe lock acquisition functions both threading Lock FileLock objects configurable timeout behaviors It supports three timeout modes blocking infinite wait non-blocking immediate blocking timeout finite wait The module offers both context manager manual acquisition patterns - Safe acquisition Uses context managers automatically handle lock release - Unsafe acquisition Manual acquisition requires explicit release caller __future__ annotations contextlib _GeneratorContextManager contextmanager ExitStack typing Generator TYPE_CHECKING typing_extensions Protocol TypeAlias filelock FileLock Timeout exceptions implementations impls TYPE_CHECKING threading Lock _LockContextManager TypeAlias = _GeneratorContextManager None None None _LockProtocol Protocol noqa PYI __call__ timeout float &#124; None = None - _LockContextManager Infinite timeout - blocks indefinitely until lock acquired _BLOCKING float = - No timeout - returns immediately lock cannot acquired _NON_BLOCKING float = Finite timeout - blocks specified duration before raising timeout error _BLOCKING_WITH_TIMEOUT float = Default timeout lock acquisition _DEFAULT_TIMEOUT float = _BLOCKING_WITH_TIMEOUT contextmanager _acquire_lock_with_timeout lock Lock timeout float &#124; None = None - Generator None None None Context manager safely acquires threading Lock timeout automatically releases This function provides safe way acquire lock timeout support ensuring lock always released even exception occurs during execution Args lock The threading Lock object acquire timeout Timeout seconds If None uses _DEFAULT_TIMEOUT - Use _BLOCKING - infinite wait - Use _NON_BLOCKING immediate - Use positive value finite timeout Yields None Yields control caller while holding lock Raises LockTimeoutError If lock cannot acquired within timeout period Example _acquire_lock_with_timeout my_lock timeout= Critical section - lock held perform_critical_operation Lock automatically released here _unsafe_acquire_lock_with_timeout lock timeout=timeout try yield finally lock release _unsafe_acquire_lock_with_timeout lock Lock timeout float &#124; None = None - None Acquire threading Lock timeout without automatic release unsafe This function acquires lock timeout support does NOT automatically release The caller responsible releasing lock explicitly Use only when you need manual control over lock lifetime Args lock The threading Lock object acquire timeout Timeout seconds If None uses _DEFAULT_TIMEOUT - Use _BLOCKING - infinite wait - Use _NON_BLOCKING immediate - Use positive value finite timeout Raises LockTimeoutError If lock cannot acquired within timeout period Warning This unsafe function because does automatically release lock Always call lock release when done preferably try finally block use safe _acquire_lock_with_timeout context manager instead Example lock = Lock try _unsafe_acquire_lock_with_timeout lock timeout= Critical section - lock held perform_critical_operation finally lock release Must manually release _timeout float = timeout timeout None _DEFAULT_TIMEOUT lock acquire timeout=_timeout raise exceptions LockTimeoutError lock _timeout contextmanager _acquire_flock_with_timeout flock FileLock timeout float &#124; None = None - Generator None None None Context manager safely acquires FileLock timeout automatically releases This function provides safe way acquire file lock timeout support ensuring lock always released even exception occurs during execution Args flock The FileLock object acquire timeout Timeout seconds If None uses _DEFAULT_TIMEOUT - Use _BLOCKING - infinite wait - Use _NON_BLOCKING immediate - Use positive value finite timeout Yields None Yields control caller while holding file lock Raises FileLockTimeoutError If file lock cannot acquired within timeout period Example flock = FileLock tmp my_process lock _acquire_flock_with_timeout flock timeout= Critical section - file lock held perform_exclusive_file_operation File lock automatically released here _unsafe_acquire_flock_with_timeout flock timeout=timeout try yield finally flock release _unsafe_acquire_flock_with_timeout flock FileLock timeout float &#124; None - None Acquire FileLock timeout without automatic release unsafe This function acquires file lock timeout support does NOT automatically release The caller responsible releasing lock explicitly Use only when you need manual control over lock lifetime Args flock The FileLock object acquire timeout Timeout seconds If None uses _DEFAULT_TIMEOUT - Use _BLOCKING - infinite wait - Use _NON_BLOCKING immediate - Use positive value finite timeout Raises FileLockTimeoutError If file lock cannot acquired within timeout period Warning This unsafe function because does automatically release lock Always call flock release when done preferably try finally block use safe _acquire_flock_with_timeout context manager instead Example flock = FileLock tmp my_process lock try _unsafe_acquire_flock_with_timeout flock timeout= Critical section - file lock held perform_exclusive_file_operation finally flock release Must manually release _timeout float = timeout timeout None _DEFAULT_TIMEOUT try _ = flock acquire timeout=_timeout except Timeout err raise exceptions FileLockTimeoutError flock _timeout err contextmanager _acquire_many_impl_locks_with_timeout impls impls _CacheImpl timeout float &#124; None = None - Generator None None None ExitStack stack impl impls stack enter_context impl lock timeout yield