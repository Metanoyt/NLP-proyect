operator_benchmark op_bench torch Microbenchmarks quantized groupnorm operator groupnorm_configs_short = op_bench cross_product_configs dims= num_groups= dtype= torch qint tags= short QGroupNormBenchmark op_bench TorchBenchmarkBase init dims num_groups dtype X = torch rand dims - num_channels = dims scale = zero_point = inputs = qX torch quantize_per_tensor X scale=scale zero_point=zero_point dtype=dtype num_groups num_groups weight torch rand num_channels dtype=torch float bias torch rand num_channels dtype=torch float eps e- Y_scale Y_zero_point forward qX num_groups int weight bias eps float Y_scale float Y_zero_point int torch ops quantized group_norm qX num_groups weight=weight bias=bias eps=eps output_scale=Y_scale output_zero_point=Y_zero_point op_bench generate_pt_test groupnorm_configs_short QGroupNormBenchmark __name__ == __main__ op_bench benchmark_runner main