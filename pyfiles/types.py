Where should I add new type ` types_base py ` vs ` types py ` This file defines data model classes torchgen typing system well some base types such int _t ` types py ` defines ATen Tensor type some c types along signatures use these types The difference between these two files ` types_base py ` should implementation-agnostic meaning shouldn t contain any type definition tight specific C++ library e g ATen so can easily reused we want generate code another C++ library Add new types ` types py ` these types ATen c related Add new types ` types_base py ` they basic attached ATen c __future__ annotations dataclasses dataclass torchgen api types types_base BaseCppType BaseCType boolT byteT charT CType doubleT floatT int T longT shortT torchgen model BaseTy ScalarType TENSOR_LIST_LIKE_CTYPES = TensorList const c List std optional Tensor const ITensorListRef halfT = BaseCppType Half complexHalfT = BaseCppType c complex c Half stuffing template param here abuse complexFloatT = BaseCppType c complex float complexDoubleT = BaseCppType c complex double bfloat T = BaseCppType BFloat float _e m T = BaseCppType Float _e m float _e m fnuzT = BaseCppType Float _e m fnuz float _e m fnT = BaseCppType Float _e m fn float _e m fnuzT = BaseCppType Float _e m fnuz float _e m fnuT = BaseCppType Float _e m fnu stringT = BaseCppType c string_view generatorT = BaseCppType Generator scalarTypeT = BaseCppType ScalarType tensorT = BaseCppType Tensor optionalTensorRefT = BaseCppType OptionalTensorRef tensorListT = BaseCppType TensorList iTensorListRefT = BaseCppType ITensorListRef iOptTensorListRefT = BaseCppType IOptTensorListRef dimnameT = BaseCppType Dimname dimnameListT = BaseCppType DimnameList dimVectorT = BaseCppType DimVector layoutT = BaseCppType Layout deviceT = BaseCppType Device deviceIndexT = BaseCppType DeviceIndex scalarT = BaseCppType Scalar optionalScalarRefT = BaseCppType OptionalScalarRef memoryFormatT = BaseCppType MemoryFormat qschemeT = BaseCppType QScheme storageT = BaseCppType Storage streamT = BaseCppType Stream intArrayRefT = BaseCppType IntArrayRef optionalIntArrayRefT = BaseCppType OptionalIntArrayRef optionalSymIntArrayRefT = BaseCppType OptionalSymIntArrayRef tensorOptionsT = BaseCppType TensorOptions typeAndSizeT = BaseCppType torch autograd generated TypeAndSize tensorGeometryT = BaseCppType TensorGeometry SymIntT = BaseCppType c SymInt SymBoolT = BaseCppType c SymBool symIntArrayRefT = BaseCppType c SymIntArrayRef Types representing template parameters Technically we probably shouldn t represent them way codegen pretty convenient scalar_t = BaseCppType scalar_t opmath_t = BaseCppType opmath_t ScalarTypeToCppMapping dict ScalarType BaseCppType = ScalarType Byte byteT ScalarType Char charT ScalarType Short shortT ScalarType Int int T ScalarType Long longT ScalarType Half halfT ScalarType Float floatT ScalarType Double doubleT ScalarType ComplexHalf complexHalfT ScalarType ComplexFloat complexFloatT ScalarType ComplexDouble complexDoubleT ScalarType Bool boolT ScalarType Float _e m float _e m T ScalarType Float _e m fnuz float _e m fnuzT ScalarType Float _e m fn float _e m fnT ScalarType Float _e m fnuz float _e m fnuzT ScalarType Float _e m fnu float _e m fnuT BaseTypeToCppMapping dict BaseTy BaseCppType = BaseTy int longT BaseTy float doubleT BaseTy bool boolT BaseTy str stringT BaseTy Generator generatorT BaseTy ScalarType scalarTypeT BaseTy Tensor tensorT BaseTy Dimname dimnameT BaseTy DimVector dimVectorT BaseTy Layout layoutT BaseTy Device deviceT BaseTy DeviceIndex deviceIndexT BaseTy Scalar scalarT BaseTy MemoryFormat memoryFormatT BaseTy QScheme qschemeT BaseTy Storage storageT BaseTy Stream streamT BaseTy SymInt SymIntT BaseTy SymBool SymBoolT CTypes encode C++ type structure needed translation dataclass frozen=True OptionalCType CType elem CType cpp_type strip_ref bool = False - str Do pass ` strip_ref ` recursively f std optional elem cpp_type remove_const_ref - CType OptionalCType elem remove_const_ref dataclass frozen=True ListCType CType elem CType cpp_type strip_ref bool = False - str Do pass ` strip_ref ` recursively f c List elem cpp_type remove_const_ref - CType ListCType elem remove_const_ref dataclass frozen=True ArrayRefCType CType elem CType cpp_type strip_ref bool = False - str Do pass ` strip_ref ` recursively f ArrayRef elem cpp_type remove_const_ref - CType ArrayRefCType elem remove_const_ref dataclass frozen=True VectorizedCType CType This template explicitly specialized so only valid elems those we have specializations e g float double scalar_t also common argument here when we codegen templated context elem BaseCType cpp_type strip_ref bool = False - str f vec Vectorized elem cpp_type remove_const_ref - CType