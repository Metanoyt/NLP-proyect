Owner s module PrivateUse torch torch testing _internal common_utils run_tests TestCase TestAutocast TestCase test_autocast_with_unsupported_type assertWarnsRegex UserWarning In openreg autocast target dtype supported Disabling autocast \n openreg Autocast only supports dtypes torch float torch bfloat currently torch autocast device_type= openreg dtype=torch float _ = torch ones test_autocast_operator_not_supported assertRaisesRegex RuntimeError torch nn functional binary_cross_entropy torch nn BCELoss unsafe autocast x = torch randn device= openreg y = torch randn device= openreg torch autocast device_type= openreg dtype=torch float _ = torch nn functional binary_cross_entropy x y test_autocast_low_precision torch amp autocast device_type= openreg dtype=torch float x = torch randn device= openreg y = torch randn device= openreg result = torch mm x y assertEqual result dtype torch float test_autocast_fp torch amp autocast device_type= openreg x = torch randn device= openreg dtype=torch float result = torch asin x assertEqual result dtype torch float test_autocast_default_dtype openreg_fast_dtype = torch get_autocast_dtype device_type= openreg assertEqual openreg_fast_dtype torch half test_autocast_set_dtype dtype torch float torch bfloat torch set_autocast_dtype openreg dtype assertEqual torch get_autocast_dtype openreg dtype __name__ == __main__ run_tests