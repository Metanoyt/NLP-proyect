usr bin env python Bootstrap Git pre‑push hook isolated virtual environment ✓ Requires uv installed fails available ✓ Creates isolated venv git hooks linter venv hook dependencies ✓ Installs lintrunner only isolated environment ✓ Creates direct git hook bypasses pre-commit Run repo root inside outside any project venv python scripts setup_hooks py IMPORTANT The generated git hook references scripts lintrunner py If users checkout branches don t have file git push will fail No such file directory Users would need either Re-run old setup_hooks py branch Manually delete git hooks pre-push disable hooks temporarily Switch back branch new scripts lintrunner py __future__ annotations shlex shutil subprocess sys pathlib Path Add scripts directory Python path so we can lintrunner module scripts_dir = Path __file__ parent sys path insert str scripts_dir Import shared functions lintrunner module lintrunner find_repo_root get_hook_venv_path Restore sys path avoid affecting other imports sys path pop ─────────────────────────────────────────── Helper utilities ─────────────────────────────────────────── run cmd list str cwd Path = None - None print f $ join cmd subprocess check_call cmd cwd=cwd which cmd str - bool shutil which cmd None ensure_uv - None which uv sys exit \n❌ uv required found your PATH \n Please install uv first using instructions \n https docs astral sh uv getting-started installation \n Then rerun python scripts setup_hooks py\n sys platform startswith win print \n⚠️ Lintrunner supported Windows so there no pre-push hooks add Exiting setup \n sys exit ─────────────────────────────────────────── Setup isolated hook environment ─────────────────────────────────────────── ensure_uv Find repo root setup hook directory repo_root = find_repo_root venv_dir = get_hook_venv_path hooks_dir = venv_dir parent parent Go git hooks linter venv git hooks print f Setting up isolated hook environment venv_dir Create isolated virtual environment hooks venv_dir exists print Removing existing hook venv shutil rmtree venv_dir run uv venv str venv_dir -- python Install lintrunner isolated environment print Installing lintrunner isolated environment run uv pip install -- python str venv_dir bin python lintrunner ─────────────────────────────────────────── Create direct git pre-push hook ─────────────────────────────────────────── pre_push_hook = hooks_dir pre-push python_exe = venv_dir bin python lintrunner_script_path_quoted = shlex quote str repo_root scripts lintrunner py hook_script = f bin bash set -e Check lintrunner script exists user might older commit -f lintrunner_script_path_quoted then echo ⚠️ lintrunner_script_path_quoted found - skipping linting likely older commit exit fi Run lintrunner wrapper using isolated venv s Python shlex quote str python_exe lintrunner_script_path_quoted print f Creating git pre-push hook pre_push_hook pre_push_hook write_text hook_script pre_push_hook chmod o Make executable print \n✅ Isolated hook environment created pre‑push hook active \n Lintrunner will now run automatically every ` git push ` \n f Hook dependencies isolated venv_dir \n