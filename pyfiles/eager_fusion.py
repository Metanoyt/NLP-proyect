time torch torch utils functorch compile aot_function tvm_compile = torch randn requires_grad=True b = torch randn f b sum dim= fw_compiler = tvm_compile target= llvm tuning_logfile= fw_keops bw_compiler = tvm_compile target= llvm tuning_logfile= bw_keops compiled_f = aot_function f fw_compiler bw_compiler fw_compiler = lambda x _ x bw_compiler = lambda x _ x iters = out = compiled_f out sum backward bench func begin = time time _ range iters out = func sin out sum backward grad = None print time time - begin bench_jax jax jax numpy jnp jax_a = jnp array detach numpy jax_b = jnp array b detach numpy f jnp sin jax_b sum axis= sum jit_f = jax jit jax grad f jit_f jax_a begin = time time _ range iters out = jit_f jax_a out block_until_ready print time time - begin bench f bench compiled_f bench_jax