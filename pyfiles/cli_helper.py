Cli Argparser Utility helpers CLI tasks argparse abc ABC abstractmethod try typing Any Callable Required TypedDict Python + except ImportError typing Any Callable TypedDict typing_extensions Required Fallback Python BaseRunner ABC __init__ args Any - None args = args abstractmethod run - None runs main logics required Pretty help keep newlines + show defaults RichHelp argparse ArgumentDefaultsHelpFormatter argparse RawDescriptionHelpFormatter pass TargetSpec TypedDict total=False CLI subcommand specification bA runner Required type BaseRunner help str description str add_arguments Callable argparse ArgumentParser None register_targets parser argparse ArgumentParser target_specs dict str TargetSpec common_args Callable argparse ArgumentParser None = lambda _ None - None Register target subcommands targets = parser add_subparsers dest= target required=True metavar= + join target_specs keys + name spec target_specs items desc = spec get description spec runner __doc__ p = targets add_parser name help=spec get help description=desc strip formatter_class=RichHelp p set_defaults func=lambda args cls=spec runner cls args run _runner_class=spec runner add_arguments spec callable spec add_arguments spec add_arguments p common_args common_args p