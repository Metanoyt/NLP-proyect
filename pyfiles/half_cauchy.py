mypy allow-untyped-defs math typing Optional Union torch torch inf Tensor torch distributions constraints torch distributions cauchy Cauchy torch distributions transformed_distribution TransformedDistribution torch distributions transforms AbsTransform __all__ = HalfCauchy HalfCauchy TransformedDistribution r Creates half-Cauchy distribution parameterized ` scale ` where X ~ Cauchy scale Y = &#124; X &#124; ~ HalfCauchy scale Example xdoctest +IGNORE_WANT non-deterministic m = HalfCauchy torch tensor m sample half-cauchy distributed scale= tensor Args scale float Tensor scale full Cauchy distribution arg_constraints = scale constraints positive pyrefly ignore bad-override support = constraints nonnegative has_rsample = True pyrefly ignore bad-override base_dist Cauchy __init__ scale Union Tensor float validate_args Optional bool = None - None base_dist = Cauchy scale validate_args=False super __init__ base_dist AbsTransform validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance HalfCauchy _instance super expand batch_shape _instance=new property scale - Tensor base_dist scale property mean - Tensor torch full _extended_shape math inf dtype=self scale dtype device=self scale device property mode - Tensor torch zeros_like scale property variance - Tensor base_dist variance log_prob value _validate_args _validate_sample value value = torch as_tensor value dtype=self base_dist scale dtype device=self base_dist scale device log_prob = base_dist log_prob value + math log log_prob = torch where value = log_prob -inf log_prob cdf value _validate_args _validate_sample value base_dist cdf value - icdf prob base_dist icdf prob + entropy base_dist entropy - math log