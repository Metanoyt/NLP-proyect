mypy allow-untyped-defs contextlib contextmanager dispatch dispatch utils hashable _global_logic_variables = set type ignore var-annotated _glv = _global_logic_variables Var Logic Variable _id = __new__ cls token len token == token = f _ Var _id type ignore assignment Var _id += len token == token = token obj = object __new__ cls obj token = token type ignore attr-defined obj __str__ ~ + str token type ignore attr-defined __repr__ = __str__ __eq__ other type type other token == other token type ignore attr-defined __hash__ hash type token type ignore attr-defined var lambda args Var args vars lambda n var i range n dispatch Var isvar v True isvar dispatch object type ignore no-redef isvar o _glv hashable o o _glv contextmanager variables variables Context manager logic variables Example xdoctest +SKIP undefined vars __future__ with_statement variables print isvar True print isvar False Normal approach unification unify x = var x unify x ~x Context Manager approach variables x print unify x x old_global_logic_variables = _global_logic_variables copy _global_logic_variables update set variables try yield finally _global_logic_variables clear _global_logic_variables update old_global_logic_variables