mypy ignore-errors Owner s module unknown token itertools product pathlib Path torch torch testing _internal common_utils instantiate_parametrized_tests parametrize run_tests TestCase MM = BINARY_RETURNS_BOOL = = = == = BINARY_ACCEPTS_FLOAT_OR_INT = + - BINARY_ACCEPTS_INT_ONLY = ^ &#124; BINARY_OPS = BINARY_RETURNS_BOOL BINARY_ACCEPTS_FLOAT_OR_INT BINARY_ACCEPTS_INT_ONLY MM BINARY_RETURNS_FLOAT = UNARY_ACCEPTS_FLOAT_OR_INT = + - UNARY_ACCEPTS_INT_ONLY = ~ UNARY_OPS = UNARY_ACCEPTS_FLOAT_OR_INT UNARY_ACCEPTS_INT_ONLY PUNCTUATION = OPERATORS = UNARY_OPS BINARY_OPS PUNCTUATION FLOATS = torch tensor INTS = torch tensor ALL = FLOATS INTS TYPE_TEST_FILE = Path __file__ parent pass arithmetic_ops py TestPythonOperators TestCase Prove UNARY_OPS BINARY_OPS OPERATORS correct complete test_operators_are_correct_and_complete assertFalse set OPERATORS difference token EXACT_TOKEN_TYPES unary binary punctuation = op token EXACT_TOKEN_TYPES op PUNCTUATION punctuation op = True try unary op = compile f op op op single except SyntaxError pass try binary op = compile f op op b op single except SyntaxError pass assertEqual sorted unary sorted UNARY_OPS assertEqual sorted binary sorted BINARY_OPS assertEqual sorted punctuation sorted PUNCTUATION test_type_tests_are_complete binary unary = TYPE_TEST_FILE open fp Looking lines like assert_type TENSOR ^ BOOL Tensor But assert_type BOOL ^ BINARY Binary lines = i i fp TENSOR i line lines expr = line partition assert_type partition expr isalpha formats differently all other operators op b = expr replace split binary setdefault op append b unary append expr assertEqual sorted unary sorted UNARY_OPS assertEqual sorted binary sorted BINARY_OPS value values = binary values assertEqual values value len values parametrize op b product ALL BINARY_OPS ALL test_binary op b try r = eval f op b except Exception e r = e any_tensor = isinstance torch Tensor isinstance b torch Tensor any_float = _any_float b returns_float = any_float op BINARY_RETURNS_FLOAT op == MM isinstance torch Tensor isinstance b torch Tensor assertIsInstance r TypeError b assertIsInstance r torch Tensor assertIsInstance r RuntimeError any_tensor op BINARY_ACCEPTS_INT_ONLY any_float See https github com pytorch pytorch issues assertIsInstance r NotImplementedError assertIsInstance r torch Tensor op BINARY_RETURNS_BOOL assertEqual r dtype torch bool op BINARY_ACCEPTS_INT_ONLY assertFalse r dtype is_floating_point op BINARY_ACCEPTS_FLOAT_OR_INT assertEqual r dtype is_floating_point returns_float assertFalse Logic error op BINARY_RETURNS_BOOL assertIsInstance r bool op BINARY_ACCEPTS_INT_ONLY any_float assertIsInstance r TypeError assertIsInstance r int returns_float assertIsInstance r float assertIsInstance r int parametrize op product UNARY_OPS ALL test_unary op try r = eval f op except Exception e r = e op UNARY_ACCEPTS_INT_ONLY _any_float assertIsInstance r TypeError isinstance torch Tensor assertIsInstance r torch Tensor op UNARY_ACCEPTS_INT_ONLY assertIsInstance r int isinstance float assertIsInstance r float assertIsInstance r int _any_float x i x isinstance i float isinstance i torch Tensor i dtype is_floating_point True False instantiate_parametrized_tests TestPythonOperators __name__ == __main__ run_tests