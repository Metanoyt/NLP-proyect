ruff noqa PGH G F flake noqa Owner s oncall distributed ################################################################################################# Copyright c - NVIDIA CORPORATION AFFILIATES All rights reserved SPDX-License-Identifier BSD- -Clause Redistribution use source binary forms without modification permitted provided following conditions met Redistributions source code must retain above copyright notice list conditions following disclaimer Redistributions binary form must reproduce above copyright notice list conditions following disclaimer documentation other materials provided distribution Neither name copyright holder nor names its contributors may used endorse promote products derived software without specific prior written permission THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT INDIRECT INCIDENTAL SPECIAL EXEMPLARY OR CONSEQUENTIAL DAMAGES INCLUDING BUT NOT LIMITED TO PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES LOSS OF USE DATA OR PROFITS OR BUSINESS INTERRUPTION HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY WHETHER IN CONTRACT STRICT LIABILITY OR TORT INCLUDING NEGLIGENCE OR OTHERWISE ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE ################################################################################################# Unit tests _pycute coalesce logging torch distributed _pycute torch testing _internal common_utils run_tests TestCase _LOGGER = logging getLogger __name__ TestCoalesce TestCase helper_test_coalesce layout coalesced_layout=None layoutR = coalesce layout _LOGGER debug f layout = layoutR coalesced_layout assertEqual coalesced_layout shape layoutR shape assertEqual coalesced_layout stride layoutR stride assertEqual size layoutR size layout i range size layout assertEqual layoutR i layout i test_coalesce layout = Layout helper_test_coalesce layout layout = Layout helper_test_coalesce layout layout = Layout helper_test_coalesce layout layout = Layout helper_test_coalesce layout layout = Layout helper_test_coalesce layout layout = Layout helper_test_coalesce layout layout = Layout helper_test_coalesce layout layout = Layout helper_test_coalesce layout layout = Layout coalesced_layout = Layout helper_test_coalesce layout coalesced_layout layout = Layout coalesced_layout = Layout helper_test_coalesce layout coalesced_layout layout = Layout coalesced_layout = Layout helper_test_coalesce layout coalesced_layout layout = Layout helper_test_coalesce layout layout = Layout helper_test_coalesce layout layout = Layout coalesced_layout = Layout helper_test_coalesce layout coalesced_layout __name__ == __main__ run_tests