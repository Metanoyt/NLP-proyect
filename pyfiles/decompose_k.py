__future__ annotations typing Any TYPE_CHECKING sympy torch ir get_free_symbols kernel mm decompose_k_subgraph_template kernel_inputs KernelInputs MMKernelInputs utils get_k_splits virtualized V base TemplateConfigHeuristics gemm GemmMaxAutotuneTemplateConfigHeuristics registry register_template_heuristic TYPE_CHECKING collections abc Generator register_template_heuristic decompose_k_subgraph_template uid None op_name= mm EmptyDecomposeKConfigHeuristics TemplateConfigHeuristics empty heuristics skip decompose k anything cuda CUDA we don t support hip decompose_k yet register_template_heuristic decompose_k_subgraph_template uid cuda register=torch version hip None op_name= mm TODO coconutruben enable decompose k AMD removing register bool benchmarking performance stability TODO coconutruben enable decompose k other devices xpu cpu mps mtia either adding specific register_template_heuristic tags setting device None enabled all devices DecomposeKConfigHeuristics GemmMaxAutotuneTemplateConfigHeuristics _get_template_configs_impl kernel_inputs KernelInputs op_name str - Generator dict str Any None None Get all valid k_splits given m n k assert isinstance kernel_inputs MMKernelInputs f __class__ __name__ requires MMKernelInputs Check unbacked symbols - found yield nothing unbacked_symbols = any len get_free_symbols itr unbacked_only=True itr kernel_inputs shapes_symbolic kernel_inputs strides_symbolic unbacked_symbols m n k = kernel_inputs mnk_symbolic k_splits = get_k_splits m n k k_split k_splits V graph sizevars statically_known_true sympy Eq sympy Mod k k_split continue yield k_split k_split