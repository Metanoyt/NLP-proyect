mypy allow-untyped-defs typing Optional torch SobolEngine r The ` torch quasirandom SobolEngine ` engine generating scrambled Sobol sequences Sobol sequences example low discrepancy quasi-random sequences This implementation engine Sobol sequences capable sampling sequences up maximum dimension It uses direction numbers https web maths unsw edu au ~fkuo sobol obtained using search criterion D up dimension This recommended choice authors References - Art B Owen Scrambling Sobol Niederreiter-Xing points Journal Complexity - December - I M Sobol The distribution points cube accurate evaluation integrals Zh Vychisl Mat i Mat Phys - Args dimension Int The dimensionality sequence drawn scramble bool optional Setting ` ` True ` ` will produce scrambled Sobol sequences Scrambling capable producing better Sobol sequences Default ` ` False ` ` seed Int optional This seed scrambling The seed random number generator set specified Otherwise uses random seed Default ` ` None ` ` Examples xdoctest +SKIP unseeded random state soboleng = torch quasirandom SobolEngine dimension= soboleng draw tensor MAXBIT = MAXDIM = __init__ dimension scramble=False seed=None dimension MAXDIM dimension raise ValueError Supported range dimensionality f SobolEngine MAXDIM seed = seed scramble = scramble dimension = dimension cpu = torch device cpu sobolstate = torch zeros dimension MAXBIT device=cpu dtype=torch long torch _sobol_engine_initialize_state_ sobolstate dimension scramble shift = torch zeros dimension device=cpu dtype=torch long _scramble quasi = shift clone memory_format=torch contiguous_format _first_point = quasi MAXBIT reshape - num_generated = draw n int = out Optional torch Tensor = None dtype Optional torch dtype = None - torch Tensor r Function draw sequence attr ` n ` points Sobol sequence Note samples dependent previous samples The size result math ` n dimension ` Args n Int optional The length sequence points draw Default out Tensor optional The output tensor dtype ` torch dtype ` optional desired data type returned tensor Default ` ` None ` ` dtype None dtype = torch get_default_dtype num_generated == n == result = _first_point dtype result quasi = torch _sobol_engine_draw quasi n - sobolstate dimension num_generated dtype=dtype result = torch cat _first_point dtype result dim=- result quasi = torch _sobol_engine_draw quasi n sobolstate dimension num_generated - dtype=dtype num_generated += n out None out resize_as_ result copy_ result out result draw_base m int out Optional torch Tensor = None dtype Optional torch dtype = None - torch Tensor r Function draw sequence attr ` m ` points Sobol sequence Note samples dependent previous samples The size result math ` m dimension ` Args m Int The base exponent number points draw out Tensor optional The output tensor dtype ` torch dtype ` optional desired data type returned tensor Default ` ` None ` ` n = m total_n = num_generated + n total_n total_n - == raise ValueError The balance properties Sobol points require f n power num_generated points have been f previously generated then n= num_generated + m = total_n If you still want do please use SobolEngine draw instead draw n=n out=out dtype=dtype reset r Function reset ` ` SobolEngine ` ` base state quasi copy_ shift num_generated = fast_forward n r Function fast-forward state ` ` SobolEngine ` ` attr ` n ` steps This equivalent drawing attr ` n ` samples without using samples Args n Int The number steps fast-forward num_generated == torch _sobol_engine_ff_ quasi n - sobolstate dimension num_generated torch _sobol_engine_ff_ quasi n sobolstate dimension num_generated - num_generated += n _scramble g Optional torch Generator = None seed None g = torch Generator g manual_seed seed cpu = torch device cpu Generate shift vector shift_ints = torch randint dimension MAXBIT device=cpu generator=g shift = torch mv shift_ints torch pow torch arange MAXBIT device=cpu Generate lower triangular matrices stacked across dimensions ltm_dims = dimension MAXBIT MAXBIT ltm = torch randint ltm_dims device=cpu generator=g tril torch _sobol_engine_scramble_ sobolstate ltm dimension __repr__ fmt_string = f dimension= dimension scramble fmt_string += scramble=True seed None fmt_string += f seed= seed __class__ __name__ + + join fmt_string +