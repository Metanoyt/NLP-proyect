sys benchmark_base BenchmarkBase torch torch autograd grad_mode inference_mode Benchmark BenchmarkBase __init__ requires_grad inference_mode backward dynamic assert inference_mode backward inference_mode backward cannot both True _requires_grad = requires_grad _inference_mode = inference_mode _backward = backward super __init__ category= runtime_overhead backend= inductor device= cuda dynamic=dynamic name prefix = f category _ backend _requires_grad prefix += _requires_grad _inference_mode prefix += _inference_mode _backward prefix += _backward is_dynamic prefix += _dynamic prefix description runtime compiled add op small input _prepare_once torch _dynamo reset = torch ones device=self device requires_grad=self _requires_grad torch compile backend=self backend fullgraph=True dynamic=self is_dynamic add + _add = add warmup _ range _backward forward_val = _add sum forward_val backward _work _prepare _backward forward_val = _add sum _work _inference_mode inference_mode _add _backward forward_val backward _add main result_path = sys argv all = Benchmark requires_grad=False inference_mode=False backward=False dynamic=False Benchmark requires_grad=False inference_mode=True backward=False dynamic=False Benchmark requires_grad=True inference_mode=False backward=False dynamic=False Benchmark requires_grad=True inference_mode=False backward=True dynamic=False Benchmark requires_grad=False inference_mode=False backward=False dynamic=True Benchmark requires_grad=False inference_mode=True backward=False dynamic=True Benchmark requires_grad=True inference_mode=False backward=False dynamic=True Benchmark requires_grad=True inference_mode=False backward=True dynamic=True benchmark all benchmark enable_instruction_count collect_all append_results result_path __name__ == __main__ main