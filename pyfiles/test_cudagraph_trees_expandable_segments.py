Owner s module cuda run time cuda tests allocator using expandable segments os pathlib sys torch torch testing _internal common_cuda IS_JETSON IS_WINDOWS torch testing _internal common_utils run_tests torch testing _internal inductor_utils HAS_CUDA_AND_TRITON pytorch_test_dir = os path dirname os path dirname os path realpath __file__ sys path append pytorch_test_dir HAS_CUDA_AND_TRITON try test_cudagraph_trees CudaGraphTreeTests except ImportError test_cudagraph_trees noqa F manual=fbcode caffe test inductor cudagraph_trees-library CudaGraphTreeTests REPO_ROOT = pathlib Path __file__ resolve parent parent parent sys path insert str REPO_ROOT tools stats import_test_stats get_disabled_tests manual Make sure remove REPO_ROOT after done sys path remove str REPO_ROOT __name__ == __main__ torch cuda is_available IS_JETSON IS_WINDOWS HAS_CUDA_AND_TRITON get_disabled_tests torch cuda memory _set_allocator_settings expandable_segments True run_tests