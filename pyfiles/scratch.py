torch torch jit script fn x scale shift scale x shift torch jit script recurrent x scale shift y = x i range y = fn y scale shift y x = torch randn device= cuda scale = torch randn device= cuda requires_grad=True shift = torch randn device= cuda requires_grad=True inputs = x scale shift out = recurrent x scale shift recurrent graph_for x scale shift torch torch jit script recurrent_scaleshift x scale shift y = x i range y = scale y + shift y x = torch randn device= cuda scale = torch randn device= cuda requires_grad=True shift = torch randn device= cuda requires_grad=True inputs = x scale shift out = recurrent_scaleshift x scale shift recurrent_scaleshift graph_for x scale shift torch x = torch tensor x requires_grad = True x mean backward no error triggered x = x cuda x mean backward