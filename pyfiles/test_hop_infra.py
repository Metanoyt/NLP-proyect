Owner s module higher order operators importlib pkgutil torch torch testing _internal common_utils run_tests skipIfTorchDynamo TestCase torch testing _internal hop_db FIXME_hop_that_doesnt_have_opinfo_test_allowlist hop_db do_imports mod pkgutil walk_packages torch _higher_order_ops __path__ torch _higher_order_ops modname = mod name importlib import_module modname do_imports skipIfTorchDynamo applicable TestHOPInfra TestCase test_all_hops_have_opinfo All HOPs should have OpInfo torch testing _internal hop_db py torch _ops _higher_order_ops hops_that_have_op_info = k name k hop_db all_hops = _higher_order_ops keys missing_ops = set op all_hops op hops_that_have_op_info op FIXME_hop_that_doesnt_have_opinfo_test_allowlist missing_ops add op assertTrue len missing_ops == f Missing hop_db OpInfo entries missing_ops please add them torch testing _internal hop_db py test_all_hops_are_imported All HOPs should listed torch _higher_order_ops __all__ Some constraints see test_testing py TestImports - Sympy must lazily imported - Dynamo must lazily imported imported_hops = torch _higher_order_ops __all__ registered_hops = torch _ops _higher_order_ops keys Please don t add anything here We want ensure all HOPs imported torch time It bad someone tries access torch ops higher_order cond doesn t exist may happen your HOP isn t imported torch time FIXME_ALLOWLIST = autograd_function_apply run_with_rng_state graphsafe_run_with_rng_state map_impl _export_tracepoint run_and_save_rng_state map custom_function_call trace_wrapped triton_kernel_wrapper_functional triton_kernel_wrapper_mutation wrap Really weird failure -- importing causes Dynamo choke checkpoint not_imported_hops = registered_hops - imported_hops not_imported_hops = not_imported_hops - FIXME_ALLOWLIST assertEqual not_imported_hops set msg= All HOPs must listed under torch _higher_order_ops __init__ py s __all__ test_imports_from_all_work All APIs listed torch _higher_order_ops __all__ must importable stuff = torch _higher_order_ops __all__ attr stuff getattr torch _higher_order_ops attr __name__ == __main__ run_tests