pt configs operator_benchmark op_bench torch torch ao nn quantized nnq Microbenchmarks qConv operators QConv dBenchmark op_bench TorchBenchmarkBase init N IC OC L G kernel stride pad init IC OC kernel stride N L device G = pad = scale = zero_point = X = torch randn N IC L dtype=torch float qX = torch quantize_per_tensor X scale=self scale zero_point=self zero_point dtype=torch quint Convert tensor NHWC format W = torch randn OC IC G kernel dtype=torch float qW = torch quantize_per_tensor W scale=self scale zero_point= dtype=torch qint inputs = input qX qconv d = nnq Conv d IC OC kernel stride=stride padding=pad groups=G qconv d set_weight_bias qW None qconv d scale = torch tensor scale dtype=torch double qconv d zero_point = torch tensor zero_point dtype=torch int set_module_name QConv d forward input qconv d input QConv dBenchmark op_bench TorchBenchmarkBase init N IC OC H W G kernel stride pad init IC OC kernel stride N H W G pad device super init N IC OC H W G kernel kernel stride pad scale = zero_point = X = torch randn N IC H W dtype=torch float qX = torch quantize_per_tensor X scale=self scale zero_point=self zero_point dtype=torch quint Convert tensor NHWC format W = torch randn OC IC G kernel kernel dtype=torch float qW = torch quantize_per_tensor W scale=self scale zero_point= dtype=torch qint inputs = input qX qconv d = nnq Conv d IC OC kernel stride=stride padding=pad groups=G qconv d set_weight_bias qW None qconv d scale = torch tensor scale dtype=torch double qconv d zero_point = torch tensor zero_point dtype=torch int set_module_name QConv d forward input qconv d input op_bench generate_pt_test configs remove_cuda configs conv_ d_configs_short + configs conv_ d_configs_long QConv dBenchmark op_bench generate_pt_test configs remove_cuda configs conv_ d_configs_short + configs conv_ d_configs_long QConv dBenchmark __name__ == __main__ op_bench benchmark_runner main