operator_benchmark op_bench torch Microbenchmarks channel_shuffle operator Configs PT channel_shuffle operator channel_shuffle_long_configs = op_bench cross_product_configs batch_size= channels_per_group= height= width= groups= channel_last= True False tags= long channel_shuffle_short_configs = op_bench config_list attr_names= batch_size channels_per_group height width groups attrs= cross_product_configs= channel_last True False tags= short ChannelSHuffleBenchmark op_bench TorchBenchmarkBase init batch_size channels_per_group height width groups channel_last channels = channels_per_group groups data_shape = batch_size channels height width input_data = torch rand data_shape channel_last input_data = input_data contiguous memory_format=torch channels_last inputs = input_data input_data groups groups set_module_name channel_shuffle forward input_data groups int torch channel_shuffle input_data groups op_bench generate_pt_test channel_shuffle_short_configs + channel_shuffle_long_configs ChannelSHuffleBenchmark __name__ == __main__ op_bench benchmark_runner main