Owner s module inductor random string sys unittest torch torch _dynamo torch utils cpp_extension try extension_backends triton device_interface manual=fbcode caffe test inductor extension_backends extension_codegen_backend noqa B DeviceInterface extension_backends triton extension_codegen_backend manual=fbcode caffe test inductor extension_backends extension_codegen_backend noqa B CPUDeviceOpOverrides ExtensionScheduling ExtensionWrapperCodegen except ImportError extension_backends triton device_interface DeviceInterface extension_backends triton extension_codegen_backend CPUDeviceOpOverrides ExtensionScheduling ExtensionWrapperCodegen torch _C FileCheck torch _dynamo device_interface torch _inductor metrics torch _inductor codegen common get_scheduling_for_device get_wrapper_codegen_for_device register_backend_for_device register_device_op_overrides torch _inductor utils get_triton_code torch testing _internal common_utils IS_FBCODE IS_MACOS try test_extension_backend BaseExtensionBackendTests except ImportError test_extension_backend BaseExtensionBackendTests try try test_torchinductor except ImportError test_torchinductor manual=fbcode caffe test inductor test_inductor-library except unittest SkipTest __name__ == __main__ sys exit raise TestCase = test_torchinductor TestCase mock_triton_hash_with_backend args kwargs Generate random string length Used mock triton_hash_with_backend function since we don t have triton backend join random choices string ascii_uppercase + string digits k= unittest skipIf IS_FBCODE cpp_extension doesn t work fbcode right now test_torchinductor skip_if_cpp_wrapper Not possible fix until CppWrapperCpu supports triton CPU TritonExtensionBackendTests BaseExtensionBackendTests Test creating backend inductor Triton scheduling test_open_device_registration torch _register_device_module privateuseone module register_backend_for_device privateuseone ExtensionScheduling ExtensionWrapperCodegen register_device_op_overrides privateuseone CPUDeviceOpOverrides device_interface register_interface_for_device privateuseone DeviceInterface assertEqual get_scheduling_for_device privateuseone ExtensionScheduling assertEqual get_wrapper_codegen_for_device privateuseone ExtensionWrapperCodegen assertEqual device_interface get_interface_for_device privateuseone DeviceInterface device = torch device privateuseone x = torch empty fill_ device foo x torch sin x + x min metrics reset opt_fn = torch compile foo Since we don t have triton backend we need mock triton_hash_with_backend function unittest mock patch torch utils _triton triton_hash_with_backend new=mock_triton_hash_with_backend code = get_triton_code opt_fn x FileCheck check triton check triton jit check tl_math sin check device_str= privateuseone run code __name__ == __main__ torch _inductor test_case run_tests torch testing _internal inductor_utils HAS_CPU HAS_CPU IS_MACOS run_tests