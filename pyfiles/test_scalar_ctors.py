Owner s module dynamo Test scalar constructors which also do type-coercion functools unittest skipIf skipif pytest torch testing _internal common_utils instantiate_parametrized_tests parametrize run_tests subtest TEST_WITH_TORCHDYNAMO TestCase xpassIfTorchDynamo_np TEST_WITH_TORCHDYNAMO numpy np numpy testing assert_almost_equal assert_equal torch _numpy np torch _numpy testing assert_almost_equal assert_equal skip = functools partial skipif True TestFromString TestCase xpassIfTorchDynamo_np reason= XXX floats strings test_floating Ticket floats string fsingle = np single fdouble = np double assert_almost_equal fsingle assert_almost_equal fdouble xpassIfTorchDynamo_np reason= XXX floats strings test_floating_overflow Strings containing unrepresentable float overflow fhalf = np half e assert_equal fhalf np inf fsingle = np single e assert_equal fsingle np inf fdouble = np double e assert_equal fdouble np inf fhalf = np half - e assert_equal fhalf -np inf fsingle = np single - e assert_equal fsingle -np inf fdouble = np double - e assert_equal fdouble -np inf test_bool pytest raises TypeError np bool_ False garbage=True TestFromInt TestCase test_intp Ticket assert_equal np intp test_uint _from_negative NumPy test asserting DeprecationWarning assert_equal np uint - np uint int_types = subtest np byte name= np_byte subtest np short name= np_short subtest np intc name= np_intc subtest np int_ name= np_int_ subtest np longlong name= np_longlong uint_types = np ubyte float_types = np half np single np double cfloat_types = np csingle np cdouble instantiate_parametrized_tests TestArrayFromScalar TestCase gh- _do_test t t x = t arr = np array x dtype=t type should preserved exactly t None assert arr dtype type t assert arr dtype type t arr = np asarray x dtype=t t None assert arr dtype type t assert arr dtype type t parametrize t int_types + uint_types parametrize t int_types + uint_types + None test_integers t t _do_test t t parametrize t float_types parametrize t float_types + None test_reals t t _do_test t t parametrize t cfloat_types parametrize t cfloat_types + None test_complex t t _do_test t t __name__ == __main__ run_tests