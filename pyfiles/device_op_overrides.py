__future__ annotations typing Optional common DeviceOpOverrides register_device_op_overrides TritonScratchWorkspace XPUDeviceOpOverrides DeviceOpOverrides import_get_raw_stream_as name str - str f torch _C _xpu_getCurrentRawStream name set_device device_idx int - str f torch xpu set_device device_idx synchronize - str torch xpu synchronize device_guard device_idx int - str f torch xpu _DeviceGuard device_idx cpp_device_guard - str DeviceGuard cpp_aoti_device_guard - str AOTIXpuGuard cpp_stream_guard - str xpu XPUStreamGuard cpp_aoti_stream_guard - str AOTIXpuStreamGuard cpp_getStreamFromExternal - str xpu getStreamFromExternal kernel_header - str source_codes = #include torch csrc inductor aoti_runtime sycl_runtime_wrappers h source_codes kernel_driver - str cpp_stream_type - str sycl queue aoti_get_stream - str aoti_torch_get_current_xpu_stream cpp_kernel_type - str std unique_ptr sycl kernel cpp_device_ptr - str void cpp_scratch idx int workspace TritonScratchWorkspace prefix Optional str = None - Optional tuple list str str f void global_scratch_ idx = f global_scratch_ idx register_device_op_overrides xpu XPUDeviceOpOverrides