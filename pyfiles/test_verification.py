Owner s module onnx Test verification module __future__ annotations json torch torch onnx _internal exporter _verification torch testing _internal common_utils VerificationInfoTest common_utils TestCase test_from_tensors Test tensors expected = torch tensor actual = torch tensor verification_info = _verification VerificationInfo from_tensors test_tensor expected actual assertEqual verification_info name test_tensor assertEqual verification_info max_abs_diff assertEqual verification_info max_rel_diff torch testing assert_close verification_info abs_diff_hist torch tensor + torch testing assert_close verification_info rel_diff_hist torch tensor + assertEqual verification_info expected_dtype torch float assertEqual verification_info actual_dtype torch float test_from_tensors_int Test int tensors expected = torch tensor actual = verification_info = _verification VerificationInfo from_tensors test_tensor_int expected actual assertEqual verification_info name test_tensor_int assertEqual verification_info max_abs_diff assertEqual verification_info max_rel_diff torch testing assert_close verification_info abs_diff_hist torch tensor + torch testing assert_close verification_info rel_diff_hist torch tensor + assertEqual verification_info expected_dtype torch int assertEqual verification_info actual_dtype torch int test_asdict Test asdict method expected = torch tensor actual = torch tensor verification_info = _verification VerificationInfo from_tensors test_tensor expected actual asdict_result = verification_info asdict assertEqual asdict_result name test_tensor assertEqual asdict_result max_abs_diff assertEqual asdict_result max_rel_diff assertEqual asdict_result abs_diff_hist + e- e- assertEqual asdict_result rel_diff_hist + e- e- assertEqual asdict_result expected_dtype torch float assertEqual asdict_result actual_dtype torch float Ensure can round tripped json json_str = json dumps asdict_result loaded_dict = json loads json_str assertEqual loaded_dict asdict_result VerificationInterpreterTest common_utils TestCase test_interpreter_stores_correct_info Model torch nn Module forward b c = + b c - model = Model args = torch tensor torch tensor onnx_program = torch onnx export model args dynamo=True verbose=False assert onnx_program None interpreter = _verification _VerificationInterpreter onnx_program results = interpreter run args torch testing assert_close results model args verification_infos = interpreter verification_infos assertEqual len verification_infos info verification_infos assertEqual info max_abs_diff assertEqual info max_rel_diff VerificationFunctionsTest common_utils TestCase test_verify_onnx_program Model torch nn Module forward b c = + b c - c model = Model args = torch tensor torch tensor onnx_program = torch onnx export model args dynamo=True verbose=False assert onnx_program None verification_infos = _verification verify_onnx_program onnx_program args compare_intermediates=False assertEqual len verification_infos test_verify_onnx_program_with_compare_intermediates_true Model torch nn Module forward b c = + b c - c model = Model args = torch tensor torch tensor onnx_program = torch onnx export model args dynamo=True verbose=False assert onnx_program None verification_infos = _verification verify_onnx_program onnx_program args compare_intermediates=True assertEqual len verification_infos __name__ == __main__ common_utils run_tests