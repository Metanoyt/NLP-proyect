sys unittest pathlib Path expecttest TestCase sys path append str Path __file__ absolute parents test_utils read_file_to_string run_bash type ignore import-not-found TestMixedMM TestCase test_mixedmm_a - None run_bash get_mixedmm_dataset sh run_bash gen_mixedmm_heuristic_a sh file_path = torch _inductor autoheuristic artifacts _MixedMMA py _heuristic_generated_code = read_file_to_string file_path assertExpectedInline _heuristic_generated_code \ flake noqa B fmt off This file generated AutoHeuristic Do modify manually To regenerate file take look steps README md file inside torchgen _autoheuristic mixed_mm typing Optional torch _inductor autoheuristic autoheuristic_utils AHContext AHMetadata Choice torch _inductor autoheuristic learnedheuristic_interface LearnedHeuristicDecision MixedMMA LearnedHeuristicDecision __init__ - None choices list Choice = fill_choices check_precondition metadata AHMetadata context AHContext - bool metadata name == get_name metadata shared_memory == str metadata device_capa == get_confidence_threshold - float get_choice idx int - Optional str idx len choices choices idx None fill_choices - None choices append extern_fallback_mixed_mm choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= get_name - str mixed_mm get_best_choices context AHContext - Optional list tuple float int str context get_value LEQmLEQ = True context get_value m = context get_value n = context get_value n = context get_value m n = None context get_value m k = context get_value k n = context get_value n = context get_value m n = context get_value m n = context get_value mat _stride_ = None None context get_value m n = str context get_value LEQmLEQ = True context get_value n = context get_value n = context get_value n = context get_value arith_intensity = str context get_value mat _dtype = torch uint context get_value m k = context get_value arith_intensity = None None context get_value arith_intensity = context get_value k n = context get_value m k = context get_value n = context get_value n = context get_value k = context get_value k n = context get_value n = test_mixedmm_h - None run_bash get_mixedmm_dataset sh run_bash gen_mixedmm_heuristic_h sh file_path = torch _inductor autoheuristic artifacts _MixedMMH py h _heuristic_generated_code = read_file_to_string file_path assertExpectedInline h _heuristic_generated_code \ flake noqa B fmt off This file generated AutoHeuristic Do modify manually To regenerate file take look steps README md file inside torchgen _autoheuristic mixed_mm typing Optional torch _inductor autoheuristic autoheuristic_utils AHContext AHMetadata Choice torch _inductor autoheuristic learnedheuristic_interface LearnedHeuristicDecision MixedMMH LearnedHeuristicDecision __init__ - None choices list Choice = fill_choices check_precondition metadata AHMetadata context AHContext - bool metadata name == get_name metadata shared_memory == str metadata device_capa == get_confidence_threshold - float get_choice idx int - Optional str idx len choices choices idx None fill_choices - None choices append extern_fallback_mixed_mm choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= choices append type=triton_BLOCK-M= _BLOCK-K= _BLOCK-N= _numstages= _numwarps= get_name - str mixed_mm get_best_choices context AHContext - Optional list tuple float int context get_value arith_intensity = context get_value n = context get_value n = context get_value mat _stride_ = context get_value m n = context get_value n = str context get_value mat _dtype = torch int str context get_value mat _dtype = torch bfloat context get_value n = context get_value n = context get_value k n = context get_value k n = context get_value n = context get_value n = context get_value m n = str context get_value LEQmLEQ = True context get_value m n = context get_value n = None context get_value m k = context get_value n = context get_value m n = None context get_value m = context get_value mat _stride_ = context get_value n = context get_value mat _stride_ = context get_value m n = context get_value n = context get_value m = __name__ == __main__ unittest main