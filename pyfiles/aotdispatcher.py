sys benchmark_base BenchmarkBase torch torch testing _internal two_tensor TwoTensor Benchmark BenchmarkBase __init__ training subclass _training = training _subclass = subclass super __init__ category= aotdispatcher backend= aot_eager_decomp_partition device= cpu mode= training _training inference name prefix = f category _ mode _subclass prefix += _subclass prefix += _nosubclass device == cpu prefix += _cpu prefix description inputs outputs each input added once _prepare_once _args = torch ones requires_grad=self _training device=self device _ range _subclass _args = TwoTensor x x clone detach requires_grad_ _training x _args _args = _args _prepare torch _dynamo reset _work torch compile backend=self backend fullgraph=True f args outs = torch add x x x args outs f _args main result_path = sys argv all = Benchmark training=False subclass=False Benchmark training=True subclass=False Benchmark training=False subclass=True Benchmark training=True subclass=True benchmark all benchmark enable_compile_time_instruction_count collect_all append_results result_path __name__ == __main__ main