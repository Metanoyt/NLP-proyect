mypy allow-untyped-defs typing Any TYPE_CHECKING Union torch torch _subclasses functional_tensor torch utils _pytree pytree torch _C DispatchKey torch _functorch utils exposed_in torch _higher_order_ops utils _set_compilation_env autograd_not_implemented torch _ops HigherOrderOperator torch _subclasses fake_tensor FakeTensorMode torch fx experimental proxy_tensor _temp_remove_metadata_torch_function_mode _temp_remove_pre_dispatch_torch_function_mode disable_proxy_modes_tracing make_fx ProxyTorchDispatchMode track_tensor_tree torch utils _python_dispatch _get_current_dispatch_mode TYPE_CHECKING collections abc Callable exposed_in torch strict_mode callable operands torch _dynamo backends debugging make_eager_backend_with_torch_function_modes torch compiler is_dynamo_compiling strict_mode_op callable operands _set_compilation_env _temp_remove_metadata_torch_function_mode metadata_mode _temp_remove_pre_dispatch_torch_function_mode predispatch_mode modes = metadata_mode predispatch_mode modes = mode mode modes mode None modes backend Union str Callable Any = make_eager_backend_with_torch_function_modes modes backend = eager torch _dynamo utils disable_cache_limit torch compile strict_mode_op backend=backend fullgraph=True callable operands StrictMode HigherOrderOperator __init__ super __init__ strict_mode __call__ callable operands super __call__ callable operands strict_mode_op = StrictMode strict_mode_op py_impl DispatchKey CompositeExplicitAutograd strict_mode_op_dense callable operands mode = _get_current_dispatch_mode assert mode None Mode should never enabled CPU CUDA key callable operands strict_mode_op py_autograd_impl autograd_not_implemented strict_mode_op deferred_error=True strict_mode_op py_impl ProxyTorchDispatchMode inner mode callable operands trace_strict_mode mode strict_mode_op callable operands trace_strict_mode mode strict_mode_op callable operands pre_dispatch = getattr mode pre_dispatch False disable_proxy_modes_tracing graph = make_fx callable pre_dispatch=pre_dispatch operands graph_name = mode tracer get_fresh_qualname strict_graph_ mode tracer root register_module graph_name graph args = graph operands proxy_args = pytree tree_map mode tracer unwrap_proxy args out_proxy = mode tracer create_proxy call_function strict_mode_op proxy_args name= strict_mode out = graph operands track_tensor_tree out out_proxy constant=None tracer=mode tracer strict_mode_op py_impl FakeTensorMode strict_mode_fake_tensor_mode mode callable operands mode true_outs = callable operands true_outs strict_mode_op py_functionalize_impl strict_mode_func ctx callable inputs unwrapped_inputs = ctx unwrap_tensors inputs ctx redispatch_to_next functional_callable = ctx functionalize callable cond_return = strict_mode_op functional_callable unwrapped_inputs ctx wrap_tensors cond_return