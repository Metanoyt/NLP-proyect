operator_benchmark op_bench torch Microbenchmarks batched operators binary ops two inputs shape batches batched_binary_ops = op_bench op_list attr_names= op_name op_func attrs= bmm torch bmm batched_binary_configs_short = op_bench config_list attr_names= B M N K attrs= cross_product_configs= device cpu dtype torch float torch bfloat tags= short batched_binary_configs_long = op_bench cross_product_configs B= M= N= K= device= cuda dtype= torch float torch bfloat torch float tags= long BatchedBinaryOpBenchmark op_bench TorchBenchmarkBase init B M N K device dtype op_func inputs = batch torch rand B M N device=device dtype=dtype requires_grad=self auto_set batch torch rand B N K device=device dtype=dtype requires_grad=self auto_set op_func = op_func forward batch batch op_func batch batch op_bench generate_pt_tests_from_op_list batched_binary_ops batched_binary_configs_short + batched_binary_configs_long BatchedBinaryOpBenchmark op_bench generate_pt_gradient_tests_from_op_list batched_binary_ops batched_binary_configs_long BatchedBinaryOpBenchmark batched ternary ops batched_ternary_ops = op_bench op_list attr_names= op_name op_func attrs= baddbmm torch baddbmm BatchedTernaryOpBenchmark op_bench TorchBenchmarkBase init B M N K device dtype op_func inputs = input_ torch rand B M K device=device dtype=dtype requires_grad=self auto_set batch torch rand B M N device=device dtype=dtype requires_grad=self auto_set batch torch rand B N K device=device dtype=dtype requires_grad=self auto_set op_func = op_func forward input_ batch batch op_func input_ batch batch op_bench generate_pt_tests_from_op_list batched_ternary_ops batched_binary_configs_short + batched_binary_configs_long BatchedTernaryOpBenchmark op_bench generate_pt_gradient_tests_from_op_list batched_ternary_ops batched_binary_configs_long BatchedTernaryOpBenchmark TODO does automatically register new scripts __name__ == __main__ op_bench benchmark_runner main