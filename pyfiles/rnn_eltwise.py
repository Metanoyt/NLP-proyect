torch benchmark RNNEltwise benchmark Benchmark __init__ mode device dtype b hs super __init__ mode device dtype b = b hs = hs input = rand b hs device=device dtype=dtype requires_grad=self requires_grad hx = rand b hs device=device dtype=dtype requires_grad=self requires_grad cx = rand b hs device=device dtype=dtype requires_grad=self requires_grad b_ih = rand b hs device=device dtype=dtype requires_grad=self requires_grad b_hh = rand b hs device=device dtype=dtype requires_grad=self requires_grad inputs = input hx cx b_ih b_hh forward input hx cx b_ih b_hh gates = input + hx + b_ih + b_hh ingate forgetgate cellgate outgate = gates chunk ingate = torch sigmoid ingate forgetgate = torch sigmoid forgetgate cellgate = torch tanh cellgate outgate = torch sigmoid outgate cy = forgetgate cx + ingate cellgate hy = outgate torch tanh cy hy cy config b hs staticmethod module rnn_eltwise memory_workload memsize t t numel t element_size input_size = sum memsize t t inputs output_size = memsize cx io_size = input_size + output_size sol io_size algorithmic io_size staticmethod default_configs benchmark register_benchmark_class RNNEltwise DynamicLSTM benchmark DynamicShape RNNEltwise __init__ mode device dtype b hs benchmark DynamicShape __init__ RNNEltwise __init__ mode device dtype b hs instantiate_input b hs = rand_shape b hs input = rand b hs device=self device dtype=self dtype requires_grad=self requires_grad hx = rand b hs device=self device dtype=self dtype requires_grad=self requires_grad cx = rand b hs device=self device dtype=self dtype requires_grad=self requires_grad b_ih = rand b hs device=self device dtype=self dtype requires_grad=self requires_grad b_hh = rand b hs device=self device dtype=self dtype requires_grad=self requires_grad inputs = input hx cx b_ih b_hh staticmethod module dynamic_lstm benchmark register_benchmark_class DynamicLSTM