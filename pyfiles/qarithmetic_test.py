operator_benchmark op_bench torch torch _ops ops qarithmetic_binary_configs = op_bench cross_product_configs N= dtype= torch quint torch qint torch qint contig= False True tags= short qarithmetic_binary_ops = op_bench op_list attrs= add ops quantized add add_relu ops quantized add_relu mul ops quantized mul attr_names= op_name op_func qarithmetic_binary_scalar_ops = op_bench op_list attrs= add_scalar ops quantized add_scalar mul_scalar ops quantized mul_scalar attr_names= op_name op_func _QFunctionalBinaryArithmeticBenchmarkBase op_bench TorchBenchmarkBase setup N dtype contig qfunctional = torch ao nn quantized QFunctional TODO Consider more diverse shapes f_input = torch rand N N - scale = zero_point = q_input_a = torch quantize_per_tensor f_input scale=self scale zero_point=self zero_point dtype=dtype contig permute_dims = list range f_input ndim - q_input_a = q_input_a permute permute_dims QFunctionalBenchmark _QFunctionalBinaryArithmeticBenchmarkBase init N dtype contig op_func super setup N dtype contig inputs = q_input_a q_input_a q_input_b q_input_a scale scale zero_point zero_point op_func = op_func forward q_input_a q_input_b scale float zero_point int op_func q_input_a q_input_b scale=scale zero_point=zero_point op_bench generate_pt_tests_from_op_list qarithmetic_binary_ops qarithmetic_binary_configs QFunctionalBenchmark QFunctionalScalarBenchmark _QFunctionalBinaryArithmeticBenchmarkBase init N dtype contig op_func super setup N dtype contig inputs = q_input q_input_a scalar_input op_func = op_func forward q_input scalar_input int op_func q_input scalar_input op_bench generate_pt_tests_from_op_list qarithmetic_binary_scalar_ops qarithmetic_binary_configs QFunctionalScalarBenchmark __name__ == __main__ op_bench benchmark_runner main