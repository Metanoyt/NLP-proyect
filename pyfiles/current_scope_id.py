Provides thread-local scope identification SubgraphTracer instances This module implements thread-safe mechanism tracking nested tracing contexts which essential when multiple SubgraphTracer instances active The scope ID helps identify which tracer context currently active when direct access InstructionTranslator difficult Key components - Thread-local scope ID storage _current_scope_id - Getter function current_scope_id safely access current scope - Context manager enter_new_scope managing nested scope transitions The scope ID increments when entering new context decrements when exiting allowing proper tracking nested tracing operations across different threads contextlib threading collections abc Generator Global variable identify which SubgraphTracer we It sometimes difficult find InstructionTranslator use _current_scope_id = threading local current_scope_id - int global _current_scope_id hasattr _current_scope_id value _current_scope_id value = _current_scope_id value contextlib contextmanager enter_new_scope - Generator None None None global _current_scope_id try _current_scope_id value = current_scope_id + yield finally _current_scope_id value = current_scope_id -