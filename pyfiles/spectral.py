mypy allow-untyped-defs math torch torch utils benchmark torch utils benchmark FuzzedParameter FuzzedTensor ParameterAlias __all__ = SpectralOpFuzzer MIN_DIM_SIZE = MAX_DIM_SIZE = power_range upper_bound base base i i range int math log upper_bound base + List regular numbers MIN_DIM_SIZE MAX_DIM_SIZE These numbers factorize into multiples prime factors only usually fastest FFT implementations REGULAR_SIZES = i power_range MAX_DIM_SIZE j power_range MAX_DIM_SIZE i ij = i j k power_range MAX_DIM_SIZE ij ijk = ij k ijk MIN_DIM_SIZE REGULAR_SIZES append ijk REGULAR_SIZES sort SpectralOpFuzzer benchmark Fuzzer __init__ seed int dtype=torch float cuda bool = False probability_regular float = super __init__ parameters= Dimensionality x e g D D D FuzzedParameter ndim distribution= strict=True Shapes ` x ` It important test all shapes however regular sizes especially important FFT therefore warrant special attention This done generating both value drawn all integers between min max allowed values another only regular numbers both distributions loguniform then randomly selecting between two FuzzedParameter name=f k_any_ i minval=MIN_DIM_SIZE maxval=MAX_DIM_SIZE distribution= loguniform i range FuzzedParameter name=f k_regular_ i distribution= size len REGULAR_SIZES size REGULAR_SIZES i range FuzzedParameter name=f k i distribution= ParameterAlias f k_regular_ i probability_regular ParameterAlias f k_any_ i - probability_regular strict=True i range Steps ` x ` Benchmarks strided memory access FuzzedParameter name=f step_ i distribution= i range tensors= FuzzedTensor name= x size= k k k steps= step_ step_ step_ probability_contiguous= min_elements= max_elements= max_allocation_bytes= GB dim_parameter= ndim dtype=dtype cuda=cuda seed=seed