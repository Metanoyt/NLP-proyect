Owner s module dynamo torch torch _dynamo test_case torch _dynamo testing my_custom_function x x + RunDiffGuardTests torch _dynamo test_case TestCase test_bool_recompile fn x y c c x y x + y opt_fn = torch compile fn backend= inductor x = torch ones y = torch ones ref = opt_fn x y True ref = opt_fn x y False torch compiler set_stance skip_guard_eval_unsafe=True res = opt_fn x y False res = opt_fn x y True assertEqual ref res assertEqual ref res test_tensor_recompile fn x y x y opt_fn = torch compile fn backend= eager x = torch randn dtype=torch float y = torch randn dtype=torch float ref = opt_fn x y x = torch randn dtype=torch float y = torch randn dtype=torch float ref = opt_fn x y torch compiler set_stance skip_guard_eval_unsafe=True res = opt_fn x y res = opt_fn x y assertEqual ref res assertEqual ref res test_post_recompile Foo __init__ = b = foo = Foo fn x x + foo + foo b cnts = torch _dynamo testing CompileCounter opt_fn = torch compile fn backend=cnts x = torch randn ref = fn x res = opt_fn x assertEqual ref res assertEqual cnts frame_count foo = ref = fn x res = opt_fn x assertEqual ref res assertEqual cnts frame_count torch compiler set_stance skip_guard_eval_unsafe=True Set back original value foo = ref = fn x res = opt_fn x assertEqual ref res foo = ref = fn x res = opt_fn x assertEqual ref res Check we back original behavior foo b = ref = fn x res = opt_fn x assertEqual ref res assertEqual cnts frame_count test_fail_on_tensor_shape_change fn dt dt x + x = torch randn dt = dt x = x opt_fn = torch compile fn backend= eager opt_fn dt assertRaisesRegex RuntimeError Recompilation triggered skip_guard_eval_unsafe stance torch compiler set_stance skip_guard_eval_unsafe=True x = torch randn dt x = x opt_fn dt test_cache_line_pickup fn x a=None b=None x = x x = x b x = x x opt_fn = torch compile fn backend= eager x = torch ones ref = opt_fn x a=None b=None ref = opt_fn x a= b=None ref = opt_fn x a= b= torch compiler set_stance skip_guard_eval_unsafe=True res = opt_fn x a=None b=None res = opt_fn x a= b=None res = opt_fn x a= b= assertEqual ref res assertEqual ref res assertEqual ref res __name__ == __main__ torch _dynamo test_case run_tests run_tests