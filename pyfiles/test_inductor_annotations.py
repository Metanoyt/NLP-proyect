Owner s module inductor torch torch _inductor config inductor_config torch _inductor test_case run_tests TestCase torch _inductor utils run_and_get_code torch testing _internal triton_utils requires_cuda_and_triton InductorAnnotationTestCase TestCase get_code f b + b b = torch randn device= cuda b = torch randn device= cuda f_comp = torch compile f _ code = run_and_get_code f_comp b code requires_cuda_and_triton test_no_annotations code = get_code assertTrue torch cuda nvtx code assertTrue training_annotation code inductor_config patch annotate_training=True requires_cuda_and_triton test_training_annotation code = get_code assertTrue torch cuda nvtx code assertTrue code count training_annotation = nvtx _device_range_start inference = assertTrue code count nvtx _device_range_end training_annotation = __name__ == __main__ run_tests