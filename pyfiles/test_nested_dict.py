Owner s oncall distributed torch torch distributed checkpoint _nested_dict flatten_state_dict unflatten_state_dict torch testing _internal common_utils run_tests TestCase TestFlattening TestCase test_flattening_round_trip - None state_dict = key key key key torch tensor key torch tensor x key flatten_dict mapping = flatten_state_dict state_dict flatten_dict key key key key tensor key tensor key x key key key restored = unflatten_state_dict flatten_dict mapping assertEqual state_dict restored test_mapping - None state_dict = k k torch tensor k torch tensor k x k y _ mapping = flatten_state_dict state_dict flatten_dict k k tensor k k k tensor k x k y mapping k k k k k k k k k k k k assertEqual k mapping k assertEqual k mapping k assertEqual k mapping k assertEqual k k mapping k k assertEqual k mapping k assertEqual k mapping k assertEqual k k mapping k k __name__ == __main__ run_tests