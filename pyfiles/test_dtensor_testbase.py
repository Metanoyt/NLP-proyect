Copyright c Meta Platforms Inc affiliates Owner s oncall distributed numpy np torch distributed device_mesh DeviceMesh init_device_mesh torch testing _internal common_utils run_tests torch testing _internal distributed _tensor common_dtensor DTensorTestBase with_comms DTensorTestBaseUtilCPUTest DTensorTestBase This tests basic functionalities DTensorTestBase working expected CPU regardless presence CUDA devices property backend gloo property device_type - str cpu property world_size np prod list mesh_dim_sizes values item property mesh_dim_sizes - dict str int Mapping mesh dimension names sizes data fsdp tensor build_device_mesh - DeviceMesh init_device_mesh device_type mesh_shape=tuple mesh_dim_sizes values mesh_dim_names=tuple mesh_dim_sizes keys with_comms test_dtensor_testbase_destroy_pg This tests destroy_pg correctly finishes device_mesh = build_device_mesh noqa F __name__ == __main__ run_tests