mypy ignore-errors inspect itertools _funcs_impl _reductions_impl _normalizations normalizer _funcs_impl py contains functions which mimic NumPy s eponymous equivalents consume PyTorch tensors dtypes They also type annotated Pull these functions _funcs_impl decorate them normalizer which - Converts any input ` np ndarray ` ` torch _numpy ndarray ` list lists Python scalars etc into ` torch Tensor ` - Maps NumPy dtypes PyTorch dtypes - If input ` axis ` kwarg ndarray maps into tuple - Implements semantics ` out= ` arg - Wraps back outputs into ` torch _numpy ndarrays ` _public_functions mod is_public_function f inspect isfunction f f __name__ startswith _ inspect getmembers mod is_public_function We fill __all__ loop below __all__ = decorate implementer functions argument normalizers export top namespace name func itertools chain _public_functions _funcs_impl _public_functions _reductions_impl name percentile quantile median decorated = normalizer func promote_scalar_result=True name == einsum normalized manually decorated = func decorated = normalizer func decorated __qualname__ = name decorated __name__ = name vars name = decorated __all__ append name Vendored objects numpy lib index_tricks IndexExpression Written Konrad Hinsen hinsen cnrs-orleans fr last revision - - Cosmetic changes T Oliphant __init__ maketuple maketuple = maketuple __getitem__ item maketuple isinstance item tuple item item index_exp = IndexExpression maketuple=True s_ = IndexExpression maketuple=False __all__ += index_exp s_