operator_benchmark op_bench torch Microbenchmarks sum reduction operator Configs PT add operator sum_configs = op_bench cross_product_configs R= Length reduced dimension V= Length other dimension dim= contiguous= True False device= cpu cuda tags= short + op_bench cross_product_configs R= V= dim= contiguous= True False device= cpu cuda tags= long SumBenchmark op_bench TorchBenchmarkBase init R V dim contiguous device shape = R V dim == V R tensor = torch rand shape device=device contiguous storage = torch empty s s shape device=device storage = tensor input_tensor = storage input_tensor = tensor inputs = input_tensor input_tensor dim dim set_module_name sum forward input_tensor dim int input_tensor sum dim=dim op_bench generate_pt_test sum_configs SumBenchmark __name__ == __main__ op_bench benchmark_runner main