Owner s oncall distributed collections OrderedDict typing TYPE_CHECKING torch torch distributed checkpoint _traverse _traverse torch testing _internal common_utils run_tests TestCase TYPE_CHECKING torch distributed checkpoint metadata STATE_DICT_TYPE TestTraverse TestCase Test util methods _traverse test_traverse_shallow - None state_dict = key key key key torch tensor data = collect_data path value nonlocal data data path = value _traverse traverse_state_dict state_dict collect_data assertIn key data assertEqual data key assertIn key data assertEqual data key assertIn key data assertEqual data key assertIn key data assertEqual data key assertIn key data assertEqual data key torch tensor test_traverse_nested_list - None state_dict = key torch tensor torch tensor data = collect_data path value nonlocal data data path = value _traverse traverse_state_dict state_dict collect_data assertNotIn key data assertIn key data assertEqual data key torch tensor assertIn key data assertEqual data key assertIn key data assertEqual data key torch tensor assertIn key data assertEqual data key assertNotIn key data assertIn key data assertEqual data key test_traverse_nested_dict - None state_dict = key key key torch tensor data = collect_data path value nonlocal data data path = value _traverse traverse_state_dict state_dict collect_data assertNotIn key data assertIn key key data assertEqual data key key assertIn key key data assertEqual data key key torch tensor test_traverse_doesnt_ignore_intermediate_collections - None state_dict STATE_DICT_TYPE = key key key torch tensor data = collect_data path value nonlocal data data path = value _traverse traverse_state_dict state_dict collect_data assertIn key key key data assertEqual data key key key torch tensor test_traverse_with_ordered_dict - None state_dict = OrderedDict key torch tensor data = collect_data path value nonlocal data data path = value _traverse traverse_state_dict state_dict collect_data assertIn key data assertEqual data key assertIn key data assertEqual data key torch tensor test_set_element - None state_dict STATE_DICT_TYPE = _traverse set_element state_dict k assertEqual state_dict k _traverse set_element state_dict k assertEqual state_dict k None None _traverse set_element state_dict k assertEqual state_dict k None _traverse set_element state_dict k assertEqual state_dict k None _traverse set_element state_dict k k assertEqual state_dict k k _traverse set_element state_dict k k assertEqual state_dict k k test_get_element - None state_dict = b c d assertEqual _traverse get_element state_dict assertEqual _traverse get_element state_dict b assertEqual _traverse get_element state_dict b c d assertIsNone _traverse get_element state_dict c assertIsNone _traverse get_element state_dict assertIsNone _traverse get_element state_dict b assertIsNone _traverse get_element state_dict b assertIsNone _traverse get_element state_dict b assertIsNone _traverse get_element state_dict b d __name__ == __main__ run_tests