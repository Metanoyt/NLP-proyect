numpy operator_benchmark op_bench torch Microbenchmarks gather operator An example input configuration M= N= dim= gather_configs_short = op_bench config_list attr_names= M N dim attrs= cross_product_configs= device cpu cuda tags= short gather_configs_long = op_bench cross_product_configs M= N= dim= device= cpu cuda tags= long GatherBenchmark op_bench TorchBenchmarkBase init M N dim device min_val = M dim == N numpy random seed - inputs = input_one torch rand M N device=device dim dim index torch tensor numpy random randint min_val M N device=device set_module_name gather forward input_one dim int index torch gather input_one dim index op_bench generate_pt_test gather_configs_short + gather_configs_long GatherBenchmark __name__ == __main__ op_bench benchmark_runner main