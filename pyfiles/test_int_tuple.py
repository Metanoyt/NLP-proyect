ruff noqa PGH G F flake noqa Owner s oncall distributed ################################################################################################# Copyright c - NVIDIA CORPORATION AFFILIATES All rights reserved SPDX-License-Identifier BSD- -Clause Redistribution use source binary forms without modification permitted provided following conditions met Redistributions source code must retain above copyright notice list conditions following disclaimer Redistributions binary form must reproduce above copyright notice list conditions following disclaimer documentation other materials provided distribution Neither name copyright holder nor names its contributors may used endorse promote products derived software without specific prior written permission THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT INDIRECT INCIDENTAL SPECIAL EXEMPLARY OR CONSEQUENTIAL DAMAGES INCLUDING BUT NOT LIMITED TO PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES LOSS OF USE DATA OR PROFITS OR BUSINESS INTERRUPTION HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY WHETHER IN CONTRACT STRICT LIABILITY OR TORT INCLUDING NEGLIGENCE OR OTHERWISE ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE ################################################################################################# Unit tests _pycute int_tuple torch distributed _pycute torch testing _internal common_utils run_tests TestCase TestIntTuple TestCase test_product assertEqual product assertEqual product assertEqual product product test_inner_product assertEqual inner_product assertEqual inner_product assertEqual inner_product test_shape_div assertEqual shape_div assertEqual shape_div assertEqual shape_div assertEqual shape_div assertEqual shape_div test_suffix_product assertEqual suffix_product assertEqual suffix_product assertEqual suffix_product assertEqual suffix_product assertEqual suffix_product test_crd idx_basic Test basic int int case assertEqual crd idx assertEqual crd idx assertEqual crd idx Test custom stride assertEqual crd idx assertEqual crd idx test_crd idx_tuple Test tuple coordinates default stride assertEqual crd idx + = assertEqual crd idx assertEqual crd idx + = Test custom stride assertEqual crd idx + = Test D case assertEqual crd idx + + = test_crd idx_none Test None coordinate should default assertEqual crd idx None assertEqual crd idx None test_crd idx_int_with_tuple_shape Test single integer coordinate multi-dimensional shape stride When crd int shape tuple converts int multi-dim coordinate first assertEqual crd idx - - + = assertEqual crd idx - - + = assertEqual crd idx - - + = assertEqual crd idx - - + = Test non-trivial strides assertEqual crd idx - - + = assertEqual crd idx - - + = assertEqual crd idx - - + = assertEqual crd idx - - + = assertEqual crd idx - - + = assertEqual crd idx - - + = Test larger strides assertEqual crd idx - - + = assertEqual crd idx - - + = assertEqual crd idx - - + = assertEqual crd idx - - + = assertEqual crd idx - - + = assertEqual crd idx - - + = Test D shape various strides assertEqual crd idx - - + + = assertEqual crd idx - - + + = assertEqual crd idx - - + + = assertEqual crd idx - - + + = assertEqual crd idx - - + + = assertEqual crd idx - - + + = assertEqual crd idx - - = Test zero-length shape strides assertEqual crd idx - - sum = test_idx crd_basic Test basic int int case assertEqual idx crd assertEqual idx crd assertEqual idx crd Test custom stride assertEqual idx crd = assertEqual idx crd = test_idx crd_tuple Test tuple shape default stride assertEqual idx crd - assertEqual idx crd assertEqual idx crd Test D case assertEqual idx crd test_crd idx_idx crd_roundtrip Test crd idx idx crd inverse operations shapes = shape shapes size = product shape idx range size crd = idx crd idx shape recovered_idx = crd idx crd shape assertEqual recovered_idx idx f Failed roundtrip shape shape idx idx test_idx crd_crd idx_roundtrip Test roundtrip starting coordinates test_cases = crd shape test_cases idx = crd idx crd shape recovered_crd = idx crd idx shape assertEqual recovered_crd crd f Failed roundtrip crd crd shape shape __name__ == __main__ run_tests