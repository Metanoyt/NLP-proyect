mypy allow-untyped-defs collections abc Sized typing TypeVar torch utils data datapipes _decorator functional_datapipe torch utils data datapipes datapipe MapDataPipe __all__ = ConcaterMapDataPipe ZipperMapDataPipe _T_co = TypeVar _T_co covariant=True functional_datapipe concat ConcaterMapDataPipe MapDataPipe r Concatenate multiple Map DataPipes functional name ` ` concat ` ` The new index cumulative sum source DataPipes For example there source DataPipes both length index resulting ` ConcatMapDataPipe ` would refer elements first DataPipe would refer elements second DataPipe Args datapipes Map DataPipes being concatenated Example xdoctest +SKIP torchdata datapipes map SequenceWrapper dp = SequenceWrapper range dp = SequenceWrapper range concat_dp = dp concat dp list concat_dp datapipes tuple MapDataPipe __init__ datapipes MapDataPipe len datapipes == raise ValueError Expected least one DataPipe got nothing all isinstance dp MapDataPipe dp datapipes raise TypeError Expected all inputs ` MapDataPipe ` all isinstance dp Sized dp datapipes raise TypeError Expected all inputs ` Sized ` datapipes = datapipes type ignore assignment __getitem__ index - _T_co type ignore type-var offset = dp datapipes pyrefly ignore bad-argument-type index - offset len dp dp index - offset pyrefly ignore bad-argument-type offset += len dp raise IndexError f Index index out range __len__ - int pyrefly ignore bad-argument-type sum len dp dp datapipes functional_datapipe zip ZipperMapDataPipe MapDataPipe tuple _T_co r Aggregates elements into tuple each input DataPipes functional name ` ` zip ` ` This MataPipe out bound soon shortest input DataPipe exhausted Args datapipes Map DataPipes being aggregated Example xdoctest +SKIP torchdata datapipes map SequenceWrapper dp = SequenceWrapper range dp = SequenceWrapper range zip_dp = dp zip dp list zip_dp datapipes tuple MapDataPipe _T_co __init__ datapipes MapDataPipe _T_co - None len datapipes == raise ValueError Expected least one DataPipe got nothing all isinstance dp MapDataPipe dp datapipes raise TypeError Expected all inputs ` MapDataPipe ` all isinstance dp Sized dp datapipes raise TypeError Expected all inputs ` Sized ` datapipes = datapipes __getitem__ index - tuple _T_co res = dp datapipes try res append dp index except IndexError e raise IndexError f Index index out range one input MapDataPipes dp e tuple res __len__ - int pyrefly ignore bad-argument-type min len dp dp datapipes