Owner s module inductor torch torch _dynamo repro aoti AOTIMinifierError export_for_aoti_minifier get_module_string torch testing _internal common_utils run_tests TestCase MinifierUtilsTests TestCase test_invalid_output SimpleModel torch nn Module __init__ super __init__ linear = torch nn Linear forward x graph module linear model = SimpleModel Here we obtained graph invalid output symbolic_trace simplicity can also obtained running functorch compile minifier exported graph traced = torch fx symbolic_trace model strict True False gm = export_for_aoti_minifier traced torch randn strict=strict assertTrue gm None test_non_exportable SimpleModel torch nn Module forward x x sum model = SimpleModel Force export failure providing input in-compatible shapes inputs = torch randn torch randn strict True False gm = export_for_aoti_minifier model inputs strict=strict skip_export_error=True print gm assertTrue gm None assertRaises AOTIMinifierError export_for_aoti_minifier model inputs strict=strict skip_export_error=False test_convert_module_to_string M torch nn Module forward x flag flag = flag item true_fn x x clone torch cond flag true_fn true_fn x inputs = torch rand torch tensor model = M gm = torch export export model inputs strict=False module check_guards=False TODO make NNModuleToString convert generate string nested submodules model_string = get_module_string gm assertExpectedInline model_string strip \ torch nn Repro torch nn Module __init__ - None super __init__ true_graph_ = lambda false_graph_ = lambda forward x flag x flag = fx_pytree tree_flatten_spec x flag _in_spec item = torch ops aten item default flag flag = None gt = item item = None true_graph_ = true_graph_ false_graph_ = false_graph_ cond = torch ops higher_order cond gt true_graph_ false_graph_ x gt = true_graph_ = false_graph_ = x = None getitem = cond cond = None pytree tree_unflatten getitem _out_spec __name__ == __main__ run_tests