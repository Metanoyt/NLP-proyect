os typing Union filesystem FileSystemReader FileSystemWriter storage StorageReader StorageWriter _storage_setup storage Union StorageReader StorageWriter None checkpoint_id Union str os PathLike None reader bool = False - Union None StorageReader StorageWriter storage checkpoint_id None storage reset checkpoint_id storage checkpoint_id raise RuntimeError ` checkpoint_id ` must specified storage_reader storage_writer None targets list type Union StorageReader StorageWriter = reader targets = FileSystemReader targets = FileSystemWriter try _fsspec_filesystem FsspecReader FsspecWriter targets append FsspecReader reader FsspecWriter except Exception pass target targets target validate_checkpoint_id checkpoint_id storage = target checkpoint_id type ignore call-arg storage reset checkpoint_id storage raise RuntimeError Cannot detect which StorageReader StorageWriter use Please specify storage_reader storage_writer