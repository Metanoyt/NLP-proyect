logging os re collections defaultdict click pandas pd tabulate tabulate log = logging getLogger __name__ gmean s s product len s find_csv_files path perf_compare Recursively search all CSV files directory subdirectories whose name contains target string is_csv f perf_compare regex = r training_ torchbench &#124; huggingface &#124; timm_models \ csv re match regex f None f endswith _performance csv csv_files = root dirs files os walk path file files is_csv file csv_files append os path join root file csv_files click command click argument directory default= artifacts click option -- amp is_flag=True click option -- float is_flag=True click option -- perf-compare is_flag=True help= Set CSVs generated running manually action rather than picking them nightly job main directory amp float perf_compare Given directory containing multiple CSVs -- performance benchmark runs aggregates generates summary statistics similar web UI https torchci-git-fork-huydhn-add-compilers-bench- abf -fbopensource vercel app benchmark compilers This most useful you ve downloaded CSVs CI need quickly look aggregate stats The CSVs expected follow exactly same naming convention used CI You may also interested https docs google com document d DQQxIgmKa eF HByDTLlcJdvefC GwtsklJUgLs fQ edit# which explains how interpret raw csv data dtypes = amp float amp float dtypes = amp float amp dtypes = float dfs = defaultdict list f find_csv_files directory perf_compare try dfs os path basename f append pd read_csv f except Exception log warning failed parsing s f raise dtype - statistic - benchmark - compiler - value results = defaultdict dtype lambda defaultdict statistic lambda defaultdict dict benchmark compiler - value k v sorted dfs items perf_compare regex = r training_ torchbench &#124; huggingface &#124; timm_models \ csv m = re match regex k assert m None k compiler = inductor benchmark = m group dtype = float mode = training device = cuda regex = + _ torchbench &#124; huggingface &#124; timm_models _ float &#124; amp _ inference &#124; training _ cpu &#124; cuda _ r performance\ csv m = re match regex k compiler = m group benchmark = m group dtype = m group mode = m group device = m group df = pd concat v df = df dropna query speedup = statistics = speedup gmean df speedup comptime df compilation_latency mean memory gmean df compression_ratio dtype dtypes continue statistic v statistics items results f device dtype mode statistic benchmark compiler = v descriptions = speedup Geometric mean speedup comptime Mean compilation time memory Peak memory compression ratio dtype_mode r results items print f dtype_mode performance results statistic data r items print f ## descriptions statistic table = row_name data next iter data keys row = row_name col_name data row append round data col_name row_name table append row headers = list data keys print tabulate table headers=headers print main