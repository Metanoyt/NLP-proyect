mypy ignore-errors unittest collections abc Callable functools partial itertools product numpy torch torch testing _internal common_dtype floating_types torch testing _internal common_utils TEST_SCIPY torch testing _internal opinfo core DecorateInfo ErrorInput OpInfo SampleInput TEST_SCIPY scipy signal sample_inputs_window op_info device dtype requires_grad args kwargs r Base function used create sample inputs windows For additional required args you should use args well kwargs additional keyword arguments Remove include_conjugated_inputs kwargs kwargs pop include_conjugated_inputs None Tests window sizes up samples size sym product range True False yield SampleInput size args sym=sym device=device dtype=dtype requires_grad=requires_grad kwargs reference_inputs_window op_info device dtype requires_grad args kwargs r Reference inputs function use windows which have common signature i e window size sym only Implement other special functions windows have specific signature See exponential gaussian windows instance yield sample_inputs_window op_info device dtype requires_grad args kwargs cases = size cases yield SampleInput size sym=False yield SampleInput size sym=True reference_inputs_exponential_window op_info device dtype requires_grad kwargs yield sample_inputs_window op_info device dtype requires_grad kwargs cases = center tau center tau center tau center tau center tau tau size kw cases yield SampleInput size sym=False kw kw center = None yield SampleInput size sym=True kw reference_inputs_gaussian_window op_info device dtype requires_grad kwargs yield sample_inputs_window op_info device dtype requires_grad kwargs cases = std std std std std std size kw cases yield SampleInput size sym=False kw yield SampleInput size sym=True kw reference_inputs_kaiser_window op_info device dtype requires_grad kwargs yield sample_inputs_window op_info device dtype requires_grad kwargs cases = beta beta beta beta beta beta size kw cases yield SampleInput size sym=False kw yield SampleInput size sym=True kw reference_inputs_general_cosine_window op_info device dtype requires_grad kwargs yield sample_inputs_window op_info device dtype requires_grad kwargs cases = size kw cases yield SampleInput size sym=False kw yield SampleInput size sym=True kw reference_inputs_general_hamming_window op_info device dtype requires_grad kwargs yield sample_inputs_window op_info device dtype requires_grad kwargs cases = alpha alpha alpha alpha alpha alpha size kw cases yield SampleInput size sym=False kw yield SampleInput size sym=True kw error_inputs_window op_info device args kwargs Tests windows have negative size yield ErrorInput SampleInput - args dtype=torch float device=device kwargs error_type=ValueError error_regex= requires non-negative window length got M=- Tests window tensors torch strided instance torch sparse_coo yield ErrorInput SampleInput args layout=torch sparse_coo device=device dtype=torch float kwargs error_type=ValueError error_regex= implemented strided tensors only got torch sparse_coo Tests window tensors floating point dtypes instance torch long yield ErrorInput SampleInput args dtype=torch long device=device kwargs error_type=ValueError error_regex= expects float float dtypes got torch int Tests window tensors bfloat yield ErrorInput SampleInput args dtype=torch bfloat device=device kwargs error_type=ValueError error_regex= expects float float dtypes got torch bfloat Tests window tensors float yield ErrorInput SampleInput args dtype=torch float device=device kwargs error_type=ValueError error_regex= expects float float dtypes got torch float error_inputs_exponential_window op_info device kwargs Yield common error inputs yield error_inputs_window op_info device kwargs Tests negative decay values yield ErrorInput SampleInput tau=- dtype=torch float device=device kwargs error_type=ValueError error_regex= Tau must positive got - instead Tests symmetric windows given center value yield ErrorInput SampleInput center= sym=True dtype=torch float device=device error_type=ValueError error_regex= Center must None symmetric windows error_inputs_gaussian_window op_info device kwargs Yield common error inputs yield error_inputs_window op_info device std= kwargs Tests negative standard deviations yield ErrorInput SampleInput std=- dtype=torch float device=device kwargs error_type=ValueError error_regex= Standard deviation must positive got - instead error_inputs_kaiser_window op_info device kwargs Yield common error inputs yield error_inputs_window op_info device beta= kwargs Tests negative beta yield ErrorInput SampleInput beta=- dtype=torch float device=device kwargs error_type=ValueError error_regex= beta must non-negative got - instead error_inputs_general_cosine_window op_info device kwargs Yield common error inputs yield error_inputs_window op_info device a= kwargs Tests negative beta yield ErrorInput SampleInput a=None dtype=torch float device=device kwargs error_type=TypeError error_regex= Coefficients must list tuple yield ErrorInput SampleInput a= dtype=torch float device=device kwargs error_type=ValueError error_regex= Coefficients cannot empty reference_signal_window fn Callable r Wrapper scipy signal window references Discards keyword arguments window reference functions don t have matching signature torch e g gaussian window _fn args dtype=numpy float device=None layout=torch strided requires_grad=False kwargs r The unused arguments defined disregard those values fn args kwargs astype dtype _fn make_signal_windows_opinfo name str ref Callable sample_inputs_func Callable reference_inputs_func Callable error_inputs_func Callable skips tuple DecorateInfo = r Helper function create OpInfo objects related different windows OpInfo name=name ref=ref TEST_SCIPY None dtypes=floating_types sample_inputs_func=sample_inputs_func reference_inputs_func=reference_inputs_func error_inputs_func=error_inputs_func supports_out=False supports_autograd=False skips= TODO same https github com pytorch pytorch issues also see arange new_full fails match any schemas despite working interpreter DecorateInfo unittest expectedFailure TestOperatorSignatures test_get_torch_func_signature_exhaustive fails match any schemas despite working interpreter DecorateInfo unittest expectedFailure TestJit test_variant_consistency_jit skip these tests since we have non tensor input DecorateInfo unittest skip Skipped TestCommon test_noncontiguous_samples DecorateInfo unittest skip Skipped TestCommon test_variant_consistency_eager DecorateInfo unittest skip Skipped TestMathBits test_conj_view DecorateInfo unittest skip Skipped TestMathBits test_neg_conj_view DecorateInfo unittest skip Skipped TestMathBits test_neg_view DecorateInfo unittest skip Skipped TestVmapOperatorsOpInfo test_vmap_exhaustive DecorateInfo unittest skip Skipped TestVmapOperatorsOpInfo test_op_has_batch_rule DecorateInfo unittest skip Buggy MPS now mistakenly promotes float TestCommon test_numpy_ref_mps skips op_db list OpInfo = make_signal_windows_opinfo name= signal windows hamming ref=reference_signal_window scipy signal windows hamming TEST_SCIPY None sample_inputs_func=sample_inputs_window reference_inputs_func=reference_inputs_window error_inputs_func=error_inputs_window make_signal_windows_opinfo name= signal windows hann ref=reference_signal_window scipy signal windows hann TEST_SCIPY None sample_inputs_func=sample_inputs_window reference_inputs_func=reference_inputs_window error_inputs_func=error_inputs_window make_signal_windows_opinfo name= signal windows bartlett ref=reference_signal_window scipy signal windows bartlett TEST_SCIPY None sample_inputs_func=sample_inputs_window reference_inputs_func=reference_inputs_window error_inputs_func=error_inputs_window make_signal_windows_opinfo name= signal windows blackman ref=reference_signal_window scipy signal windows blackman TEST_SCIPY None sample_inputs_func=sample_inputs_window reference_inputs_func=reference_inputs_window error_inputs_func=error_inputs_window make_signal_windows_opinfo name= signal windows cosine ref=reference_signal_window scipy signal windows cosine TEST_SCIPY None sample_inputs_func=sample_inputs_window reference_inputs_func=reference_inputs_window error_inputs_func=error_inputs_window make_signal_windows_opinfo name= signal windows exponential ref=reference_signal_window scipy signal windows exponential TEST_SCIPY None sample_inputs_func=partial sample_inputs_window tau= reference_inputs_func=partial reference_inputs_exponential_window tau= error_inputs_func=error_inputs_exponential_window make_signal_windows_opinfo name= signal windows gaussian ref=reference_signal_window scipy signal windows gaussian TEST_SCIPY None sample_inputs_func=partial sample_inputs_window std= reference_inputs_func=partial reference_inputs_gaussian_window std= error_inputs_func=error_inputs_gaussian_window skips= DecorateInfo unittest skip Buggy MPS now mistakenly promotes float TestCommon test_numpy_ref_mps make_signal_windows_opinfo name= signal windows kaiser ref=reference_signal_window scipy signal windows kaiser TEST_SCIPY None sample_inputs_func=partial sample_inputs_window beta= reference_inputs_func=partial reference_inputs_kaiser_window beta= error_inputs_func=error_inputs_kaiser_window make_signal_windows_opinfo name= signal windows general_cosine ref=reference_signal_window scipy signal windows general_cosine TEST_SCIPY None sample_inputs_func=partial sample_inputs_window a= reference_inputs_func=partial reference_inputs_general_cosine_window a= error_inputs_func=error_inputs_general_cosine_window make_signal_windows_opinfo name= signal windows general_hamming ref=reference_signal_window scipy signal windows general_hamming TEST_SCIPY None sample_inputs_func=partial sample_inputs_window alpha= reference_inputs_func=partial reference_inputs_general_hamming_window alpha= error_inputs_func=error_inputs_window make_signal_windows_opinfo name= signal windows nuttall ref=reference_signal_window scipy signal windows nuttall TEST_SCIPY None sample_inputs_func=sample_inputs_window reference_inputs_func=reference_inputs_window error_inputs_func=error_inputs_window