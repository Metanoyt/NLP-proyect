Owner s oncall jit os sys torch torch nn Make helper files test importable pytorch_test_dir = os path dirname os path dirname os path realpath __file__ sys path append pytorch_test_dir torch testing _internal common_utils raise_on_run_directly torch testing _internal jit_utils JitTestCase Sequence nn Module __init__ - None super __init__ lstm = nn LSTMCell lstm = nn LSTMCell linear = nn Linear forward input outputs = h_t = torch zeros input size c_t = torch zeros input size h_t = torch zeros input size c_t = torch zeros input size input_t input split dim= h_t c_t = lstm input_t h_t c_t h_t c_t = lstm h_t h_t c_t output = linear h_t outputs += output outputs = torch cat outputs dim= outputs TestScriptProfile JitTestCase test_basic seq = torch jit script Sequence p = torch jit _ScriptProfile p enable seq torch rand p disable assertNotEqual p dump_string test_script seq = Sequence p = torch jit _ScriptProfile p enable torch jit script fn _ = seq torch rand fn p disable assertNotEqual p dump_string test_multi seq = torch jit script Sequence profiles = torch jit _ScriptProfile _ range p profiles p enable last = None while len profiles seq torch rand p = profiles pop p disable stats = p dump_string assertNotEqual stats last assertNotEqual stats last last = stats test_section seq = Sequence torch jit script fn max int _ = seq torch rand max p = torch jit _ScriptProfile p enable fn p disable s = p dump_string fn p disable s = p dump_string p enable fn p disable s = p dump_string assertEqual s s assertNotEqual s s test_empty p = torch jit _ScriptProfile p enable p disable assertEqual p dump_string __name__ == __main__ raise_on_run_directly test test_jit py