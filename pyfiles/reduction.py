benchmark ReduceBench benchmark Benchmark __init__ mode device dtype case M N K skip_input_transform super __init__ mode device dtype case = case M = M N = N K = K _set_skip_input_transform skip_input_transform inputs = randn M N K device=device dtype=dtype requires_grad=self requires_grad case == row dims = case == mid dims = case == col dims = case == full dims = raise ValueError f invalid case case forward inputs skip_input_transform x = inputs x = add inputs y = sum x dims y config case == full M N K _skip_input_transform_str M N K _skip_input_transform_str staticmethod default_configs s staticmethod module reduce memory_workload mode == fwd sol_count = algorithmic_count = sol_count = + algorithmic_count = + buffer_size = M N K sol buffer_size sol_count algorithmic buffer_size algorithmic_count _set_skip_input_transform input_str In test setting s will skip input transformation s will input_str == s skip_input_transform = False input_str == s skip_input_transform = True raise ValueError f invalid skip_input_transform input_str _skip_input_transform_str skip_input_transform s s ReduceRowBench ReduceBench __init__ mode device dtype M N K skip_input_transform super __init__ mode device dtype row M N K skip_input_transform staticmethod module reduce_row ReduceMidBench ReduceBench __init__ mode device dtype M N K skip_input_transform super __init__ mode device dtype mid M N K skip_input_transform staticmethod module reduce_mid ReduceColBench ReduceBench __init__ mode device dtype M N K skip_input_transform super __init__ mode device dtype col M N K skip_input_transform staticmethod module reduce_col ReduceFullBench ReduceBench __init__ mode device dtype M skip_input_transform super __init__ mode device dtype full M skip_input_transform config M N K _skip_input_transform_str staticmethod default_configs s staticmethod module reduce_full Reduce DBench benchmark Benchmark A benchmark validate dimensional reduction performance Only simple add fused induce fuser isolate reduction perf __init__ mode device dtype red_dim dim dim super __init__ mode device dtype red_dim = red_dim dim = dim dim = dim inputs = randn dim dim device=device dtype=dtype requires_grad=self requires_grad red_dim = red_dim = raise ValueError f invalid reduction dimension red_dim forward inputs x = add inputs y = sum x red_dim y config red_dim dim dim staticmethod default_configs staticmethod module reduce d staticmethod input_iterable True memory_workload assert mode == fwd Only forward operation modeled buffer_size = dim dim red_dim == buffer_size += dim buffer_size += dim sol buffer_size algorithmic buffer_size Reduce DInnerBench Reduce DBench __init__ mode device dtype dim dim super __init__ mode device dtype dim dim staticmethod default_configs parent_config = Reduce DBench default_configs parent_config config parent_config = super config parent_config staticmethod module reduce d_inner Reduce DOuterBench Reduce DBench __init__ mode device dtype dim dim super __init__ mode device dtype dim dim staticmethod default_configs parent_config = Reduce DBench default_configs parent_config config parent_config = super config parent_config staticmethod module reduce d_outer benchmark register_benchmark_class ReduceRowBench benchmark register_benchmark_class ReduceMidBench benchmark register_benchmark_class ReduceColBench benchmark register_benchmark_class Reduce DInnerBench benchmark register_benchmark_class Reduce DOuterBench benchmark register_benchmark_class ReduceFullBench DynamicReduce DBench benchmark DynamicShape Reduce DBench A benchmark validate dimensional reduction performance Only simple add fused induce fuser isolate reduction perf __init__ mode device dtype red_dim dim dim benchmark DynamicShape __init__ Reduce DBench __init__ mode device dtype red_dim dim dim instantiate_input dim dim = rand_shape dim dim inputs = randn dim dim device=self device dtype=self dtype requires_grad=self requires_grad staticmethod module dynamicreduce d DynamicReduce DInnerBench DynamicReduce DBench __init__ mode device dtype dim dim super __init__ mode device dtype dim dim staticmethod default_configs parent_config = DynamicReduce DBench default_configs parent_config config parent_config = super config parent_config staticmethod module reduce d_dynamic_inner DynamicReduce DOuterBench DynamicReduce DBench __init__ mode device dtype dim dim super __init__ mode device dtype dim dim staticmethod default_configs parent_config = DynamicReduce DBench default_configs parent_config config parent_config = super config parent_config staticmethod module reduce d_dynamic_outer benchmark register_benchmark_class DynamicReduce DInnerBench benchmark register_benchmark_class DynamicReduce DOuterBench