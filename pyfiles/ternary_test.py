operator_benchmark op_bench torch Microbenchmarks ternary operators ternary_ops = op_bench op_list attr_names= op_name op_func attrs= addcmul torch addcmul addcdiv torch addcdiv ternary_configs_short = op_bench config_list attr_names= M N attrs= cross_product_configs= device cpu dtype torch float torch bfloat tags= short ternary_configs_long = op_bench cross_product_configs M= N= device= cpu cuda dtype= torch float torch bfloat tags= long TernaryOpBenchmark op_bench TorchBenchmarkBase init M N device dtype op_func inputs = input_ torch rand M N device=device dtype=dtype tensor torch rand M N device=device dtype=dtype tensor torch rand M N device=device dtype=dtype op_func = op_func forward input_ tensor tensor op_func input_ tensor tensor op_bench generate_pt_tests_from_op_list ternary_ops ternary_configs_short + ternary_configs_long TernaryOpBenchmark __name__ == __main__ op_bench benchmark_runner main