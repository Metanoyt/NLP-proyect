mypy allow-untyped-defs Async API This module contains API parallelism TorchScript notably torch jit fork torch jit wait This intended imported directly please use exposed functionalities ` torch jit ` torch torch _jit_internal Future torch jit _builtins _register_builtin torch utils set_module set_module Future torch jit fork func args kwargs r Create asynchronous task executing ` func ` reference value result execution ` fork ` will immediately so value ` func ` may have been computed yet To force completion task access value invoke ` torch jit wait ` Future ` fork ` invoked ` func ` which returns ` T ` typed ` torch jit Future T ` ` fork ` calls can arbitrarily nested may invoked positional keyword arguments Asynchronous execution will only occur when run TorchScript If run pure python ` fork ` will execute parallel ` fork ` will also execute parallel when invoked while tracing however ` fork ` ` wait ` calls will captured exported IR Graph warning ` fork ` tasks will execute non-deterministically We recommend only spawning parallel fork tasks pure functions do modify their inputs module attributes global state Args func callable torch nn Module A Python function ` torch nn Module ` will invoked If executed TorchScript will execute asynchronously otherwise will Traced invocations fork will captured IR ` ` args ` ` ` ` kwargs ` ` arguments invoke ` func ` Returns ` torch jit Future T ` reference execution ` func ` The value ` T ` can only accessed forcing completion ` func ` through ` torch jit wait ` Example fork free function code-block python torch torch Tensor foo Tensor b int - Tensor + b bar fut torch jit Future Tensor = torch jit fork foo b= torch jit wait fut script_bar = torch jit script bar input = torch tensor only scripted version executes asynchronously assert script_bar input == bar input trace run asynchronously fork captured IR graph = torch jit trace bar input graph assert fork str graph Example fork module method code-block python torch torch Tensor AddMod torch nn Module forward Tensor b int + b Mod torch nn Module __init__ - None super __init__ mod = AddMod forward input fut = torch jit fork mod b= torch jit wait fut input = torch tensor mod = Mod assert mod input == torch jit script mod forward input torch _C fork func args kwargs wait future r Force completion ` torch jit Future T ` asynchronous task returning result task See func ` ~fork ` docs examples Args future torch jit Future T asynchronous task reference created through ` torch jit fork ` Returns ` T ` value completed task torch _C wait future _register_builtin wait aten wait