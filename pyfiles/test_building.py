Owner s module onnx Unit tests _building module __future__ annotations numpy np onnxscript onnxscript ir torch torch onnx _internal exporter _building _tensors torch testing _internal common_utils TestOpRecorder common_utils TestCase setUp opset_version = opset = onnxscript values Opset opset_version recorder = _building OpRecorder opset=self opset constant_farm= model = ir Model graph=ir Graph nodes= opset_imports= opset_version name= main_graph ir_version= producer_name= pytorch producer_version=torch __version__ test_skippable_castlike_is_ommited input_x = _tensors SymbolicTensor opset=self opset name= input_x input_x dtype = ir DataType FLOAT input_y = _tensors SymbolicTensor opset=self opset name= input_y input_y dtype = ir DataType FLOAT onnxscript evaluator default_as tracer = recorder cast = opset CastLike input_y input_x _ = opset Add input_x cast assertEqual len tracer nodes assertEqual tracer nodes op_type Add test_castlike_is_replaced_with_cast_when_it_is_traced input_x = _tensors SymbolicTensor opset=self opset name= input_x input_x dtype = ir DataType FLOAT input_y = _tensors SymbolicTensor opset=self opset name= input_y input_y dtype = ir DataType INT onnxscript evaluator default_as tracer = recorder cast = opset CastLike input_y input_x _ = opset Add input_x cast assertEqual len tracer nodes assertEqual tracer nodes op_type Cast assertEqual tracer nodes op_type Add test_python_constant_added_as_constant_nodes input_x = _tensors SymbolicTensor opset=self opset name= input_x shape=ir Shape new_shape = onnxscript evaluator default_as tracer = recorder _ = opset Reshape input_x new_shape assertEqual len tracer nodes assertEqual tracer nodes op_type Constant assertEqual tracer nodes attributes value value numpy np array new_shape assertEqual tracer nodes op_type Reshape test_process_python_sequence_with_allowed_sequence_type input_x = _tensors SymbolicTensor opset=self opset name= input_x shape=ir Shape input_y = _tensors SymbolicTensor opset=self opset name= input_y shape=ir Shape input_z = _tensors SymbolicTensor opset=self opset name= input_z shape=ir Shape onnxscript evaluator default_as tracer = recorder _ = opset SequenceAt input_x input_y input_z assertEqual len tracer nodes assertEqual tracer nodes op_type SequenceConstruct test_process_python_sequence_with_variadic_input input_x = _tensors SymbolicTensor opset=self opset name= input_x shape=ir Shape input_y = _tensors SymbolicTensor opset=self opset name= input_y shape=ir Shape input_z = _tensors SymbolicTensor opset=self opset name= input_z shape=ir Shape onnxscript evaluator default_as tracer = recorder _ = opset Max input_x input_y input_z assertEqual len tracer nodes assertEqual tracer nodes op_type Constant test_process_python_sequence_creates_extra_concat Elements list must D tensors input_x = _tensors SymbolicTensor opset=self opset name= input_x shape=ir Shape input_y = _tensors SymbolicTensor opset=self opset name= input_y shape=ir Shape input_z = _tensors SymbolicTensor opset=self opset name= input_z shape=ir Shape onnxscript evaluator default_as tracer = recorder _ = opset Add input_x input_y input_z assertEqual len tracer nodes assertEqual tracer nodes - op_type Concat assertEqual tracer nodes - attributes axis value test_process_python_sequence_mix_symbolic_constant_creates_extra_concat Elements list must D tensors input_x = _tensors SymbolicTensor opset=self opset name= input_x shape=ir Shape input_z = _tensors SymbolicTensor opset=self opset name= input_z shape=ir Shape onnxscript evaluator default_as tracer = recorder _ = opset Add input_x input_z assertEqual len tracer nodes assertEqual tracer nodes - op_type Concat assertEqual tracer nodes - attributes axis value test_process_python_sequence_mix_constant_symbolic_creates_extra_concat Elements list must D tensors input_x = _tensors SymbolicTensor opset=self opset name= input_x shape=ir Shape input_z = _tensors SymbolicTensor opset=self opset name= input_z shape=ir Shape onnxscript evaluator default_as tracer = recorder Constant first _ = opset Add input_x input_z assertEqual len tracer nodes assertEqual tracer nodes - op_type Concat assertEqual tracer nodes - attributes axis value __name__ == __main__ common_utils run_tests