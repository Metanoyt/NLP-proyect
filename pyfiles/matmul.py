numpy np benchmark MatMulBench benchmark Benchmark __init__ mode device dtype B M N K super __init__ mode device dtype B = B M = M N = N K = K d = rand B M N device=device dtype=dtype requires_grad=self requires_grad d = rand B N K device=device dtype=dtype requires_grad=self requires_grad inputs = d d forward d d y = matmul d d y reference np matmul numpy d numpy d config B M N K staticmethod module batch_matmul memory_workload mode == fwd sol_count = algorithmic_count = sol_count = + algorithmic_count = + + buffer_size = B M N + B M N + B N K sol buffer_size sol_count algorithmic buffer_size algorithmic_count compute_workload mode == fwd count = count = + + op_count = B M N K op_count count staticmethod default_configs benchmark register_benchmark_class MatMulBench