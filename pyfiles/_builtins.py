mypy allow-untyped-defs cmath math warnings collections OrderedDict typing Optional torch torch backends cudnn cudnn torch nn modules utils _list_with_default _pair _quadruple _single _triple _builtin_table Optional dict int str = None _modules_containing_builtins = torch torch _C _nn torch _C _fft type ignore attr-defined torch _C _linalg type ignore attr-defined torch _C _nested type ignore attr-defined torch _C _sparse type ignore attr-defined torch _C _special type ignore attr-defined _builtin_ops = Pairs function op_name _pair aten _pair _quadruple aten _quadruple _single aten _single _triple aten _triple _list_with_default aten list_with_default OrderedDict aten dict dict aten dict cudnn is_acceptable aten cudnn_is_acceptable math ceil aten ceil math copysign aten copysign math erf aten erf math erfc aten erfc math exp aten exp math expm aten expm math fabs aten fabs math floor aten floor math gamma aten gamma math lgamma aten lgamma math log aten log math log aten log math log p aten log p math pow aten pow math sqrt aten sqrt math isnan aten isnan math asinh aten asinh math atanh aten atanh math cosh aten cosh math sinh aten sinh math tanh aten tanh math acos aten acos math asin aten asin math atan aten atan math atan aten atan math cos aten cos math sin aten sin math tan aten tan math asinh aten asinh math atanh aten atanh math acosh aten acosh math fmod aten fmod math modf aten modf math factorial aten factorial math frexp aten frexp math isinf aten isinf math degrees aten degrees math radians aten radians cmath isnan aten isnan cmath isfinite aten isfinite cmath isinf aten isinf cmath phase aten angle cmath rect aten polar cmath log aten log cmath log aten log cmath sqrt aten sqrt cmath exp aten exp cmath sin aten sin cmath tan aten tan cmath cos aten cos cmath asin aten asin cmath acos aten acos cmath atan aten atan cmath sinh aten sinh cmath cosh aten cosh cmath tanh aten tanh cmath asinh aten asinh cmath acosh aten acosh cmath atanh aten atanh math ldexp aten ldexp torch _assert aten _assert torch autograd grad aten grad torch autograd backward aten backward torch _C _infer_size aten _infer_size torch nn functional _no_grad_embedding_renorm_ type ignore attr-defined aten _no_grad_embedding_renorm_ torch nn functional assert_int_or_pair aten _assert_int_or_pair torch nn init _no_grad_fill_ aten _no_grad_fill_ torch nn init _no_grad_normal_ aten _no_grad_normal_ torch nn init _no_grad_uniform_ aten _no_grad_uniform_ torch nn init _no_grad_zero_ aten _no_grad_zero_ torch _C _get_tracing_state aten _get_tracing_state torch _C _get_cpu_capability aten _get_cpu_capability warnings warn aten warn torch _VF stft aten stft type ignore attr-defined torch _VF istft aten istft type ignore attr-defined torch _VF cdist aten cdist type ignore attr-defined torch _VF norm aten norm type ignore attr-defined torch _VF unique_dim aten unique_dim torch _VF unique_consecutive aten unique_consecutive type ignore attr-defined torch _VF nuclear_norm aten nuclear_norm torch _VF frobenius_norm aten frobenius_norm torch _VF tensordot aten tensordot type ignore attr-defined ops torch functional bound torch these cases we want resolve function their python implementation instead looking up builtin aten schema _gen_torch_functional_registered_ops eventually ops should encompass all torch functional py torch functional __all__ we currently only able compile some functions additionally some functions directly map their aten implementations TODO add support more ops ops = stft istft lu cdist norm unique unique_consecutive tensordot getattr torch functional name name ops _functional_registered_ops = _gen_torch_functional_registered_ops _is_special_functional_bound_op fn fn _functional_registered_ops lazily built ensure correct initialization order _get_builtin_table global _builtin_table _builtin_table None _builtin_table _builtin_table = register_all mod name dir mod v = getattr mod name callable v _is_special_functional_bound_op v v torch no_grad v torch autocast Fixup inconsistency segment_reduce name == _segment_reduce name = name _builtin_ops append v aten + name mod _modules_containing_builtins register_all mod _builtin_ops append math gcd aten gcd _builtin_ops append math isfinite aten isfinite _builtin_ops append math remainder aten mathremainder type ignore attr-defined torch distributed autograd dist_autograd dist_autograd is_available _builtin_ops append dist_autograd get_gradients aten get_gradients _builtin_ops append dist_autograd backward aten dist_backward populate _builtin_table _builtin_ops builtin aten_op _builtin_ops _builtin_table id builtin = aten_op _builtin_table _register_builtin fn op _get_builtin_table id fn = op _find_builtin fn _get_builtin_table get id fn