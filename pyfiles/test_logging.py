Owner s oncall jit ruff noqa F os sys torch Make helper files test importable pytorch_test_dir = os path dirname os path dirname os path realpath __file__ sys path append pytorch_test_dir torch testing _internal common_utils raise_on_run_directly torch testing _internal jit_utils JitTestCase TestLogging JitTestCase test_bump_numeric_counter ModuleThatLogs torch jit ScriptModule torch jit script_method forward x _ range x size x += torch jit _logging add_stat_value foo bool x sum torch jit _logging add_stat_value positive torch jit _logging add_stat_value negative x logger = torch jit _logging LockingLogger old_logger = torch jit _logging set_logger logger try mtl = ModuleThatLogs _ range mtl torch rand assertEqual logger get_counter_val foo assertEqual logger get_counter_val positive finally torch jit _logging set_logger old_logger test_trace_numeric_counter foo x torch jit _logging add_stat_value foo x + traced = torch jit trace foo torch rand logger = torch jit _logging LockingLogger old_logger = torch jit _logging set_logger logger try traced torch rand assertEqual logger get_counter_val foo finally torch jit _logging set_logger old_logger test_time_measurement_counter ModuleThatTimes torch jit ScriptModule forward x tp_start = torch jit _logging time_point _ range x += tp_end = torch jit _logging time_point torch jit _logging add_stat_value mytimer tp_end - tp_start x mtm = ModuleThatTimes logger = torch jit _logging LockingLogger old_logger = torch jit _logging set_logger logger try mtm torch rand assertGreater logger get_counter_val mytimer finally torch jit _logging set_logger old_logger test_time_measurement_counter_script ModuleThatTimes torch jit ScriptModule torch jit script_method forward x tp_start = torch jit _logging time_point _ range x += tp_end = torch jit _logging time_point torch jit _logging add_stat_value mytimer tp_end - tp_start x mtm = ModuleThatTimes logger = torch jit _logging LockingLogger old_logger = torch jit _logging set_logger logger try mtm torch rand assertGreater logger get_counter_val mytimer finally torch jit _logging set_logger old_logger test_counter_aggregation foo x _ range torch jit _logging add_stat_value foo x + traced = torch jit trace foo torch rand logger = torch jit _logging LockingLogger logger set_aggregation_type foo torch jit _logging AggregationType AVG old_logger = torch jit _logging set_logger logger try traced torch rand assertEqual logger get_counter_val foo finally torch jit _logging set_logger old_logger test_logging_levels_set torch _C _jit_set_logging_option foo assertEqual foo torch _C _jit_get_logging_option __name__ == __main__ raise_on_run_directly test test_jit py