Owner s module PrivateUse torch torch_openreg noqa F torch testing _internal common_utils run_tests TestCase TestDevice TestCase test_device_count count = torch accelerator device_count assertEqual count test_device_switch torch accelerator set_device_index assertEqual torch accelerator current_device_index torch accelerator set_device_index assertEqual torch accelerator current_device_index test_device_context device = torch accelerator current_device_index torch accelerator device_index None assertEqual torch accelerator current_device_index device assertEqual torch accelerator current_device_index device torch accelerator device_index assertEqual torch accelerator current_device_index assertEqual torch accelerator current_device_index device __name__ == __main__ run_tests