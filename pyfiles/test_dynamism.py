Owner s oncall fx torch torch fx experimental _dynamism track_dynamism_across_examples torch testing _internal common_utils TestCase TestDynamism TestCase test_dynamic_tensor ex = x y torch ones z torch ones ex = x y torch ones z torch ones ex = x y torch ones z torch ones ex = x y torch ones z torch ones ex = x y torch ones z torch ones examples = ex ex ex ex ex result = track_dynamism_across_examples examples expected = x L x True y L y True False z L z True assertEqual result expected test_dynamic_tensor_deeply_nested ex = z z z z torch ones ex = z z z z torch ones ex = z z z z torch ones ex = z z z z torch ones ex = z z z z torch ones examples = ex ex ex ex ex result = track_dynamism_across_examples examples expected = z L z z z z True assertEqual result expected test_mixed_dynamism ex = torch ones b torch ones c d ex = torch ones b torch ones c d ex = torch ones b torch ones c d ex = torch ones b torch ones c d ex = torch ones b torch ones c d examples = ex ex ex ex ex result = track_dynamism_across_examples examples expected = L True False b L b True L b True c L c d False assertEqual result expected test_nn_module Y torch nn Module __init__ n_input n_output super __init__ compress = torch nn Linear n_input n_output x = n_input forward x compress x x M torch nn Module __init__ n_input n_output n_input = n_input n_output = n_output super __init__ y = Y n_input n_output forward x y x model = M model = M result = track_dynamism_across_examples model model expected = L _modules y _modules compress _parameters weight False True L _modules y _modules compress _parameters bias False L _modules y _modules compress bias False L _modules y _modules compress in_features True L _modules y _modules compress out_features False L _modules y _modules compress weight False True L _modules y x True L n_input True L n_output False assertEqual result expected test_property_not_implemented ModuleWithNotImplementedProperty torch nn Module __init__ x y super __init__ linear = torch nn Linear x y property not_implemented_property raise NotImplementedError This property implemented module = ModuleWithNotImplementedProperty module = ModuleWithNotImplementedProperty result = track_dynamism_across_examples module module expected = L _modules linear _parameters weight False False L _modules linear _parameters bias False L _modules linear bias False L _modules linear in_features False L _modules linear out_features False L _modules linear weight False False assertEqual result expected __name__ == __main__ raise RuntimeError This test currently used should enabled discover_tests py required