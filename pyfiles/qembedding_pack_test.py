operator_benchmark op_bench torch embeddingbag_conversion_short_configs = op_bench cross_product_configs num_embeddings= embedding_dim= tags= short embeddingbag_conversion_long_configs = op_bench cross_product_configs num_embeddings= embedding_dim= tags= long embeddingbag_conversion_three_dim_configs = op_bench cross_product_configs num_embeddings= embedding_dim= batch_size= tags= short conversion_ops = op_bench op_list attrs= qembeddingbag_byte_prepack torch ops quantized embedding_bag_byte_prepack qembeddingbag_ bit_prepack torch ops quantized embedding_bag_ bit_prepack qembeddingbag_ bit_prepack torch ops quantized embedding_bag_ bit_prepack attr_names= op_name op_func unpack_ops = op_bench op_list attrs= qembeddingbag_byte_unpack torch ops quantized embedding_bag_byte_unpack qembeddingbag_ bit_unpack torch ops quantized embedding_bag_ bit_unpack qembeddingbag_ bit_unpack torch ops quantized embedding_bag_ bit_unpack attr_names= op_name op_func EmbeddingBagFloatToFusedBase op_bench TorchBenchmarkBase init num_embeddings embedding_dim op_func inputs = weight torch rand num_embeddings embedding_dim dtype=torch float + op_func = op_func forward weight op_func weight EmbeddingBagThreeDimFloatToFusedBase op_bench TorchBenchmarkBase init num_embeddings embedding_dim batch_size op_func inputs = weight torch rand batch_size num_embeddings embedding_dim dtype=torch float + op_func = op_func forward weight op_func weight EmbeddingBagFusedToFloatBase op_bench TorchBenchmarkBase init num_embeddings embedding_dim op_func weight = torch randn num_embeddings embedding_dim + dtype=torch float inputs = packed_weight weight torch uint op_func = op_func forward packed_weight op_func packed_weight EmbeddingBagThreeDimFusedToFloatBase op_bench TorchBenchmarkBase init num_embeddings embedding_dim batch_size op_func weight = torch randn batch_size num_embeddings embedding_dim + dtype=torch float inputs = packed_weight weight torch uint op_func = op_func forward packed_weight op_func packed_weight op_bench generate_pt_tests_from_op_list conversion_ops embeddingbag_conversion_short_configs + embeddingbag_conversion_long_configs EmbeddingBagFloatToFusedBase op_bench generate_pt_tests_from_op_list unpack_ops embeddingbag_conversion_short_configs + embeddingbag_conversion_long_configs EmbeddingBagFusedToFloatBase op_bench generate_pt_tests_from_op_list conversion_ops embeddingbag_conversion_three_dim_configs EmbeddingBagThreeDimFloatToFusedBase op_bench generate_pt_tests_from_op_list unpack_ops embeddingbag_conversion_three_dim_configs EmbeddingBagThreeDimFusedToFloatBase __name__ == __main__ op_bench benchmark_runner main