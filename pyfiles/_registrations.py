flake noqa B _internal register_artifact register_log DYNAMIC = torch fx experimental symbolic_shapes torch fx experimental sym_node torch fx experimental recording DISTRIBUTED = torch distributed torch _dynamo backends distributed torch nn parallel distributed register_log async_compile torch _inductor async_compile torch _inductor compile_worker tracked_process_pool register_log cache torch _inductor remote_cache torch _inductor fb remote_cache register_log dynamo torch _dynamo DYNAMIC register_log fake_tensor torch _subclasses fake_tensor register_log aot torch _functorch aot_autograd torch _functorch _aot_autograd register_log autograd torch autograd register_log inductor torch _inductor torch _inductor cudagraph_trees register_artifact cudagraphs Logs information wrapping inductor generated code cudagraphs register_log dynamic DYNAMIC register_log torch torch register_log distributed DISTRIBUTED register_log c d torch distributed distributed_c d torch distributed rendezvous register_log ddp torch nn parallel distributed torch _dynamo backends distributed register_log pp torch distributed pipelining register_log fsdp torch distributed fsdp torch distributed _composable fsdp register_log dtensor torch distributed _tensor torch distributed tensor register_log onnx torch onnx register_log export torch _dynamo torch export torch export dynamic_shapes DYNAMIC torch _export converter torch _export non_strict_utils torch _export serde serialize torch fx experimental proxy_tensor register_artifact guards This prints guards every compiled Dynamo frame It does tell you where guards come visible=True register_artifact verbose_guards off_by_default=True register_artifact bytecode Prints original modified bytecode Dynamo Mostly useful you re debugging our bytecode generation Dynamo off_by_default=True register_artifact graph Prints dynamo traced graph prior AOTDispatch table If you prefer python code use ` graph_code ` instead register_artifact graph_code Like ` graph ` gives you Python code instead register_artifact graph_code_verbose Verbose FX pass logs e g tensorify_python_scalars runtime_assert register_artifact graph_sizes Prints sizes all FX nodes dynamo graph register_artifact trace_source As we execute bytecode prints file name line number we processing actual source code Useful ` bytecode ` register_artifact trace_call Like trace_source will give you per-expression blow-by-blow your Python recent enough register_artifact trace_bytecode As we trace bytecode prints instruction current stack register_artifact aot_graphs Prints FX forward backward graph generated AOTDispatch after partitioning Useful understand what s being given Inductor visible=True register_artifact aot_joint_graph Print FX joint graph AOTAutograd prior partitioning Useful debugging partitioning register_artifact aot_graphs_effects Prints FX forward backward graph generated AOTDispatch useful debugging effects processing visible=True register_artifact pre_grad_graphs Prints FX graph before inductor pre grad passes Useful understand what s being given Inductor before grad passes register_artifact post_grad_graphs Prints FX graph generated post grad passes Useful understand what s being given Inductor after post grad passes register_artifact ir_pre_fusion Prints IR before inductor fusion passes off_by_default=True register_artifact ir_post_fusion Prints IR after inductor fusion passes off_by_default=True register_artifact compiled_autograd Prints various logs compiled_autograd including limited graphs Useful debugging compiled_autograd visible=True register_artifact compiled_autograd_verbose Will affect performance Prints compiled_autograd logs C++ info e g autograd node - fx node mapping off_by_default=True register_artifact ddp_graphs Only relevant compiling DDP DDP splits into multiple graphs trigger comms early This will print each individual graph here register_artifact recompiles Prints reason why we recompiled graph Very very useful visible=True register_artifact recompiles_verbose Prints all guard checks fail during recompilation At runtime Dynamo will stop first failed check each failing guard So all logged failing checks actually ran Dynamo visible=True off_by_default=True register_artifact graph_breaks Prints whenever Dynamo decides needs graph break i e create new graph Useful debugging why torch compile has poor performance visible=True register_artifact not_implemented Prints log messages whenever we NotImplemented multi-dispatch letting you trace through each object we attempted dispatch register_artifact output_code Prints code Inductor generates either Triton C++ off_by_default=True visible=True register_artifact kernel_code Prints code Inductor generates per-kernel basis off_by_default=True visible=True register_artifact schedule Inductor scheduler information Useful working Inductor fusion algo off_by_default=True register_artifact perf_hints off_by_default=True register_artifact onnx_diagnostics off_by_default=True register_artifact compute_dependencies off_by_default=True register_artifact fusion Detailed Inductor fusion decisions More detailed than schedule off_by_default=True register_artifact loop_ordering Logs related loop ordering off_by_default=True register_artifact loop_tiling Logs related loop ordering off_by_default=True register_artifact overlap Detailed Inductor compute comm overlap decisions off_by_default=True register_artifact sym_node Logs extra info various SymNode operations off_by_default=True register_artifact trace_shape_events Logs traces every ShapeEnv operation we record replay off_by_default=True register_artifact cudagraph_static_inputs Logs static inputs handling dynamo AOT cudagraphs off_by_default=True register_artifact benchmarking Detailed Inductor benchmarking information off_by_default=True register_artifact autotuning Autotuning choice logs such kernel source perf tuning parameters off_by_default=True register_artifact graph_region_expansion Logs detailed steps duplicate graph region tracker expansion algorithm off_by_default=True register_artifact inductor_metrics Logs Inductor metrics such num_bytes nodes_num_elem node_runtimes off_by_default=True register_artifact hierarchical_compile Logs debug info hierarchical compilation off_by_default=True register_artifact annotation Logs detailed steps creating annotation graph nodes off_by_default=True register_artifact custom_format_test_artifact Testing only log_format=