operator_benchmark op_bench torch torch nn torch ao pruning Microbenchmarks sparsifier sparse_configs_short = op_bench config_list attr_names= M SL SBS ZPB attrs= tags= short sparse_configs_long = op_bench cross_product_configs M= Mask shape SL= Sparsity level SBS= Sparse block shape ZPB= None Zeros per block tags= long WeightNormSparsifierBenchmark op_bench TorchBenchmarkBase init M SL SBS ZPB weight = torch ones M model = nn Module model register_buffer weight weight sparse_config = tensor_fqn weight sparsifier = pruning WeightNormSparsifier sparsity_level=SL sparse_block_shape=SBS zeros_per_block=ZPB sparsifier prepare model config=sparse_config inputs = All benchmarks need inputs set_module_name weight_norm_sparsifier_step forward sparsifier step all_tests = sparse_configs_short + sparse_configs_long op_bench generate_pt_test all_tests WeightNormSparsifierBenchmark __name__ == __main__ op_bench benchmark_runner main