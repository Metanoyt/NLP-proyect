concurrent futures Future typing Any Optional torch distributed dist torch distributed checkpoint state_dict_loader loader torch distributed checkpoint state_dict_saver saver torch distributed checkpoint metadata Metadata STATE_DICT_TYPE torch distributed checkpoint storage LoadPlanner SavePlanner StorageReader StorageWriter __all__ list str = _Checkpointer This base specifies high level API saving loading distributed ` state_dict ` s It provides abstraction over low-level APIs provided py mod ` torch distributed checkpoint storage ` essentially calling py meth ` torch distributed state_dict_saver save ` py meth ` torch distributed state_dict_loader load ` provided storage readers writers warning This feature experimental subject removal change __init__ storage_writer StorageWriter storage_reader StorageReader process_group Optional dist ProcessGroup = None coordinator_rank int = no_dist bool = False load_planner Optional LoadPlanner = None save_planner Optional SavePlanner = None Initializes Checkpointer instance Args storage_writer Instance StorageWrite use perform writes storage_reader StorageReader used load data process_group ProcessGroup used cross-rank synchronization coordinator_rank Rank use coordinate checkpoint rank used default no_dist If ` ` True ` ` distributed checkpoint will load SPMD style Default ` ` False ` ` loader_planner Instance LoadPlanner use when loading save_planner Instance SavePlanner use when saving storage_writer = storage_writer storage_reader = storage_reader process_group = process_group coordinator_rank = coordinator_rank no_dist = no_dist load_planner = load_planner save_planner = save_planner save state_dict STATE_DICT_TYPE - Metadata Calls py meth ` torch distributed state_dict_saver save ` Utilizing values passed during initialization saver save state_dict storage_writer process_group=self process_group coordinator_rank=self coordinator_rank no_dist=self no_dist planner=self save_planner async_save state_dict STATE_DICT_TYPE - Future Calls py meth ` torch distributed state_dict_saver _async_save ` Utilizing values passed during initialization Returns Future A future holding resultant Metadata object ` save ` response = saver async_save state_dict storage_writer=self storage_writer process_group=self process_group planner=self save_planner isinstance response Future raise AssertionError response should Future instance response load state_dict dict str Any - None Calls py meth ` torch distributed state_dict_loader load ` Utilizing values passed during initialization loader load state_dict storage_reader=self storage_reader process_group=self process_group planner=self load_planner