Copyright c Facebook Inc its affiliates All rights reserved This source code licensed under BSD-style license found LICENSE file root directory source tree functools collections abc Callable types BuiltinMethodType FunctionType GetSetDescriptorType MethodDescriptorType WrapperDescriptorType typing Any FUNC_TYPES = FunctionType MethodDescriptorType BuiltinMethodType WrapperDescriptorType PROPERTY_TYPES = GetSetDescriptorType property _py_wrap_method orig Callable __torch_function__ Callable - Callable impl args Any kwargs Any - Any __torch_function__ orig None args kwargs Copy metadata using functools update_wrapper just __name__ __doc__ functools update_wrapper impl orig assigned= __name__ __doc__ updated= impl wrap_type to_patch Any pattern type __torch_function__ Callable - None wrap_method = _py_wrap_method all dict str Any = t reversed pattern mro - skip object all update t __dict__ wrap_attr orig Any - property property wrap_method orig __get__ __torch_function__ name obj all items name __dict__ __new__ __init__ __repr__ __weakref__ __doc__ __module__ __dir__ continue skip things have been overloaded things come object like ` __eq__ ` still need patched however hasattr to_patch name getattr to_patch name getattr object name None continue isinstance obj FUNC_TYPES setattr to_patch name wrap_method obj __torch_function__ isinstance obj PROPERTY_TYPES setattr to_patch name wrap_attr obj