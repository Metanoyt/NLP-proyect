usr bin env python Owner s oncall r p Copyright c Facebook Inc its affiliates All rights reserved This source code licensed under BSD-style license found LICENSE file root directory source tree unittest torch distributed elastic utils data CyclingIterator CyclingIteratorTest unittest TestCase generator epoch stride max_epochs generate continuously incrementing list each epoch e g iter stride epoch + i i range stride test_cycling_iterator stride = max_epochs = generator_fn epoch generator epoch stride max_epochs = CyclingIterator n=max_epochs generator_fn=generator_fn i range stride max_epochs assertEqual i next assertRaises StopIteration next test_cycling_iterator_start_epoch stride = max_epochs = start_epoch = generator_fn epoch generator epoch stride max_epochs = CyclingIterator max_epochs generator_fn start_epoch i range stride start_epoch stride max_epochs assertEqual i next assertRaises StopIteration next