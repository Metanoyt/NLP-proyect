argparse os textwrap pathlib Path common Imports working classi classifier CategoryConfig CommitClassifier CommitClassifierInputs get_author_map get_file_map XLMR_BASE commitlist CommitList common get_commit_data_cache topics torch Categorizer __init__ path category= Uncategorized use_classifier bool = False cache = get_commit_data_cache commits = CommitList from_existing path use_classifier print Using classifier aid categorization device = cuda torch cuda is_available cpu classifier_config = CategoryConfig common categories author_map = get_author_map Path results classifier regen_data=False assert_stored=True file_map = get_file_map Path results classifier regen_data=False assert_stored=True classifier = CommitClassifier XLMR_BASE author_map file_map classifier_config device classifier load_state_dict torch load Path results classifier commit_classifier pt classifier eval classifier = None Special categories Uncategorized All other categories must real category = category categorize commits = commits filter category=self category total_commits = len commits commits already_done = total_commits - len commits i = while i len commits cur_commit = commits i next_commit = commits i + i + len commits None jump_to = handle_commit cur_commit already_done + i + total_commits commits Increment counter jump_to None i = jump_to next_commit None i = len commits i = commits index next_commit features commit cache get commit commit_hash potential_reverts_of commit commits submodule_update_str = Update TensorPipe submodule Updating submodules Automated submodule update any commit title submodule_update_str features = features commit Reverted features labels reasons = GithubBot Reverted reasons = index = commits index commit - remove cleaned_title = commit title - NB index + sketch reasons update index + + delta cand delta cand enumerate commits index + cleaned_title cand title commit commit_hash = cand commit_hash reasons handle_commit commit i total commits potential_reverts = potential_reverts_of commit commits potential_reverts potential_reverts = f POTENTIAL REVERTS potential_reverts potential_reverts = features = features commit classifier None Some commits don t have authors author = features author features author Unknown files = join features files_changed classifier_input = CommitClassifierInputs title= features title files= files author= author classifier_category = classifier get_most_likely_category_name classifier_input classifier_category = commit category breaking_alarm = module bc-breaking features labels breaking_alarm += \n BC BREAKING module deprecation features labels breaking_alarm += \n DEPRECATION os system clear view = textwrap dedent f \ i total ================================================================================ features title potential_reverts breaking_alarm features body Files changed features files_changed Labels features labels Current category commit category Select join common categories print view cat_choice = None while cat_choice None print Enter category value = input f classifier_category strip len value == The user just pressed enter likes default value cat_choice = classifier_category continue choices = cat cat common categories cat startswith value len choices = print f Possible matches choices try again continue cat_choice = choices print f \nSelected cat_choice print f \nCurrent topic commit topic print f Select join topics topic_choice = None while topic_choice None value = input topic strip len value == topic_choice = commit topic continue choices = cat cat topics cat startswith value len choices = print f Possible matches choices try again continue topic_choice = choices print f \nSelected topic_choice update_commit commit cat_choice topic_choice None update_commit commit category topic assert category common categories assert topic topics commit category = category commit topic = topic commits write_result main parser = argparse ArgumentParser description= Tool help categorize commits parser add_argument -- category type=str default= Uncategorized help= Which category filter Uncategorized None category name parser add_argument -- file help= The location commits CSV default= results commitlist csv parser add_argument -- use_classifier action= store_true help= Whether use classifier aid categorization args = parser parse_args categorizer = Categorizer args file args category args use_classifier categorizer categorize __name__ == __main__ main