numpy operator_benchmark op_bench torch Microbenchmarks index_add_ operator configs_short = op_bench config_list attr_names= M N K dim attrs= cross_product_configs= device cpu dtype torch float tags= short configs_long = op_bench cross_product_configs M= N= K= dim= device= cpu cuda dtype= torch float tags= long IndexAddBenchmark op_bench TorchBenchmarkBase init M N K dim dtype device creating original tensor tensor = torch rand M N K dtype=dtype device=device creating index index_max_len = tensor shape dim index_len = numpy random randint index_max_len + index = torch tensor numpy random choice index_max_len index_len replace=False device=device src_dims = M N K src_dims dim = index_len source = torch rand src_dims dtype=dtype device=device inputs = tensor tensor dim dim index index source source set_module_name index_add_ forward tensor dim index source tensor index_add_ dim index source op_bench generate_pt_test configs_short + configs_long IndexAddBenchmark __name__ == __main__ op_bench benchmark_runner main