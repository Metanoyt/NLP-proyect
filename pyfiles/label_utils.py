GitHub Label Utilities json functools lru_cache typing Any TYPE_CHECKING Union github_utils gh_fetch_url_and_headers GitHubComment TODO temp workaround avoid circular dependencies should removed once GitHubPR refactored out trymerge script TYPE_CHECKING trymerge GitHubPR BOT_AUTHORS = github-actions pytorchmergebot pytorch-bot LABEL_ERR_MSG_TITLE = This PR needs ` release notes ` label LABEL_ERR_MSG = f LABEL_ERR_MSG_TITLE If your changes user facing intended part release notes please use label starting ` release notes ` If please add ` topic user facing ` label To add label you can comment pytorchbot example ` pytorchbot label topic user facing ` For more information see https github com pytorch pytorch wiki PyTorch-AutoLabel-Bot#why-categorize-for-release-notes-and-how-does-it-work request_for_labels url str - tuple Any Any headers = Accept application vnd github v +json gh_fetch_url_and_headers url headers=headers reader=lambda x x read decode utf- update_labels labels list str info str - None labels_json = json loads info labels extend x name x labels_json get_last_page_num_from_header header Any - int Link info looks like https api github com repositories labels per_page= page= rel= next https api github com repositories labels per_page= page= rel= last link_info = header link Docs does specify should present projects just few labels And https github com malfet deleteme actions runs job s case lint-ignore link_info None prefix = page= suffix = int link_info link_info rindex prefix + len prefix link_info rindex suffix lru_cache gh_get_labels org str repo str - list str prefix = f https api github com repos org repo labels per_page= header info = request_for_labels prefix + page= labels list str = update_labels labels info last_page = get_last_page_num_from_header header assert last_page Error reading header info determine total number pages labels page_number range last_page + skip page _ info = request_for_labels prefix + f page= page_number update_labels labels info labels gh_add_labels org str repo str pr_num int labels Union str list str dry_run bool - None dry_run print f Dryrun Adding labels labels PR pr_num gh_fetch_url_and_headers url=f https api github com repos org repo issues pr_num labels data= labels labels gh_remove_label org str repo str pr_num int label str dry_run bool - None dry_run print f Dryrun Removing label PR pr_num gh_fetch_url_and_headers url=f https api github com repos org repo issues pr_num labels label method= DELETE get_release_notes_labels org str repo str - list str label label gh_get_labels org repo label lstrip startswith release notes has_required_labels pr GitHubPR - bool pr_labels = pr get_labels Check PR user facing is_not_user_facing_pr = any label strip == topic user facing label pr_labels is_not_user_facing_pr any label strip get_release_notes_labels pr org pr project label pr_labels is_label_err_comment comment GitHubComment - bool comment body_text returns text without markdown no_format_title = LABEL_ERR_MSG_TITLE replace ` comment body_text lstrip startswith no_format_title comment author_login BOT_AUTHORS