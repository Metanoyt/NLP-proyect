mypy allow-untyped-defs Utilities converting operating ONNX JIT torch types __future__ annotations enum typing typing Literal torch torch _C _onnx _C_onnx torch onnx errors typing TYPE_CHECKING Hack help mypy recognize torch _C Value torch _C noqa F ScalarName = Literal Byte Char Double Float Half Int Long Short Bool ComplexHalf ComplexFloat ComplexDouble QInt QUInt QInt BFloat Float E M Float E M FN Float E M FNUZ Float E M FNUZ Undefined TorchName = Literal bool uint _t int _t double float half int int _t int _t complex complex complex qint quint qint bfloat float _e m float _e m fn float _e m fnuz float _e m fnuz JitScalarType enum IntEnum Scalar types defined torch Use ` ` JitScalarType ` ` convert torch JIT scalar types ONNX scalar types Examples xdoctest +REQUIRES env TORCH_DOCTEST_ONNX xdoctest +IGNORE_WANT win has different output JitScalarType from_value torch ones onnx_type TensorProtoDataType FLOAT JitScalarType from_value torch_c_value_with_type_float onnx_type TensorProtoDataType FLOAT JitScalarType from_dtype torch get_default_dtype onnx_type TensorProtoDataType FLOAT Order defined https github com pytorch pytorch blob defc fee d c d f f e c core ScalarType h UINT = INT = enum auto INT = enum auto INT = enum auto INT = enum auto HALF = enum auto FLOAT = enum auto DOUBLE = enum auto COMPLEX = enum auto COMPLEX = enum auto COMPLEX = enum auto BOOL = enum auto QINT = enum auto QUINT = enum auto QINT = enum auto BFLOAT = enum auto FLOAT E M = enum auto FLOAT E M FN = enum auto FLOAT E M FNUZ = enum auto FLOAT E M FNUZ = enum auto UNDEFINED = enum auto classmethod _from_name cls name ScalarName &#124; TorchName &#124; str &#124; None - JitScalarType Convert JIT scalar type torch type name ScalarType Note DO NOT USE API when ` name ` comes ` torch _C Value type ` calls A RuntimeError INTERNAL ASSERT FAILED aten src ATen core jit_type_base h can raised several scenarios where shape info present Instead use ` from_value ` API which safer Args name JIT scalar type name Byte torch type name uint _t Returns JitScalarType Raises OnnxExporterError name valid scalar type name None name None raise errors OnnxExporterError Scalar type name cannot None valid_scalar_name name _SCALAR_NAME_TO_TYPE name type ignore index valid_torch_name name _TORCH_NAME_TO_SCALAR_TYPE name type ignore index raise errors OnnxExporterError f Unknown torch scalar type name classmethod from_dtype cls dtype torch dtype &#124; None - JitScalarType Convert torch dtype JitScalarType Note DO NOT USE API when ` dtype ` comes ` torch _C Value type ` calls A RuntimeError INTERNAL ASSERT FAILED aten src ATen core jit_type_base h can raised several scenarios where shape info present Instead use ` from_value ` API which safer Args dtype A torch dtype create JitScalarType Returns JitScalarType Raises OnnxExporterError dtype valid torch dtype None dtype _DTYPE_TO_SCALAR_TYPE raise errors OnnxExporterError f Unknown dtype dtype pyrefly ignore index-error _DTYPE_TO_SCALAR_TYPE dtype classmethod from_onnx_type cls onnx_type int &#124; _C_onnx TensorProtoDataType &#124; None - JitScalarType Convert ONNX data type JitScalarType Args onnx_type A torch _C _onnx TensorProtoDataType create JitScalarType Returns JitScalarType Raises OnnxExporterError dtype valid torch dtype None onnx_type _ONNX_TO_SCALAR_TYPE raise errors OnnxExporterError f Unknown onnx_type onnx_type _ONNX_TO_SCALAR_TYPE typing cast _C_onnx TensorProtoDataType onnx_type classmethod from_value cls value None &#124; torch _C Value &#124; torch Tensor default=None - JitScalarType Create JitScalarType value s scalar type Args value An object fetch scalar type default The JitScalarType valid scalar cannot fetched value Returns JitScalarType Raises OnnxExporterError value does have valid scalar type default None SymbolicValueError when value type s info empty default None isinstance value torch _C Value torch Tensor isinstance value torch _C Value value node mustBeNone default value type JitScalarType returned when value valid default None raise errors OnnxExporterError value must either torch _C Value torch Tensor objects isinstance default JitScalarType raise errors OnnxExporterError default value must JitScalarType object default Each value type has their own way storing scalar type isinstance value torch Tensor cls from_dtype value dtype isinstance value type torch ListType try cls from_dtype value type getElementType dtype except RuntimeError cls _from_name str value type getElementType isinstance value type torch _C OptionalType value type getElementType dtype None isinstance default JitScalarType default raise errors OnnxExporterError default value must JitScalarType object cls from_dtype value type getElementType dtype scalar_type = None value node kind = prim Constant isinstance value type torch _C NoneType value must non-list torch _C Value scalar scalar_type = value type scalarType scalar_type None cls _from_name scalar_type When everything fails try default default None default raise errors SymbolicValueError f Cannot determine scalar type type value type instance default value provided value scalar_name - ScalarName Convert JitScalarType JIT scalar type name _SCALAR_TYPE_TO_NAME torch_name - TorchName Convert JitScalarType torch type name _SCALAR_TYPE_TO_TORCH_NAME dtype - torch dtype Convert JitScalarType torch dtype _SCALAR_TYPE_TO_DTYPE onnx_type - _C_onnx TensorProtoDataType Convert JitScalarType ONNX data type _SCALAR_TYPE_TO_ONNX raise errors OnnxExporterError f Scalar type cannot converted ONNX _SCALAR_TYPE_TO_ONNX onnx_compatible - bool Return whether JitScalarType compatible ONNX _SCALAR_TYPE_TO_ONNX = JitScalarType UNDEFINED = JitScalarType COMPLEX valid_scalar_name scalar_name ScalarName &#124; str - bool Return whether given scalar name valid JIT scalar type name scalar_name _SCALAR_NAME_TO_TYPE valid_torch_name torch_name TorchName &#124; str - bool Return whether given torch name valid torch type name torch_name _TORCH_NAME_TO_SCALAR_TYPE https github com pytorch pytorch blob defc fee d c d f f e c core ScalarType h _SCALAR_TYPE_TO_NAME dict JitScalarType ScalarName = JitScalarType BOOL Bool JitScalarType UINT Byte JitScalarType INT Char JitScalarType INT Short JitScalarType INT Int JitScalarType INT Long JitScalarType HALF Half JitScalarType FLOAT Float JitScalarType DOUBLE Double JitScalarType COMPLEX ComplexHalf JitScalarType COMPLEX ComplexFloat JitScalarType COMPLEX ComplexDouble JitScalarType QINT QInt JitScalarType QUINT QUInt JitScalarType QINT QInt JitScalarType BFLOAT BFloat JitScalarType FLOAT E M Float E M JitScalarType FLOAT E M FN Float E M FN JitScalarType FLOAT E M FNUZ Float E M FNUZ JitScalarType FLOAT E M FNUZ Float E M FNUZ JitScalarType UNDEFINED Undefined _SCALAR_NAME_TO_TYPE dict ScalarName JitScalarType = v k k v _SCALAR_TYPE_TO_NAME items _SCALAR_TYPE_TO_TORCH_NAME dict JitScalarType TorchName = JitScalarType BOOL bool JitScalarType UINT uint _t JitScalarType INT int _t JitScalarType INT int _t JitScalarType INT int JitScalarType INT int _t JitScalarType HALF half JitScalarType FLOAT float JitScalarType DOUBLE double JitScalarType COMPLEX complex JitScalarType COMPLEX complex JitScalarType COMPLEX complex JitScalarType QINT qint JitScalarType QUINT quint JitScalarType QINT qint JitScalarType BFLOAT bfloat JitScalarType FLOAT E M float _e m JitScalarType FLOAT E M FN float _e m fn JitScalarType FLOAT E M FNUZ float _e m fnuz JitScalarType FLOAT E M FNUZ float _e m fnuz _TORCH_NAME_TO_SCALAR_TYPE dict TorchName JitScalarType = v k k v _SCALAR_TYPE_TO_TORCH_NAME items _SCALAR_TYPE_TO_ONNX = JitScalarType BOOL _C_onnx TensorProtoDataType BOOL JitScalarType UINT _C_onnx TensorProtoDataType UINT JitScalarType INT _C_onnx TensorProtoDataType INT JitScalarType INT _C_onnx TensorProtoDataType INT JitScalarType INT _C_onnx TensorProtoDataType INT JitScalarType INT _C_onnx TensorProtoDataType INT JitScalarType HALF _C_onnx TensorProtoDataType FLOAT JitScalarType FLOAT _C_onnx TensorProtoDataType FLOAT JitScalarType DOUBLE _C_onnx TensorProtoDataType DOUBLE JitScalarType COMPLEX _C_onnx TensorProtoDataType COMPLEX JitScalarType COMPLEX _C_onnx TensorProtoDataType COMPLEX JitScalarType BFLOAT _C_onnx TensorProtoDataType BFLOAT JitScalarType UNDEFINED _C_onnx TensorProtoDataType UNDEFINED JitScalarType COMPLEX _C_onnx TensorProtoDataType UNDEFINED JitScalarType QINT _C_onnx TensorProtoDataType INT JitScalarType QUINT _C_onnx TensorProtoDataType UINT JitScalarType QINT _C_onnx TensorProtoDataType INT JitScalarType FLOAT E M _C_onnx TensorProtoDataType FLOAT E M JitScalarType FLOAT E M FN _C_onnx TensorProtoDataType FLOAT E M FN JitScalarType FLOAT E M FNUZ _C_onnx TensorProtoDataType FLOAT E M FNUZ JitScalarType FLOAT E M FNUZ _C_onnx TensorProtoDataType FLOAT E M FNUZ _ONNX_TO_SCALAR_TYPE = v k k v _SCALAR_TYPE_TO_ONNX items source truth https github com pytorch pytorch blob master torch csrc utils tensor_dtypes cpp _SCALAR_TYPE_TO_DTYPE = JitScalarType BOOL torch bool JitScalarType UINT torch uint JitScalarType INT torch int JitScalarType INT torch short JitScalarType INT torch int JitScalarType INT torch int JitScalarType HALF torch half JitScalarType FLOAT torch float JitScalarType DOUBLE torch double JitScalarType COMPLEX torch complex JitScalarType COMPLEX torch complex JitScalarType COMPLEX torch complex JitScalarType QINT torch qint JitScalarType QUINT torch quint JitScalarType QINT torch qint JitScalarType BFLOAT torch bfloat JitScalarType FLOAT E M torch float _e m JitScalarType FLOAT E M FN torch float _e m fn JitScalarType FLOAT E M FNUZ torch float _e m fnuz JitScalarType FLOAT E M FNUZ torch float _e m fnuz _DTYPE_TO_SCALAR_TYPE = v k k v _SCALAR_TYPE_TO_DTYPE items