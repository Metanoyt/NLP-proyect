Owner s module dynamo os unittest mock patch torch torch _dynamo debug_utils torch _dynamo debug_utils aot_graph_input_parser generate_env_vars_string torch _dynamo test_case TestCase torch fx experimental proxy_tensor make_fx torch testing _internal common_device_type instantiate_device_type_tests f = torch float i = torch int i = torch int TestDebugUtils TestCase test_cast_model_to_fp _dtype_args Test dtype arguments converted fp fn x torch ops prims convert_element_type x torch float x torch float torch full x shape dtype=torch float device=x device x new_empty x shape x = torch randn device= cpu decomps = torch _decomp core_aten_decompositions fx = make_fx fn decomposition_table=decomps x assertExpectedInline fx code lstrip \ forward x_ convert_element_type = torch ops prims convert_element_type default x_ torch float _to_copy = torch ops aten _to_copy default x_ dtype = torch float x_ = None full = torch ops aten full default dtype = torch float device = device type= cpu pin_memory = False empty = torch ops aten empty memory_format dtype = torch float layout = torch strided device = device type= cpu pin_memory = False convert_element_type _to_copy full empty NOQA B _ fp _examples = debug_utils cast_to_fp fx x assertEqual fp _examples x torch float assertExpectedInline fx code lstrip \ forward x_ convert_element_type = torch ops prims convert_element_type default x_ torch float _to_copy = torch ops aten _to_copy default x_ dtype = torch float x_ = None full = torch ops aten full default dtype = torch float device = device type= cpu pin_memory = False empty = torch ops aten empty memory_format dtype = torch float layout = torch strided device = device type= cpu pin_memory = False convert_element_type _to_copy full empty NOQA B patch dict os environ TORCHINDUCTOR_MAX_AUTOTUNE TEST_ENV test_generate_env_vars_string env_strings = generate_env_vars_string assertIn os environ TORCHINDUCTOR_MAX_AUTOTUNE = env_strings assertIn os env_strings assertNotIn TEST_ENV env_strings TestDebugUtilsDevice TestCase test_aot_graph_parser device forward primals_ f primals_ f primals_ f primals_ f primals_ f primals_ f primals_ f _tensor_constant i = _tensor_constant lift_fresh_copy i = torch ops aten lift_fresh_copy default _tensor_constant _tensor_constant = None index f = torch ops aten index Tensor noqa F primals_ None lift_fresh_copy lift_fresh_copy = None _tensor_constant i = _tensor_constant lift_fresh_copy_ i = torch ops aten lift_fresh_copy default _tensor_constant _tensor_constant = None index_ f = torch ops aten index Tensor primals_ None lift_fresh_copy_ primals_ = lift_fresh_copy_ = None permute f = torch ops aten permute default primals_ primals_ = None addmm f = torch ops aten addmm default primals_ index_ permute primals_ = permute = None amax f = torch ops aten amax default addmm - True sub f = torch ops aten sub Tensor addmm amax exp f = torch ops aten exp default sub sub = None sum_ f = torch ops aten sum dim_IntList exp - True div f = torch ops aten div Tensor exp sum_ exp = None full_default i = torch ops aten full default dtype=torch int layout=torch strided device=device pin_memory=False iota i = torch ops prims iota default start= step= dtype=torch int device=device requires_grad=False mul i = torch ops aten mul Tensor full_default iota full_default = iota = None iota_ i = torch ops prims iota default start= step= dtype=torch int device=device requires_grad=False view i = torch ops aten reshape default mul - mul = None view_ f = torch ops aten reshape default div - div = None _embedding_bag = torch ops aten _embedding_bag default primals_ view iota_ False False view_ _embedding_bag kwargs = aot_graph_input_parser forward device=device runs successfully forward kwargs test_sym_aot_graph_parser device forward primals_ f noqa F primals_ f s noqa F primals_ Sym s noqa F primals_ f s noqa F primals_ Sym s noqa F _tensor_constant i = _tensor_constant kwargs = aot_graph_input_parser forward device=device sym_shapes= s default_sym_shape= assertEqual list kwargs primals_ shape assertEqual kwargs primals_ assertEqual list kwargs primals_ shape assertEqual kwargs primals_ instantiate_device_type_tests TestDebugUtils globals devices = cuda hpu instantiate_device_type_tests TestDebugUtilsDevice globals only_for=devices __name__ == __main__ torch _dynamo test_case run_tests run_tests