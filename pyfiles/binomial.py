mypy allow-untyped-defs typing Optional Union torch torch Tensor torch distributions constraints torch distributions distribution Distribution torch distributions utils broadcast_all lazy_property logits_to_probs probs_to_logits __all__ = Binomial _clamp_by_zero x works like clamp x min= has grad x clamp min= + x - x clamp max= Binomial Distribution r Creates Binomial distribution parameterized attr ` total_count ` either attr ` probs ` attr ` logits ` both attr ` total_count ` must broadcastable attr ` probs ` attr ` logits ` Example xdoctest +IGNORE_WANT non-deterministic m = Binomial torch tensor x = m sample tensor m = Binomial torch tensor torch tensor x = m sample tensor Args total_count int Tensor number Bernoulli trials probs Tensor Event probabilities logits Tensor Event log-odds pyrefly ignore bad-override arg_constraints = total_count constraints nonnegative_integer probs constraints unit_interval logits constraints real has_enumerate_support = True __init__ total_count Union Tensor int = probs Optional Tensor = None logits Optional Tensor = None validate_args Optional bool = None - None probs None == logits None raise ValueError Either ` probs ` ` logits ` must specified both probs None total_count pyrefly ignore read-only probs = broadcast_all total_count probs total_count = total_count type_as probs assert logits None helps mypy total_count pyrefly ignore read-only logits = broadcast_all total_count logits total_count = total_count type_as logits _param = probs probs None logits batch_shape = _param size super __init__ batch_shape validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance Binomial _instance batch_shape = torch Size batch_shape new total_count = total_count expand batch_shape probs __dict__ new probs = probs expand batch_shape new _param = new probs logits __dict__ new logits = logits expand batch_shape new _param = new logits super Binomial new __init__ batch_shape validate_args=False new _validate_args = _validate_args new _new args kwargs _param new args kwargs constraints dependent_property is_discrete=True event_dim= pyrefly ignore bad-override support constraints integer_interval total_count property mean - Tensor total_count probs property mode - Tensor total_count + probs floor clamp max=self total_count property variance - Tensor total_count probs - probs lazy_property logits - Tensor probs_to_logits probs is_binary=True lazy_property probs - Tensor logits_to_probs logits is_binary=True property param_shape - torch Size _param size sample sample_shape=torch Size shape = _extended_shape sample_shape torch no_grad torch binomial total_count expand shape probs expand shape log_prob value _validate_args _validate_sample value log_factorial_n = torch lgamma total_count + log_factorial_k = torch lgamma value + log_factorial_nmk = torch lgamma total_count - value + k log p + n - k log - p = k log p - log - p + n log - p case logit = k logit - n log p e^logit case logit = k logit - n log p - log - p + n log p = k logit - n logit - n log p e^-logit merge two cases = k logit - n max logit - n log p e^- &#124; logit &#124; normalize_term = total_count _clamp_by_zero logits + total_count torch log p torch exp -torch abs logits - log_factorial_n value logits - log_factorial_k - log_factorial_nmk - normalize_term entropy total_count = int total_count max total_count min == total_count raise NotImplementedError Inhomogeneous total count supported ` entropy ` log_prob = log_prob enumerate_support False - torch exp log_prob log_prob sum enumerate_support expand=True total_count = int total_count max total_count min == total_count raise NotImplementedError Inhomogeneous total count supported ` enumerate_support ` values = torch arange + total_count dtype=self _param dtype device=self _param device values = values view - + len _batch_shape expand values = values expand - + _batch_shape values