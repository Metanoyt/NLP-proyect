mypy allow-untyped-defs os path glob glob typing cast torch torch types Storage __serialization_id_record_name__ = data serialization_id because get_storage_from_record returns tensor _HasStorage __init__ storage _storage = storage storage _storage DirectoryReader Class allow PackageImporter operate unzipped packages Methods copy behavior internal PyTorchFileReader which used accessing packages all other cases N B ScriptObjects depickleable accessible via DirectoryReader due ScriptObjects requiring actual PyTorchFileReader instance __init__ directory directory = directory get_record name filename = f directory name open filename rb f f read get_storage_from_record name numel dtype filename = f directory name nbytes = torch _utils _element_size dtype numel storage = cast Storage torch UntypedStorage _HasStorage storage from_file filename=filename nbytes=nbytes has_record path full_path = os path join directory path os path isfile full_path get_all_records files = filename len directory + filename glob f directory recursive=True os path isdir filename files serialization_id has_record __serialization_id_record_name__ get_record __serialization_id_record_name__