__future__ annotations functools linecache os sys time warnings pathlib Path types ModuleType typing Any Callable TYPE_CHECKING torch _utils_internal log_triton_builds TYPE_CHECKING torch _inductor runtime triton_heuristics CachingAutotuner _reload_python_module key str path str set_sys_modules bool = True - ModuleType open path f try code = compile f read path exec dont_inherit=True except Exception e raise RuntimeError f Failed path \n type e __name__ e None mod = ModuleType f __name__ key mod __file__ = path mod key = key type ignore attr-defined exec code mod __dict__ mod __dict__ set_sys_modules sys modules mod __name__ = mod mod functools cache _set_triton_ptxas_path - None os environ get TRITON_PTXAS_PATH None ptxas = Path __file__ absolute parents bin ptxas ptxas exists ptxas is_file os access ptxas os X_OK os environ TRITON_PTXAS_PATH = str ptxas warnings warn f ptxas exists executable _worker_compile_triton load_kernel Callable CachingAutotuner extra_env dict str str extra_config dict str Any - tuple CachingAutotuner int _set_triton_ptxas_path os environ update extra_env torch _inductor config config patch extra_config fail = None try start_ns = time time_ns kernel = load_kernel kernel precompile warm_cache_only=True elapsed_ns = time time_ns - start_ns kernel prepare_for_pickle We can release memory compile subprocesses linecache clearcache kernel elapsed_ns except Exception e fail = str e raise finally log_triton_builds fail=fail