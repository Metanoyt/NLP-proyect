mypy allow-untyped-defs Various linear algebra utility methods internal use typing Optional torch torch Tensor is_sparse A Check tensor A sparse COO tensor All other sparse storage formats CSR CSC etc will False isinstance A torch Tensor A layout == torch sparse_coo error_str = expected Tensor torch jit is_scripting error_str += f got type A raise TypeError error_str get_floating_dtype A Return floating point dtype tensor A Integer types map float dtype = A dtype dtype torch float torch float torch float dtype torch float matmul A Optional Tensor B Tensor - Tensor Multiply two matrices If A None B A can sparse dense B always dense A None B is_sparse A torch sparse mm A B torch matmul A B bform X Tensor A Optional Tensor Y Tensor - Tensor Return bilinear form matrices math ` X^T A Y ` matmul X mT matmul A Y qform A Optional Tensor S Tensor Return quadratic form math ` S^T A S ` bform S A S basis A Return orthogonal basis A columns torch linalg qr A Q symeig A Tensor largest Optional bool = False - tuple Tensor Tensor Return eigenpairs A specified ordering largest None largest = False E Z = torch linalg eigh A UPLO= U assuming E ordered largest E = torch flip E dims= - Z = torch flip Z dims= - E Z These functions deprecated removed This nice error message can removed version + matrix_rank input tol=None symmetric=False out=None - Tensor raise RuntimeError This function deprecated since version now removed \n Please use ` torch linalg matrix_rank ` function instead The parameter symmetric renamed ` torch linalg matrix_rank ` hermitian solve input Tensor A Tensor out=None - tuple Tensor Tensor raise RuntimeError This function deprecated since version now removed ` torch solve ` deprecated favor ` torch linalg solve ` ` torch linalg solve ` has its arguments reversed does LU factorization \n\n To get LU factorization see ` torch lu ` which can used ` torch lu_solve ` ` torch lu_unpack ` \n X = torch solve B A solution should replaced \n X = torch linalg solve A B lstsq input Tensor A Tensor out=None - tuple Tensor Tensor raise RuntimeError This function deprecated since version now removed ` torch lstsq ` deprecated favor ` torch linalg lstsq ` \n ` torch linalg lstsq ` has reversed arguments does QR decomposition returned tuple although returns other information about problem \n\n To get QR decomposition consider using ` torch linalg qr ` \n\n The returned solution ` torch lstsq ` stored residuals solution last m - n columns returned value whenever m n In torch linalg lstsq residuals field residuals returned named tuple \n\n The unpacking solution in\n X _ = torch lstsq B A solution A size \n should replaced \n X = torch linalg lstsq A B solution _symeig input eigenvectors=False upper=True out=None - tuple Tensor Tensor raise RuntimeError This function deprecated since version now removed The default behavior has changed using upper triangular portion matrix default using lower triangular portion \n\n L _ = torch symeig A upper=upper should replaced \n L = torch linalg eigvalsh A UPLO= U upper L \n\n and\n\n L V = torch symeig A eigenvectors=True should replaced \n L V = torch linalg eigh A UPLO= U upper L eig Tensor eigenvectors bool = False e=None v=None - tuple Tensor Tensor raise RuntimeError This function deprecated since version now removed ` torch linalg eig ` returns complex tensors dtype ` cfloat ` ` cdouble ` rather than real tensors mimicking complex tensors \n\n L _ = torch eig A should replaced \n L_complex = torch linalg eigvals A \n\n and\n\n L V = torch eig A eigenvectors=True should replaced \n L_complex V_complex = torch linalg eig A