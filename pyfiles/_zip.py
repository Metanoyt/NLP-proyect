mypy allow-untyped-defs argparse glob os pathlib Path zipfile ZipFile Exclude some standard library modules Slim down final zipped file size Remove functionality we don t want support DENY_LIST = Interface unix databases dbm ncurses bindings terminal interfaces curses Tcl Tk GUI tkinter tkinter Tests standard library test tests idle_test __phello__ foo py importlib frozen modules These already baked into CPython _bootstrap py _bootstrap_external py strip_file_dir = remove_prefix text prefix text startswith prefix text len prefix text write_to_zip file_path strip_file_path zf prepend_str= stripped_file_path = prepend_str + remove_prefix file_path strip_file_dir + path = Path stripped_file_path path name DENY_LIST zf write file_path stripped_file_path main - None global strip_file_dir parser = argparse ArgumentParser description= Zip py source parser add_argument paths nargs= help= Paths zip parser add_argument -- install-dir -- install_dir help= Root directory all output files parser add_argument -- strip-dir -- strip_dir help= The absolute directory we want remove zip parser add_argument -- prepend-str -- prepend_str help= A string prepend onto all paths file zip default= parser add_argument -- zip-name -- zip_name help= Output zip name args = parser parse_args zip_file_name = args install_dir + + args zip_name strip_file_dir = args strip_dir prepend_str = args prepend_str zf = ZipFile zip_file_name mode= w p sorted args paths os path isdir p files = glob glob p + py recursive=True file_path sorted files strip absolute path write_to_zip file_path strip_file_dir + zf prepend_str=prepend_str write_to_zip p strip_file_dir + zf prepend_str=prepend_str __name__ == __main__ main pragma no cover