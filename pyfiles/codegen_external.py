mypy ignore-errors argparse torchgen model model torchgen gen FileManager parse_native_yaml num_leading_spaces line str - int len line - len line lstrip deindent code str - str lines = code split \n min_leading_spaces = min map num_leading_spaces lines lines = line min_leading_spaces line lines \n join lines gen_external native_functions_path tags_path external_path native_functions = parse_native_yaml native_functions_path tags_path func_decls = func_registrations = func native_functions schema = func func name = schema name name base args = schema arguments Only supports extern calls functions out variants schema is_out_fn continue Doesn t currently support functions more than one out parameter len args out continue Doesn t currently support kwarg arguments len args pre_tensor_options_kwarg_only len args post_tensor_options_kwarg_only continue self_arg = args self_arg argument args self_arg None args = list args pre_self_positional + self_arg + list args post_self_positional tensor_args = arg arg args isinstance arg type model BaseType arg type name == model BaseTy Tensor len tensor_args = len args continue arg_names = None len args tensor_decls = idx arg enumerate tensor_args s = f const Tensor arg name = tensors idx + tensor_decls append s arg_names idx = arg name nl = \n print tensor_decls name arg_names func_decl = f \ void nnc_aten_ name int _t bufs_num void buf_data int _t buf_ranks int _t buf_dims int _t buf_strides int _t buf_dtypes int _t args_num int _t extra_args std vector Tensor tensors = constructTensors bufs_num buf_data buf_ranks buf_dims buf_strides buf_dtypes Tensor r = tensors nl join tensor_decls try name _out join r + arg_names catch func_registration = f \ const static RegisterNNCExternalFunction nnc_ name nnc_aten_ name nnc_aten_ name func_decls append func_decl func_registrations append func_registration fm = FileManager install_dir= template_dir= dry_run=False fm write_with_template external_functions_codegen cpp external_path lambda external_registrations func_registrations external_functions func_decls main - None parser = argparse ArgumentParser description= Generate annotated_fn_args script parser add_argument -- native-functions -- native_functions help= path native_functions yaml default= aten src ATen native native_functions yaml parser add_argument -- tags help= path tags yaml default= aten src ATen native tags yaml parser add_argument -- template-path -- template_path help= path external_functions_codegen_template cpp default= tools jit templates external_functions_codegen_template cpp args = parser parse_args gen_external args native_functions args tags args template_path __name__ == __main__ main