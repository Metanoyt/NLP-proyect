numpy operator_benchmark op_bench torch Microbenchmarks index_select operator An example input configuration M= N= dim= index_select_configs_short = op_bench config_list attr_names= M N K dim attrs= cross_product_configs= device cpu cuda tags= short index_select_configs_long = op_bench cross_product_configs M= N= K= dim= device= cpu cuda tags= long IndexSelectBenchmark op_bench TorchBenchmarkBase init M N K dim device max_val = N numpy random seed - index_dim = numpy random randint N inputs = input_one torch rand M N K device=device dim dim index torch tensor numpy random randint max_val index_dim device=device set_module_name index_select forward input_one dim index torch index_select input_one dim index op_bench generate_pt_test index_select_configs_short + index_select_configs_long IndexSelectBenchmark __name__ == __main__ op_bench benchmark_runner main