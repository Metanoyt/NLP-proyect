benchmark_helper time_with_torch_timer torch torch _dynamo torch _dynamo config torch _inductor config config torch _dynamo optimize inductor nopython=True inductor_aten_bmm b torch bmm b torch _dynamo optimize inductor nopython=True inductor_triton_bmm b torch bmm b torch_bmm b torch bmm b test_total_time shapes print shape torch bmm inductor aten bmm inductor triton bmm i range len shapes a_shape b_shape = shapes i print a_shape x b_shape end= = torch randn a_shape device= cuda dtype=torch float b = torch randn b_shape device= cuda dtype=a dtype config triton use_bmm = False inductor_aten_bmm b config triton use_bmm = True inductor_triton_bmm b torch_ms = time_with_torch_timer torch_bmm b mean config triton use_bmm = False ind_aten_ms = time_with_torch_timer inductor_aten_bmm b mean config triton use_bmm = True ind_triton_ms = time_with_torch_timer inductor_triton_bmm b mean print torch_ms ind_aten_ms ind_triton_ms sep= __name__ == __main__ shapes = BERT all hf_GPT all hf_Albert all test_total_time shapes