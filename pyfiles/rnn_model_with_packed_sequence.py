torch nn torch nn utils rnn rnn_utils RnnModelWithPackedSequence nn Module __init__ model batch_first super __init__ model = model batch_first = batch_first forward input args args seq_lengths = args - args - input = rnn_utils pack_padded_sequence input seq_lengths batch_first rets = model input args ret rets = rets rets ret _ = rnn_utils pad_packed_sequence ret batch_first tuple ret + list rets RnnModelWithPackedSequenceWithoutState nn Module __init__ model batch_first super __init__ model = model batch_first = batch_first forward input seq_lengths input = rnn_utils pack_padded_sequence input seq_lengths batch_first rets = model input ret rets = rets rets ret _ = rnn_utils pad_packed_sequence ret batch_first list ret + list rets RnnModelWithPackedSequenceWithState nn Module __init__ model batch_first super __init__ model = model batch_first = batch_first forward input hx seq_lengths input = rnn_utils pack_padded_sequence input seq_lengths batch_first rets = model input hx ret rets = rets rets ret _ = rnn_utils pad_packed_sequence ret batch_first list ret + list rets