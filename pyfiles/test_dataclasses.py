Owner s oncall jit dataclasses dataclass field InitVar enum Enum typing List Optional hypothesis given settings strategies st torch torch testing _internal common_utils raise_on_run_directly torch testing _internal jit_utils JitTestCase Example jittable dataclass dataclass order=True Point x float y float norm Optional torch Tensor = None __post_init__ norm = torch tensor x + torch tensor y MixupScheme Enum INPUT = input MANIFOLD = input before_fusion_projection after_fusion_projection after_classifier_projection dataclass MixupParams __init__ alpha float = scheme MixupScheme = MixupScheme INPUT alpha = alpha scheme = scheme MixupScheme Enum A = B = dataclass MixupParams __init__ alpha float = scheme MixupScheme = MixupScheme A alpha = alpha scheme = scheme dataclass MixupParams __init__ alpha float = scheme MixupScheme = MixupScheme A alpha = alpha scheme = scheme Make sure Meta internal tooling doesn t raise overflow error NonHugeFloats = st floats min_value=- e max_value= e allow_nan=False TestDataclasses JitTestCase classmethod tearDownClass cls torch _C _jit_clear_class_registry test_init_vars torch jit script dataclass order=True Point x float y float norm_p InitVar int = norm Optional torch Tensor = None __post_init__ norm_p int norm = torch tensor x norm_p + torch tensor y norm_p norm_p fn x float y float p int pt = Point x y p pt norm checkScript fn Sort tests both __post_init__ optional fields settings deadline=None given NonHugeFloats NonHugeFloats test__post_init__ x y P = torch jit script Point fn x float y float pt = P x y pt norm checkScript fn x y settings deadline=None given st tuples NonHugeFloats NonHugeFloats st tuples NonHugeFloats NonHugeFloats test_comparators pt pt x y = pt x y = pt P = torch jit script Point compare x float y float x float y float pt = P x y pt = P x y pt == pt pt = pt TODO Modify interpreter auto-resolve = b == b when there s no __ne__ pt pt pt = pt pt pt pt = pt checkScript compare x y x y test_default_factories dataclass Foo object x List int = field default_factory=list assertRaises NotImplementedError torch jit script Foo fn foo = Foo foo x torch jit script fn The user should able write their own __eq__ implementation without us overriding test_custom__eq__ torch jit script dataclass CustomEq int b int __eq__ other CustomEq - bool == other ignore b field fn int b int b int pt = CustomEq b pt = CustomEq b pt == pt checkScript fn test_no_source assertRaises RuntimeError uses list Enum supported torch jit script MixupParams torch jit script MixupParams don t throw test_use_unregistered_dataclass_raises f MixupParams assertRaises OSError torch jit script f __name__ == __main__ raise_on_run_directly test test_jit py