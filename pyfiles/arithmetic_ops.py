typing Union typing_extensions assert_type TypeAlias torch randn Tensor Test deduced types arithmetic operations between tensors ints floats bools The expected type should always ` Tensor ` isn t See https github com pytorch pytorch issues TENSOR INT FLOAT BOOL = randn True Unary ops assert_type +TENSOR Tensor assert_type -TENSOR Tensor assert_type ~TENSOR Tensor Binary ops boolean Operator == assert_type TENSOR == TENSOR Tensor assert_type TENSOR == BOOL Tensor assert_type BOOL == TENSOR bool Should Tensor assert_type TENSOR == INT Tensor assert_type INT == TENSOR bool Should Tensor assert_type TENSOR == FLOAT Tensor assert_type FLOAT == TENSOR bool Should Tensor Operator = assert_type TENSOR = TENSOR Tensor assert_type TENSOR = BOOL Tensor assert_type BOOL = TENSOR bool Should Tensor assert_type TENSOR = INT Tensor assert_type INT = TENSOR bool Should Tensor assert_type TENSOR = FLOAT Tensor assert_type FLOAT = TENSOR bool Should Tensor Operator assert_type TENSOR TENSOR Tensor assert_type TENSOR BOOL Tensor assert_type BOOL TENSOR Tensor assert_type TENSOR INT Tensor assert_type INT TENSOR Tensor assert_type TENSOR FLOAT Tensor assert_type FLOAT TENSOR Tensor Operator assert_type TENSOR TENSOR Tensor assert_type TENSOR BOOL Tensor assert_type BOOL TENSOR Tensor assert_type TENSOR INT Tensor assert_type INT TENSOR Tensor assert_type TENSOR FLOAT Tensor assert_type FLOAT TENSOR Tensor Operator = assert_type TENSOR = TENSOR Tensor assert_type TENSOR = BOOL Tensor assert_type BOOL = TENSOR Tensor assert_type TENSOR = INT Tensor assert_type INT = TENSOR Tensor assert_type TENSOR = FLOAT Tensor assert_type FLOAT = TENSOR Tensor Operator = assert_type TENSOR = TENSOR Tensor assert_type TENSOR = BOOL Tensor assert_type BOOL = TENSOR Tensor assert_type TENSOR = INT Tensor assert_type INT = TENSOR Tensor assert_type TENSOR = FLOAT Tensor assert_type FLOAT = TENSOR Tensor Binary ops take ints floats Operator + assert_type TENSOR + TENSOR Tensor assert_type TENSOR + BOOL Tensor assert_type BOOL + TENSOR Tensor assert_type TENSOR + INT Tensor assert_type INT + TENSOR Tensor assert_type TENSOR + FLOAT Tensor assert_type FLOAT + TENSOR Tensor Operator - assert_type TENSOR - TENSOR Tensor assert_type TENSOR - BOOL Tensor assert_type BOOL - TENSOR Tensor assert_type TENSOR - INT Tensor assert_type INT - TENSOR Tensor assert_type TENSOR - FLOAT Tensor assert_type FLOAT - TENSOR Tensor Operator assert_type TENSOR TENSOR Tensor assert_type TENSOR BOOL Tensor assert_type BOOL TENSOR Tensor assert_type TENSOR INT Tensor assert_type INT TENSOR Tensor assert_type TENSOR FLOAT Tensor assert_type FLOAT TENSOR Tensor Operator assert_type TENSOR TENSOR Tensor assert_type TENSOR BOOL Tensor assert_type BOOL TENSOR Tensor assert_type TENSOR INT Tensor assert_type INT TENSOR Tensor assert_type TENSOR FLOAT Tensor assert_type FLOAT TENSOR Tensor Operator assert_type TENSOR TENSOR Tensor assert_type TENSOR BOOL Tensor assert_type BOOL TENSOR Tensor assert_type TENSOR INT Tensor assert_type INT TENSOR Tensor assert_type TENSOR FLOAT Tensor assert_type FLOAT TENSOR Tensor Operator assert_type TENSOR TENSOR Tensor assert_type TENSOR BOOL Tensor assert_type BOOL TENSOR Tensor assert_type TENSOR INT Tensor assert_type INT TENSOR Tensor assert_type TENSOR FLOAT Tensor assert_type FLOAT TENSOR Tensor Operator assert_type TENSOR TENSOR Tensor assert_type TENSOR BOOL Tensor assert_type BOOL TENSOR Tensor assert_type TENSOR INT Tensor assert_type INT TENSOR Tensor assert_type TENSOR FLOAT Tensor assert_type FLOAT TENSOR Tensor Matrix multiplication Operator assert_type TENSOR TENSOR Tensor assert_type TENSOR BOOL Tensor Should fail type checking assert_type BOOL TENSOR Tensor type ignore operator assert_type TENSOR INT Tensor Should fail type checking assert_type INT TENSOR Tensor type ignore operator assert_type TENSOR FLOAT Tensor Should fail type checking assert_type FLOAT TENSOR Tensor type ignore operator Binary ops take ints only Operator assert_type TENSOR TENSOR Tensor assert_type TENSOR BOOL Tensor assert_type BOOL TENSOR Tensor assert_type TENSOR INT Tensor assert_type INT TENSOR Tensor assert_type TENSOR FLOAT Tensor Should fail type checking assert_type FLOAT TENSOR Tensor Should fail type checking Operator assert_type TENSOR TENSOR Tensor assert_type TENSOR BOOL Tensor assert_type BOOL TENSOR Tensor assert_type TENSOR INT Tensor assert_type INT TENSOR Tensor assert_type TENSOR FLOAT Tensor Should fail type checking assert_type FLOAT TENSOR Tensor Should fail type checking Operator assert_type TENSOR TENSOR Tensor assert_type TENSOR BOOL Tensor assert_type BOOL TENSOR Tensor assert_type TENSOR INT Tensor assert_type INT TENSOR Tensor assert_type TENSOR FLOAT Tensor Should fail type checking assert_type FLOAT TENSOR Tensor type ignore operator Operator &#124; assert_type TENSOR &#124; TENSOR Tensor assert_type TENSOR &#124; BOOL Tensor assert_type BOOL &#124; TENSOR Tensor assert_type TENSOR &#124; INT Tensor assert_type INT &#124; TENSOR Tensor assert_type TENSOR &#124; FLOAT Tensor Should fail type checking assert_type FLOAT &#124; TENSOR Tensor type ignore operator Operator ^ assert_type TENSOR ^ TENSOR Tensor assert_type TENSOR ^ BOOL Tensor assert_type BOOL ^ TENSOR Tensor assert_type TENSOR ^ INT Tensor assert_type INT ^ TENSOR Tensor assert_type TENSOR ^ FLOAT Tensor Should fail type checking assert_type FLOAT ^ TENSOR Tensor type ignore operator NUMBER TypeAlias = Union int float bool Binary This demonstrates what possible overriding every magic method relating binary operations __add__ other NUMBER - Binary type ignore override __and__ other NUMBER - Binary type ignore override __div__ other NUMBER - Binary type ignore override __eq__ other NUMBER - Binary type ignore override __floordiv__ other NUMBER - Binary type ignore override __ge__ other NUMBER - Binary type ignore override __gt__ other NUMBER - Binary type ignore override __le__ other NUMBER - Binary type ignore override __lshift__ other NUMBER - Binary type ignore override __lt__ other NUMBER - Binary type ignore override __mod__ other NUMBER - Binary type ignore override __mul__ other NUMBER - Binary type ignore override __ne__ other NUMBER - Binary type ignore override __or__ other NUMBER - Binary type ignore override __pow__ other NUMBER - Binary type ignore override __radd__ other NUMBER - Binary type ignore override __rand__ other NUMBER - Binary type ignore override __rdiv__ other NUMBER - Binary type ignore override __rfloordiv__ other NUMBER - Binary type ignore override __rlshift__ other NUMBER - Binary type ignore override __rmod__ other NUMBER - Binary type ignore override __rmul__ other NUMBER - Binary type ignore override __ror__ other NUMBER - Binary type ignore override __rpow__ other NUMBER - Binary type ignore override __rrshift__ other NUMBER - Binary type ignore override __rshift__ other NUMBER - Binary type ignore override __rsub__ other NUMBER - Binary type ignore override __rtruediv__ other NUMBER - Binary type ignore override __rxor__ other NUMBER - Binary type ignore override __sub__ other NUMBER - Binary type ignore override __truediv__ other NUMBER - Binary type ignore override __xor__ other NUMBER - Binary type ignore override BINARY = Binary assert_type BINARY + INT Binary assert_type BINARY INT Binary assert_type BINARY INT Binary assert_type BINARY == INT Binary assert_type BINARY INT Binary assert_type BINARY = INT Binary assert_type BINARY INT Binary assert_type BINARY = INT Binary assert_type BINARY INT Binary assert_type BINARY INT Binary assert_type BINARY INT Binary assert_type BINARY INT Binary assert_type BINARY = INT Binary assert_type BINARY &#124; INT Binary assert_type BINARY INT Binary assert_type BINARY INT Binary assert_type BINARY - INT Binary assert_type BINARY ^ INT Binary assert_type INT + BINARY Binary assert_type INT BINARY Binary assert_type INT BINARY Binary assert_type INT == BINARY bool assert_type INT BINARY Binary assert_type INT = BINARY Binary assert_type INT BINARY Binary assert_type INT = BINARY Binary assert_type INT BINARY Binary assert_type INT BINARY Binary assert_type INT BINARY Binary assert_type INT BINARY Binary assert_type INT = BINARY bool assert_type INT &#124; BINARY Binary assert_type INT BINARY Binary assert_type INT BINARY Binary assert_type INT - BINARY Binary assert_type INT ^ BINARY Binary assert_type BINARY + FLOAT Binary assert_type BINARY FLOAT Binary assert_type BINARY FLOAT Binary assert_type BINARY == FLOAT Binary assert_type BINARY FLOAT Binary assert_type BINARY = FLOAT Binary assert_type BINARY FLOAT Binary assert_type BINARY = FLOAT Binary assert_type BINARY FLOAT Binary assert_type BINARY FLOAT Binary assert_type BINARY FLOAT Binary assert_type BINARY FLOAT Binary assert_type BINARY = FLOAT Binary assert_type BINARY &#124; FLOAT Binary assert_type BINARY FLOAT Binary assert_type BINARY FLOAT Binary assert_type BINARY - FLOAT Binary assert_type BINARY ^ FLOAT Binary assert_type FLOAT + BINARY Binary assert_type FLOAT BINARY Binary assert_type FLOAT BINARY Binary assert_type FLOAT == BINARY bool assert_type FLOAT BINARY Binary assert_type FLOAT = BINARY Binary assert_type FLOAT BINARY Binary assert_type FLOAT = BINARY Binary assert_type FLOAT BINARY Binary assert_type FLOAT BINARY Binary assert_type FLOAT BINARY Binary assert_type FLOAT BINARY Binary assert_type FLOAT = BINARY bool assert_type FLOAT &#124; BINARY Binary assert_type FLOAT BINARY Binary assert_type FLOAT BINARY Binary assert_type FLOAT - BINARY Binary assert_type FLOAT ^ BINARY Binary assert_type BINARY + BOOL Binary assert_type BINARY BOOL Binary assert_type BINARY BOOL Binary assert_type BINARY == BOOL Binary assert_type BINARY BOOL Binary assert_type BINARY = BOOL Binary assert_type BINARY BOOL Binary assert_type BINARY = BOOL Binary assert_type BINARY BOOL Binary assert_type BINARY BOOL Binary assert_type BINARY BOOL Binary assert_type BINARY BOOL Binary assert_type BINARY = BOOL Binary assert_type BINARY &#124; BOOL Binary assert_type BINARY BOOL Binary assert_type BINARY BOOL Binary assert_type BINARY - BOOL Binary assert_type BINARY ^ BOOL Binary assert_type BOOL + BINARY Binary assert_type BOOL BINARY Binary assert_type BOOL BINARY Binary assert_type BOOL == BINARY bool assert_type BOOL BINARY Binary assert_type BOOL = BINARY Binary assert_type BOOL BINARY Binary assert_type BOOL = BINARY Binary assert_type BOOL BINARY Binary assert_type BOOL BINARY Binary assert_type BOOL BINARY Binary assert_type BOOL BINARY Binary assert_type BOOL = BINARY bool assert_type BOOL &#124; BINARY Binary assert_type BOOL BINARY Binary assert_type BOOL BINARY Binary assert_type BOOL - BINARY Binary assert_type BOOL ^ BINARY Binary