mypy ignore-errors typing Any Optional torch torch utils _pytree pytree torch _subclasses fake_tensor is_fake torch testing _internal two_tensor TwoTensor torch utils _python_dispatch return_and_correct_aliasing WrapperSubclass torch Tensor staticmethod __new__ cls outer_size=None outer_stride=None outer_size None outer_size = size outer_stride None outer_stride = stride kwargs = kwargs strides = outer_stride kwargs storage_offset = storage_offset kwargs device = device kwargs layout = layout kwargs requires_grad = requires_grad kwargs dtype = dtype out = torch Tensor _make_wrapper_subclass cls outer_size kwargs out __init__ outer_size=None outer_stride=None = __repr__ f WrapperSubclass repr __tensor_flatten__ None staticmethod __tensor_unflatten__ inner_tensors meta outer_size outer_stride assert meta None = inner_tensors is_fake assert outer_size None assert outer_stride None WrapperSubclass outer_size outer_stride classmethod __torch_dispatch__ cls func types args kwargs kwargs None kwargs = args_a = pytree tree_map_only WrapperSubclass lambda x x args kwargs_a = pytree tree_map_only WrapperSubclass lambda x x kwargs out_a = func args_a kwargs_a out_a_flat spec = pytree tree_flatten out_a out_flat = WrapperSubclass o_a isinstance o_a torch Tensor o_a o_a out_a_flat out = pytree tree_unflatten out_flat spec torch _higher_order_ops cond cond_op func cond_op out return_and_correct_aliasing func args kwargs out __coerce_same_metadata_as_tangent__ expected_metadata Any expected_type Optional type = None expected_type type expected_type TwoTensor TwoTensor clone None