Owner s oncall jit io os sys warnings contextlib redirect_stderr torch torch testing FileCheck Make helper files test importable pytorch_test_dir = os path dirname os path dirname os path realpath __file__ sys path append pytorch_test_dir torch testing _internal common_utils raise_on_run_directly torch testing _internal jit_utils JitTestCase TestWarn JitTestCase test_warn torch jit script fn warnings warn I am warning you f = io StringIO redirect_stderr f fn FileCheck check_count str= UserWarning I am warning you count= exactly=True run f getvalue test_warn_only_once torch jit script fn _ range warnings warn I am warning you f = io StringIO redirect_stderr f fn FileCheck check_count str= UserWarning I am warning you count= exactly=True run f getvalue test_warn_only_once_in_loop_func w warnings warn I am warning you torch jit script fn _ range w f = io StringIO redirect_stderr f fn FileCheck check_count str= UserWarning I am warning you count= exactly=True run f getvalue test_warn_once_per_func w warnings warn I am warning you w warnings warn I am warning you torch jit script fn w w f = io StringIO redirect_stderr f fn FileCheck check_count str= UserWarning I am warning you count= exactly=True run f getvalue test_warn_once_per_func_in_loop w warnings warn I am warning you w warnings warn I am warning you torch jit script fn _ range w w f = io StringIO redirect_stderr f fn FileCheck check_count str= UserWarning I am warning you count= exactly=True run f getvalue test_warn_multiple_calls_multiple_warnings torch jit script fn warnings warn I am warning you f = io StringIO redirect_stderr f fn fn FileCheck check_count str= UserWarning I am warning you count= exactly=True run f getvalue test_warn_multiple_calls_same_func_diff_stack warn caller str warnings warn I am warning you + caller torch jit script foo warn foo torch jit script bar warn bar f = io StringIO redirect_stderr f foo bar FileCheck check_count str= UserWarning I am warning you foo count= exactly=True check_count str= UserWarning I am warning you bar count= exactly=True run f getvalue __name__ == __main__ raise_on_run_directly test test_jit py