Copyright c Meta Platforms Inc affiliates typing_extensions Protocol runtime_checkable torch runtime_checkable _Checkpointable Protocol noqa PYI Interface checkpointable objects Implemented protocol implicit subtyping supported so subclasses do need inherit explicitly This allow arbitrary objects tensor subclasses hook into DCP seamlessly through implementing interface __create_write_items__ fqn str object object - list object Return list WriteItems based object s contents raise NotImplementedError _Checkpointable _create_write_items implemented __create_chunk_list__ - list object Return list ` ChunkStorageMetadata ` based object s contents raise NotImplementedError _Checkpointable _create_chunk_list implemented __get_tensor_shard__ index int - torch Tensor Return torch Tensor shard based MetadataIndex raise NotImplementedError _Checkpointable _get_tensor_shard implemented