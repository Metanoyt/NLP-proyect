torch fx BackwardState BackwardState used pass Python hooks forwards pass into backwards pass Dynamo+Compiled Autograd It created TorchDynamo has special handling there Dynamo will pass empty BackwardState forwards then populate members via setattr only after forwards graph finished Later CompileAutograd we will inline add needed guards BackwardState BackwardState identified has special handling AOTAutograd During AOTAutograd BackwardState input forwards graph It must only used backwards It will empty forwards In forwards we add wrapper save In backwards becomes input There can only one per graph BackwardState requires CompiledAutograd proxy torch fx Proxy