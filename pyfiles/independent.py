mypy allow-untyped-defs typing Generic Optional TypeVar torch torch Size Tensor torch distributions constraints torch distributions distribution Distribution torch distributions utils _sum_rightmost torch types _size __all__ = Independent D = TypeVar D bound=Distribution Independent Distribution Generic D r Reinterprets some batch dims distribution event dims This mainly useful changing shape result meth ` log_prob ` For example create diagonal Normal distribution same shape Multivariate Normal distribution so they interchangeable you can torch distributions multivariate_normal MultivariateNormal torch distributions normal Normal loc = torch zeros scale = torch ones mvn = MultivariateNormal loc scale_tril=torch diag scale mvn batch_shape mvn event_shape torch Size torch Size normal = Normal loc scale normal batch_shape normal event_shape torch Size torch Size diagn = Independent normal diagn batch_shape diagn event_shape torch Size torch Size Args base_distribution torch distributions distribution Distribution base distribution reinterpreted_batch_ndims int number batch dims reinterpret event dims arg_constraints dict str constraints Constraint = base_dist D __init__ base_distribution D reinterpreted_batch_ndims int validate_args Optional bool = None - None reinterpreted_batch_ndims len base_distribution batch_shape raise ValueError Expected reinterpreted_batch_ndims = len base_distribution batch_shape f actual reinterpreted_batch_ndims vs len base_distribution batch_shape shape Size = base_distribution batch_shape + base_distribution event_shape event_dim int = reinterpreted_batch_ndims + len base_distribution event_shape batch_shape = shape len shape - event_dim event_shape = shape len shape - event_dim base_dist = base_distribution reinterpreted_batch_ndims = reinterpreted_batch_ndims super __init__ batch_shape event_shape validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance Independent _instance batch_shape = torch Size batch_shape new base_dist = base_dist expand batch_shape + event_shape reinterpreted_batch_ndims new reinterpreted_batch_ndims = reinterpreted_batch_ndims super Independent new __init__ batch_shape event_shape validate_args=False new _validate_args = _validate_args new property has_rsample - bool type ignore override base_dist has_rsample property has_enumerate_support - bool type ignore override reinterpreted_batch_ndims False base_dist has_enumerate_support constraints dependent_property pyrefly ignore bad-override support result = base_dist support reinterpreted_batch_ndims result = constraints independent result reinterpreted_batch_ndims result property mean - Tensor base_dist mean property mode - Tensor base_dist mode property variance - Tensor base_dist variance sample sample_shape=torch Size - Tensor base_dist sample sample_shape rsample sample_shape _size = torch Size - Tensor base_dist rsample sample_shape log_prob value log_prob = base_dist log_prob value _sum_rightmost log_prob reinterpreted_batch_ndims entropy entropy = base_dist entropy _sum_rightmost entropy reinterpreted_batch_ndims enumerate_support expand=True reinterpreted_batch_ndims raise NotImplementedError Enumeration over cartesian product implemented base_dist enumerate_support expand=expand __repr__ __class__ __name__ + f base_dist reinterpreted_batch_ndims