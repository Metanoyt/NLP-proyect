os timeit torch fx torch _dynamo utils counters torch _inductor utils clear_caches fresh_cache N = K = huge_graph x _ range N x = x sin x main torch _inductor config fx_graph_cache = True torch _inductor config fx_graph_remote_cache = False fresh_cache = torch randn cuda compiled_fn = torch compile huge_graph backend= inductor write cache compiled_fn assert counters inductor fxgraph_cache_miss == setup torch _dynamo reset clear_caches m torch _inductor codecache PyCodeCache cache values os remove m __file__ counters clear fn result = compiled_fn assert counters inductor fxgraph_cache_miss == assert counters inductor fxgraph_cache_hit == result t = min timeit repeat fn setup=setup number=K repeat= print f took t f s __name__ == __main__ main