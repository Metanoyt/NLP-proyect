inspect os re pathlib Path torch torch _dynamo torchdynamo torch _export db case ExportCase torch _export db examples all_examples torch export export PWD = Path __file__ absolute parent ROOT = Path __file__ absolute parents SOURCE = ROOT source EXPORTDB_SOURCE = SOURCE generated exportdb generate_example_rst example_case ExportCase Generates rst files all examples db examples model = example_case model tags = join f doc ` tag tag ` tag example_case tags source_file = inspect getfile model __class__ isinstance model torch nn Module inspect getfile model open source_file file source_code = file read source_code = source_code replace \n \n splitted_source_code = re split r export_rewrite_case \n source_code assert len splitted_source_code f more than one export_rewrite_case decorator source_code more_arguments = example_case example_kwargs more_arguments += example_kwargs example_case dynamic_shapes more_arguments += dynamic_shapes=dynamic_shapes Generate contents rst file title = f example_case name doc_contents = f title ^ len title note Tags tags Support Level example_case support_level name Original source code code-block python splitted_source_code torch export export model example_args more_arguments Result code-block Get resulting graph dynamo trace try exported_program = export model example_case example_args example_case example_kwargs dynamic_shapes=example_case dynamic_shapes strict=True graph_output = str exported_program graph_output = re sub r File &#124; \n \n graph_output graph_output = graph_output replace \n \n output = f graph_output except torchdynamo exc Unsupported e output = Unsupported + str e split \n except AssertionError e output = AssertionError + str e split \n except RuntimeError e output = RuntimeError + str e split \n doc_contents += output + \n len splitted_source_code == doc_contents += f \n You can rewrite example above something like following code-block python splitted_source_code doc_contents generate_index_rst example_cases tag_to_modules support_level_to_modules Generates index rst file support_contents = k v support_level_to_modules items support_level = k name lower replace _ title module_contents = \n\n join v support_contents += f support_level - len support_level module_contents tag_names = \n join t t tag_to_modules keys open os path join PWD blurb txt file blurb = file read Generate contents rst file doc_contents = f _torch export_db ExportDB ======== blurb toctree maxdepth caption Tags tag_names support_contents open os path join EXPORTDB_SOURCE index rst w f f write doc_contents generate_tag_rst tag_to_modules For each tag shows up each ExportCase tag generate rst file containing all examples have tag tag modules_rst tag_to_modules items doc_contents = f tag \n = len tag + \n full_modules_rst = \n\n join modules_rst full_modules_rst = re sub r = lambda match - len match group full_modules_rst doc_contents += full_modules_rst open os path join EXPORTDB_SOURCE f tag rst w f f write doc_contents generate_rst os path exists EXPORTDB_SOURCE os makedirs EXPORTDB_SOURCE example_cases = all_examples tag_to_modules = support_level_to_modules = example_case example_cases values doc_contents = generate_example_rst example_case tag example_case tags tag_to_modules setdefault tag append doc_contents support_level_to_modules setdefault example_case support_level append doc_contents generate_tag_rst tag_to_modules generate_index_rst example_cases tag_to_modules support_level_to_modules __name__ == __main__ generate_rst