Owner s module inductor torch torch _inductor config torch _inductor metrics torch _inductor test_case run_tests TestCase torch _inductor utils run_and_get_code torch testing _internal common_utils instantiate_parametrized_tests parametrize skipIfRocm torch testing _internal triton_utils requires_cuda_and_triton instantiate_parametrized_tests TestTorchDeviceAssertTrigger TestCase parametrize backend eager aot_eager inductor test_assert_should_throw backend func = torch tensor - device= cpu result = torch all assert result should throw func_inline = torch tensor - device= cpu assert torch all should throw assertRaisesRegex RuntimeError should throw torch _dynamo reset f_c = torch compile func backend=backend f_c assertRaisesRegex RuntimeError should throw torch _dynamo reset f_c = torch compile func_inline backend=backend f_c parametrize backend eager aot_eager inductor test_assert_should_not_throw backend func = torch tensor device= cpu result = torch all assert result should throw func_inline = torch tensor device= cpu assert torch all should throw torch _dynamo reset f_c = torch compile func backend=backend f_c torch _dynamo reset f_c = torch compile func_inline backend=backend f_c requires_cuda_and_triton skipIfRocm torch _inductor config patch force_disable_caches=True test_assert_fusion torch _logging set_logs inductor_metrics=True func = torch tensor device= cuda result = torch all assert result should throw torch _dynamo reset f_c = torch compile func backend= inductor metrics reset assertEqual metrics generated_kernel_count f_c assertEqual metrics generated_kernel_count torch _logging set_logs requires_cuda_and_triton skipIfRocm torch _inductor config patch force_disable_caches=True test_run_assert_triton torch compile backend= inductor fn = torch tensor device= cuda result = torch all assert result should throw should_not_throw fn try fn True except Exception False assertEqual should_not_throw fn True _ code = run_and_get_code fn assertEqual code count tl device_assert __name__ == __main__ run_tests