mypy ignore-errors noqa F E This auto-generated file Please do modify hand To re-generate run cd ~ pytorch python torchgen fuse gen_patterns py torch torch _inductor operator aten = torch ops aten prims = torch ops prims torch _inductor pattern_matcher Arg CallFunction CallFunctionVarArgs CallMethod CallMethodVarArgs CallModule CallModuleVarArgs ExclusiveKeywordArg Ignored KeywordArg ListOf MultiOutputPattern PatternExpr RepeatedExpr _TargetArgsExpr _TargetExpr _TargetExprVarArgs rand_default = CallFunction aten rand default Ignored dtype=Ignored device=Ignored pin_memory=False gt_Scalar = CallFunction aten gt Scalar rand_default KeywordArg dropout_p _users= permute_default = CallFunction aten permute default KeywordArg query Ignored expand_default = CallFunction aten expand default permute_default Ignored clone_default = CallFunction aten clone default expand_default memory_format=torch contiguous_format view_default = CallFunction aten view default clone_default Ignored _users= permute_default_ = CallFunction aten permute default KeywordArg key Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored clone_default_ = CallFunction aten clone default expand_default_ memory_format=torch contiguous_format view_default_ = CallFunction aten view default clone_default_ Ignored _users= bmm_default = CallFunction aten bmm default view_default view_default_ view_default_ = CallFunction aten view default bmm_default Ignored div_Tensor = CallFunction aten div Tensor view_default_ KeywordArg inv_scale add_Tensor = CallFunction aten add Tensor div_Tensor KeywordArg attn_mask _users= amax_default = CallFunction aten amax default add_Tensor Ignored True sub_Tensor = CallFunction aten sub Tensor add_Tensor amax_default exp_default = CallFunction aten exp default sub_Tensor _users= sum_dim_IntList = CallFunction aten sum dim_IntList exp_default Ignored True div_Tensor_ = CallFunction aten div Tensor exp_default sum_dim_IntList _users= mul_Tensor = CallFunction aten mul Tensor gt_Scalar div_Tensor_ mul_Tensor_ = CallFunction aten mul Tensor mul_Tensor Ignored expand_default_ = CallFunction aten expand default mul_Tensor_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored _users= permute_default_ = CallFunction aten permute default KeywordArg value Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored clone_default_ = CallFunction aten clone default expand_default_ memory_format=torch contiguous_format view_default_ = CallFunction aten view default clone_default_ Ignored _users= bmm_default_ = CallFunction aten bmm default view_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored neg_default = CallFunction aten neg default div_Tensor_ view_default_ = CallFunction aten view default KeywordArg tangents_ Ignored _users= permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ permute_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored convert_element_type_default = CallFunction prims convert_element_type default gt_Scalar Ignored mul_Tensor_ = CallFunction aten mul Tensor convert_element_type_default Ignored mul_Tensor_ = CallFunction aten mul Tensor view_default_ mul_Tensor_ mul_Tensor_ = CallFunction aten mul Tensor mul_Tensor_ div_Tensor_ _users= sum_dim_IntList_ = CallFunction aten sum dim_IntList mul_Tensor_ Ignored True fma_default = CallFunction prims fma default neg_default sum_dim_IntList_ mul_Tensor_ div_Tensor_ = CallFunction aten div Tensor fma_default KeywordArg inv_scale view_default_ = CallFunction aten view default div_Tensor_ Ignored _users= permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ permute_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored permute_default_ = CallFunction aten permute default view_default Ignored bmm_default_ = CallFunction aten bmm default permute_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default permute_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored _sfdp_pattern_ _training = MultiOutputPattern view_default_ permute_default_ permute_default_ permute_default_ None None None permute_default = CallFunction aten permute default KeywordArg query Ignored expand_default = CallFunction aten expand default permute_default Ignored clone_default = CallFunction aten clone default expand_default memory_format=torch contiguous_format view_default = CallFunction aten view default clone_default Ignored permute_default_ = CallFunction aten permute default KeywordArg key Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored clone_default_ = CallFunction aten clone default expand_default_ memory_format=torch contiguous_format view_default_ = CallFunction aten view default clone_default_ Ignored bmm_default = CallFunction aten bmm default view_default view_default_ view_default_ = CallFunction aten view default bmm_default Ignored div_Tensor = CallFunction aten div Tensor view_default_ KeywordArg inv_scale add_Tensor = CallFunction aten add Tensor div_Tensor KeywordArg attn_mask _users= amax_default = CallFunction aten amax default add_Tensor Ignored True sub_Tensor = CallFunction aten sub Tensor add_Tensor amax_default exp_default = CallFunction aten exp default sub_Tensor _users= sum_dim_IntList = CallFunction aten sum dim_IntList exp_default Ignored True div_Tensor_ = CallFunction aten div Tensor exp_default sum_dim_IntList expand_default_ = CallFunction aten expand default div_Tensor_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored permute_default_ = CallFunction aten permute default KeywordArg value Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored clone_default_ = CallFunction aten clone default expand_default_ memory_format=torch contiguous_format view_default_ = CallFunction aten view default clone_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ view_default_ _sfdp_pattern_ _inference = CallFunction aten view default bmm_default_ Ignored _users= rand_default = CallFunction aten rand default Ignored dtype=Ignored device=Ignored pin_memory=False gt_Scalar = CallFunction aten gt Scalar rand_default KeywordArg dropout_p _users= permute_default = CallFunction aten permute default KeywordArg query Ignored expand_default = CallFunction aten expand default permute_default Ignored view_default = CallFunction aten view default expand_default Ignored _users= permute_default_ = CallFunction aten permute default KeywordArg key Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored _users= bmm_default = CallFunction aten bmm default view_default view_default_ view_default_ = CallFunction aten view default bmm_default Ignored div_Tensor = CallFunction aten div Tensor view_default_ KeywordArg inv_scale add_Tensor = CallFunction aten add Tensor div_Tensor KeywordArg attn_mask _users= amax_default = CallFunction aten amax default add_Tensor Ignored True sub_Tensor = CallFunction aten sub Tensor add_Tensor amax_default exp_default = CallFunction aten exp default sub_Tensor _users= sum_dim_IntList = CallFunction aten sum dim_IntList exp_default Ignored True div_Tensor_ = CallFunction aten div Tensor exp_default sum_dim_IntList _users= mul_Tensor = CallFunction aten mul Tensor gt_Scalar div_Tensor_ mul_Tensor_ = CallFunction aten mul Tensor mul_Tensor Ignored expand_default_ = CallFunction aten expand default mul_Tensor_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored _users= permute_default_ = CallFunction aten permute default KeywordArg value Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored _users= bmm_default_ = CallFunction aten bmm default view_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored neg_default = CallFunction aten neg default div_Tensor_ view_default_ = CallFunction aten view default KeywordArg tangents_ Ignored _users= permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ permute_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored convert_element_type_default = CallFunction prims convert_element_type default gt_Scalar Ignored mul_Tensor_ = CallFunction aten mul Tensor convert_element_type_default Ignored mul_Tensor_ = CallFunction aten mul Tensor view_default_ mul_Tensor_ mul_Tensor_ = CallFunction aten mul Tensor mul_Tensor_ div_Tensor_ _users= sum_dim_IntList_ = CallFunction aten sum dim_IntList mul_Tensor_ Ignored True fma_default = CallFunction prims fma default neg_default sum_dim_IntList_ mul_Tensor_ div_Tensor_ = CallFunction aten div Tensor fma_default KeywordArg inv_scale view_default_ = CallFunction aten view default div_Tensor_ Ignored _users= permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ permute_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored permute_default_ = CallFunction aten permute default view_default Ignored bmm_default_ = CallFunction aten bmm default permute_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default permute_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored _sfdp_pattern_ _bs _training = MultiOutputPattern view_default_ permute_default_ permute_default_ permute_default_ None None None permute_default = CallFunction aten permute default KeywordArg query Ignored expand_default = CallFunction aten expand default permute_default Ignored view_default = CallFunction aten view default expand_default Ignored permute_default_ = CallFunction aten permute default KeywordArg key Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored bmm_default = CallFunction aten bmm default view_default view_default_ view_default_ = CallFunction aten view default bmm_default Ignored div_Tensor = CallFunction aten div Tensor view_default_ KeywordArg inv_scale add_Tensor = CallFunction aten add Tensor div_Tensor KeywordArg attn_mask _users= amax_default = CallFunction aten amax default add_Tensor Ignored True sub_Tensor = CallFunction aten sub Tensor add_Tensor amax_default exp_default = CallFunction aten exp default sub_Tensor _users= sum_dim_IntList = CallFunction aten sum dim_IntList exp_default Ignored True div_Tensor_ = CallFunction aten div Tensor exp_default sum_dim_IntList expand_default_ = CallFunction aten expand default div_Tensor_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored permute_default_ = CallFunction aten permute default KeywordArg value Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ view_default_ _sfdp_pattern_ _bs _inference = CallFunction aten view default bmm_default_ Ignored _users= rand_default = CallFunction aten rand default Ignored dtype=Ignored device=Ignored pin_memory=False gt_Scalar = CallFunction aten gt Scalar rand_default KeywordArg dropout_p _users= permute_default = CallFunction aten permute default KeywordArg query Ignored expand_default = CallFunction aten expand default permute_default Ignored clone_default = CallFunction aten clone default expand_default memory_format=torch contiguous_format view_default = CallFunction aten view default clone_default Ignored _users= permute_default_ = CallFunction aten permute default KeywordArg key Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored clone_default_ = CallFunction aten clone default expand_default_ memory_format=torch contiguous_format view_default_ = CallFunction aten view default clone_default_ Ignored _users= bmm_default = CallFunction aten bmm default view_default view_default_ view_default_ = CallFunction aten view default bmm_default Ignored div_Tensor = CallFunction aten div Tensor view_default_ KeywordArg inv_scale add_Tensor = CallFunction aten add Tensor div_Tensor KeywordArg attn_mask convert_element_type_default = CallFunction prims convert_element_type default add_Tensor Ignored _users= amax_default = CallFunction aten amax default convert_element_type_default Ignored True sub_Tensor = CallFunction aten sub Tensor convert_element_type_default amax_default exp_default = CallFunction aten exp default sub_Tensor _users= sum_dim_IntList = CallFunction aten sum dim_IntList exp_default Ignored True div_Tensor_ = CallFunction aten div Tensor exp_default sum_dim_IntList convert_element_type_default_ = CallFunction prims convert_element_type default div_Tensor_ Ignored _users= mul_Tensor = CallFunction aten mul Tensor gt_Scalar convert_element_type_default_ mul_Tensor_ = CallFunction aten mul Tensor mul_Tensor Ignored expand_default_ = CallFunction aten expand default mul_Tensor_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored _users= permute_default_ = CallFunction aten permute default KeywordArg value Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored clone_default_ = CallFunction aten clone default expand_default_ memory_format=torch contiguous_format view_default_ = CallFunction aten view default clone_default_ Ignored _users= bmm_default_ = CallFunction aten bmm default view_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored convert_element_type_default_ = CallFunction prims convert_element_type default convert_element_type_default_ Ignored _users= neg_default = CallFunction aten neg default convert_element_type_default_ view_default_ = CallFunction aten view default KeywordArg tangents_ Ignored _users= permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ permute_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored convert_element_type_default_ = CallFunction prims convert_element_type default gt_Scalar Ignored mul_Tensor_ = CallFunction aten mul Tensor convert_element_type_default_ Ignored mul_Tensor_ = CallFunction aten mul Tensor view_default_ mul_Tensor_ convert_element_type_default_ = CallFunction prims convert_element_type default mul_Tensor_ Ignored mul_Tensor_ = CallFunction aten mul Tensor convert_element_type_default_ convert_element_type_default_ _users= sum_dim_IntList_ = CallFunction aten sum dim_IntList mul_Tensor_ Ignored True fma_default = CallFunction prims fma default neg_default sum_dim_IntList_ mul_Tensor_ convert_element_type_default_ = CallFunction prims convert_element_type default fma_default Ignored div_Tensor_ = CallFunction aten div Tensor convert_element_type_default_ KeywordArg inv_scale view_default_ = CallFunction aten view default div_Tensor_ Ignored _users= permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ permute_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored permute_default_ = CallFunction aten permute default view_default Ignored bmm_default_ = CallFunction aten bmm default permute_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default permute_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored _sfdp_pattern_ _half_training = MultiOutputPattern view_default_ permute_default_ permute_default_ permute_default_ None None None permute_default = CallFunction aten permute default KeywordArg query Ignored expand_default = CallFunction aten expand default permute_default Ignored clone_default = CallFunction aten clone default expand_default memory_format=torch contiguous_format view_default = CallFunction aten view default clone_default Ignored permute_default_ = CallFunction aten permute default KeywordArg key Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored clone_default_ = CallFunction aten clone default expand_default_ memory_format=torch contiguous_format view_default_ = CallFunction aten view default clone_default_ Ignored bmm_default = CallFunction aten bmm default view_default view_default_ view_default_ = CallFunction aten view default bmm_default Ignored div_Tensor = CallFunction aten div Tensor view_default_ KeywordArg inv_scale add_Tensor = CallFunction aten add Tensor div_Tensor KeywordArg attn_mask convert_element_type_default = CallFunction prims convert_element_type default add_Tensor Ignored _users= amax_default = CallFunction aten amax default convert_element_type_default Ignored True sub_Tensor = CallFunction aten sub Tensor convert_element_type_default amax_default exp_default = CallFunction aten exp default sub_Tensor _users= sum_dim_IntList = CallFunction aten sum dim_IntList exp_default Ignored True div_Tensor_ = CallFunction aten div Tensor exp_default sum_dim_IntList convert_element_type_default_ = CallFunction prims convert_element_type default div_Tensor_ Ignored expand_default_ = CallFunction aten expand default convert_element_type_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored permute_default_ = CallFunction aten permute default KeywordArg value Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored clone_default_ = CallFunction aten clone default expand_default_ memory_format=torch contiguous_format view_default_ = CallFunction aten view default clone_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ view_default_ _sfdp_pattern_ _half_inference = CallFunction aten view default bmm_default_ Ignored _users= rand_default = CallFunction aten rand default Ignored dtype=Ignored device=Ignored pin_memory=False gt_Scalar = CallFunction aten gt Scalar rand_default KeywordArg dropout_p _users= permute_default = CallFunction aten permute default KeywordArg query Ignored expand_default = CallFunction aten expand default permute_default Ignored view_default = CallFunction aten view default expand_default Ignored _users= permute_default_ = CallFunction aten permute default KeywordArg key Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored _users= bmm_default = CallFunction aten bmm default view_default view_default_ view_default_ = CallFunction aten view default bmm_default Ignored div_Tensor = CallFunction aten div Tensor view_default_ KeywordArg inv_scale add_Tensor = CallFunction aten add Tensor div_Tensor KeywordArg attn_mask convert_element_type_default = CallFunction prims convert_element_type default add_Tensor Ignored _users= amax_default = CallFunction aten amax default convert_element_type_default Ignored True sub_Tensor = CallFunction aten sub Tensor convert_element_type_default amax_default exp_default = CallFunction aten exp default sub_Tensor _users= sum_dim_IntList = CallFunction aten sum dim_IntList exp_default Ignored True div_Tensor_ = CallFunction aten div Tensor exp_default sum_dim_IntList convert_element_type_default_ = CallFunction prims convert_element_type default div_Tensor_ Ignored _users= mul_Tensor = CallFunction aten mul Tensor gt_Scalar convert_element_type_default_ mul_Tensor_ = CallFunction aten mul Tensor mul_Tensor Ignored expand_default_ = CallFunction aten expand default mul_Tensor_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored _users= permute_default_ = CallFunction aten permute default KeywordArg value Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored _users= bmm_default_ = CallFunction aten bmm default view_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored convert_element_type_default_ = CallFunction prims convert_element_type default convert_element_type_default_ Ignored _users= neg_default = CallFunction aten neg default convert_element_type_default_ view_default_ = CallFunction aten view default KeywordArg tangents_ Ignored _users= permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ permute_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored convert_element_type_default_ = CallFunction prims convert_element_type default gt_Scalar Ignored mul_Tensor_ = CallFunction aten mul Tensor convert_element_type_default_ Ignored mul_Tensor_ = CallFunction aten mul Tensor view_default_ mul_Tensor_ convert_element_type_default_ = CallFunction prims convert_element_type default mul_Tensor_ Ignored mul_Tensor_ = CallFunction aten mul Tensor convert_element_type_default_ convert_element_type_default_ _users= sum_dim_IntList_ = CallFunction aten sum dim_IntList mul_Tensor_ Ignored True fma_default = CallFunction prims fma default neg_default sum_dim_IntList_ mul_Tensor_ convert_element_type_default_ = CallFunction prims convert_element_type default fma_default Ignored div_Tensor_ = CallFunction aten div Tensor convert_element_type_default_ KeywordArg inv_scale view_default_ = CallFunction aten view default div_Tensor_ Ignored _users= permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ permute_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored permute_default_ = CallFunction aten permute default view_default Ignored bmm_default_ = CallFunction aten bmm default permute_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default permute_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored _sfdp_pattern_ _half_bs _training = MultiOutputPattern view_default_ permute_default_ permute_default_ permute_default_ None None None permute_default = CallFunction aten permute default KeywordArg query Ignored expand_default = CallFunction aten expand default permute_default Ignored view_default = CallFunction aten view default expand_default Ignored permute_default_ = CallFunction aten permute default KeywordArg key Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored bmm_default = CallFunction aten bmm default view_default view_default_ view_default_ = CallFunction aten view default bmm_default Ignored div_Tensor = CallFunction aten div Tensor view_default_ KeywordArg inv_scale add_Tensor = CallFunction aten add Tensor div_Tensor KeywordArg attn_mask convert_element_type_default = CallFunction prims convert_element_type default add_Tensor Ignored _users= amax_default = CallFunction aten amax default convert_element_type_default Ignored True sub_Tensor = CallFunction aten sub Tensor convert_element_type_default amax_default exp_default = CallFunction aten exp default sub_Tensor _users= sum_dim_IntList = CallFunction aten sum dim_IntList exp_default Ignored True div_Tensor_ = CallFunction aten div Tensor exp_default sum_dim_IntList convert_element_type_default_ = CallFunction prims convert_element_type default div_Tensor_ Ignored expand_default_ = CallFunction aten expand default convert_element_type_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored permute_default_ = CallFunction aten permute default KeywordArg value Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ view_default_ _sfdp_pattern_ _half_bs _inference = CallFunction aten view default bmm_default_ Ignored _users= rand_default = CallFunction aten rand default Ignored dtype=Ignored device=Ignored pin_memory=False gt_Scalar = CallFunction aten gt Scalar rand_default KeywordArg dropout_p _users= permute_default = CallFunction aten permute default KeywordArg query Ignored expand_default = CallFunction aten expand default permute_default Ignored clone_default = CallFunction aten clone default expand_default memory_format=torch contiguous_format view_default = CallFunction aten view default clone_default Ignored _users= permute_default_ = CallFunction aten permute default KeywordArg key Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored clone_default_ = CallFunction aten clone default expand_default_ memory_format=torch contiguous_format view_default_ = CallFunction aten view default clone_default_ Ignored _users= bmm_default = CallFunction aten bmm default view_default view_default_ view_default_ = CallFunction aten view default bmm_default Ignored div_Tensor = CallFunction aten div Tensor view_default_ KeywordArg inv_scale add_Tensor = CallFunction aten add Tensor div_Tensor KeywordArg attn_mask _users= amax_default = CallFunction aten amax default add_Tensor Ignored True sub_Tensor = CallFunction aten sub Tensor add_Tensor amax_default exp_default = CallFunction aten exp default sub_Tensor _users= sum_dim_IntList = CallFunction aten sum dim_IntList exp_default Ignored True div_Tensor_ = CallFunction aten div Tensor exp_default sum_dim_IntList _users= mul_Tensor = CallFunction aten mul Tensor gt_Scalar div_Tensor_ mul_Tensor_ = CallFunction aten mul Tensor mul_Tensor Ignored convert_element_type_default = CallFunction prims convert_element_type default mul_Tensor_ Ignored expand_default_ = CallFunction aten expand default convert_element_type_default Ignored view_default_ = CallFunction aten view default expand_default_ Ignored _users= permute_default_ = CallFunction aten permute default KeywordArg value Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored clone_default_ = CallFunction aten clone default expand_default_ memory_format=torch contiguous_format view_default_ = CallFunction aten view default clone_default_ Ignored _users= bmm_default_ = CallFunction aten bmm default view_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored neg_default = CallFunction aten neg default div_Tensor_ view_default_ = CallFunction aten view default KeywordArg tangents_ Ignored _users= permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ permute_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored convert_element_type_default_ = CallFunction prims convert_element_type default view_default_ Ignored convert_element_type_default_ = CallFunction prims convert_element_type default gt_Scalar Ignored mul_Tensor_ = CallFunction aten mul Tensor convert_element_type_default_ Ignored mul_Tensor_ = CallFunction aten mul Tensor convert_element_type_default_ mul_Tensor_ mul_Tensor_ = CallFunction aten mul Tensor mul_Tensor_ div_Tensor_ _users= sum_dim_IntList_ = CallFunction aten sum dim_IntList mul_Tensor_ Ignored True fma_default = CallFunction prims fma default neg_default sum_dim_IntList_ mul_Tensor_ convert_element_type_default_ = CallFunction prims convert_element_type default fma_default Ignored div_Tensor_ = CallFunction aten div Tensor convert_element_type_default_ KeywordArg inv_scale view_default_ = CallFunction aten view default div_Tensor_ Ignored _users= permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ permute_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored permute_default_ = CallFunction aten permute default view_default Ignored bmm_default_ = CallFunction aten bmm default permute_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default permute_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored _sfdp_pattern_ _half_mask_fp _training = MultiOutputPattern view_default_ permute_default_ permute_default_ permute_default_ None None None permute_default = CallFunction aten permute default KeywordArg query Ignored expand_default = CallFunction aten expand default permute_default Ignored clone_default = CallFunction aten clone default expand_default memory_format=torch contiguous_format view_default = CallFunction aten view default clone_default Ignored permute_default_ = CallFunction aten permute default KeywordArg key Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored clone_default_ = CallFunction aten clone default expand_default_ memory_format=torch contiguous_format view_default_ = CallFunction aten view default clone_default_ Ignored bmm_default = CallFunction aten bmm default view_default view_default_ view_default_ = CallFunction aten view default bmm_default Ignored div_Tensor = CallFunction aten div Tensor view_default_ KeywordArg inv_scale add_Tensor = CallFunction aten add Tensor div_Tensor KeywordArg attn_mask _users= amax_default = CallFunction aten amax default add_Tensor Ignored True sub_Tensor = CallFunction aten sub Tensor add_Tensor amax_default exp_default = CallFunction aten exp default sub_Tensor _users= sum_dim_IntList = CallFunction aten sum dim_IntList exp_default Ignored True div_Tensor_ = CallFunction aten div Tensor exp_default sum_dim_IntList convert_element_type_default = CallFunction prims convert_element_type default div_Tensor_ Ignored expand_default_ = CallFunction aten expand default convert_element_type_default Ignored view_default_ = CallFunction aten view default expand_default_ Ignored permute_default_ = CallFunction aten permute default KeywordArg value Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored clone_default_ = CallFunction aten clone default expand_default_ memory_format=torch contiguous_format view_default_ = CallFunction aten view default clone_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ view_default_ _sfdp_pattern_ _half_mask_fp _inference = CallFunction aten view default bmm_default_ Ignored _users= rand_default = CallFunction aten rand default Ignored dtype=Ignored device=Ignored pin_memory=False gt_Scalar = CallFunction aten gt Scalar rand_default KeywordArg dropout_p _users= permute_default = CallFunction aten permute default KeywordArg query Ignored expand_default = CallFunction aten expand default permute_default Ignored view_default = CallFunction aten view default expand_default Ignored _users= permute_default_ = CallFunction aten permute default KeywordArg key Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored _users= bmm_default = CallFunction aten bmm default view_default view_default_ view_default_ = CallFunction aten view default bmm_default Ignored div_Tensor = CallFunction aten div Tensor view_default_ KeywordArg inv_scale add_Tensor = CallFunction aten add Tensor div_Tensor KeywordArg attn_mask _users= amax_default = CallFunction aten amax default add_Tensor Ignored True sub_Tensor = CallFunction aten sub Tensor add_Tensor amax_default exp_default = CallFunction aten exp default sub_Tensor _users= sum_dim_IntList = CallFunction aten sum dim_IntList exp_default Ignored True div_Tensor_ = CallFunction aten div Tensor exp_default sum_dim_IntList _users= mul_Tensor = CallFunction aten mul Tensor gt_Scalar div_Tensor_ mul_Tensor_ = CallFunction aten mul Tensor mul_Tensor Ignored convert_element_type_default = CallFunction prims convert_element_type default mul_Tensor_ Ignored expand_default_ = CallFunction aten expand default convert_element_type_default Ignored view_default_ = CallFunction aten view default expand_default_ Ignored _users= permute_default_ = CallFunction aten permute default KeywordArg value Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored _users= bmm_default_ = CallFunction aten bmm default view_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored neg_default = CallFunction aten neg default div_Tensor_ view_default_ = CallFunction aten view default KeywordArg tangents_ Ignored _users= permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ permute_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored convert_element_type_default_ = CallFunction prims convert_element_type default view_default_ Ignored convert_element_type_default_ = CallFunction prims convert_element_type default gt_Scalar Ignored mul_Tensor_ = CallFunction aten mul Tensor convert_element_type_default_ Ignored mul_Tensor_ = CallFunction aten mul Tensor convert_element_type_default_ mul_Tensor_ mul_Tensor_ = CallFunction aten mul Tensor mul_Tensor_ div_Tensor_ _users= sum_dim_IntList_ = CallFunction aten sum dim_IntList mul_Tensor_ Ignored True fma_default = CallFunction prims fma default neg_default sum_dim_IntList_ mul_Tensor_ convert_element_type_default_ = CallFunction prims convert_element_type default fma_default Ignored div_Tensor_ = CallFunction aten div Tensor convert_element_type_default_ KeywordArg inv_scale view_default_ = CallFunction aten view default div_Tensor_ Ignored _users= permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ permute_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored permute_default_ = CallFunction aten permute default view_default Ignored bmm_default_ = CallFunction aten bmm default permute_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored bmm_default_ = CallFunction aten bmm default permute_default_ view_default_ view_default_ = CallFunction aten view default bmm_default_ Ignored permute_default_ = CallFunction aten permute default view_default_ Ignored _sfdp_pattern_ _half_mask_fp _bs _training = MultiOutputPattern view_default_ permute_default_ permute_default_ permute_default_ None None None permute_default = CallFunction aten permute default KeywordArg query Ignored expand_default = CallFunction aten expand default permute_default Ignored view_default = CallFunction aten view default expand_default Ignored permute_default_ = CallFunction aten permute default KeywordArg key Ignored permute_default_ = CallFunction aten permute default permute_default_ Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored bmm_default = CallFunction aten bmm default view_default view_default_ view_default_ = CallFunction aten view default bmm_default Ignored div_Tensor = CallFunction aten div Tensor view_default_ KeywordArg inv_scale add_Tensor = CallFunction aten add Tensor div_Tensor KeywordArg attn_mask _users= amax_default = CallFunction aten amax default add_Tensor Ignored True sub_Tensor = CallFunction aten sub Tensor add_Tensor amax_default exp_default = CallFunction aten exp default sub_Tensor _users= sum_dim_IntList = CallFunction aten sum dim_IntList exp_default Ignored True div_Tensor_ = CallFunction aten div Tensor exp_default sum_dim_IntList convert_element_type_default = CallFunction prims convert_element_type default div_Tensor_ Ignored expand_default_ = CallFunction aten expand default convert_element_type_default Ignored view_default_ = CallFunction aten view default expand_default_ Ignored permute_default_ = CallFunction aten permute default KeywordArg value Ignored expand_default_ = CallFunction aten expand default permute_default_ Ignored view_default_ = CallFunction aten view default expand_default_ Ignored bmm_default_ = CallFunction aten bmm default view_default_ view_default_ _sfdp_pattern_ _half_mask_fp _bs _inference = CallFunction aten view default bmm_default_ Ignored _users=