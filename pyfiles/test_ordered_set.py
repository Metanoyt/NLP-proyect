Owner s module inductor ruff noqa F collections collections abc copy gc operator pickle unittest warnings weakref test support torch testing _internal common_utils TestCase torch utils _ordered_set OrderedSet PassThru Exception pass check_pass_thru raise PassThru yield BadCmp __hash__ __eq__ other raise RuntimeError ReprWrapper Used test self-referential repr calls __repr__ repr value HashCountingInt int int-like object counts number times __hash__ called __init__ args hash_count = __hash__ hash_count += int __hash__ TestJointOps TestCase Tests common both OrderedSet frozenset thetype = OrderedSet basetype = OrderedSet setUp word = word = simsalabim otherword = madagascar letters = abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ s = thetype word d = dict fromkeys word test_new_or_init assertRaises TypeError thetype assertRaises TypeError OrderedSet __init__ a= test_uniquification actual = sorted s expected = sorted d assertEqual actual expected assertRaises PassThru thetype check_pass_thru assertRaises TypeError thetype test_len assertEqual len s len d test_contains c letters assertEqual c s c d assertRaises TypeError s __contains__ s = thetype frozenset letters assertIn thetype letters s test_union u = s union otherword c letters assertEqual c u c d c otherword assertEqual s thetype word assertEqual type u basetype assertRaises PassThru s union check_pass_thru assertRaises TypeError s union C OrderedSet frozenset dict fromkeys str list tuple assertEqual thetype abcba union C cdc OrderedSet abcd assertEqual thetype abcba union C efgfe OrderedSet abcefg assertEqual thetype abcba union C ccb OrderedSet abc assertEqual thetype abcba union C ef OrderedSet abcef assertEqual thetype abcba union C ef C fg OrderedSet abcefg Issue x = thetype assertEqual x union OrderedSet x OrderedSet thetype test_or i = s union otherword assertEqual s &#124; OrderedSet otherword i assertEqual s &#124; frozenset otherword i try s &#124; otherword except TypeError pass fail s &#124; t did screen-out general iterables test_intersection i = s intersection otherword c letters assertEqual c i c d c otherword assertEqual s thetype word assertEqual type i basetype assertRaises PassThru s intersection check_pass_thru C OrderedSet frozenset dict fromkeys str list tuple assertEqual thetype abcba intersection C cdc OrderedSet cc assertEqual thetype abcba intersection C efgfe OrderedSet assertEqual thetype abcba intersection C ccb OrderedSet bc assertEqual thetype abcba intersection C ef OrderedSet assertEqual thetype abcba intersection C cbcf C bag OrderedSet b s = thetype abcba z = s intersection thetype == frozenset assertEqual id s id z assertNotEqual id s id z test_isdisjoint f s s Pure python equivalent isdisjoint OrderedSet s intersection s large ab abc ababac cdc cc efgfe ccb ef s = thetype large rarg ab abc ababac cdc cc efgfe ccb ef C OrderedSet frozenset dict fromkeys str list tuple s = C rarg actual = s isdisjoint s expected = f s s assertEqual actual expected assertTrue actual True actual False test_and i = s intersection otherword assertEqual s OrderedSet otherword i assertEqual s frozenset otherword i try s otherword except TypeError pass fail s t did screen-out general iterables test_difference i = s difference otherword c letters assertEqual c i c d c otherword assertEqual s thetype word assertEqual type i basetype assertRaises PassThru s difference check_pass_thru assertRaises TypeError s difference C OrderedSet frozenset dict fromkeys str list tuple assertEqual thetype abcba difference C cdc OrderedSet ab assertEqual thetype abcba difference C efgfe OrderedSet abc assertEqual thetype abcba difference C ccb OrderedSet assertEqual thetype abcba difference C ef OrderedSet abc assertEqual thetype abcba difference OrderedSet abc assertEqual thetype abcba difference C C b OrderedSet c test_sub i = s difference otherword assertEqual s - OrderedSet otherword i assertEqual s - frozenset otherword i try s - otherword except TypeError pass fail s-t did screen-out general iterables test_symmetric_difference i = s symmetric_difference otherword c letters assertEqual c i c d ^ c otherword assertEqual s thetype word assertEqual type i basetype assertRaises PassThru s symmetric_difference check_pass_thru assertRaises TypeError s symmetric_difference C OrderedSet frozenset dict fromkeys str list tuple assertEqual thetype abcba symmetric_difference C cdc OrderedSet abd codespell ignore assertEqual thetype abcba symmetric_difference C efgfe OrderedSet abcefg assertEqual thetype abcba symmetric_difference C ccb OrderedSet assertEqual thetype abcba symmetric_difference C ef OrderedSet abcef test_xor i = s symmetric_difference otherword assertEqual s ^ OrderedSet otherword i assertEqual s ^ frozenset otherword i try s ^ otherword except TypeError pass fail s^t did screen-out general iterables test_equality assertEqual s OrderedSet word assertEqual s frozenset word assertEqual s == word False assertNotEqual s OrderedSet otherword assertNotEqual s frozenset otherword assertEqual s = word True test_setOfFrozensets t = map frozenset abcdef bcd bdcb fed fedccba s = thetype t assertEqual len s test_sub_and_super p q r = map thetype ab abcde assertTrue p q assertTrue p = q assertTrue q = q assertTrue q p assertTrue q = p assertFalse q r assertFalse q = r assertFalse q r assertFalse q = r assertTrue OrderedSet issubset abc assertTrue OrderedSet abc issuperset assertFalse OrderedSet issubset cbs assertFalse OrderedSet cbs issuperset test_pickling i range pickle HIGHEST_PROTOCOL + type s OrderedSet frozenset s x = x s z = z p = pickle dumps s i dup = pickle loads p assertEqual s dup s = s s dup noqa UP type s OrderedSet frozenset assertEqual s x dup x assertEqual s z dup z assertFalse hasattr s y del s x s z unittest skip Pickling nyi test_iterator_pickling proto range pickle HIGHEST_PROTOCOL + itorg = iter s data = thetype s d = pickle dumps itorg proto = pickle loads d Set iterators unpickle list iterators due undefined order OrderedSet items assertEqual type itorg type assertIsInstance collections abc Iterator assertEqual thetype data = pickle loads d try drop = next except StopIteration continue d = pickle dumps proto = pickle loads d assertEqual thetype data - thetype drop test_deepcopy Tracer __init__ value value = value __hash__ value __deepcopy__ memo=None Tracer value + t = Tracer s = thetype t dup = copy deepcopy s assertNotEqual id s id dup elem dup newt = elem assertNotEqual id t id newt assertEqual t value + newt value test_gc Create nest cycles exercise overall ref count check A pass s = OrderedSet A i range elem s elem cycle = s elem sub = elem elem OrderedSet = OrderedSet elem test_subclass_with_custom_hash Bug H thetype __hash__ int id x FFFFFFF s = H f = OrderedSet f add s assertIn s f f remove s f add s f discard s test_badcmp s = thetype BadCmp Detect comparison errors during insertion lookup assertRaises RuntimeError thetype BadCmp BadCmp assertRaises RuntimeError s __contains__ BadCmp Detect errors during mutating operations hasattr s add assertRaises RuntimeError s add BadCmp assertRaises RuntimeError s discard BadCmp assertRaises RuntimeError s remove BadCmp unittest skip Different repr test_cyclical_repr w = ReprWrapper s = thetype w w value = s thetype == OrderedSet assertEqual repr s OrderedSet name = repr s partition strip name assertEqual repr s s s name name noqa UP unittest skip Different hashing test_do_not_rehash_dict_keys n = d = dict fromkeys map HashCountingInt range n assertEqual sum elem hash_count elem d n s = thetype d assertEqual sum elem hash_count elem d n s difference d assertEqual sum elem hash_count elem d n hasattr s symmetric_difference_update s symmetric_difference_update d assertEqual sum elem hash_count elem d n d = dict fromkeys OrderedSet d assertEqual sum elem hash_count elem d n d = dict fromkeys frozenset d assertEqual sum elem hash_count elem d n d = dict fromkeys frozenset d assertEqual sum elem hash_count elem d n assertEqual d dict fromkeys d test_container_iterator Bug tp_traverse implemented OrderedSet iterator object C pass obj = C ref = weakref ref obj container = OrderedSet obj obj x = iter container del obj container gc collect assertTrue ref None Cycle collected test_free_after_iterating support check_free_after_iterating iter thetype TestSet TestJointOps TestCase thetype = OrderedSet basetype = OrderedSet test_init s = thetype s __init__ word assertEqual s OrderedSet word s __init__ otherword assertEqual s OrderedSet otherword assertRaises TypeError s __init__ s assertRaises TypeError s __init__ test_constructor_identity s = thetype range t = thetype s assertNotEqual id s id t test_set_literal s = OrderedSet t = assertEqual s t test_set_literal_insertion_order SF Issue -- Expect left right insertion s = True noqa B assertEqual len s stored_value = s pop assertEqual type stored_value int test_set_literal_evaluation_order Expect left right expression evaluation events = record obj events append obj s = record record record assertEqual events test_hash assertRaises TypeError hash s test_clear s clear assertEqual s OrderedSet assertEqual len s test_copy dup = s copy assertEqual s dup assertNotEqual id s id dup assertEqual type dup basetype test_add s add Q assertIn Q s dup = s copy s add Q assertEqual s dup assertRaises TypeError s add test_remove s remove assertNotIn s assertRaises KeyError s remove Q assertRaises TypeError s remove NYI __as_immutable__ s = thetype frozenset word assertIn thetype word s s remove thetype word assertNotIn thetype word s assertRaises KeyError s remove thetype word test_remove_keyerror_unpacking https bugs python org issue v Q try s remove v except KeyError e v = e args assertEqual v v fail test_remove_keyerror_set key = thetype try s remove key except Exception pass assertTrue e args key KeyError should format key e args fail test_discard s discard assertNotIn s s discard Q assertRaises TypeError s discard NYI __as_immutable__ s = thetype frozenset word assertIn thetype word s s discard thetype word assertNotIn thetype word s s discard thetype word test_pop _ range len s elem = s pop assertNotIn elem s assertRaises KeyError s pop test_update retval = s update otherword assertEqual retval None c word + otherword assertIn c s assertRaises PassThru s update check_pass_thru assertRaises TypeError s update p q cdc abcd efgfe abcefg ccb abc ef abcef C OrderedSet frozenset dict fromkeys str list tuple s = thetype abcba assertEqual s update C p None assertEqual s OrderedSet q p cdc efgfe ccb ef abcda q = ahi C OrderedSet frozenset dict fromkeys str list tuple s = thetype abcba assertEqual s update C p C q None assertEqual s OrderedSet s &#124; OrderedSet p &#124; OrderedSet q test_ior s &#124; = OrderedSet otherword c word + otherword assertIn c s test_intersection_update retval = s intersection_update otherword assertEqual retval None c word + otherword c otherword c word assertIn c s assertNotIn c s assertRaises PassThru s intersection_update check_pass_thru assertRaises TypeError s intersection_update p q cdc c efgfe ccb bc ef C OrderedSet frozenset dict fromkeys str list tuple s = thetype abcba assertEqual s intersection_update C p None assertEqual s OrderedSet q ss = abcba s = thetype ss t = cbc assertEqual s intersection_update C p C t None assertEqual s OrderedSet abcba OrderedSet p OrderedSet t test_iand s = OrderedSet otherword c word + otherword c otherword c word assertIn c s assertNotIn c s test_difference_update retval = s difference_update otherword assertEqual retval None c word + otherword c word c otherword assertIn c s assertNotIn c s assertRaises PassThru s difference_update check_pass_thru assertRaises TypeError s difference_update assertRaises TypeError s symmetric_difference_update p q cdc ab efgfe abc ccb ef abc C OrderedSet frozenset dict fromkeys str list tuple s = thetype abcba assertEqual s difference_update C p None assertEqual s OrderedSet q s = thetype abcdefghih s difference_update assertEqual s thetype abcdefghih s = thetype abcdefghih s difference_update C aba assertEqual s thetype cdefghih s = thetype abcdefghih s difference_update C cdc C aba assertEqual s thetype efghih test_isub s -= OrderedSet otherword c word + otherword c word c otherword assertIn c s assertNotIn c s test_symmetric_difference_update retval = s symmetric_difference_update otherword assertEqual retval None c word + otherword c word ^ c otherword assertIn c s assertNotIn c s assertRaises PassThru s symmetric_difference_update check_pass_thru assertRaises TypeError s symmetric_difference_update p q cdc abd codespell ignore efgfe abcefg ccb ef abcef C OrderedSet frozenset dict fromkeys str list tuple s = thetype abcba assertEqual s symmetric_difference_update C p None assertEqual s OrderedSet q test_ixor s ^= OrderedSet otherword c word + otherword c word ^ c otherword assertIn c s assertNotIn c s test_inplace_on_self t = s copy t &#124; = t assertEqual t s t = t assertEqual t s t -= t assertEqual t thetype t = s copy t ^= t assertEqual t thetype unittest skip Slots interferes weakrefs test_weakref s = thetype gallahad p = weakref proxy s assertEqual str p str s s = None support gc_collect For PyPy other GCs assertRaises ReferenceError str p test_rich_compare TestRichSetCompare __gt__ some_set gt_called = True False __lt__ some_set lt_called = True False __ge__ some_set ge_called = True False __le__ some_set le_called = True False This first tries builtin rich OrderedSet comparison which doesn t know how handle custom object Upon returning NotImplemented corresponding comparison right object invoked myset = myobj = TestRichSetCompare myset myobj noqa B assertTrue myobj gt_called myobj = TestRichSetCompare myset myobj noqa B assertTrue myobj lt_called myobj = TestRichSetCompare myset = myobj noqa B assertTrue myobj ge_called myobj = TestRichSetCompare myset = myobj noqa B assertTrue myobj le_called Tests taken test_sets py ============================================= empty_set = OrderedSet ============================================================================== TestBasicOps TestCase unittest skip Different repr test_repr repr None assertEqual repr OrderedSet repr check_repr_against_values text = repr OrderedSet assertTrue text startswith assertTrue text endswith result = text - split result sort sorted_repr_values = repr value value values sorted_repr_values sort assertEqual result sorted_repr_values test_length assertEqual len OrderedSet length test_self_equality assertEqual OrderedSet OrderedSet test_equivalent_equality assertEqual OrderedSet dup test_copy assertEqual OrderedSet copy dup test_self_union result = OrderedSet &#124; OrderedSet assertEqual result dup test_empty_union result = OrderedSet &#124; empty_set assertEqual result dup test_union_empty result = empty_set &#124; OrderedSet assertEqual result dup test_self_intersection result = OrderedSet OrderedSet assertEqual result dup test_empty_intersection result = OrderedSet empty_set assertEqual result empty_set test_intersection_empty result = empty_set OrderedSet assertEqual result empty_set test_self_isdisjoint result = OrderedSet isdisjoint OrderedSet assertEqual result OrderedSet test_empty_isdisjoint result = OrderedSet isdisjoint empty_set assertEqual result True test_isdisjoint_empty result = empty_set isdisjoint OrderedSet assertEqual result True test_self_symmetric_difference result = OrderedSet ^ OrderedSet assertEqual result empty_set test_empty_symmetric_difference result = OrderedSet ^ empty_set assertEqual result OrderedSet test_self_difference result = OrderedSet - OrderedSet assertEqual result empty_set test_empty_difference result = OrderedSet - empty_set assertEqual result dup test_empty_difference_rev result = empty_set - OrderedSet assertEqual result empty_set test_iteration v OrderedSet assertIn v values setiter = iter OrderedSet assertEqual setiter __length_hint__ len OrderedSet test_pickling proto range pickle HIGHEST_PROTOCOL + p = pickle dumps OrderedSet proto copy = pickle loads p assertEqual OrderedSet copy s = s OrderedSet copy noqa UP test_issue_ assertRaises TypeError OrderedSet difference assertRaises TypeError OrderedSet difference_update ------------------------------------------------------------------------------ TestBasicOpsEmpty TestBasicOps TestCase setUp case = empty OrderedSet values = OrderedSet = OrderedSet values dup = OrderedSet values length = repr = OrderedSet ------------------------------------------------------------------------------ TestBasicOpsSingleton TestBasicOps TestCase setUp case = unit OrderedSet number values = OrderedSet = OrderedSet values dup = OrderedSet values length = repr = test_in assertIn OrderedSet test_not_in assertNotIn OrderedSet ------------------------------------------------------------------------------ TestBasicOpsTuple TestBasicOps TestCase setUp case = unit OrderedSet tuple values = zero OrderedSet = OrderedSet values dup = OrderedSet values length = repr = zero test_in assertIn zero OrderedSet test_not_in assertNotIn OrderedSet ------------------------------------------------------------------------------ TestBasicOpsTriple TestBasicOps TestCase setUp case = triple OrderedSet values = zero operator add OrderedSet = OrderedSet values dup = OrderedSet values length = repr = None ------------------------------------------------------------------------------ TestBasicOpsString TestBasicOps TestCase setUp case = string OrderedSet values = b c OrderedSet = OrderedSet values dup = OrderedSet values length = unittest skip Different repr test_repr check_repr_against_values ------------------------------------------------------------------------------ TestBasicOpsBytes TestBasicOps TestCase setUp case = bytes OrderedSet values = b b b b c OrderedSet = OrderedSet values dup = OrderedSet values length = unittest skip Different repr test_repr check_repr_against_values ------------------------------------------------------------------------------ TestBasicOpsMixedStringBytes TestBasicOps TestCase setUp warnings simplefilter ignore BytesWarning case = string bytes OrderedSet values = b b b b OrderedSet = OrderedSet values dup = OrderedSet values length = unittest skip Different repr test_repr check_repr_against_values del TestBasicOps ============================================================================== baditer raise TypeError yield True gooditer yield True TestExceptionPropagation TestCase SF Set constructor should trap iterator TypeErrors test_instanceWithException assertRaises TypeError OrderedSet baditer test_instancesWithoutException All these iterables should load without exception OrderedSet OrderedSet OrderedSet one two three OrderedSet range OrderedSet abc OrderedSet gooditer test_changingSizeWhileIterating s = OrderedSet try _ s s update noqa B except RuntimeError pass fail no exception when changing size during iteration ============================================================================== TestSetOfSets TestCase test_constructor inner = frozenset outer = OrderedSet inner element = outer pop assertEqual type element frozenset outer add inner Rebuild OrderedSet sets add method outer remove inner assertEqual outer OrderedSet Verify remove worked outer discard inner Absence KeyError indicates working fine ============================================================================== TestBinaryOps TestCase setUp OrderedSet = OrderedSet test_eq SF bug assertEqual OrderedSet OrderedSet test_union_subset result = OrderedSet &#124; OrderedSet assertEqual result OrderedSet test_union_superset result = OrderedSet &#124; OrderedSet assertEqual result OrderedSet test_union_overlap result = OrderedSet &#124; OrderedSet assertEqual result OrderedSet test_union_non_overlap result = OrderedSet &#124; OrderedSet assertEqual result OrderedSet test_intersection_subset result = OrderedSet OrderedSet assertEqual result OrderedSet test_intersection_superset result = OrderedSet OrderedSet assertEqual result OrderedSet test_intersection_overlap result = OrderedSet OrderedSet assertEqual result OrderedSet test_intersection_non_overlap result = OrderedSet OrderedSet assertEqual result empty_set test_isdisjoint_subset result = OrderedSet isdisjoint OrderedSet assertEqual result False test_isdisjoint_superset result = OrderedSet isdisjoint OrderedSet assertEqual result False test_isdisjoint_overlap result = OrderedSet isdisjoint OrderedSet assertEqual result False test_isdisjoint_non_overlap result = OrderedSet isdisjoint OrderedSet assertEqual result True test_sym_difference_subset result = OrderedSet ^ OrderedSet assertEqual result OrderedSet test_sym_difference_superset result = OrderedSet ^ OrderedSet assertEqual result OrderedSet test_sym_difference_overlap result = OrderedSet ^ OrderedSet assertEqual result OrderedSet test_sym_difference_non_overlap result = OrderedSet ^ OrderedSet assertEqual result OrderedSet ============================================================================== TestUpdateOps TestCase setUp OrderedSet = OrderedSet test_union_subset OrderedSet &#124; = OrderedSet assertEqual OrderedSet OrderedSet test_union_superset OrderedSet &#124; = OrderedSet assertEqual OrderedSet OrderedSet test_union_overlap OrderedSet &#124; = OrderedSet assertEqual OrderedSet OrderedSet test_union_non_overlap OrderedSet &#124; = OrderedSet assertEqual OrderedSet OrderedSet test_union_method_call OrderedSet update OrderedSet assertEqual OrderedSet OrderedSet test_intersection_subset OrderedSet = OrderedSet assertEqual OrderedSet OrderedSet test_intersection_superset OrderedSet = OrderedSet assertEqual OrderedSet OrderedSet test_intersection_overlap OrderedSet = OrderedSet assertEqual OrderedSet OrderedSet test_intersection_non_overlap OrderedSet = OrderedSet assertEqual OrderedSet empty_set test_intersection_method_call OrderedSet intersection_update OrderedSet assertEqual OrderedSet OrderedSet test_sym_difference_subset OrderedSet ^= OrderedSet assertEqual OrderedSet OrderedSet test_sym_difference_superset OrderedSet ^= OrderedSet assertEqual OrderedSet OrderedSet test_sym_difference_overlap OrderedSet ^= OrderedSet assertEqual OrderedSet OrderedSet test_sym_difference_non_overlap OrderedSet ^= OrderedSet assertEqual OrderedSet OrderedSet test_sym_difference_method_call OrderedSet symmetric_difference_update OrderedSet assertEqual OrderedSet OrderedSet test_difference_subset OrderedSet -= OrderedSet assertEqual OrderedSet OrderedSet test_difference_superset OrderedSet -= OrderedSet assertEqual OrderedSet OrderedSet test_difference_overlap OrderedSet -= OrderedSet assertEqual OrderedSet OrderedSet test_difference_non_overlap OrderedSet -= OrderedSet assertEqual OrderedSet OrderedSet test_difference_method_call OrderedSet difference_update OrderedSet assertEqual OrderedSet OrderedSet ============================================================================== TestMutate TestCase setUp values = b c OrderedSet = OrderedSet values test_add_present OrderedSet add c assertEqual OrderedSet OrderedSet abc test_add_absent OrderedSet add d assertEqual OrderedSet OrderedSet abcd test_add_until_full tmp = OrderedSet expected_len = v values tmp add v expected_len += noqa SIM assertEqual len tmp expected_len assertEqual tmp OrderedSet test_remove_present OrderedSet remove b assertEqual OrderedSet OrderedSet ac test_remove_absent try OrderedSet remove d fail Removing missing element should have raised LookupError except LookupError pass test_remove_until_empty expected_len = len OrderedSet v values OrderedSet remove v expected_len -= assertEqual len OrderedSet expected_len test_discard_present OrderedSet discard c assertEqual OrderedSet OrderedSet ab test_discard_absent OrderedSet discard d assertEqual OrderedSet OrderedSet abc test_clear OrderedSet clear assertEqual len OrderedSet test_pop popped = while OrderedSet popped OrderedSet pop = None assertEqual len popped len values v values assertIn v popped test_update_empty_tuple OrderedSet update assertEqual OrderedSet OrderedSet values test_update_unit_tuple_overlap OrderedSet update assertEqual OrderedSet OrderedSet values test_update_unit_tuple_non_overlap OrderedSet update z assertEqual OrderedSet OrderedSet values + z ============================================================================== TestSubsets TestCase case method = = issubset = issuperset reverse = == == = = = = = = test_issubset type TestSubsets raise unittest SkipTest Only meant run subclass x = left y = right case = == = = expected = case cases Test binary infix spelling result = eval x + case + y locals assertEqual result expected Test friendly method-name spelling one exists case TestSubsets case method method = getattr x TestSubsets case method case result = method y assertEqual result expected Now do same operands reversed rcase = TestSubsets reverse case result = eval y + rcase + x locals assertEqual result expected rcase TestSubsets case method method = getattr y TestSubsets case method rcase result = method x assertEqual result expected ------------------------------------------------------------------------------ TestSubsetEqualEmpty TestSubsets TestCase left = OrderedSet right = OrderedSet name = both empty cases = == = = ------------------------------------------------------------------------------ TestSubsetEqualNonEmpty TestSubsets TestCase left = OrderedSet right = OrderedSet name = equal pair cases = == = = ------------------------------------------------------------------------------ TestSubsetEmptyNonEmpty TestSubsets TestCase left = OrderedSet right = OrderedSet name = one empty one non-empty cases = = = ------------------------------------------------------------------------------ TestSubsetPartial TestSubsets TestCase left = OrderedSet right = OrderedSet name = one non-empty proper subset other cases = = = ------------------------------------------------------------------------------ TestSubsetNonOverlap TestSubsets TestCase left = OrderedSet right = OrderedSet name = neither empty neither contains cases = = ============================================================================== TestOnlySetsInBinaryOps TestCase test_eq_ne Unlike others testing == = allowed assertEqual other == OrderedSet False assertEqual OrderedSet == other False assertEqual other = OrderedSet True assertEqual OrderedSet = other True test_ge_gt_le_lt pass assertRaises TypeError lambda OrderedSet other assertRaises TypeError lambda OrderedSet = other assertRaises TypeError lambda OrderedSet other assertRaises TypeError lambda OrderedSet = other assertRaises TypeError lambda other OrderedSet assertRaises TypeError lambda other = OrderedSet assertRaises TypeError lambda other OrderedSet assertRaises TypeError lambda other = OrderedSet test_update_operator try OrderedSet &#124; = other except TypeError pass fail expected TypeError test_update otherIsIterable OrderedSet update other assertRaises TypeError OrderedSet update other test_union assertRaises TypeError lambda OrderedSet &#124; other assertRaises TypeError lambda other &#124; OrderedSet otherIsIterable OrderedSet union other assertRaises TypeError OrderedSet union other test_intersection_update_operator try OrderedSet = other except TypeError pass fail expected TypeError test_intersection_update otherIsIterable OrderedSet intersection_update other assertRaises TypeError OrderedSet intersection_update other test_intersection assertRaises TypeError lambda OrderedSet other assertRaises TypeError lambda other OrderedSet otherIsIterable OrderedSet intersection other assertRaises TypeError OrderedSet intersection other test_sym_difference_update_operator try OrderedSet ^= other except TypeError pass fail expected TypeError test_sym_difference_update otherIsIterable OrderedSet symmetric_difference_update other assertRaises TypeError OrderedSet symmetric_difference_update other test_sym_difference assertRaises TypeError lambda OrderedSet ^ other assertRaises TypeError lambda other ^ OrderedSet otherIsIterable OrderedSet symmetric_difference other assertRaises TypeError OrderedSet symmetric_difference other test_difference_update_operator try OrderedSet -= other except TypeError pass fail expected TypeError test_difference_update otherIsIterable OrderedSet difference_update other assertRaises TypeError OrderedSet difference_update other test_difference assertRaises TypeError lambda OrderedSet - other assertRaises TypeError lambda other - OrderedSet otherIsIterable OrderedSet difference other assertRaises TypeError OrderedSet difference other ------------------------------------------------------------------------------ TestOnlySetsNumeric TestOnlySetsInBinaryOps TestCase setUp OrderedSet = OrderedSet other = otherIsIterable = False ------------------------------------------------------------------------------ TestOnlySetsDict TestOnlySetsInBinaryOps TestCase setUp OrderedSet = OrderedSet other = otherIsIterable = True ------------------------------------------------------------------------------ TestOnlySetsOperator TestOnlySetsInBinaryOps TestCase setUp OrderedSet = OrderedSet other = operator add otherIsIterable = False ------------------------------------------------------------------------------ TestOnlySetsTuple TestOnlySetsInBinaryOps TestCase setUp OrderedSet = OrderedSet other = otherIsIterable = True ------------------------------------------------------------------------------ TestOnlySetsString TestOnlySetsInBinaryOps TestCase setUp OrderedSet = OrderedSet other = abc otherIsIterable = True ------------------------------------------------------------------------------ TestOnlySetsGenerator TestOnlySetsInBinaryOps TestCase setUp gen i range noqa UP yield i OrderedSet = OrderedSet other = gen otherIsIterable = True del TestOnlySetsInBinaryOps ============================================================================== TestCopying test_copy dup = OrderedSet copy dup_list = sorted dup key=repr set_list = sorted OrderedSet key=repr assertEqual len dup_list len set_list i range len dup_list assertTrue dup_list i set_list i test_deep_copy dup = copy deepcopy OrderedSet print type dup repr dup dup_list = sorted dup key=repr set_list = sorted OrderedSet key=repr assertEqual len dup_list len set_list i range len dup_list assertEqual dup_list i set_list i ------------------------------------------------------------------------------ TestCopyingEmpty TestCopying TestCase setUp OrderedSet = OrderedSet ------------------------------------------------------------------------------ TestCopyingSingleton TestCopying TestCase setUp OrderedSet = OrderedSet hello ------------------------------------------------------------------------------ TestCopyingTriple TestCopying TestCase setUp OrderedSet = OrderedSet zero None ------------------------------------------------------------------------------ TestCopyingTuple TestCopying TestCase setUp OrderedSet = OrderedSet ------------------------------------------------------------------------------ TestCopyingNested TestCopying TestCase setUp OrderedSet = OrderedSet del TestCopying ============================================================================== TestIdentities TestCase setUp = OrderedSet abracadabra b = OrderedSet alacazam test_binopsVsSubsets b = b assertTrue - b assertTrue b - b assertTrue b assertTrue b b assertTrue &#124; b assertTrue &#124; b b assertTrue ^ b &#124; b test_commutativity b = b assertEqual b b assertEqual &#124; b b &#124; assertEqual ^ b b ^ = b assertNotEqual - b b - test_summations check sums parts equal whole b = b assertEqual - b &#124; b &#124; b - &#124; b assertEqual b &#124; ^ b &#124; b assertEqual &#124; b - &#124; b assertEqual - b &#124; b &#124; b assertEqual - b &#124; b assertEqual b - &#124; b b assertEqual - b &#124; b - ^ b test_exclusion check inverse operations show non-overlap b zero = b OrderedSet assertEqual - b b zero assertEqual b - zero assertEqual b ^ b zero Tests derived test_itertools py ======================================= R seqn Regular generator i seqn noqa UP yield i G Sequence using __getitem__ __init__ seqn seqn = seqn __getitem__ i seqn i I noqa E Sequence using iterator protocol __init__ seqn seqn = seqn i = __iter__ __next__ i = len seqn raise StopIteration v = seqn i i += v Ig Sequence using iterator protocol defined generator __init__ seqn seqn = seqn i = __iter__ val seqn noqa UP yield val X Missing __getitem__ __iter__ __init__ seqn seqn = seqn i = __next__ i = len seqn raise StopIteration v = seqn i i += v N Iterator missing __next__ __init__ seqn seqn = seqn i = __iter__ E Test propagation exceptions __init__ seqn seqn = seqn i = __iter__ __next__ S Test immediate stop __init__ seqn pass __iter__ __next__ raise StopIteration itertools chain L seqn Test multiple tiers iterators chain map lambda x x R Ig G seqn noqa C TestVariousIteratorArgs TestCase test_constructor cons OrderedSet frozenset s range do range g G I Ig S L R assertEqual sorted cons g s key=repr sorted g s key=repr assertRaises TypeError cons X s assertRaises TypeError cons N s assertRaises ZeroDivisionError cons E s test_inline_methods s = OrderedSet november data range do range december meth s union s intersection s difference s symmetric_difference s isdisjoint g G I Ig L R Only iterables supported sequences g G continue expected = meth data actual = meth g data isinstance expected bool assertEqual actual expected assertEqual sorted actual key=repr sorted expected key=repr assertRaises TypeError meth X s assertRaises TypeError meth N s assertRaises ZeroDivisionError meth E s test_inplace_methods data range do range december methname update intersection_update difference_update symmetric_difference_update g G I Ig S L R Only Iterables supported Sequence g G continue s = OrderedSet january t = s copy getattr s methname list g data getattr t methname g data assertEqual sorted s key=repr sorted t key=repr assertRaises TypeError getattr OrderedSet january methname X data assertRaises TypeError getattr OrderedSet january methname N data assertRaises ZeroDivisionError getattr OrderedSet january methname E data bad_eq __eq__ other be_bad set clear raise ZeroDivisionError other __hash__ bad_dict_clear __eq__ other be_bad dict clear other __hash__ TestWeirdBugs TestCase test_ _set_merge This used segfault global be_bad set dict be_bad = False set = bad_eq set = bad_eq i range be_bad = True assertRaises ZeroDivisionError set update set be_bad = False set = bad_dict_clear dict = bad_dict_clear None be_bad = True set symmetric_difference_update dict test_iter_and_mutate Issue s = OrderedSet range s clear s update range si = iter s s clear = list range s update range list si test_merge_and_mutate X __hash__ hash __eq__ o other clear False other = OrderedSet other = X i range s = s update other Application tests based David Eppstein s graph recipes ==================================== powerset U Generates all subsets OrderedSet sequence U U = iter U try x = frozenset next U S powerset U yield S yield S &#124; x except StopIteration yield frozenset cube n Graph n-dimensional hypercube singletons = frozenset x x range n dict noqa C x frozenset x ^ s s singletons x powerset range n linegraph G Graph vertices which edges G two vertices being adjacent iff corresponding edges share vertex L = x G y G x nx = frozenset x z z G x z = y ny = frozenset y z z G y z = x L frozenset x y = frozenset nx + ny L faces G Return OrderedSet faces G Where face OrderedSet vertices face currently limited triangles squares pentagons f = OrderedSet v edges G items v edges v G v v == v continue v G v f add frozenset v v v v G v v == v continue v G v f add frozenset v v v v v G v v == v v == v noqa SIM continue v G v f add frozenset v v v v v f TestGraphs TestCase test_cube g = cube vert -- v v v vertices = OrderedSet g assertEqual len vertices eight vertices edge g values assertEqual len edge each vertex connects three edges vertices = OrderedSet v edges g values v edges assertEqual vertices vertices edge vertices original OrderedSet cubefaces = faces g assertEqual len cubefaces six faces face cubefaces assertEqual len face each face square test_cuboctahedron http en wikipedia org wiki Cuboctahedron triangular faces square faces identical vertices each connecting triangle square g = cube cuboctahedron = linegraph g V -- V V V V assertEqual len cuboctahedron twelve vertices vertices = OrderedSet cuboctahedron edges cuboctahedron values assertEqual len edges each vertex connects four other vertices othervertices = OrderedSet edge edges cuboctahedron values edge edges assertEqual vertices othervertices edge vertices original OrderedSet cubofaces = faces cuboctahedron facesizes = collections defaultdict int face cubofaces facesizes len face += assertEqual facesizes eight triangular faces assertEqual facesizes six square faces vertex cuboctahedron edge = vertex Cuboctahedron vertices edges Cube assertEqual len edge Two cube vertices define edge cubevert edge assertIn cubevert g ============================================================================== __name__ == __main__ torch _inductor test_case run_tests run_tests