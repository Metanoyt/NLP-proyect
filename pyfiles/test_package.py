Owner s oncall export unittest torch torch _dynamo eval_frame is_dynamo_supported torch export Dim torch export experimental _ExportPackage torch testing _internal common_utils run_tests TestCase unittest skipIf is_dynamo_supported dynamo isn t supported TestPackage TestCase test_basic fn x torch Tensor - torch Tensor x + x = torch randn package = _ExportPackage assertEqual package _exporter fn fn x fn x assertEqual len package methods assertEqual len package methods fn fallbacks assertEqual len package methods fn overloads test_more_than_once fn x torch Tensor - torch Tensor x + x = torch randn package = _ExportPackage exporter = package _exporter fn fn exporter x assertRaisesRegex RuntimeError Cannot export more than once exporter x test_error fn x torch Tensor - torch Tensor x + x = torch randn package = _ExportPackage exporter = package _exporter fn fn fallback= error assertRaisesRegex RuntimeError Cannot export fallback when fallback policy set error exporter x test_overloads Module torch nn Module forward x torch Tensor - torch Tensor x shape == x + x shape == x - x + fn = Module x = torch randn x = torch randn x = torch randn spec x assert x shape == spec x assert x shape == spec x assert x shape = x Dim batch min= Dim STATIC package = _ExportPackage exporter = package _exporter fn fn _define_overload spec spec _define_overload spec spec _define_overload spec spec assertEqual exporter x x - assertEqual exporter x x + assertEqual exporter x x + assertEqual len package methods assertEqual len package methods fn overloads __name__ == __main__ run_tests