Owner s module fx collections abc Mapping torch torch fx passes infra partitioner CapabilityBasedPartitioner torch fx passes operator_support OperatorSupport torch testing _internal common_utils TestCase DummyDevOperatorSupport OperatorSupport is_node_supported submodules Mapping str torch nn Module node torch fx Node - bool True DummyPartitioner CapabilityBasedPartitioner __init__ graph_module torch fx GraphModule super __init__ graph_module DummyDevOperatorSupport allows_single_node_partition=True original graph node order x add add_ output AddModule torch nn Module forward x y = torch add x x z = torch add y x z TestPartitionerOrder TestCase partitoner test check graph node order remains same original graph after partitioning test_partitioner_graph_node_order m = AddModule traced_m = torch fx symbolic_trace m origin_node_order = n name n traced_m graph nodes partions = DummyPartitioner traced_m propose_partitions partion_nodes = list partition nodes partition partions partition_node_order = n name n partion_nodes assertTrue partition_node_order == origin_node_order partitoner test check graph node order remains same during multiple runs test_partitioner_multiple_runs_order m = AddModule traced_m = torch fx symbolic_trace m partitions = DummyPartitioner traced_m propose_partitions partition_nodes = list partition nodes partition partitions node_order = n name n partition_nodes _ range traced_m = torch fx symbolic_trace m new_partion = DummyPartitioner traced_m propose_partitions new_partion_nodes = list partition nodes partition new_partion new_node_order = n name n new_partion_nodes assertTrue node_order == new_node_order __name__ == __main__ raise RuntimeError This test currently used should enabled discover_tests py required