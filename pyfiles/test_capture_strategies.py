Owner s module onnx Unit tests _capture_strategies module __future__ annotations torch torch onnx _internal exporter _capture_strategies torch testing _internal common_utils common_utils instantiate_parametrized_tests ExportStrategiesTest common_utils TestCase common_utils parametrize strategy_cls _capture_strategies TorchExportStrictStrategy _capture_strategies TorchExportNonStrictStrategy _capture_strategies TorchExportDraftExportStrategy name_fn=lambda strategy_cls strategy_cls __name__ test_jit_isinstance strategy_cls Model torch nn Module forward b torch jit isinstance torch Tensor cos b sin model = Model = torch tensor b = torch tensor result = strategy_cls model b kwargs=None dynamic_shapes=None ep = result exported_program assert ep None torch testing assert_close ep module b model b test_draft_export_on_data_dependent_model Model torch nn Module forward b sum cos The branch expected specialized warning logged b sin model = Model = torch tensor b = torch tensor strategy = _capture_strategies TorchExportDraftExportStrategy assertLogs torch export level= WARNING cm result = strategy model b kwargs=None dynamic_shapes=None expected_warning = issue s found during export able soundly produce graph assertIn expected_warning str cm output ep = result exported_program assert ep None torch testing assert_close ep module b model b __name__ == __main__ common_utils run_tests