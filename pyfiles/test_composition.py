ruff noqa PGH G F flake noqa Owner s oncall distributed ################################################################################################# Copyright c - NVIDIA CORPORATION AFFILIATES All rights reserved SPDX-License-Identifier BSD- -Clause Redistribution use source binary forms without modification permitted provided following conditions met Redistributions source code must retain above copyright notice list conditions following disclaimer Redistributions binary form must reproduce above copyright notice list conditions following disclaimer documentation other materials provided distribution Neither name copyright holder nor names its contributors may used endorse promote products derived software without specific prior written permission THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT INDIRECT INCIDENTAL SPECIAL EXEMPLARY OR CONSEQUENTIAL DAMAGES INCLUDING BUT NOT LIMITED TO PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES LOSS OF USE DATA OR PROFITS OR BUSINESS INTERRUPTION HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY WHETHER IN CONTRACT STRICT LIABILITY OR TORT INCLUDING NEGLIGENCE OR OTHERWISE ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE ################################################################################################# Unit tests _pycute composition logging torch distributed _pycute torch testing _internal common_utils run_tests TestCase _LOGGER = logging getLogger __name__ TestComposition TestCase helper_test_composition layoutA layoutB layoutR = composition layoutA layoutB _LOGGER debug f layoutA o layoutB = layoutR True post-condition Every coordinate c layoutB L D c size layoutR coordinate layoutR Test R c = A B c all coordinates c layoutR i range size layoutR assertEqual layoutR i layoutA layoutB i test_composition layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB Pre-coalesced LHS layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB Pre-coalesced RHS layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB Case when meet stride divisibility condition assertRaises AssertionError layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB Mid-layout truncation layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB layoutA = Layout layoutB = Layout helper_test_composition layoutA layoutB __name__ == __main__ run_tests