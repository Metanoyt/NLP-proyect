sys benchmark_base BenchmarkBase torch torch _inductor utils fresh_cache Benchmark BenchmarkBase __init__ is_dynamic bool - None super __init__ category= mm_loop backend= inductor device= cuda dynamic=is_dynamic name - str prefix = f category _ backend is_dynamic prefix += _dynamic device == cuda prefix += _gpu prefix description - str mm times loop max auto tune _prepare_once - None = torch ones device=self device b = torch torch ones device=self device _prepare - None torch _dynamo reset _work - None torch compile backend= inductor fullgraph=True dynamic=self _dynamic f b z = torch mm b i range z = torch mm z b z fresh_cache torch _inductor config patch max_autotune=True f b main result_path = sys argv all_benchamrks = Benchmark False Benchmark True b all_benchamrks b enable_compile_time_instruction_count collect_all append_results result_path __name__ == __main__ main