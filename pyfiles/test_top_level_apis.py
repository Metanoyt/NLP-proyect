Owner s oncall quantization torch torch ao quantization torch testing _internal common_utils TestCase TestDefaultObservers TestCase observers = default_affine_fixed_qparams_observer default_debug_observer default_dynamic_quant_observer default_placeholder_observer default_fixed_qparams_range_ _observer default_fixed_qparams_range_neg _observer default_float_qparams_observer default_float_qparams_observer_ bit default_histogram_observer default_observer default_per_channel_weight_observer default_reuse_input_observer default_symmetric_fixed_qparams_observer default_weight_observer per_channel_weight_observer_range_neg_ _to_ weight_observer_range_neg_ _to_ fake_quants = default_affine_fixed_qparams_fake_quant default_dynamic_fake_quant default_embedding_fake_quant default_embedding_fake_quant_ bit default_fake_quant default_fixed_qparams_range_ _fake_quant default_fixed_qparams_range_neg _fake_quant default_fused_act_fake_quant default_fused_per_channel_wt_fake_quant default_fused_wt_fake_quant default_histogram_fake_quant default_per_channel_weight_fake_quant default_symmetric_fixed_qparams_fake_quant default_weight_fake_quant fused_per_channel_wt_fake_quant_range_neg_ _to_ fused_wt_fake_quant_range_neg_ _to_ _get_observer_ins observer obs_func = getattr torch ao quantization observer obs_func test_observers - None t = torch rand observer observers obs = _get_observer_ins observer obs forward t test_fake_quants - None t = torch rand observer fake_quants obs = _get_observer_ins observer obs forward t TestQConfig TestCase REDUCE_RANGE_DICT = fbgemm True False qnnpack False False onednn False False x True False test_reduce_range_qat - None backend reduce_ranges REDUCE_RANGE_DICT items version range qconfig = torch ao quantization get_default_qat_qconfig backend version fake_quantize_activ = qconfig activation assertEqual fake_quantize_activ activation_post_process reduce_range reduce_ranges fake_quantize_weight = qconfig weight assertEqual fake_quantize_weight activation_post_process reduce_range reduce_ranges test_reduce_range - None backend reduce_ranges REDUCE_RANGE_DICT items version range qconfig = torch ao quantization get_default_qconfig backend version fake_quantize_activ = qconfig activation assertEqual fake_quantize_activ reduce_range reduce_ranges fake_quantize_weight = qconfig weight assertEqual fake_quantize_weight reduce_range reduce_ranges __name__ == __main__ raise RuntimeError This test currently used should enabled discover_tests py required