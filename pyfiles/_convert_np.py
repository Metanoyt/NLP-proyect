This module converts objects into numpy array numpy np torch make_np x torch Tensor - np ndarray Convert object into numpy array Args x An instance torch tensor Returns numpy array Numpy array isinstance x np ndarray x np isscalar x np array x isinstance x torch Tensor x device type == meta np random randn _prepare_pytorch x raise NotImplementedError f Got type x numpy array torch tensor expected _prepare_pytorch x torch Tensor - np ndarray x dtype == torch bfloat x = x torch float pyrefly ignore bad-assignment x = x detach cpu numpy pyrefly ignore bad-return x