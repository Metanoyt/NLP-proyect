mypy ignore-errors sys pathlib Path sys path append str Path __file__ absolute parents train_decision AHTrainDecisionTree torch _inductor autoheuristic autoheuristic_utils mixed_mm_operations AHTrainDecisionTreeMixedMM AHTrainDecisionTree __init__ super __init__ add_new_features results ops = mixed_mm_operations added_categorical_features = op ops results op name = results apply op func axis= op is_categorical added_categorical_features append op name results added_categorical_features get_default_config row extern_fallback_mixed_mm get_allowed_wrong_prediction_pct okay have wrong predictions we introduce uncertainty marking leaves unsafe instead get_test_and_val_size is_unsafe_leaf row predicted_config choice time predicted_config choice time heuristic always returns unsure such case False predicted_time = choice time predicted_config fallback_time = choice time get_default_config row we mark leaves unsafe there chance our choice will slower than fallback we okay making wrong choice long our choice better than fallback because fallback default when max_autotune false fallback_time predicted_time get_grid_search_values A lot different hyperparameters perform very similar mixed_mm kind hard automatically pick one so I just manually picked one small max_depth max_depth min_samples_leaf criterion entropy __name__ == __main__ train = AHTrainDecisionTreeMixedMM train generate_heuristic