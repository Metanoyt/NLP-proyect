sys benchmark_base BenchmarkBase torch Benchmark BenchmarkBase __init__ super __init__ category= aotdispatcher_partitioner backend= aot_eager_decomp_partition device= cpu name f category _ device description partitioner benchmark input weights mix recompute non-recompute ops _prepare_once weights = torch randn requires_grad=True _ range inp = torch randn _prepare torch _dynamo reset _work torch compile backend=self backend fullgraph=True f inp weights x = inp w weights x = torch matmul w x sin sin x f inp weights main result_path = sys argv all = Benchmark benchmark all benchmark enable_compile_time_instruction_count collect_all append_results result_path __name__ == __main__ main