dataclasses dataclass torch torch distributed _shard metadata ShardMetadata torch distributed remote_device _remote_device dataclass Shard Container which holds data shard Tensor also associated metadata shard Args tensor torch Tensor Local tensor shard metadata ` torch distributed _shard sharded_tensor ShardMetadata ` The metadata shard including offsets lengths device placement __slots__ = tensor metadata tensor torch Tensor metadata ShardMetadata __post_init__ - None verification between local tensor metadata list tensor size = metadata shard_sizes raise ValueError Shard tensor size does match metadata shard_lengths f Found shard tensor size list tensor size f metadata shard_lengths metadata shard_sizes placement_device = metadata placement placement_device None placement_device device = tensor device raise ValueError f Local shard tensor device does match local Shard s placement f Found local shard tensor device tensor device f local shard metadata placement device placement_device device classmethod from_tensor_and_offsets cls tensor torch Tensor shard_offsets list int rank int - Shard Creates Shard ShardedTensor local torch Tensor shard_offsets rank Args tensor torch Tensor Local tensor shard shard_offsets List int List integers specify offset shard each dimension rank int Specify rank shard shard_sizes = list tensor size placement = _remote_device f rank rank str tensor device shard_meta = ShardMetadata shard_offsets=shard_offsets shard_sizes=shard_sizes placement=placement Shard tensor shard_meta