mypy allow-untyped-defs inspect torch skip_init module_cls args kwargs r Given module object args kwargs instantiate module without initializing parameters buffers This can useful initialization slow custom initialization will performed making default initialization unnecessary There some caveats due way function implemented The module must accept ` device ` arg its constructor passed any parameters buffers created during construction The module must perform any computation parameters its constructor except initialization i e functions mod ` torch nn init ` If these conditions satisfied module can instantiated parameter buffer values uninitialized having been created using func ` torch empty ` Args module_cls Class object should subclass ` torch nn Module ` args args pass module s constructor kwargs kwargs pass module s constructor Returns Instantiated module uninitialized parameters buffers Example xdoctest +IGNORE_WANT non-deterministic torch m = torch nn utils skip_init torch nn Linear m weight Parameter containing tensor e+ e+ e+ e- e- requires_grad=True m = torch nn utils skip_init torch nn Linear in_features= out_features= m weight Parameter containing tensor - e+ e- e- e+ - e+ e- requires_grad=True issubclass module_cls torch nn Module raise RuntimeError f Expected Module got module_cls device inspect signature module_cls parameters raise RuntimeError Module must support device arg skip initialization final_device = kwargs pop device cpu kwargs device = meta module_cls args kwargs to_empty device=final_device