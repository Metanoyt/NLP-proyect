torch ` SampleModule ` used ` test_cpp_api_parity py ` test Python C++ API parity test harness works ` torch nn Module ` subclasses When ` SampleModule has_parity ` true behavior ` forward ` ` backward ` same C++ equivalent When ` SampleModule has_parity ` false behavior ` forward ` ` backward ` different C++ equivalent SampleModule torch nn Module __init__ has_parity has_submodule super __init__ has_parity = has_parity has_submodule submodule = SampleModule has_parity False has_submodule = has_submodule register_parameter param torch nn Parameter torch empty reset_parameters reset_parameters torch no_grad param fill_ forward x submodule_forward_result = submodule x hasattr submodule has_parity x + param + submodule_forward_result x + param + submodule_forward_result + torch nn SampleModule = SampleModule SAMPLE_MODULE_CPP_SOURCE = \n namespace torch namespace nn struct C _EXPORT SampleModuleOptions SampleModuleOptions bool has_parity bool has_submodule has_parity_ has_parity has_submodule_ has_submodule TORCH_ARG bool has_parity TORCH_ARG bool has_submodule struct C _EXPORT SampleModuleImpl public torch nn Cloneable SampleModuleImpl explicit SampleModuleImpl SampleModuleOptions options options std move options options has_submodule submodule = register_module submodule std make_shared SampleModuleImpl SampleModuleOptions options has_parity false reset void reset param = register_parameter param torch ones torch Tensor forward torch Tensor x x + param + submodule submodule- forward x torch zeros_like x SampleModuleOptions options torch Tensor param std shared_ptr SampleModuleImpl submodule nullptr TORCH_MODULE SampleModule namespace nn namespace torch module_tests = dict module_name= SampleModule desc= has_parity constructor_args= True True cpp_constructor_args= torch nn SampleModuleOptions true true input_size= cpp_input_args= torch randn has_parity=True dict fullname= SampleModule_no_parity constructor=lambda SampleModule has_parity=False has_submodule=True cpp_constructor_args= torch nn SampleModuleOptions false true input_size= cpp_input_args= torch randn has_parity=False This test setting ` test_cpp_api_parity=False ` flag skips C++ API parity test accordingly otherwise test would run throw parity error dict fullname= SampleModule_THIS_TEST_SHOULD_BE_SKIPPED constructor=lambda SampleModule False True cpp_constructor_args= torch nn SampleModuleOptions false true input_size= cpp_input_args= torch randn test_cpp_api_parity=False