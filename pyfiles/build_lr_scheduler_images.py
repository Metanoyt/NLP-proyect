pathlib Path matplotlib matplotlib pyplot plt torch torch optim optim torch optim lr_scheduler ChainedScheduler ConstantLR CosineAnnealingLR CosineAnnealingWarmRestarts CyclicLR ExponentialLR LambdaLR LinearLR MultiplicativeLR MultiStepLR OneCycleLR PolynomialLR ReduceLROnPlateau SequentialLR StepLR matplotlib use Agg LR_SCHEDULER_IMAGE_PATH = Path __file__ parent lr_scheduler_images LR_SCHEDULER_IMAGE_PATH exists LR_SCHEDULER_IMAGE_PATH mkdir model = torch nn Linear optimizer = optim SGD model parameters lr= num_epochs = scheduler = ConstantLR optimizer factor= total_iters=num_epochs scheduler = ExponentialLR optimizer gamma= schedulers = lambda opt LambdaLR opt lr_lambda=lambda epoch epoch lambda opt MultiplicativeLR opt lr_lambda=lambda epoch lambda opt StepLR opt step_size= gamma= lambda opt MultiStepLR opt milestones= gamma= lambda opt ConstantLR opt factor= total_iters= lambda opt LinearLR opt start_factor= total_iters= lambda opt ExponentialLR opt gamma= lambda opt PolynomialLR opt total_iters=num_epochs power= lambda opt CosineAnnealingLR opt T_max=num_epochs lambda opt CosineAnnealingWarmRestarts opt T_ = lambda opt CyclicLR opt base_lr= max_lr= step_size_up= lambda opt OneCycleLR opt max_lr= epochs= steps_per_epoch= lambda opt ReduceLROnPlateau opt mode= min lambda opt ChainedScheduler scheduler scheduler lambda opt SequentialLR opt schedulers= scheduler scheduler milestones= num_epochs plot_function scheduler plt clf plt grid color= k alpha= linestyle= -- lrs = optimizer param_groups lr = scheduler = scheduler optimizer plot_path = LR_SCHEDULER_IMAGE_PATH f scheduler __class__ __name__ png plot_path exists _ range num_epochs lrs append optimizer param_groups lr isinstance scheduler ReduceLROnPlateau val_loss = torch randn item scheduler step val_loss scheduler step plt plot range num_epochs lrs plt title f Learning Rate scheduler __class__ __name__ plt xlabel Epoch plt ylabel Learning Rate plt xlim num_epochs plt savefig plot_path print f Saved learning rate scheduler image scheduler __class__ __name__ plot_path scheduler schedulers plot_function scheduler