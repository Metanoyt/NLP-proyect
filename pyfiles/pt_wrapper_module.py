torch WrapperModule Wraps instance wrapped_type For graph_mode traces instance wrapped_type Randomaly initializes num_params tensors single float element Args wrapped_type - Object type wrapped Expects wrapped_type - constructed pt_fn specified module_config - provide forward method takes module_config num_params args module_config - Specified pt_fn construct wrapped_type whether graph_mode enabled number parameters wrapped_type s forward method takes debug - Whether debug mode enabled save - In graph mode whether graph saved __init__ wrapped_type module_config debug save=False pt_fn = module_config pt_fn module = wrapped_type pt_fn tensor_inputs = module_name = wrapped_type __name__ _ range module_config num_params tensor_inputs append torch randn module_config graph_mode module = torch jit trace module tensor_inputs save file_name = module_name + _ + pt_fn __name__ + pt torch jit save module file_name print f Generated graph saved file_name print f Benchmarking module module_name fn pt_fn __name__ Graph mode module_config graph_mode debug isinstance module torch jit ScriptModule print module graph print module code forward niters torch no_grad _ range niters module forward tensor_inputs