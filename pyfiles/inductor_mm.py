triton benchmark_helper time_with_torch_timer torch torch _dynamo torch _dynamo config torch _inductor config config torch _inductor runtime benchmarking benchmarker The flag below controls whether allow TF matmul This flag defaults True torch backends cuda matmul allow_tf = True The flag below controls whether allow TF cuDNN This flag defaults True torch backends cudnn allow_tf = True torch _dynamo optimize inductor nopython=True inductor_aten_mm b torch mm b torch _dynamo optimize inductor nopython=True inductor_triton_mm b torch mm b torch_mm b torch mm b triton_mm b triton ops matmul b test_total_time shapes print shape torch mm triton mm inductor aten mm inductor triton mm i range len shapes a_shape b_shape = shapes i print a_shape x b_shape end= = torch randn a_shape device= cuda dtype=torch float b = torch randn b_shape device= cuda dtype=a dtype config triton mm = aten inductor_aten_mm b config triton mm = triton inductor_triton_mm b torch_ms = time_with_torch_timer torch_mm b mean triton_ms = time_with_torch_timer triton_mm b mean config triton mm = aten ind_aten_ms = time_with_torch_timer inductor_aten_mm b mean config triton mm = triton ind_triton_ms = time_with_torch_timer inductor_triton_mm b mean print torch_ms triton_ms ind_aten_ms ind_triton_ms sep= torch _dynamo reset test_GPU_time shapes print shape torch mm triton mm inductor aten mm inductor triton mm i range len shapes a_shape b_shape = shapes i print a_shape x b_shape end= = torch randn a_shape device= cuda dtype=torch float b = torch randn b_shape device= cuda dtype=a dtype config triton mm = aten inductor_aten_mm b config triton mm = triton inductor_triton_mm b torch_ms _ _ = benchmarker benchmark_gpu lambda torch_mm b triton_ms _ _ = benchmarker benchmark_gpu lambda triton_mm b ind_aten_ms _ _ = benchmarker benchmark_gpu lambda inductor_aten_mm b ind_triton_ms _ _ = benchmarker benchmark_gpu lambda inductor_triton_mm b print torch_ms triton_ms ind_aten_ms ind_triton_ms sep= torch _dynamo reset __name__ == __main__ shapes = alexnet BERT hf_GPT print test total time test_total_time shapes print test GPU time test_GPU_time shapes Results Preview AWS AI cluster test total time shape torch mm triton mm inductor aten mm inductor triton mm x x x x x x x x x x test GPU time shape torch mm triton mm inductor aten mm inductor triton mm x x x x x x x x x x