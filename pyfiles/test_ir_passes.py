Owner s module onnx Unit tests _ir_passes module __future__ annotations torch torch onnx _internal _lazy_import onnxscript_ir ir torch onnx _internal exporter _ir_passes torch testing _internal common_utils common_utils instantiate_parametrized_tests ONNXIRPassesTest common_utils TestCase common_utils parametrize shape_expr expected_shape_expr s batch_size sequence_length s s past_sequence_length sequence_length s + s masked_sequence_length batch_size test__replace_names_in_rename_axis shape_expr expected_shape_expr rename_mapping = s + s masked_sequence_length s past_sequence_length s sequence_length batch_size new_shape_expr = _ir_passes _replace_names shape_expr rename_mapping assertEqual new_shape_expr expected_shape_expr test_rename_axis_succeeds_when_mapping_is_not_sorted_and_contains_the_str_not_in_the_model model = ir Model ir Graph inputs= ir Value name= input_ type=ir DataType FLOAT shape=ir Shape s s ir Value name= input_ type=ir DataType FLOAT shape=ir Shape s + s s + s ir Value name= input_ type=ir DataType FLOAT shape=ir Shape s s + s s + s outputs= ir Value name= output type=ir DataType FLOAT shape=ir Shape s nodes= ir_version= producer_name= pytorch producer_version=torch __version__ mapping = s sequence_length s past_sequence_length s batch_size s + s masked_sequence_length s extra_sequence_length _ir_passes rename_axis model mapping assertEqual model graph inputs shape ir Shape batch_size sequence_length assertEqual model graph inputs shape ir Shape batch_size + past_sequence_length masked_sequence_length assertEqual model graph inputs shape ir Shape sequence_length masked_sequence_length masked_sequence_length __name__ == __main__ common_utils run_tests