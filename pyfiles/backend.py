argparse os path sys torch get_custom_backend_library_path Get path library containing custom backend Return The path custom backend object customized platform sys platform startswith win library_filename = custom_backend dll sys platform startswith darwin library_filename = libcustom_backend dylib library_filename = libcustom_backend so path = os path abspath f build library_filename assert os path exists path path path to_custom_backend module This helper wraps torch _C _jit_to_test_backend compiles only forward method empty compile spec Args module input ScriptModule Returns The module lowered so can run TestBackend lowered_module = torch _C _jit_to_backend custom_backend module forward lowered_module Model torch nn Module Simple model used testing to_backend API supports saving loading executing C++ forward b + b - b main parser = argparse ArgumentParser description= Lower Module custom backend parser add_argument -- export-module-to required=True options = parser parse_args Load library containing custom backend library_path = get_custom_backend_library_path torch ops load_library library_path assert library_path torch ops loaded_libraries Lower instance Model custom backend export specified location lowered_module = to_custom_backend torch jit script Model torch jit save lowered_module options export_module_to __name__ == __main__ main