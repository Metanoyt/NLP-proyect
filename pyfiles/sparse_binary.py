mypy allow-untyped-defs numpy np torch torch utils benchmark Fuzzer FuzzedParameter ParameterAlias FuzzedSparseTensor _MIN_DIM_SIZE = _MAX_DIM_SIZE = _POW_TWO_SIZES = tuple i i range int np log _MIN_DIM_SIZE int np log _MAX_DIM_SIZE + BinaryOpSparseFuzzer Fuzzer __init__ seed dtype=torch float cuda=False super __init__ parameters= Dimensionality x y e g D D D FuzzedParameter dim_parameter distribution= strict=True FuzzedParameter name= sparse_dim distribution= strict=True Shapes ` x ` ` y ` It important test all shapes however powers two especially important therefore warrant special attention This done generating both value drawn all integers between min max allowed values another only powers two both distributions loguniform then randomly selecting between two Moreover ` y ` will occasionally have singleton dimensions order test broadcasting FuzzedParameter name=f k_any_ i minval=_MIN_DIM_SIZE maxval=_MAX_DIM_SIZE distribution= loguniform i range FuzzedParameter name=f k_pow _ i distribution= size len _POW_TWO_SIZES size _POW_TWO_SIZES i range FuzzedParameter name=f k i distribution= ParameterAlias f k_any_ i ParameterAlias f k_pow _ i strict=True i range FuzzedParameter name=f y_k i distribution= ParameterAlias f k i strict=True i range FuzzedParameter name= density distribution= FuzzedParameter name= coalesced distribution= True False Repeatable entropy downstream applications FuzzedParameter name= random_value minval= maxval= - distribution= uniform tensors= FuzzedSparseTensor name= x size= k k k dim_parameter= dim_parameter sparse_dim= sparse_dim density= density coalesced= coalesced min_elements= max_elements= dtype=dtype cuda=cuda FuzzedSparseTensor name= y size= y_k y_k y_k dim_parameter= dim_parameter sparse_dim= sparse_dim density= density coalesced= coalesced min_elements= max_elements= dtype=dtype cuda=cuda seed=seed