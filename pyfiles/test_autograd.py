Owner s module PrivateUse os psutil torch torch testing _internal common_utils run_tests skipIfMPS skipIfTorchDynamo skipIfWindows TestCase TestAutograd TestCase Support MPS Windows platform later fix torchdynamo issue skipIfMPS skipIfWindows skipIfTorchDynamo test_autograd_init Make sure autograd initialized torch ones requires_grad=True device= openreg sum backward pid = os getpid task_path = f proc pid task all_threads = psutil Process pid threads all_thread_names = set t all_threads open f task_path t id comm file thread_name = file read strip all_thread_names add thread_name i range torch accelerator device_count assertIn f pt_autograd_ i all_thread_names __name__ == __main__ run_tests