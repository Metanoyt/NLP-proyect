mypy allow-untyped-defs typing Optional Union torch torch nan Tensor torch distributions constraints torch distributions exp_family ExponentialFamily torch distributions utils broadcast_all lazy_property logits_to_probs probs_to_logits torch nn functional binary_cross_entropy_with_logits torch types _Number Number __all__ = Bernoulli Bernoulli ExponentialFamily r Creates Bernoulli distribution parameterized attr ` probs ` attr ` logits ` both Samples binary They take value ` ` probability ` p ` ` ` probability ` - p ` Example xdoctest +IGNORE_WANT non-deterministic m = Bernoulli torch tensor m sample chance chance tensor Args probs Number Tensor probability sampling ` ` logits Number Tensor log-odds sampling ` ` validate_args bool optional whether validate arguments None default pyrefly ignore bad-override arg_constraints = probs constraints unit_interval logits constraints real support = constraints boolean has_enumerate_support = True _mean_carrier_measure = __init__ probs Optional Union Tensor Number = None logits Optional Union Tensor Number = None validate_args Optional bool = None - None probs None == logits None raise ValueError Either ` probs ` ` logits ` must specified both probs None is_scalar = isinstance probs _Number pyrefly ignore read-only probs = broadcast_all probs assert logits None helps mypy is_scalar = isinstance logits _Number pyrefly ignore read-only logits = broadcast_all logits _param = probs probs None logits is_scalar batch_shape = torch Size batch_shape = _param size super __init__ batch_shape validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance Bernoulli _instance batch_shape = torch Size batch_shape probs __dict__ new probs = probs expand batch_shape new _param = new probs logits __dict__ new logits = logits expand batch_shape new _param = new logits super Bernoulli new __init__ batch_shape validate_args=False new _validate_args = _validate_args new _new args kwargs _param new args kwargs property mean - Tensor probs property mode - Tensor mode = probs = probs mode probs == = nan mode property variance - Tensor probs - probs lazy_property logits - Tensor probs_to_logits probs is_binary=True lazy_property probs - Tensor logits_to_probs logits is_binary=True property param_shape - torch Size _param size sample sample_shape=torch Size shape = _extended_shape sample_shape torch no_grad torch bernoulli probs expand shape log_prob value _validate_args _validate_sample value logits value = broadcast_all logits value -binary_cross_entropy_with_logits logits value reduction= none entropy binary_cross_entropy_with_logits logits probs reduction= none enumerate_support expand=True values = torch arange dtype=self _param dtype device=self _param device values = values view - + len _batch_shape expand values = values expand - + _batch_shape values property _natural_params - tuple Tensor torch logit probs pyrefly ignore bad-override _log_normalizer x torch log p torch exp x