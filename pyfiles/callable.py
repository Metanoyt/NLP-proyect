mypy allow-untyped-defs collections abc Callable typing TypeVar torch utils data datapipes _decorator functional_datapipe torch utils data datapipes datapipe MapDataPipe torch utils data datapipes utils common _check_unpickable_fn __all__ = MapperMapDataPipe default_fn _T_co = TypeVar _T_co covariant=True Default function each item directly In order keep datapipe picklable eliminates usage python lambda function default_fn data data functional_datapipe map MapperMapDataPipe MapDataPipe _T_co r Apply input function over each item source DataPipe functional name ` ` map ` ` The function can any regular Python function partial object Lambda function recommended supported pickle Args datapipe Source MapDataPipe fn Function being applied each item Example xdoctest +SKIP torchdata datapipes map SequenceWrapper Mapper add_one x x + dp = SequenceWrapper range map_dp_ = dp map add_one list map_dp_ map_dp_ = Mapper dp lambda x x + list map_dp_ datapipe MapDataPipe fn Callable __init__ datapipe MapDataPipe fn Callable = default_fn - None super __init__ datapipe = datapipe _check_unpickable_fn fn fn = fn type ignore assignment __len__ - int pyrefly ignore bad-argument-type len datapipe __getitem__ index - _T_co fn datapipe index