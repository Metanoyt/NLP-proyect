mypy allow-untyped-defs math typing Optional Union torch torch Tensor torch distributions constraints torch distributions transformed_distribution TransformedDistribution torch distributions transforms AffineTransform ExpTransform torch distributions uniform Uniform torch distributions utils broadcast_all euler_constant torch types _Number __all__ = Gumbel Gumbel TransformedDistribution r Samples Gumbel Distribution Examples xdoctest +IGNORE_WANT non-deterministic m = Gumbel torch tensor torch tensor m sample sample Gumbel distribution loc= scale= tensor Args loc float Tensor Location parameter distribution scale float Tensor Scale parameter distribution arg_constraints = loc constraints real scale constraints positive pyrefly ignore bad-override support = constraints real __init__ loc Union Tensor float scale Union Tensor float validate_args Optional bool = None - None loc scale = broadcast_all loc scale finfo = torch finfo loc dtype isinstance loc _Number isinstance scale _Number base_dist = Uniform finfo tiny - finfo eps validate_args=validate_args base_dist = Uniform torch full_like loc finfo tiny torch full_like loc - finfo eps validate_args=validate_args transforms = ExpTransform inv AffineTransform loc= scale=-torch ones_like scale ExpTransform inv AffineTransform loc=loc scale=-self scale super __init__ base_dist transforms validate_args=validate_args expand batch_shape _instance=None new = _get_checked_instance Gumbel _instance new loc = loc expand batch_shape new scale = scale expand batch_shape super expand batch_shape _instance=new Explicitly defining log probability function Gumbel due precision issues log_prob value _validate_args _validate_sample value y = loc - value scale y - y exp - scale log property mean - Tensor loc + scale euler_constant property mode - Tensor loc property stddev - Tensor math pi math sqrt scale property variance - Tensor stddev pow entropy scale log + + euler_constant