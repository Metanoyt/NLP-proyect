Argsort operator implementation random typing Optional torch torchfuzz operators base Operator torchfuzz tensor_fuzzer fuzz_valid_stride Spec TensorSpec ArgsortOperator Operator Operator torch argsort operation __init__ Initialize ArgsortOperator super __init__ argsort property torch_op_name - Optional str Return torch operation name torch argsort can_produce output_spec Spec - bool Argsort can produce tensor outputs integer dtype long isinstance output_spec TensorSpec False argsort returns indices so must integer type long output_spec dtype == torch long len output_spec size fuzz_inputs_specs output_spec Spec - list Spec Generate input spec argsort operation torch argsort input dim=- descending=False returns tensor - Same shape input - dtype torch long indices isinstance output_spec TensorSpec raise ValueError ArgsortOperator can only produce TensorSpec outputs Input tensor has same shape output can have any numeric dtype input_size = output_spec size Generate valid stride input input_stride = fuzz_valid_stride input_size Choose random float dtype input argsort works numeric types Using float reasonable default input_dtype = torch float TensorSpec size=input_size stride=input_stride dtype=input_dtype codegen output_name str input_names list str output_spec Spec - str Generate code argsort operation isinstance output_spec TensorSpec raise ValueError ArgsortOperator can only produce TensorSpec outputs len input_names = raise ValueError ArgsortOperator requires exactly one input Randomly choose dimension sort along Default - last dimension s most common len output_spec size dim = random randint -len output_spec size len output_spec size - dim = Randomly choose ascending descending order descending = random choice True False f output_name = torch argsort input_names dim= dim descending= descending