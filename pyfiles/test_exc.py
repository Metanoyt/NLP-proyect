Owner s module dynamo logging unittest torch torch _dynamo torch _dynamo config torch _dynamo test_case torch _dynamo comptime comptime torch _dynamo exc Unsupported torch testing _internal common_device_type skipIf torch testing _internal common_utils IS_FBCODE munge_exc skipIfWindows TEST_Z torch testing _internal logging_utils LoggingTestCase make_logging_test ExcTests LoggingTestCase maxDiff = None test_unsupported_real_stack exercise Unsupported constructor augment_exc_message fn x torch _dynamo graph_break fn x x = x + fn x assertExpectedInlineMunged Unsupported lambda torch compile fn backend= eager fullgraph=True torch randn \ Call ` torch _dynamo graph_break ` Explanation User-inserted graph break Message None Hint Remove ` torch _dynamo graph_break ` call Developer debug context Called ` torch _dynamo graph_break ` args ` ` kwargs ` ` For more details about graph break please visit https meta-pytorch github io compile-graph-break-site gb gb html user code File test_exc py line N fn fn x File test_exc py line N fn torch _dynamo graph_break torch _dynamo config patch verbose=True suppress_errors=True make_logging_test unittest skipIf IS_FBCODE stack trace slightly different fbcode test_internal_error_suppress_errors records fn x f ctx raise AssertionError comptime f torch compile fn backend= eager torch randn record = getRecord records WON T CONVERT assertExpectedInline munge_exc record getMessage \ WON T CONVERT fn test_exc py line N ========== TorchDynamo Stack Trace ========== Traceback most recent call last File test_exc py line N f raise AssertionError AssertionError user code File test_exc py line N fn comptime f ========== The above exception occurred while processing following code ========== File test_exc py line N test_internal_error_suppress_errors torch compile fn backend= eager torch randn File test_exc py line N fn comptime f ========== make_logging_test test_not_implemented_error records fn x f ctx raise NotImplementedError Ensure graph break possible _ range comptime f torch compile fn backend= eager torch randn record = getRecord records WON T CONVERT assertExpectedInline munge_exc record getMessage \ WON T CONVERT fn test_exc py line N due Traceback most recent call last File test_exc py line N f raise NotImplementedError torch _dynamo exc InternalTorchDynamoError NotImplementedError user code File test_exc py line N fn comptime f torch _dynamo config patch inject_BUILD_SET_unimplemented_TESTING_ONLY=True make_logging_test dynamo=logging DEBUG test_unsupported_error records fn x torch compile fn backend= eager torch randn TODO There no graph break log This because graph break logging centralized location unsupported instruction bypasses getRecord records Graph break torch _dynamo config patch suppress_errors=False test_internal_error_no_suppress fn x NB avoid decorator changed line number attributed situation f ctx raise AssertionError comptime f NB OK user code truncated here because regular exception backtrace has rest crumbs assertExpectedInlineMunged AssertionError lambda torch compile fn backend= eager torch randn \ user code File test_exc py line N fn comptime f make_logging_test graph_breaks=True test_graph_break_log records fn x x = x + torch _dynamo graph_break x = x + x fn x fn x torch compile fn backend= eager torch randn record = getRecord records Graph break user code TODO This should also report enclosing frames need plumb frame object assertExpectedInline munge_exc record getMessage \ Graph break user code test_exc py N Graph Break Reason Call ` torch _dynamo graph_break ` Explanation User-inserted graph break Message None Hint Remove ` torch _dynamo graph_break ` call Developer debug context Called ` torch _dynamo graph_break ` args ` ` kwargs ` ` For more details about graph break please visit https meta-pytorch github io compile-graph-break-site gb gb html User code traceback File test_exc py line N test_graph_break_log torch compile fn backend= eager torch randn File test_exc py line N fn fn x File test_exc py line N fn torch _dynamo graph_break noqa B make_logging_test graph_breaks=True test_graph_break_log_generic_jump records fn x x sum x + x - torch compile fn backend= eager torch ones check record existence getRecord records Graph break user code torch _dynamo config patch suppress_errors=False test_backend_suppress_line fn x x = torch relu x x + Do NOT let get attributed x + assertExpectedInlineMunged torch _dynamo exc BackendCompilerFailed lambda torch compile fn backend= relu_compile_error_TESTING_ONLY torch randn \ backend= relu_compile_error_TESTING_ONLY raised ReluCompileError skipIf TEST_Z z installed torch _dynamo config patch assume_static_by_default=False suppress_errors=False torch fx experimental _config patch inject_EVALUATE_EXPR_flip_equality_TESTING_ONLY=True translation_validation=True translation_validation_no_bisect=True skipIfWindows msg= AssertionError tran chars s s s s \n == = + s s + s - chars noqa PLR = tran chars s s + s - s \n == = + s s chars test_trigger_on_error torch fx experimental validator ValidationException torch compile fn x shape x split shape assertExpectedInlineMunged ValidationException lambda fn torch randn \ translation validation failed Model == L shape == L shape == L shape == L x size == L x storage_offset == L x stride == s == s == s == s Assertions == == L x storage_offset == == L x stride == == L shape s == == L shape s == == L shape s == == L x size s == s Target Expressions == = + s s s s == = s == = s == = s == = s == == L x storage_offset == == L x stride == == L shape s == == L shape s == == L shape s == == L x size s == s == = s Failed Source Expressions == == + L shape L shape L shape L x size skipIf TEST_Z z installed torch _dynamo config patch assume_static_by_default=False suppress_errors=False torch fx experimental _config patch inject_EVALUATE_EXPR_flip_equality_TESTING_ONLY=True translation_validation=True test_trigger_bisect_on_error torch fx experimental validator BisectValidationException torch compile fn x shape x split shape assertExpectedInlineMunged BisectValidationException lambda fn torch randn \ translation validation failed when evaluating Eq s + s + s s Failure occurred while running node split num_users= = call_method target=split args = l_x_ l_shape_ _ l_shape_ _ l_shape_ _ kwargs = Model == L shape == L shape == L shape == L x size == L x storage_offset == L x stride == s == s == s == s Assertions == == L x storage_offset == == L x stride == == L shape s == == L shape s == == L shape s == == L x size s == s Target Expressions == = + s s s s == = s == = s == = s == = s == == L x storage_offset == == L x stride == == L shape s == == L shape s == == L shape s == == L x size s == s Failed Source Expressions == == + L shape L shape L shape L x size __name__ == __main__ torch _dynamo test_case run_tests run_tests