torch _GreenContext = object SUPPORTED = False hasattr torch _C _CUDAGreenContext _GreenContext = torch _C _CUDAGreenContext type ignore misc SUPPORTED = True Python shim helps Sphinx process docstrings more reliably pyrefly ignore invalid-inheritance GreenContext _GreenContext r Wrapper around CUDA green context warning This API beta may change future releases staticmethod create num_sms int device_id int = - _GreenContext r Create CUDA green context Arguments num_sms int The number SMs use green context device_id int optional The device index green context SUPPORTED raise RuntimeError PyTorch built Green Context support _GreenContext create num_sms device_id type ignore attr-defined Note these functions bypassed we define them here Sphinx documentation purposes set_context - None r Make green context current context super set_context type ignore misc pop_context - None r Assuming green context current context pop context stack restore previous context super pop_context type ignore misc