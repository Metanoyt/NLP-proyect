sys benchmark_base BenchmarkBase torch torch _inductor utils fresh_cache Benchmark BenchmarkBase __init__ backend dynamic=False is_gpu=False super __init__ category= add_loop backend=backend device= cuda is_gpu cpu dynamic=dynamic name prefix = f category _ backend is_dynamic prefix += _dynamic device == cuda prefix += _gpu prefix description loop over add node _prepare_once = torch ones device=self device b = torch torch ones device=self device _prepare torch _dynamo reset _work torch compile backend=self backend fullgraph=True dynamic=self is_dynamic f b result = clone i range i == result = result + b i == result = result + b result = result sin result fresh_cache f b main result_path = sys argv all = Benchmark eager Benchmark eager dynamic=True Benchmark inductor Benchmark inductor is_gpu=True Benchmark inductor is_gpu=True dynamic=True benchmark all benchmark enable_compile_time_instruction_count collect_all append_results result_path __name__ == __main__ main